var Mt=Object.defineProperty;var xt=(l,e,t)=>e in l?Mt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var U=(l,e,t)=>(xt(l,typeof e!="symbol"?e+"":e,t),t);import{r as Ne,s as Z,a as yt,u as Ct,g as It,b as Lt,x as Nt,e as fe,i as Dt,n as ne,y as de,c as pe,o as Rt,z as ze,A as Oe}from"../chunks/scheduler.C5v8YK5g.js";import{n as T,m as R,S as ee,i as te,e as N,c as D,a as A,d as m,l as v,g as C,z as K,t as le,b as re,h as I,j as ge,s as H,v as G,A as ie,f as M,w as q,x as X,r as ue,p as ae,B as ye,y as W,C as oe,D as me,E as he,o as Q,q as Re,F as $e,G as Ee,H as St,I as Ye}from"../chunks/index.ChYF1Lys.js";import{w as He}from"../chunks/index.CD1dNpfE.js";function J(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Me(l,e){T(l,1,1,()=>{e.delete(l.key)})}function xe(l,e,t,n,r,i,o,s,u,f,a,h){let c=l.length,b=i.length,_=c;const $={};for(;_--;)$[l[_].key]=_;const d=[],p=new Map,g=new Map,k=[];for(_=b;_--;){const E=h(r,i,_),F=t(E);let B=o.get(F);B?n&&k.push(()=>B.p(E,e)):(B=f(F,E),B.c()),p.set(F,d[_]=B),F in $&&g.set(F,Math.abs(_-$[F]))}const P=new Set,x=new Set;function L(E){R(E,1),E.m(s,a),o.set(E.key,E),a=E.first,b--}for(;c&&b;){const E=d[b-1],F=l[c-1],B=E.key,O=F.key;E===F?(a=E.first,c--,b--):p.has(O)?!o.has(B)||P.has(B)?L(E):x.has(O)?c--:g.get(B)>g.get(O)?(x.add(B),L(E)):(P.add(O),c--):(u(F,o),c--)}for(;c--;){const E=l[c];p.has(E.key)||u(E,o)}for(;b;)L(d[b-1]);return Ne(k),d}function Fe(l,e){const t={},n={},r={$$scope:1};let i=l.length;for(;i--;){const o=l[i],s=e[i];if(s){for(const u in o)u in s||(n[u]=1);for(const u in s)r[u]||(t[u]=s[u],r[u]=1);l[i]=s}else for(const u in o)r[u]=1}for(const o in n)o in t||(t[o]=void 0);return t}function je(l){return typeof l=="object"&&l!==null?l:{}}let At=class{constructor(e,t,n){U(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},zt=class{constructor(e,t,n,r){U(this,"ttl",32);U(this,"label",-1);U(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=r;const i=t.firstHop.get(n.address);if(!i)return;const o=V.getRouter(i);o&&(this.nextHop=o)}decrementTTL(){--this.ttl<=0&&this.drop()}drop(){V.deletePacket(this.id)}},Ue=class{constructor(e,t){this.id=e,this.node=t}};class _e extends Ue{constructor(){super(...arguments);U(this,"address",`CE-IP-${this.id}`);U(this,"firstHop",new Map);U(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});U(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});U(this,"updateAddress",(t,n)=>{const r=this.firstHop.get(t);if(!r){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,r),this.firstHop.delete(t)});U(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop()}get type(){return"CE"}}let Tt=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});U(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}},Ot=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});U(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class ve extends Ue{constructor(){super(...arguments);U(this,"FIB",new Ot);U(this,"LIB",new Tt)}receivePacket(t){var r,i,o,s;const n=t.destination;if(t.label===-1){const u=(r=this.FIB.get(n.address))==null?void 0:r.nextHop;if(!u)return;const f=(i=this.FIB.get(n.address))==null?void 0:i.label;if(!f)return;t.label=f;const a=V.getRouter(parseInt(u));if(!a)return;t.nextHop=a}else{const u=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!u)return;const f=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!f)return;t.label=f;const a=V.routers.find(h=>h instanceof _e&&h.address===u);if(!a)return;t.nextHop=a}t.decrementTTL()}get type(){return"LER"}}class Pe extends Ue{constructor(){super(...arguments);U(this,"LIB",new Tt)}receivePacket(t){var o,s;const n=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!n)return;const r=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!r)return;t.label=r;const i=V.getRouter(parseInt(n));i&&(t.nextHop=i,t.decrementTTL())}get type(){return"LSR"}}const Ft={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class jt{constructor(){U(this,"store",He({routers:[],links:[],packets:[]}));U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_routers",[]);U(this,"_links",[]);U(this,"_packets",[]);U(this,"routerMap",new Map);U(this,"CEMap",new Map);U(this,"routerCounter",1);U(this,"packetCounter",1)}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!Ft[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new At(`${e.source.id}-${e.target.id}`,e.source,e.target);this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,r=new _e(n,{label:`CE ${n}`,x:e,y:t});this.addRouter(r)}createLER(e,t){const n=this.routerCounter++,r=new ve(n,{label:`LER ${n}`,x:e,y:t});this.addRouter(r)}createLSR(e,t){const n=this.routerCounter++,r=new Pe(n,{label:`LSR ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(r)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof _e&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof _e&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){const n=new zt(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=1,this.packetCounter=1,this.notify()}notify(){this.store.set(this.networkState)}}const Ut=new jt,V=Ut,De=He({running:!0,speedMultiplier:1});class Vt{constructor(){U(this,"store",He());U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_map",new Map)}getPath(e,t){const n=this._map.get(e);if(n)return n.get(t)}findShortestPath(e,t){return Ge(e,t)}findShortestPaths(){const e=new Map,t=V.routers.filter(n=>n.type==="CE");for(const n of t){const r=new Map;for(const i of t){if(n===i)continue;const o=Ge(n,i);r.set(i.id,o)}e.set(n.id,r)}this._map=e}notify(){this.store.set(this._map)}}function Ge(l,e){const t=V.routers,n=t.length,r=new Array(n).fill(1/0),i=new Array(n).fill(!1),o=new Array(n).fill(null);r[t.indexOf(l)]=0;let s=!1;for(;!s;){let a=null,h=1/0;for(let c=0;c<n;c++)!i[c]&&r[c]<h&&(a=t[c],h=r[c]);if(!a||a.id===e.id){s=!0;continue}i[t.indexOf(a)]=!0;for(const c of V.links){let b;if(c.source===a)b=c.target;else if(c.target===a)b=c.source;else continue;const _=t.indexOf(b),$=h+c.distance;$<r[_]&&(r[_]=$,o[_]=a)}}const u=[];let f=e;for(;f;){u.unshift(f);const a=t.indexOf(f);f=o[a]}return u}const Yt=new Vt,Pt=Yt,Le=He(!1);function Gt(l){let e,t,n,r;const i=l[2].default,o=yt(i,l,l[1],null);return{c(){e=N("dialog"),o&&o.c(),this.h()},l(s){e=D(s,"DIALOG",{class:!0});var u=A(e);o&&o.l(u),u.forEach(m),this.h()},h(){v(e,"class","svelte-p5wejv")},m(s,u){C(s,e,u),o&&o.m(e,null),l[4](e),t=!0,n||(r=K(e,"close",l[3]),n=!0)},p(s,[u]){o&&o.p&&(!t||u&2)&&Ct(o,i,s,s[1],t?Lt(i,s[1],u,null):It(s[1]),null)},i(s){t||(R(o,s),t=!0)},o(s){T(o,s),t=!1},d(s){s&&m(e),o&&o.d(s),l[4](null),n=!1,r()}}}function qt(l,e,t){let{$$slots:n={},$$scope:r}=e,{dialog:i}=e;function o(u){Nt.call(this,l,u)}function s(u){fe[u?"unshift":"push"](()=>{i=u,t(0,i)})}return l.$$set=u=>{"dialog"in u&&t(0,i=u.dialog),"$$scope"in u&&t(1,r=u.$$scope)},[i,r,n,o,s]}class Ve extends ee{constructor(e){super(),te(this,e,qt,Gt,Z,{dialog:0})}}const qe=16,Xt=2**20-1;function Bt(l,e){const t=l[0];if(!(t instanceof _e)){alert("The path does not start with a CE");return}if(t.firstHop.has(e)){alert("The destination is already in the CE's first hop");return}const n=l.length-2,r=l[n];if(!(r instanceof ve)){alert("Destination CE is not connected directly to a LER");return}let i=Xe(l[n]);r.LIB.receiveEntry(i,-1,e);for(let o=l.length-2;o>0;o--){const s=l[o],u=l[o-1],f=i;i=Xe(s),u instanceof ve?u.FIB.receiveEntry(e,f,s.id.toString()):u instanceof Pe&&u.LIB.receiveEntry(i,f,s.id.toString())}t.firstHop.set(e,l[1].id)}function Wt(l,e){return l instanceof Pe||l instanceof ve?l.LIB.map.has(e):!1}function Xe(l){let e;do e=Math.floor(Math.random()*(Xt-qe+1)+qe);while(Wt(l,e));return e}function Kt(l){let e,t,n,r;return{c(){e=N("button"),t=le(l[0]),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var o=A(e);t=re(o,l[0]),o.forEach(m),this.h()},h(){v(e,"class","svelte-17itt71")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"click",function(){Dt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&ge(t,l[0])},i:ne,o:ne,d(i){i&&m(e),n=!1,r()}}}function Jt(l,e,t){let{text:n}=e,{callback:r}=e;return l.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,r=i.callback)},[n,r]}class Ce extends ee{constructor(e){super(),te(this,e,Jt,Kt,Z,{text:0,callback:1})}}function We(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n}function Ke(l){let e,t,n,r,i,o,s,u,f,a,h,c,b,_;function $(...g){return l[4](l[7],...g)}function d(...g){return l[5](l[7],...g)}function p(){return l[6](l[7])}return a=new Ce({props:{text:"-",callback:p}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),f=H(),G(a.$$.fragment),h=H(),this.h()},l(g){e=D(g,"TR",{});var k=A(e);t=D(k,"TD",{});var P=A(t);n=D(P,"INPUT",{type:!0,placeholder:!0}),P.forEach(m),i=M(k),o=D(k,"TD",{});var x=A(o);s=D(x,"INPUT",{type:!0,placeholder:!0}),x.forEach(m),f=M(k),q(a.$$.fragment,k),h=M(k),k.forEach(m),this.h()},h(){v(n,"type","text"),n.value=r=l[7],v(n,"placeholder","Address"),v(s,"type","text"),s.value=u=l[8],v(s,"placeholder","Link")},m(g,k){C(g,e,k),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),I(e,f),X(a,e,null),I(e,h),c=!0,b||(_=[K(n,"change",$),K(s,"change",d)],b=!0)},p(g,k){l=g,(!c||k&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),(!c||k&1&&u!==(u=l[8])&&s.value!==u)&&(s.value=u);const P={};k&1&&(P.callback=p),a.$set(P)},i(g){c||(R(a.$$.fragment,g),c=!0)},o(g){T(a.$$.fragment,g),c=!1},d(g){g&&m(e),W(a),b=!1,Ne(_)}}}function Qt(l){let e,t="Destinations:",n,r,i,o="<tr><th>Destination</th> <th>First hop</th> <th></th></tr>",s,u,f,a,h,c,b=J([...l[0].firstHop]),_=[];for(let d=0;d<b.length;d+=1)_[d]=Ke(We(l,b,d));const $=d=>T(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1ixmdgd"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var p=A(r);i=D(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1uq9vp1"&&(i.innerHTML=o),s=M(p),u=D(p,"TBODY",{});var g=A(u);for(let P=0;P<_.length;P+=1)_[P].l(g);g.forEach(m),p.forEach(m),f=M(d),a=D(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(m),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&13){b=J([...d[0].firstHop]);let k;for(k=0;k<b.length;k+=1){const P=We(d,b,k);_[k]?(_[k].p(P,p),R(_[k],1)):(_[k]=Ke(P),_[k].c(),R(_[k],1),_[k].m(u,null))}for(ue(),k=b.length;k<_.length;k+=1)$(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<b.length;p+=1)R(_[p]);R(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)T(_[p]);T(h.$$.fragment,d),c=!1},d(d){d&&(m(e),m(n),m(r),m(f),m(a)),ye(_,d),W(h)}}}function Zt(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=a.target.value.toUpperCase();n.updateAddress(h,c);const b=V.getCERouter(c);if(!b){alert("Destination router not found.");return}const _=Pt.findShortestPath(n,b);Bt(_,c),t(0,n)}function o(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=parseInt(a.target.value);n.firstHop.set(h,c)}const s=(a,h)=>{i(h,a)},u=(a,h)=>{o(h,a)},f=a=>{n.firstHop.delete(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class en extends ee{constructor(e){super(),te(this,e,Zt,Qt,Z,{router:0})}}function Je(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Qe(l){let e,t,n,r,i,o,s,u,f,a,h,c,b,_,$,d;function p(...x){return l[3](l[7],...x)}function g(){l[4].call(s,l[9],l[10])}function k(){l[5].call(a,l[9],l[10])}function P(){return l[6](l[7])}return c=new Ce({props:{text:"-",callback:P}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),u=H(),f=N("td"),a=N("input"),h=H(),G(c.$$.fragment),b=H(),this.h()},l(x){e=D(x,"TR",{});var L=A(e);t=D(L,"TD",{});var E=A(t);n=D(E,"INPUT",{type:!0}),E.forEach(m),i=M(L),o=D(L,"TD",{});var F=A(o);s=D(F,"INPUT",{type:!0}),F.forEach(m),u=M(L),f=D(L,"TD",{});var B=A(f);a=D(B,"INPUT",{type:!0}),B.forEach(m),h=M(L),q(c.$$.fragment,L),b=M(L),L.forEach(m),this.h()},h(){v(n,"type","number"),n.value=r=l[7],v(s,"type","number"),v(a,"type","text")},m(x,L){C(x,e,L),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),oe(s,l[8].outgoingLabel),I(e,u),I(e,f),I(f,a),oe(a,l[8].nextHop),I(e,h),X(c,e,null),I(e,b),_=!0,$||(d=[K(n,"change",p),K(s,"input",g),K(a,"input",k)],$=!0)},p(x,L){l=x,(!_||L&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),L&1&&me(s.value)!==l[8].outgoingLabel&&oe(s,l[8].outgoingLabel),L&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const E={};L&1&&(E.callback=P),c.$set(E)},i(x){_||(R(c.$$.fragment,x),_=!0)},o(x){T(c.$$.fragment,x),_=!1},d(x){x&&m(e),W(c),$=!1,Ne(d)}}}function tn(l){let e,t="LIB:",n,r,i,o="<tr><th>Incoming</th> <th>Outgoing</th> <th>Next hop</th> <th></th></tr>",s,u,f,a,h,c,b=J([...l[0].LIB.map]),_=[];for(let d=0;d<b.length;d+=1)_[d]=Qe(Je(l,b,d));const $=d=>T(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].LIB.addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1j64kst"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var p=A(r);i=D(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1fy2y89"&&(i.innerHTML=o),s=M(p),u=D(p,"TBODY",{});var g=A(u);for(let P=0;P<_.length;P+=1)_[P].l(g);g.forEach(m),p.forEach(m),f=M(d),a=D(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(m),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&5){b=J([...d[0].LIB.map]);let k;for(k=0;k<b.length;k+=1){const P=Je(d,b,k);_[k]?(_[k].p(P,p),R(_[k],1)):(_[k]=Qe(P),_[k].c(),R(_[k],1),_[k].m(u,null))}for(ue(),k=b.length;k<_.length;k+=1)$(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].LIB.addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<b.length;p+=1)R(_[p]);R(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)T(_[p]);T(h.$$.fragment,d),c=!1},d(d){d&&(m(e),m(n),m(r),m(f),m(a)),ye(_,d),W(h)}}}function nn(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=parseInt(a.target.value);n.LIB.updateLabel(h,c)}const o=(a,h)=>{i(h,a)};function s(a,h){a[h][1].outgoingLabel=me(this.value),t(0,n)}function u(a,h){a[h][1].nextHop=this.value,t(0,n)}const f=a=>{n.LIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class ln extends ee{constructor(e){super(),te(this,e,nn,tn,Z,{router:0})}}function Ze(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function et(l){let e,t,n,r,i,o,s,u,f,a,h,c,b,_,$,d;function p(...x){return l[3](l[7],...x)}function g(){l[4].call(s,l[9],l[10])}function k(){l[5].call(a,l[9],l[10])}function P(){return l[6](l[7])}return c=new Ce({props:{text:"-",callback:P}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),u=H(),f=N("td"),a=N("input"),h=H(),G(c.$$.fragment),b=H(),this.h()},l(x){e=D(x,"TR",{});var L=A(e);t=D(L,"TD",{});var E=A(t);n=D(E,"INPUT",{type:!0}),E.forEach(m),i=M(L),o=D(L,"TD",{});var F=A(o);s=D(F,"INPUT",{type:!0}),F.forEach(m),u=M(L),f=D(L,"TD",{});var B=A(f);a=D(B,"INPUT",{type:!0}),B.forEach(m),h=M(L),q(c.$$.fragment,L),b=M(L),L.forEach(m),this.h()},h(){v(n,"type","text"),n.value=r=l[7],v(s,"type","number"),v(a,"type","text")},m(x,L){C(x,e,L),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),oe(s,l[8].label),I(e,u),I(e,f),I(f,a),oe(a,l[8].nextHop),I(e,h),X(c,e,null),I(e,b),_=!0,$||(d=[K(n,"change",p),K(s,"input",g),K(a,"input",k)],$=!0)},p(x,L){l=x,(!_||L&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),L&1&&me(s.value)!==l[8].label&&oe(s,l[8].label),L&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const E={};L&1&&(E.callback=P),c.$set(E)},i(x){_||(R(c.$$.fragment,x),_=!0)},o(x){T(c.$$.fragment,x),_=!1},d(x){x&&m(e),W(c),$=!1,Ne(d)}}}function rn(l){let e,t="FIB:",n,r,i,o="<tr><th>Address</th> <th>Label</th> <th>Next hop</th> <th></th></tr>",s,u,f,a,h,c,b=J([...l[0].FIB.map]),_=[];for(let d=0;d<b.length;d+=1)_[d]=et(Ze(l,b,d));const $=d=>T(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].FIB.addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1j6bdhj"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var p=A(r);i=D(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1qhs6t7"&&(i.innerHTML=o),s=M(p),u=D(p,"TBODY",{});var g=A(u);for(let P=0;P<_.length;P+=1)_[P].l(g);g.forEach(m),p.forEach(m),f=M(d),a=D(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(m),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&5){b=J([...d[0].FIB.map]);let k;for(k=0;k<b.length;k+=1){const P=Ze(d,b,k);_[k]?(_[k].p(P,p),R(_[k],1)):(_[k]=et(P),_[k].c(),R(_[k],1),_[k].m(u,null))}for(ue(),k=b.length;k<_.length;k+=1)$(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].FIB.addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<b.length;p+=1)R(_[p]);R(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)T(_[p]);T(h.$$.fragment,d),c=!1},d(d){d&&(m(e),m(n),m(r),m(f),m(a)),ye(_,d),W(h)}}}function on(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=a.target.value;n.FIB.updateAddress(h,c)}const o=(a,h)=>{i(h,a)};function s(a,h){a[h][1].label=me(this.value),t(0,n)}function u(a,h){a[h][1].nextHop=this.value,t(0,n)}const f=a=>{n.FIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class sn extends ee{constructor(e){super(),te(this,e,on,rn,Z,{router:0})}}function un(l){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=N("p"),e.textContent=t},l(n){e=D(n,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&m(e)}}}function an(l){let e,t,n,r,i,o,s,u,f,a,h,c,b,_,$=l[0].id+"",d,p,g,k,P,x,L,E,F,B,O=l[0]instanceof _e&&tt(l),w=l[0]instanceof ve&&nt(l),z=(l[0]instanceof ve||l[0]instanceof Pe)&&lt(l);return L=new Ce({props:{text:"Delete Router",callback:l[3]}}),{c(){e=N("div"),t=N("div"),n=N("label"),r=le(`Label:
          `),i=N("input"),o=H(),s=N("label"),u=le(`Position:
        `),f=N("input"),a=H(),h=N("input"),c=H(),b=N("p"),_=le("ID: "),d=le($),p=H(),O&&O.c(),g=H(),w&&w.c(),k=H(),z&&z.c(),P=H(),x=N("div"),G(L.$$.fragment),this.h()},l(S){e=D(S,"DIV",{});var j=A(e);t=D(j,"DIV",{});var ke=A(t);n=D(ke,"LABEL",{});var be=A(n);r=re(be,`Label:
          `),i=D(be,"INPUT",{type:!0,class:!0}),be.forEach(m),ke.forEach(m),o=M(j),s=D(j,"LABEL",{});var Ie=A(s);u=re(Ie,`Position:
        `),f=D(Ie,"INPUT",{type:!0,class:!0}),a=M(Ie),h=D(Ie,"INPUT",{type:!0,class:!0}),Ie.forEach(m),c=M(j),b=D(j,"P",{});var Te=A(b);_=re(Te,"ID: "),d=re(Te,$),Te.forEach(m),j.forEach(m),p=M(S),O&&O.l(S),g=M(S),w&&w.l(S),k=M(S),z&&z.l(S),P=M(S),x=D(S,"DIV",{class:!0});var Be=A(x);q(L.$$.fragment,Be),Be.forEach(m),this.h()},h(){v(i,"type","text"),v(i,"class","svelte-cihl2i"),v(f,"type","number"),f.disabled=l[2],v(f,"class","svelte-cihl2i"),v(h,"type","number"),h.disabled=l[2],v(h,"class","svelte-cihl2i"),v(x,"class","margin-top svelte-cihl2i")},m(S,j){C(S,e,j),I(e,t),I(t,n),I(n,r),I(n,i),oe(i,l[0].node.label),I(e,o),I(e,s),I(s,u),I(s,f),oe(f,l[0].node.x),I(s,a),I(s,h),oe(h,l[0].node.y),I(e,c),I(e,b),I(b,_),I(b,d),C(S,p,j),O&&O.m(S,j),C(S,g,j),w&&w.m(S,j),C(S,k,j),z&&z.m(S,j),C(S,P,j),C(S,x,j),X(L,x,null),E=!0,F||(B=[K(i,"input",l[4]),K(f,"input",l[5]),K(h,"input",l[6]),K(e,"input",l[7])],F=!0)},p(S,j){j&1&&i.value!==S[0].node.label&&oe(i,S[0].node.label),(!E||j&4)&&(f.disabled=S[2]),j&1&&me(f.value)!==S[0].node.x&&oe(f,S[0].node.x),(!E||j&4)&&(h.disabled=S[2]),j&1&&me(h.value)!==S[0].node.y&&oe(h,S[0].node.y),(!E||j&1)&&$!==($=S[0].id+"")&&ge(d,$),S[0]instanceof _e?O?(O.p(S,j),j&1&&R(O,1)):(O=tt(S),O.c(),R(O,1),O.m(g.parentNode,g)):O&&(ue(),T(O,1,1,()=>{O=null}),ae()),S[0]instanceof ve?w?(w.p(S,j),j&1&&R(w,1)):(w=nt(S),w.c(),R(w,1),w.m(k.parentNode,k)):w&&(ue(),T(w,1,1,()=>{w=null}),ae()),S[0]instanceof ve||S[0]instanceof Pe?z?(z.p(S,j),j&1&&R(z,1)):(z=lt(S),z.c(),R(z,1),z.m(P.parentNode,P)):z&&(ue(),T(z,1,1,()=>{z=null}),ae())},i(S){E||(R(O),R(w),R(z),R(L.$$.fragment,S),E=!0)},o(S){T(O),T(w),T(z),T(L.$$.fragment,S),E=!1},d(S){S&&(m(e),m(p),m(g),m(k),m(P),m(x)),O&&O.d(S),w&&w.d(S),z&&z.d(S),W(L),F=!1,Ne(B)}}}function tt(l){let e,t="Address:",n,r,i=l[0].address+"",o,s,u,f,a,h,c,b;function _(d){l[9](d)}let $={};return l[0]!==void 0&&($.router=l[0]),f=new en({props:$}),fe.push(()=>he(f,"router",_)),{c(){e=N("p"),e.textContent=t,n=H(),r=N("button"),o=le(i),s=H(),u=N("div"),G(f.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-18hoeeh"&&(e.textContent=t),n=M(d),r=D(d,"BUTTON",{class:!0});var p=A(r);o=re(p,i),p.forEach(m),s=M(d),u=D(d,"DIV",{class:!0});var g=A(u);q(f.$$.fragment,g),g.forEach(m),this.h()},h(){Re(e,"display","inline"),v(r,"class","svelte-cihl2i"),v(u,"class","margin-top svelte-cihl2i")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,o),C(d,s,p),C(d,u,p),X(f,u,null),h=!0,c||(b=K(r,"click",l[8]),c=!0)},p(d,p){(!h||p&1)&&i!==(i=d[0].address+"")&&ge(o,i);const g={};!a&&p&1&&(a=!0,g.router=d[0],de(()=>a=!1)),f.$set(g)},i(d){h||(R(f.$$.fragment,d),h=!0)},o(d){T(f.$$.fragment,d),h=!1},d(d){d&&(m(e),m(n),m(r),m(s),m(u)),W(f),c=!1,b()}}}function nt(l){let e,t,n,r;function i(s){l[10](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new sn({props:o}),fe.push(()=>he(t,"router",i)),{c(){e=N("div"),G(t.$$.fragment),this.h()},l(s){e=D(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(m),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const f={};!n&&u&1&&(n=!0,f.router=s[0],de(()=>n=!1)),t.$set(f)},i(s){r||(R(t.$$.fragment,s),r=!0)},o(s){T(t.$$.fragment,s),r=!1},d(s){s&&m(e),W(t)}}}function lt(l){let e,t,n,r;function i(s){l[11](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new ln({props:o}),fe.push(()=>he(t,"router",i)),{c(){e=N("div"),G(t.$$.fragment),this.h()},l(s){e=D(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(m),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const f={};!n&&u&1&&(n=!0,f.router=s[0],de(()=>n=!1)),t.$set(f)},i(s){r||(R(t.$$.fragment,s),r=!0)},o(s){T(t.$$.fragment,s),r=!1},d(s){s&&m(e),W(t)}}}function fn(l){let e,t,n,r;const i=[an,un],o=[];function s(u,f){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,f){o[e].m(u,f),C(u,n,f),r=!0},p(u,f){let a=e;e=s(u),e===a?o[e].p(u,f):(ue(),T(o[a],1,1,()=>{o[a]=null}),ae(),t=o[e],t?t.p(u,f):(t=o[e]=i[e](u),t.c()),R(t,1),t.m(n.parentNode,n))},i(u){r||(R(t),r=!0)},o(u){T(t),r=!1},d(u){u&&m(n),o[e].d(u)}}}function cn(l){let e,t,n;function r(o){l[12](o)}let i={$$slots:{default:[fn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>he(e,"dialog",r)),e.$on("close",l[13]),{c(){G(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&16389&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],de(()=>t=!1)),e.$set(u)},i(o){n||(R(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){W(e,o)}}}function dn(l,e,t){let n;pe(l,Le,p=>t(2,n=p));let{router:r}=e,{dialog:i}=e;function o(){!n&&r?confirm("Are you sure you want to delete this router?")&&(V.deleteRouter(r.id),i.close()):alert("You can't delete a router while the network is locked.")}function s(){r.node.label=this.value,t(0,r)}function u(){r.node.x=me(this.value),t(0,r)}function f(){r.node.y=me(this.value),t(0,r)}const a=()=>{V.notify()},h=async()=>{r instanceof _e&&await navigator.clipboard.writeText(r.address)};function c(p){r=p,t(0,r)}function b(p){r=p,t(0,r)}function _(p){r=p,t(0,r)}function $(p){i=p,t(1,i)}const d=()=>{V.notify()};return l.$$set=p=>{"router"in p&&t(0,r=p.router),"dialog"in p&&t(1,i=p.dialog)},[r,i,n,o,s,u,f,a,h,c,b,_,$,d]}class hn extends ee{constructor(e){super(),te(this,e,dn,cn,Z,{router:0,dialog:1})}}function pn(l){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=N("p"),e.textContent=t},l(n){e=D(n,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&m(e)}}}function _n(l){let e,t=l[0].distance+"",n,r,i,o,s,u,f,a,h,c,b;return a=new Ce({props:{text:"Delete Link",callback:l[3]}}),{c(){e=le("Distance: "),n=le(t),r=le(` km
    `),i=N("label"),o=le(`Bandwidth:
      `),s=N("input"),u=H(),f=N("div"),G(a.$$.fragment),this.h()},l(_){e=re(_,"Distance: "),n=re(_,t),r=re(_,` km
    `),i=D(_,"LABEL",{class:!0});var $=A(i);o=re($,`Bandwidth:
      `),s=D($,"INPUT",{type:!0,class:!0}),$.forEach(m),u=M(_),f=D(_,"DIV",{class:!0});var d=A(f);q(a.$$.fragment,d),d.forEach(m),this.h()},h(){v(s,"type","number"),s.disabled=l[2],v(s,"class","svelte-11gx5jd"),v(i,"class","svelte-11gx5jd"),v(f,"class","svelte-11gx5jd")},m(_,$){C(_,e,$),C(_,n,$),C(_,r,$),C(_,i,$),I(i,o),I(i,s),oe(s,l[0].bandwidth),C(_,u,$),C(_,f,$),X(a,f,null),h=!0,c||(b=K(s,"input",l[4]),c=!0)},p(_,$){(!h||$&1)&&t!==(t=_[0].distance+"")&&ge(n,t),(!h||$&4)&&(s.disabled=_[2]),$&1&&me(s.value)!==_[0].bandwidth&&oe(s,_[0].bandwidth)},i(_){h||(R(a.$$.fragment,_),h=!0)},o(_){T(a.$$.fragment,_),h=!1},d(_){_&&(m(e),m(n),m(r),m(i),m(u),m(f)),W(a),c=!1,b()}}}function gn(l){let e,t,n,r;const i=[_n,pn],o=[];function s(u,f){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,f){o[e].m(u,f),C(u,n,f),r=!0},p(u,f){let a=e;e=s(u),e===a?o[e].p(u,f):(ue(),T(o[a],1,1,()=>{o[a]=null}),ae(),t=o[e],t?t.p(u,f):(t=o[e]=i[e](u),t.c()),R(t,1),t.m(n.parentNode,n))},i(u){r||(R(t),r=!0)},o(u){T(t),r=!1},d(u){u&&m(n),o[e].d(u)}}}function mn(l){let e,t,n;function r(o){l[5](o)}let i={$$slots:{default:[gn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>he(e,"dialog",r)),e.$on("close",l[6]),{c(){G(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&133&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],de(()=>t=!1)),e.$set(u)},i(o){n||(R(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){W(e,o)}}}function bn(l,e,t){let n;pe(l,Le,a=>t(2,n=a));let{link:r}=e,{dialog:i}=e;function o(){!n&&r&&confirm("Are you sure you want to delete this link?")&&(V.deleteLink(r.id),i.close())}function s(){r.bandwidth=me(this.value),t(0,r)}function u(a){i=a,t(1,i)}const f=()=>{V.notify()};return l.$$set=a=>{"link"in a&&t(0,r=a.link),"dialog"in a&&t(1,i=a.dialog)},[r,i,n,o,s,u,f]}class kn extends ee{constructor(e){super(),te(this,e,bn,mn,Z,{link:0,dialog:1})}}function rt(l){let e,t="Loading...";return{c(){e=N("p"),e.textContent=t,this.h()},l(n){e=D(n,"P",{style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){Re(e,"font-size","200px")},m(n,r){C(n,e,r)},d(n){n&&m(e)}}}function it(l){let e,t,n,r,i,o;return{c(){e=$e("line"),this.h()},l(s){e=Ee(s,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),A(e).forEach(m),this.h()},h(){v(e,"class","preview"),v(e,"x1",t=l[4].node.x),v(e,"y1",n=l[4].node.y),v(e,"x2",r=l[17](l[2].x)),v(e,"y2",i=l[18](l[2].y)),v(e,"stroke",o=[l[11].CONNECTING,l[11].MASS_CONNECTING].includes(l[6])?"green":"blue")},m(s,u){C(s,e,u)},p(s,u){u[0]&16&&t!==(t=s[4].node.x)&&v(e,"x1",t),u[0]&16&&n!==(n=s[4].node.y)&&v(e,"y1",n),u[0]&4&&r!==(r=s[17](s[2].x))&&v(e,"x2",r),u[0]&4&&i!==(i=s[18](s[2].y))&&v(e,"y2",i),u[0]&64&&o!==(o=[s[11].CONNECTING,s[11].MASS_CONNECTING].includes(s[6])?"green":"blue")&&v(e,"stroke",o)},d(s){s&&m(e)}}}function vn(l){let e,t,n=(!l[0]&&l[6]===l[11].CONNECTING||[l[11].MASS_CONNECTING,l[11].ADDING_DESTINATION].includes(l[6]))&&l[4],r,i,o,s,u,f,a,h,c,b,_,$,d,p=!l[9]&&rt(),g=n&&it(l);const k=l[21].default,P=yt(k,l,l[20],null);function x(w){l[24](w)}function L(w){l[25](w)}let E={};l[4]!==void 0&&(E.router=l[4]),l[7]!==void 0&&(E.dialog=l[7]),s=new hn({props:E}),fe.push(()=>he(s,"router",x)),fe.push(()=>he(s,"dialog",L));function F(w){l[26](w)}function B(w){l[27](w)}let O={};return l[5]!==void 0&&(O.link=l[5]),l[8]!==void 0&&(O.dialog=l[8]),h=new kn({props:O}),fe.push(()=>he(h,"link",F)),fe.push(()=>he(h,"dialog",B)),{c(){p&&p.c(),e=H(),t=$e("svg"),g&&g.c(),r=Q(),P&&P.c(),o=H(),G(s.$$.fragment),a=H(),G(h.$$.fragment),this.h()},l(w){p&&p.l(w),e=M(w),t=Ee(w,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var z=A(t);g&&g.l(z),r=Q(),P&&P.l(z),z.forEach(m),o=M(w),q(s.$$.fragment,w),a=M(w),q(h.$$.fragment,w),this.h()},h(){v(t,"viewBox",i=`${l[1].x} ${l[1].y} ${l[1].width} ${l[1].height}`),v(t,"role","button"),v(t,"tabindex","-1"),v(t,"class","svelte-1cmb9l6"),Re(t,"cursor",l[10][l[6]])},m(w,z){p&&p.m(w,z),C(w,e,z),C(w,t,z),g&&g.m(t,null),I(t,r),P&&P.m(t,null),l[23](t),C(w,o,z),X(s,w,z),C(w,a,z),X(h,w,z),_=!0,$||(d=[K(t,"pointerdown",l[12]),K(t,"pointerup",l[13]),K(t,"wheel",l[14]),K(t,"dblclick",l[15]),K(t,"dragover",St(l[22])),K(t,"drop",l[16])],$=!0)},p(w,z){w[9]?p&&(p.d(1),p=null):p||(p=rt(),p.c(),p.m(e.parentNode,e)),z[0]&81&&(n=(!w[0]&&w[6]===w[11].CONNECTING||[w[11].MASS_CONNECTING,w[11].ADDING_DESTINATION].includes(w[6]))&&w[4]),n?g?g.p(w,z):(g=it(w),g.c(),g.m(t,r)):g&&(g.d(1),g=null),P&&P.p&&(!_||z[0]&1048576)&&Ct(P,k,w,w[20],_?Lt(k,w[20],z,null):It(w[20]),null),(!_||z[0]&2&&i!==(i=`${w[1].x} ${w[1].y} ${w[1].width} ${w[1].height}`))&&v(t,"viewBox",i),z[0]&1088&&Re(t,"cursor",w[10][w[6]]);const S={};!u&&z[0]&16&&(u=!0,S.router=w[4],de(()=>u=!1)),!f&&z[0]&128&&(f=!0,S.dialog=w[7],de(()=>f=!1)),s.$set(S);const j={};!c&&z[0]&32&&(c=!0,j.link=w[5],de(()=>c=!1)),!b&&z[0]&256&&(b=!0,j.dialog=w[8],de(()=>b=!1)),h.$set(j)},i(w){_||(R(P,w),R(s.$$.fragment,w),R(h.$$.fragment,w),_=!0)},o(w){T(P,w),T(s.$$.fragment,w),T(h.$$.fragment,w),_=!1},d(w){w&&(m(e),m(t),m(o),m(a)),p&&p.d(w),g&&g.d(),P&&P.d(w),l[23](null),W(s,w),W(h,w),$=!1,Ne(d)}}}function $n(l,e,t){let n,r;pe(l,Le,y=>t(0,r=y));let{$$slots:i={},$$scope:o}=e;var s=(y=>(y[y.NONE=0]="NONE",y[y.DRAGGING=1]="DRAGGING",y[y.PANNING=2]="PANNING",y[y.CONNECTING=3]="CONNECTING",y[y.MASS_CONNECTING=4]="MASS_CONNECTING",y[y.ADDING_DESTINATION=5]="ADDING_DESTINATION",y))(s||{});const u={x:0,y:0,width:0,height:0,get scale(){return h?this.width/h.getBoundingClientRect().width:1}},f={x:0,y:0},a={x:0,y:0};let h=null,c=null,b=null,_=0,$,d,p=!1;Rt(()=>{if(!h)return;new ResizeObserver(g).observe(h),requestAnimationFrame(()=>{h&&(t(1,u.x=h.getBoundingClientRect().width/-2,u),t(1,u.y=h.getBoundingClientRect().height/-2,u))}),t(9,p=!0)});function g(){if(!h)return;const y=u.scale||1;t(1,u.width=h.getBoundingClientRect().width*y,u),t(1,u.height=h.getBoundingClientRect().height*y,u)}function k(y){if(!(y.target instanceof Element))return;y.preventDefault(),h==null||h.addEventListener("pointermove",x),h==null||h.setPointerCapture(y.pointerId);const Y=y.target.id;if(Y){if(t(4,c=V.getRouter(parseInt(Y))||null),!c)return;y.shiftKey?t(6,_=3):y.altKey?t(6,_=4):y.ctrlKey&&c instanceof _e?t(6,_=5):(a.x=c.node.x,a.y=c.node.y,t(6,_=1))}else t(6,_=2);t(2,f.x=y.clientX,f),t(2,f.y=y.clientY,f)}function P(y){if(y.target instanceof Element){if(y.preventDefault(),c){if(!r&&_===3){const Y=document.elementFromPoint(y.clientX,y.clientY),se=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,ce=V.getRouter(parseInt(se??""));ce&&V.addLink({source:c,target:ce})}else if(_===5){const Y=document.elementFromPoint(y.clientX,y.clientY),se=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,ce=V.getRouter(parseInt(se??""));if(ce instanceof _e){const Ht=Pt.findShortestPath(c,ce);Bt(Ht,ce.address.toUpperCase()),V.notify()}else alert("Destination must be a CE")}}t(6,_=0),t(4,c=null),h==null||h.releasePointerCapture(y.pointerId),h==null||h.removeEventListener("pointermove",x)}}function x(y){y.preventDefault();const Y={x:(y.clientX-f.x)*u.scale,y:(y.clientY-f.y)*u.scale};if(!r&&_===1&&c)t(4,c.node.x=Math.round(a.x+Y.x),c),t(4,c.node.y=Math.round(a.y+Y.y),c),V.notify();else if(_===2)t(2,f.x=y.clientX,f),t(2,f.y=y.clientY,f),t(1,u.x-=Y.x,u),t(1,u.y-=Y.y,u);else if(!r&&_===3||_===5)t(2,f.x=y.clientX,f),t(2,f.y=y.clientY,f);else if(!r&&_===4){t(2,f.x=y.clientX,f),t(2,f.y=y.clientY,f);const se=document.elementFromPoint(y.clientX,y.clientY);if(!se)return;const ce=V.getRouter(parseInt(se.id));se.tagName==="circle"&&ce&&c&&(V.addLink({source:c,target:ce}),t(4,c=ce))}}function L(y){y.preventDefault(),t(2,f.x=y.clientX,f),t(2,f.y=y.clientY,f);const Y=y.deltaY>0?1.025:.975;E(Y,f)}function E(y,Y){if(!h||u.scale<.1&&y<1||u.scale>5&&y>1)return;const se=h.getBoundingClientRect(),ce={x:(Y.x-se.left)/se.width,y:(Y.y-se.top)/se.height};t(1,u.x-=u.width*(y-1)*ce.x,u),t(1,u.y-=u.height*(y-1)*ce.y,u),t(1,u.width*=y,u),t(1,u.height*=y,u)}function F(y){if(!(y.target instanceof Element))return;y.preventDefault();const Y=document.elementFromPoint(y.clientX,y.clientY);Y&&(Y.tagName==="circle"?B(Y.id):Y.tagName==="rect"&&O(Y.id))}function B(y){const Y=V.getRouter(parseInt(y));Y&&(t(4,c=Y),$.showModal())}function O(y){const Y=V.links.find(se=>y===se.id);Y&&(t(5,b=Y),d.showModal())}function w(y){var se;y.preventDefault();const Y=(se=y.dataTransfer)==null?void 0:se.getData("text/plain");if(Y)switch(Y){case"CE":V.createCE(z(y.clientX),S(y.clientY));break;case"LER":V.createLER(z(y.clientX),S(y.clientY));break;case"LSR":V.createLSR(z(y.clientX),S(y.clientY));break}}function z(y){return h?(y-h.getBoundingClientRect().left)*u.scale+u.x:y}function S(y){return h?(y-h.getBoundingClientRect().top)*u.scale+u.y:y}function j(y){Nt.call(this,l,y)}function ke(y){fe[y?"unshift":"push"](()=>{h=y,t(3,h)})}function be(y){c=y,t(4,c)}function Ie(y){$=y,t(7,$)}function Te(y){b=y,t(5,b)}function Be(y){d=y,t(8,d)}return l.$$set=y=>{"$$scope"in y&&t(20,o=y.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1&&t(10,n={0:"move",1:r?"not-allowed":"grabbing",2:"grabbing",3:r?"not-allowed":"crosshair",4:r?"not-allowed":"crosshair",5:"crosshair"})},[r,u,f,h,c,b,_,$,d,p,n,s,k,P,L,F,w,z,S,E,o,i,j,ke,be,Ie,Te,Be]}class En extends ee{constructor(e){super(),te(this,e,$n,vn,Z,{zoom:19},null,[-1,-1])}get zoom(){return this.$$.ctx[19]}}function wn(l){let e,t,n,r;return{c(){e=N("button"),t=le(l[0]),this.h()},l(i){e=D(i,"BUTTON",{style:!0,class:!0});var o=A(e);t=re(o,l[0]),o.forEach(m),this.h()},h(){v(e,"style",l[2]),v(e,"class","svelte-v6s8rg")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"click",function(){Dt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&ge(t,l[0]),o&4&&v(e,"style",l[2])},i:ne,o:ne,d(i){i&&m(e),n=!1,r()}}}function yn(l,e,t){let{text:n}=e,{callback:r=()=>{}}=e,{style:i=void 0}=e;return l.$$set=o=>{"text"in o&&t(0,n=o.text),"callback"in o&&t(1,r=o.callback),"style"in o&&t(2,i=o.style)},[n,r,i]}class we extends ee{constructor(e){super(),te(this,e,yn,wn,Z,{text:0,callback:1,style:2})}}function Cn(l){let e,t,n=l[0].address+"",r,i,o,s="â†’",u,f,a=l[1].address+"",h,c,b,_;return b=new we({props:{text:"Play",callback:l[2]}}),{c(){e=N("div"),t=N("p"),r=le(n),i=H(),o=N("p"),o.textContent=s,u=H(),f=N("p"),h=le(a),c=H(),G(b.$$.fragment),this.h()},l($){e=D($,"DIV",{class:!0});var d=A(e);t=D(d,"P",{});var p=A(t);r=re(p,n),p.forEach(m),i=M(d),o=D(d,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1giyjq6"&&(o.textContent=s),u=M(d),f=D(d,"P",{});var g=A(f);h=re(g,a),g.forEach(m),c=M(d),q(b.$$.fragment,d),d.forEach(m),this.h()},h(){v(e,"class","svelte-phufxh")},m($,d){C($,e,d),I(e,t),I(t,r),I(e,i),I(e,o),I(e,u),I(e,f),I(f,h),I(e,c),X(b,e,null),_=!0},p($,[d]){(!_||d&1)&&n!==(n=$[0].address+"")&&ge(r,n),(!_||d&2)&&a!==(a=$[1].address+"")&&ge(h,a)},i($){_||(R(b.$$.fragment,$),_=!0)},o($){T(b.$$.fragment,$),_=!1},d($){$&&m(e),W(b)}}}function In(l,e,t){let{source:n}=e,{destination:r}=e;function i(){V.addPacket(n,r)}return l.$$set=o=>{"source"in o&&t(0,n=o.source),"destination"in o&&t(1,r=o.destination)},[n,r,i]}class Ln extends ee{constructor(e){super(),te(this,e,In,Cn,Z,{source:0,destination:1})}}function ot(l,e,t){const n=l.slice();return n[2]=e[t],n}function st(l,e,t){const n=l.slice();return n[5]=e[t][0],n}function ut(l){let e,t;return e=new Ln({props:{source:l[2],destination:V.getSureCERouter(l[5])}}),{c(){G(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p(n,r){const i={};r&1&&(i.source=n[2]),r&1&&(i.destination=V.getSureCERouter(n[5])),e.$set(i)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function at(l){let e,t,n=J([...l[2].firstHop]),r=[];for(let o=0;o<n.length;o+=1)r[o]=ut(st(l,n,o));const i=o=>T(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,s){if(s&1){n=J([...o[2].firstHop]);let u;for(u=0;u<n.length;u+=1){const f=st(o,n,u);r[u]?(r[u].p(f,s),R(r[u],1)):(r[u]=ut(f),r[u].c(),R(r[u],1),r[u].m(e.parentNode,e))}for(ue(),u=n.length;u<r.length;u+=1)i(u);ae()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)R(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)T(r[s]);t=!1},d(o){o&&m(e),ye(r,o)}}}function Nn(l){let e,t,n=J(l[0]),r=[];for(let o=0;o<n.length;o+=1)r[o]=at(ot(l,n,o));const i=o=>T(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,[s]){if(s&1){n=J(o[0]);let u;for(u=0;u<n.length;u+=1){const f=ot(o,n,u);r[u]?(r[u].p(f,s),R(r[u],1)):(r[u]=at(f),r[u].c(),R(r[u],1),r[u].m(e.parentNode,e))}for(ue(),u=n.length;u<r.length;u+=1)i(u);ae()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)R(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)T(r[s]);t=!1},d(o){o&&m(e),ye(r,o)}}}function Dn(l,e,t){let n,r;return pe(l,V,i=>t(1,r=i)),l.$$.update=()=>{l.$$.dirty&2&&t(0,n=r.routers.filter(i=>i instanceof _e))},[n,r]}class Rn extends ee{constructor(e){super(),te(this,e,Dn,Nn,Z,{})}}function ft(l,e,t){const n=l.slice();return n[13]=e[t],n}function ct(l){let e,t;const n=[l[13],{style:"padding: 10px 20px"}];let r={};for(let i=0;i<n.length;i+=1)r=Oe(r,n[i]);return e=new we({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&32?Fe(n,[je(i[13]),n[1]]):{};e.$set(s)},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){T(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function Tn(l){let e,t,n,r,i,o,s,u,f,a,h,c=l[1].speedMultiplier+"",b,_,$,d,p,g,k,P,x,L=J(l[5]),E=[];for(let B=0;B<L.length;B+=1)E[B]=ct(ft(l,L,B));const F=B=>T(E[B],1,1,()=>{E[B]=null});return p=new Rn({}),{c(){e=N("div"),t=N("div"),r=H(),i=N("div"),o=N("div"),s=N("div");for(let B=0;B<E.length;B+=1)E[B].c();u=H(),f=N("div"),a=N("p"),h=le("Speed Multiplier: "),b=le(c),_=H(),$=N("input"),d=H(),G(p.$$.fragment),this.h()},l(B){e=D(B,"DIV",{id:!0,style:!0,class:!0});var O=A(e);t=D(O,"DIV",{id:!0,class:!0}),A(t).forEach(m),O.forEach(m),r=M(B),i=D(B,"DIV",{id:!0,style:!0,class:!0});var w=A(i);o=D(w,"DIV",{id:!0,class:!0});var z=A(o);s=D(z,"DIV",{id:!0,class:!0});var S=A(s);for(let be=0;be<E.length;be+=1)E[be].l(S);S.forEach(m),u=M(z),f=D(z,"DIV",{id:!0,class:!0});var j=A(f);a=D(j,"P",{});var ke=A(a);h=re(ke,"Speed Multiplier: "),b=re(ke,c),ke.forEach(m),_=M(j),$=D(j,"INPUT",{type:!0,min:!0,max:!0,step:!0}),j.forEach(m),d=M(z),q(p.$$.fragment,z),z.forEach(m),w.forEach(m),this.h()},h(){v(t,"id","resize-bar"),v(t,"class","svelte-1jmh3n8"),v(e,"id","visual-resize-bar"),v(e,"style",n=`width: ${l[0]?1:0}px`),v(e,"class","svelte-1jmh3n8"),v(s,"id","control-panel-buttons"),v(s,"class","svelte-1jmh3n8"),v($,"type","range"),v($,"min","0.1"),v($,"max","2"),v($,"step","0.1"),v(f,"id","slider"),v(f,"class","svelte-1jmh3n8"),v(o,"id","control-panel-content"),v(o,"class","svelte-1jmh3n8"),v(i,"id","control-panel"),v(i,"style",g=`width: ${l[4]}px; transition: ${l[3]};`),v(i,"class","svelte-1jmh3n8")},m(B,O){C(B,e,O),I(e,t),l[9](t),C(B,r,O),C(B,i,O),I(i,o),I(o,s);for(let w=0;w<E.length;w+=1)E[w]&&E[w].m(s,null);I(o,u),I(o,f),I(f,a),I(a,h),I(a,b),I(f,_),I(f,$),oe($,l[1].speedMultiplier),I(o,d),X(p,o,null),k=!0,P||(x=[K(t,"pointerdown",l[6]),K($,"change",l[10]),K($,"input",l[10])],P=!0)},p(B,[O]){if((!k||O&1&&n!==(n=`width: ${B[0]?1:0}px`))&&v(e,"style",n),O&32){L=J(B[5]);let w;for(w=0;w<L.length;w+=1){const z=ft(B,L,w);E[w]?(E[w].p(z,O),R(E[w],1)):(E[w]=ct(z),E[w].c(),R(E[w],1),E[w].m(s,null))}for(ue(),w=L.length;w<E.length;w+=1)F(w);ae()}(!k||O&2)&&c!==(c=B[1].speedMultiplier+"")&&ge(b,c),O&2&&oe($,B[1].speedMultiplier),(!k||O&24&&g!==(g=`width: ${B[4]}px; transition: ${B[3]};`))&&v(i,"style",g)},i(B){if(!k){for(let O=0;O<L.length;O+=1)R(E[O]);R(p.$$.fragment,B),k=!0}},o(B){E=E.filter(Boolean);for(let O=0;O<E.length;O+=1)T(E[O]);T(p.$$.fragment,B),k=!1},d(B){B&&(m(e),m(r),m(i)),l[9](null),ye(E,B),W(p),P=!1,Ne(x)}}}function Pn(l,e,t){let n,r,i,o,s,u;pe(l,Le,d=>t(0,o=d)),pe(l,De,d=>t(1,s=d)),pe(l,V,d=>t(8,u=d));let f,a="width 250ms";function h(d){o&&(t(3,a="none"),f.setPointerCapture(d.pointerId),f.addEventListener("pointermove",c),f.addEventListener("pointerup",b))}function c(d){t(4,i=window.innerWidth-d.clientX),i<=20&&t(4,i=0),i>=window.innerWidth-20&&t(4,i=window.innerWidth-20)}function b(d){f.removeEventListener("pointermove",c),f.removeEventListener("pointerup",b),f.releasePointerCapture(d.pointerId),t(3,a="width 250ms")}function _(d){fe[d?"unshift":"push"](()=>{f=d,t(2,f)})}function $(){s.speedMultiplier=me(this.value),De.set(s)}return l.$$.update=()=>{l.$$.dirty&256&&t(7,n=u.routers.filter(d=>d instanceof _e)),l.$$.dirty&130&&t(5,r=[{text:s.running?"Pause":"Resume",callback:()=>{ze(De,s.running=!s.running,s)}},{text:"Reset",callback:()=>{V.clearPackets()}},{text:"Play All",callback:()=>{for(const d of n)for(const[p]of d.firstHop)V.addPacket(d,V.getSureCERouter(p))}}]),l.$$.dirty&1&&t(4,i=o?300:0)},[o,s,f,a,i,r,h,n,u,_,$]}class Bn extends ee{constructor(e){super(),te(this,e,Pn,Tn,Z,{})}}function Hn(l){let e;return{c(){e=$e("circle"),this.h()},l(t){e=Ee(t,"circle",{r:!0,class:!0}),A(e).forEach(m),this.h()},h(){v(e,"r","5"),v(e,"class","svelte-rvo2j9"),Ye(e,"labeled",l[0].label!==-1)},m(t,n){C(t,e,n),l[4](e)},p(t,[n]){n&1&&Ye(e,"labeled",t[0].label!==-1)},i:ne,o:ne,d(t){t&&m(e),l[4](null)}}}function Mn(l,e,t){let n;pe(l,De,c=>t(3,n=c));let{packet:r}=e,i,o,s;function u(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}const c=Math.sqrt((r.node.x-r.nextHop.node.x)**2+(r.node.y-r.nextHop.node.y)**2);i=Math.round(c/250*1e3)}function f(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}u(),s&&(t(2,o=s.animate([{transform:`translate(${r.node.x}px, ${r.node.y}px)`},{transform:`translate(${r.nextHop.node.x}px, ${r.nextHop.node.y}px)`}],{duration:i,easing:"linear"})),t(2,o.onfinish=a,o))}function a(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}t(0,r.node=r.nextHop.node,r),r.nextHop.receivePacket(r),f()}requestAnimationFrame(f);function h(c){fe[c?"unshift":"push"](()=>{s=c,t(1,s)})}return l.$$set=c=>{"packet"in c&&t(0,r=c.packet)},l.$$.update=()=>{l.$$.dirty&12&&o&&t(2,o.playbackRate=n.speedMultiplier,o),l.$$.dirty&12&&o&&(n.running?o.play():o.pause())},[r,s,o,n,h]}class xn extends ee{constructor(e){super(),te(this,e,Mn,Hn,Z,{packet:0})}}function Sn(l){let e,t,n,r,i,o,s,u,f=l[0].distance+"",a,h,c,b;return{c(){e=$e("line"),t=H(),n=$e("rect"),s=H(),u=$e("text"),a=le(f),h=le(" km"),this.h()},l(_){e=Ee(_,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),A(e).forEach(m),t=M(_),n=Ee(_,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),A(n).forEach(m),s=M(_),u=Ee(_,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var $=A(u);a=re($,f),h=re($," km"),$.forEach(m),this.h()},h(){v(e,"x1",l[4]),v(e,"y1",l[2]),v(e,"x2",l[3]),v(e,"y2",l[1]),v(n,"id",r=l[0].id),v(n,"x",i=l[5].x-Se/2),v(n,"y",o=l[5].y-Ae/2),v(n,"width",Se),v(n,"height",Ae),v(n,"class","svelte-zjn2k6"),v(u,"x",c=l[5].x),v(u,"y",b=l[5].y),v(u,"dominant-baseline","central"),v(u,"class","svelte-zjn2k6")},m(_,$){C(_,e,$),C(_,t,$),C(_,n,$),C(_,s,$),C(_,u,$),I(u,a),I(u,h)},p(_,[$]){$&16&&v(e,"x1",_[4]),$&4&&v(e,"y1",_[2]),$&8&&v(e,"x2",_[3]),$&2&&v(e,"y2",_[1]),$&1&&r!==(r=_[0].id)&&v(n,"id",r),$&32&&i!==(i=_[5].x-Se/2)&&v(n,"x",i),$&32&&o!==(o=_[5].y-Ae/2)&&v(n,"y",o),$&1&&f!==(f=_[0].distance+"")&&ge(a,f),$&32&&c!==(c=_[5].x)&&v(u,"x",c),$&32&&b!==(b=_[5].y)&&v(u,"y",b)},i:ne,o:ne,d(_){_&&(m(e),m(t),m(n),m(s),m(u))}}}const Se=50,Ae=20;function dt(l,e){return(l+e)/2}function An(l,e,t){let n,r,i,o,s,{link:u}=e;return l.$$set=f=>{"link"in f&&t(0,u=f.link)},l.$$.update=()=>{l.$$.dirty&1&&t(4,n=u.source.node.x),l.$$.dirty&1&&t(3,r=u.target.node.x),l.$$.dirty&1&&t(2,i=u.source.node.y),l.$$.dirty&1&&t(1,o=u.target.node.y),l.$$.dirty&30&&t(5,s={x:dt(n,r),y:dt(i,o)})},[u,o,i,r,n,s]}class zn extends ee{constructor(e){super(),te(this,e,An,Sn,Z,{link:0})}}function On(l){let e,t,n,r,i,o,s,u=l[0].node.label+"",f,a,h;return{c(){e=$e("circle"),o=H(),s=$e("text"),f=le(u),this.h()},l(c){e=Ee(c,"circle",{id:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),A(e).forEach(m),o=M(c),s=Ee(c,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var b=A(s);f=re(b,u),b.forEach(m),this.h()},h(){v(e,"id",t=l[0].id.toString()),v(e,"cx",n=l[0].node.x),v(e,"cy",r=l[0].node.y),v(e,"r","20"),v(e,"fill",i=l[1][l[0].type]),v(e,"class","svelte-17jcsko"),v(s,"x",a=l[0].node.x),v(s,"y",h=l[0].node.y),v(s,"dominant-baseline","central"),v(s,"font-size","smaller"),v(s,"class","svelte-17jcsko")},m(c,b){C(c,e,b),C(c,o,b),C(c,s,b),I(s,f)},p(c,[b]){b&1&&t!==(t=c[0].id.toString())&&v(e,"id",t),b&1&&n!==(n=c[0].node.x)&&v(e,"cx",n),b&1&&r!==(r=c[0].node.y)&&v(e,"cy",r),b&1&&i!==(i=c[1][c[0].type])&&v(e,"fill",i),b&1&&u!==(u=c[0].node.label+"")&&ge(f,u),b&1&&a!==(a=c[0].node.x)&&v(s,"x",a),b&1&&h!==(h=c[0].node.y)&&v(s,"y",h)},i:ne,o:ne,d(c){c&&(m(e),m(o),m(s))}}}function Fn(l,e,t){let{router:n}=e;const r={CE:"#7FC8F8",LER:"#FFE45E",LSR:"#FF6392"};return l.$$set=i=>{"router"in i&&t(0,n=i.router)},[n,r]}class jn extends ee{constructor(e){super(),te(this,e,Fn,On,Z,{router:0})}}function Un(l){let e,t,n,r;return{c(){e=N("div"),t=le(l[0]),this.h()},l(i){e=D(i,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var o=A(e);t=re(o,l[0]),o.forEach(m),this.h()},h(){v(e,"draggable","true"),v(e,"role","button"),v(e,"tabindex","-1"),Re(e,"background-color",l[1]),v(e,"class","svelte-blffat")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"dragstart",l[2]),n=!0)},p(i,[o]){o&1&&ge(t,i[0]),o&2&&Re(e,"background-color",i[1])},i:ne,o:ne,d(i){i&&m(e),n=!1,r()}}}function Vn(l,e,t){let n;pe(l,Le,u=>t(4,n=u));let{text:r}=e,{type:i}=e,{color:o}=e;function s(u){var f;if(n){alert("Network is locked.");return}(f=u.dataTransfer)==null||f.setData("text/plain",i)}return l.$$set=u=>{"text"in u&&t(0,r=u.text),"type"in u&&t(3,i=u.type),"color"in u&&t(1,o=u.color)},[r,o,s,i]}class Yn extends ee{constructor(e){super(),te(this,e,Vn,Un,Z,{text:0,type:3,color:1})}}function ht(l,e,t){const n=l.slice();return n[4]=e[t],n}function pt(l,e,t){const n=l.slice();return n[7]=e[t],n}function _t(l){let e,t,n,r=J(l[2]),i=[];for(let a=0;a<r.length;a+=1)i[a]=gt(pt(l,r,a));const o=a=>T(i[a],1,1,()=>{i[a]=null});let s=J(l[1]),u=[];for(let a=0;a<s.length;a+=1)u[a]=mt(ht(l,s,a));const f=a=>T(u[a],1,1,()=>{u[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=H();for(let a=0;a<u.length;a+=1)u[a].c();t=Q()},l(a){for(let h=0;h<i.length;h+=1)i[h].l(a);e=M(a);for(let h=0;h<u.length;h+=1)u[h].l(a);t=Q()},m(a,h){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,h);C(a,e,h);for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(a,h);C(a,t,h),n=!0},p(a,h){if(h&4){r=J(a[2]);let c;for(c=0;c<r.length;c+=1){const b=pt(a,r,c);i[c]?(i[c].p(b,h),R(i[c],1)):(i[c]=gt(b),i[c].c(),R(i[c],1),i[c].m(e.parentNode,e))}for(ue(),c=r.length;c<i.length;c+=1)o(c);ae()}if(h&2){s=J(a[1]);let c;for(c=0;c<s.length;c+=1){const b=ht(a,s,c);u[c]?(u[c].p(b,h),R(u[c],1)):(u[c]=mt(b),u[c].c(),R(u[c],1),u[c].m(t.parentNode,t))}for(ue(),c=s.length;c<u.length;c+=1)f(c);ae()}},i(a){if(!n){for(let h=0;h<r.length;h+=1)R(i[h]);for(let h=0;h<s.length;h+=1)R(u[h]);n=!0}},o(a){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)T(i[h]);u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)T(u[h]);n=!1},d(a){a&&(m(e),m(t)),ye(i,a),ye(u,a)}}}function gt(l){let e,t;const n=[l[7]];let r={};for(let i=0;i<n.length;i+=1)r=Oe(r,n[i]);return e=new Yn({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&4?Fe(n,[je(i[7])]):{};e.$set(s)},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){T(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function mt(l){let e,t;const n=[l[4]];let r={};for(let i=0;i<n.length;i+=1)r=Oe(r,n[i]);return e=new we({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&2?Fe(n,[je(i[4])]):{};e.$set(s)},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){T(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function Gn(l){let e,t,n,r;e=new we({props:{text:l[0]?"Edit":"Simulation",callback:l[3],style:`width: 100px; background-color: ${l[0]?"#3CB371":"#6495ED"};`}});let i=!l[0]&&_t(l);return{c(){G(e.$$.fragment),t=H(),i&&i.c(),n=Q()},l(o){q(e.$$.fragment,o),t=M(o),i&&i.l(o),n=Q()},m(o,s){X(e,o,s),C(o,t,s),i&&i.m(o,s),C(o,n,s),r=!0},p(o,[s]){const u={};s&1&&(u.text=o[0]?"Edit":"Simulation"),s&1&&(u.callback=o[3]),s&1&&(u.style=`width: 100px; background-color: ${o[0]?"#3CB371":"#6495ED"};`),e.$set(u),o[0]?i&&(ue(),T(i,1,1,()=>{i=null}),ae()):i?(i.p(o,s),s&1&&R(i,1)):(i=_t(o),i.c(),R(i,1),i.m(n.parentNode,n))},i(o){r||(R(e.$$.fragment,o),R(i),r=!0)},o(o){T(e.$$.fragment,o),T(i),r=!1},d(o){o&&(m(t),m(n)),W(e,o),i&&i.d(o)}}}function qn(l,e,t){let n,r;pe(l,Le,s=>t(0,r=s));const i=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],o=()=>{ze(Le,r=!r,r),V.clearPackets()};return l.$$.update=()=>{l.$$.dirty&1&&t(1,n=[{text:"Clear",callback:()=>{if(r){alert("Network is locked.");return}confirm("Are you sure you want to clear the network?")&&V.clear()}}])},[r,n,i,o]}class Xn extends ee{constructor(e){super(),te(this,e,qn,Gn,Z,{})}}function Wn(l){let e,t="Drag and drop routers to add them to the network.",n,r,i="Hold the shift key and drag routers to make a singular link.",o,s,u="Hold the alt key and drag routers to make continous links.",f,a,h="Hold the ctrl key and drag CE's to add destinations.",c,b,_="Double click a router to configure it.",$,d,p="The clear button will delete the entire network.",g,k,P,x,L="Press Esc to close this popup.";return{c(){e=N("p"),e.textContent=t,n=H(),r=N("p"),r.textContent=i,o=H(),s=N("p"),s.textContent=u,f=H(),a=N("p"),a.textContent=h,c=H(),b=N("p"),b.textContent=_,$=H(),d=N("p"),d.textContent=p,g=H(),k=N("br"),P=H(),x=N("p"),x.textContent=L},l(E){e=D(E,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-bhocp0"&&(e.textContent=t),n=M(E),r=D(E,"P",{"data-svelte-h":!0}),ie(r)!=="svelte-11o7jqf"&&(r.textContent=i),o=M(E),s=D(E,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-g9ilhz"&&(s.textContent=u),f=M(E),a=D(E,"P",{"data-svelte-h":!0}),ie(a)!=="svelte-33j76o"&&(a.textContent=h),c=M(E),b=D(E,"P",{"data-svelte-h":!0}),ie(b)!=="svelte-11scjjz"&&(b.textContent=_),$=M(E),d=D(E,"P",{"data-svelte-h":!0}),ie(d)!=="svelte-vcl8s3"&&(d.textContent=p),g=M(E),k=D(E,"BR",{}),P=M(E),x=D(E,"P",{"data-svelte-h":!0}),ie(x)!=="svelte-1dvt5v1"&&(x.textContent=L)},m(E,F){C(E,e,F),C(E,n,F),C(E,r,F),C(E,o,F),C(E,s,F),C(E,f,F),C(E,a,F),C(E,c,F),C(E,b,F),C(E,$,F),C(E,d,F),C(E,g,F),C(E,k,F),C(E,P,F),C(E,x,F)},p:ne,d(E){E&&(m(e),m(n),m(r),m(o),m(s),m(f),m(a),m(c),m(b),m($),m(d),m(g),m(k),m(P),m(x))}}}function Kn(l){let e,t,n,r,i,o;t=new we({props:{text:"Help",callback:l[1]}});function s(f){l[2](f)}let u={$$slots:{default:[Wn]},$$scope:{ctx:l}};return l[0]!==void 0&&(u.dialog=l[0]),r=new Ve({props:u}),fe.push(()=>he(r,"dialog",s)),{c(){e=N("div"),G(t.$$.fragment),n=H(),G(r.$$.fragment)},l(f){e=D(f,"DIV",{});var a=A(e);q(t.$$.fragment,a),a.forEach(m),n=M(f),q(r.$$.fragment,f)},m(f,a){C(f,e,a),X(t,e,null),C(f,n,a),X(r,f,a),o=!0},p(f,[a]){const h={};a&1&&(h.callback=f[1]),t.$set(h);const c={};a&8&&(c.$$scope={dirty:a,ctx:f}),!i&&a&1&&(i=!0,c.dialog=f[0],de(()=>i=!1)),r.$set(c)},i(f){o||(R(t.$$.fragment,f),R(r.$$.fragment,f),o=!0)},o(f){T(t.$$.fragment,f),T(r.$$.fragment,f),o=!1},d(f){f&&(m(e),m(n)),W(t),W(r,f)}}}function Jn(l,e,t){let n;const r=()=>{n.showModal()};function i(o){n=o,t(0,n)}return[n,r,i]}class Qn extends ee{constructor(e){super(),te(this,e,Jn,Kn,Z,{})}}function Zn(l){let e,t,n,r,i,o;return e=new we({props:{text:" - ",callback:l[1]}}),n=new we({props:{text:"Fullscreen",callback:l[2]}}),i=new we({props:{text:" + ",callback:l[3]}}),{c(){G(e.$$.fragment),t=H(),G(n.$$.fragment),r=H(),G(i.$$.fragment)},l(s){q(e.$$.fragment,s),t=M(s),q(n.$$.fragment,s),r=M(s),q(i.$$.fragment,s)},m(s,u){X(e,s,u),C(s,t,u),X(n,s,u),C(s,r,u),X(i,s,u),o=!0},p(s,[u]){const f={};u&1&&(f.callback=s[1]),e.$set(f);const a={};u&1&&(a.callback=s[3]),i.$set(a)},i(s){o||(R(e.$$.fragment,s),R(n.$$.fragment,s),R(i.$$.fragment,s),o=!0)},o(s){T(e.$$.fragment,s),T(n.$$.fragment,s),T(i.$$.fragment,s),o=!1},d(s){s&&(m(t),m(r)),W(e,s),W(n,s),W(i,s)}}}function el(l,e,t){let{zoom:n}=e;const r=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,s)},i=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},o=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,s)};return l.$$set=s=>{"zoom"in s&&t(0,n=s.zoom)},[n,r,i,o]}class tl extends ee{constructor(e){super(),te(this,e,el,Zn,Z,{zoom:0})}}function bt(l,e,t){const n=l.slice();return n[5]=e[t],n}function kt(l,e,t){const n=l.slice();return n[8]=e[t],n}function vt(l,e,t){const n=l.slice();return n[11]=e[t],n}function $t(l,e){let t,n,r;return n=new zn({props:{link:e[11]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.link=e[11]),n.$set(s)},i(i){r||(R(n.$$.fragment,i),r=!0)},o(i){T(n.$$.fragment,i),r=!1},d(i){i&&m(t),W(n,i)}}}function Et(l,e){let t,n,r;return n=new jn({props:{router:e[8]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.router=e[8]),n.$set(s)},i(i){r||(R(n.$$.fragment,i),r=!0)},o(i){T(n.$$.fragment,i),r=!1},d(i){i&&m(t),W(n,i)}}}function wt(l,e){let t,n,r;return n=new xn({props:{packet:e[5]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.packet=e[5]),n.$set(s)},i(i){r||(R(n.$$.fragment,i),r=!0)},o(i){T(n.$$.fragment,i),r=!1},d(i){i&&m(t),W(n,i)}}}function nl(l){let e=[],t=new Map,n,r=[],i=new Map,o,s=[],u=new Map,f,a,h=J(l[1].links);const c=p=>p[11].id;for(let p=0;p<h.length;p+=1){let g=vt(l,h,p),k=c(g);t.set(k,e[p]=$t(k,g))}let b=J(l[1].routers);const _=p=>p[8].id;for(let p=0;p<b.length;p+=1){let g=kt(l,b,p),k=_(g);i.set(k,r[p]=Et(k,g))}let $=J(l[1].packets);const d=p=>p[5].id;for(let p=0;p<$.length;p+=1){let g=bt(l,$,p),k=d(g);u.set(k,s[p]=wt(k,g))}return{c(){for(let p=0;p<e.length;p+=1)e[p].c();n=H();for(let p=0;p<r.length;p+=1)r[p].c();o=H();for(let p=0;p<s.length;p+=1)s[p].c();f=Q()},l(p){for(let g=0;g<e.length;g+=1)e[g].l(p);n=M(p);for(let g=0;g<r.length;g+=1)r[g].l(p);o=M(p);for(let g=0;g<s.length;g+=1)s[g].l(p);f=Q()},m(p,g){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(p,g);C(p,n,g);for(let k=0;k<r.length;k+=1)r[k]&&r[k].m(p,g);C(p,o,g);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(p,g);C(p,f,g),a=!0},p(p,g){g&2&&(h=J(p[1].links),ue(),e=xe(e,g,c,1,p,h,t,n.parentNode,Me,$t,n,vt),ae()),g&2&&(b=J(p[1].routers),ue(),r=xe(r,g,_,1,p,b,i,o.parentNode,Me,Et,o,kt),ae()),g&2&&($=J(p[1].packets),ue(),s=xe(s,g,d,1,p,$,u,f.parentNode,Me,wt,f,bt),ae())},i(p){if(!a){for(let g=0;g<h.length;g+=1)R(e[g]);for(let g=0;g<b.length;g+=1)R(r[g]);for(let g=0;g<$.length;g+=1)R(s[g]);a=!0}},o(p){for(let g=0;g<e.length;g+=1)T(e[g]);for(let g=0;g<r.length;g+=1)T(r[g]);for(let g=0;g<s.length;g+=1)T(s[g]);a=!1},d(p){p&&(m(n),m(o),m(f));for(let g=0;g<e.length;g+=1)e[g].d(p);for(let g=0;g<r.length;g+=1)r[g].d(p);for(let g=0;g<s.length;g+=1)s[g].d(p)}}}function ll(l){let e,t,n,r,i,o,s,u,f,a,h,c,b,_,$,d,p;function g(L){l[2](L)}let k={$$slots:{default:[nl]},$$scope:{ctx:l}};l[0]!==void 0&&(k.zoom=l[0]),n=new En({props:k}),fe.push(()=>he(n,"zoom",g)),s=new Xn({}),a=new Qn({});function P(L){l[3](L)}let x={};return l[0]!==void 0&&(x.zoom=l[0]),b=new tl({props:x}),fe.push(()=>he(b,"zoom",P)),d=new Bn({}),{c(){e=N("div"),t=N("div"),G(n.$$.fragment),i=H(),o=N("div"),G(s.$$.fragment),u=H(),f=N("div"),G(a.$$.fragment),h=H(),c=N("div"),G(b.$$.fragment),$=H(),G(d.$$.fragment),this.h()},l(L){e=D(L,"DIV",{id:!0,class:!0});var E=A(e);t=D(E,"DIV",{id:!0,class:!0});var F=A(t);q(n.$$.fragment,F),i=M(F),o=D(F,"DIV",{id:!0,class:!0});var B=A(o);q(s.$$.fragment,B),B.forEach(m),u=M(F),f=D(F,"DIV",{id:!0,class:!0});var O=A(f);q(a.$$.fragment,O),O.forEach(m),h=M(F),c=D(F,"DIV",{id:!0,class:!0});var w=A(c);q(b.$$.fragment,w),w.forEach(m),F.forEach(m),$=M(E),q(d.$$.fragment,E),E.forEach(m),this.h()},h(){v(o,"id","top-left-bar"),v(o,"class","absolute-flex svelte-1kpnzxr"),v(f,"id","bottom-left-bar"),v(f,"class","absolute-flex svelte-1kpnzxr"),v(c,"id","bottom-right-bar"),v(c,"class","absolute-flex svelte-1kpnzxr"),v(t,"id","network"),v(t,"class","svelte-1kpnzxr"),v(e,"id","mpls"),v(e,"class","svelte-1kpnzxr")},m(L,E){C(L,e,E),I(e,t),X(n,t,null),I(t,i),I(t,o),X(s,o,null),I(t,u),I(t,f),X(a,f,null),I(t,h),I(t,c),X(b,c,null),I(e,$),X(d,e,null),p=!0},p(L,[E]){const F={};E&16386&&(F.$$scope={dirty:E,ctx:L}),!r&&E&1&&(r=!0,F.zoom=L[0],de(()=>r=!1)),n.$set(F);const B={};!_&&E&1&&(_=!0,B.zoom=L[0],de(()=>_=!1)),b.$set(B)},i(L){p||(R(n.$$.fragment,L),R(s.$$.fragment,L),R(a.$$.fragment,L),R(b.$$.fragment,L),R(d.$$.fragment,L),p=!0)},o(L){T(n.$$.fragment,L),T(s.$$.fragment,L),T(a.$$.fragment,L),T(b.$$.fragment,L),T(d.$$.fragment,L),p=!1},d(L){L&&m(e),W(n),W(s),W(a),W(b),W(d)}}}function rl(l,e,t){let n,r;pe(l,De,u=>t(4,n=u)),pe(l,V,u=>t(1,r=u));let i;Rt(()=>{window.addEventListener("visibilitychanged",()=>{ze(De,n.running=!document.hidden,n)})});function o(u){i=u,t(0,i)}function s(u){i=u,t(0,i)}return[i,r,o,s]}class il extends ee{constructor(e){super(),te(this,e,rl,ll,Z,{})}}function ol(l){let e,t;return e=new il({}),{c(){G(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p:ne,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}class gl extends ee{constructor(e){super(),te(this,e,null,ol,Z,{})}}export{gl as component};
