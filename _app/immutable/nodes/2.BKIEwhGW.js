var Mt=Object.defineProperty;var xt=(l,e,t)=>e in l?Mt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var U=(l,e,t)=>(xt(l,typeof e!="symbol"?e+"":e,t),t);import{r as Ne,s as Z,a as wt,u as Ct,g as It,b as Lt,x as Nt,e as fe,i as Rt,n as ne,y as pe,c as he,o as Dt,z as Oe,A as Fe}from"../chunks/scheduler.C5v8YK5g.js";import{n as B,m as D,S as ee,i as te,e as N,c as R,a as A,d as b,l as v,g as C,z as K,t as le,b as re,h as I,j as ge,s as H,v as G,A as ie,f as M,w as q,x as X,r as ue,p as ae,B as we,y as W,C as oe,D as me,E as _e,o as Q,q as De,F as Ee,G as ye,H as St,I as Ye}from"../chunks/index.ChYF1Lys.js";import{w as He}from"../chunks/index.CD1dNpfE.js";function J(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Me(l,e){B(l,1,1,()=>{e.delete(l.key)})}function xe(l,e,t,n,r,i,o,s,u,f,a,h){let c=l.length,m=i.length,_=c;const E={};for(;_--;)E[l[_].key]=_;const d=[],p=new Map,g=new Map,k=[];for(_=m;_--;){const y=h(r,i,_),j=t(y);let P=o.get(j);P?n&&k.push(()=>P.p(y,e)):(P=f(j,y),P.c()),p.set(j,d[_]=P),j in E&&g.set(j,Math.abs(_-E[j]))}const T=new Set,x=new Set;function L(y){D(y,1),y.m(s,a),o.set(y.key,y),a=y.first,m--}for(;c&&m;){const y=d[m-1],j=l[c-1],P=y.key,F=j.key;y===j?(a=y.first,c--,m--):p.has(F)?!o.has(P)||T.has(P)?L(y):x.has(F)?c--:g.get(P)>g.get(F)?(x.add(P),L(y)):(T.add(F),c--):(u(j,o),c--)}for(;c--;){const y=l[c];p.has(y.key)||u(y,o)}for(;m;)L(d[m-1]);return Ne(k),d}function je(l,e){const t={},n={},r={$$scope:1};let i=l.length;for(;i--;){const o=l[i],s=e[i];if(s){for(const u in o)u in s||(n[u]=1);for(const u in s)r[u]||(t[u]=s[u],r[u]=1);l[i]=s}else for(const u in o)r[u]=1}for(const o in n)o in t||(t[o]=void 0);return t}function ze(l){return typeof l=="object"&&l!==null?l:{}}let At=class{constructor(e,t,n){U(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},Ot=class{constructor(e,t,n,r){U(this,"ttl",32);U(this,"label",-1);U(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=r;const i=t.firstHop.get(n.address);if(!i)return;const o=V.getRouter(i);o&&(this.nextHop=o)}decrementTTL(){--this.ttl<=0&&this.drop()}drop(){V.deletePacket(this.id)}},Ue=class{constructor(e,t){this.id=e,this.node=t}};class ce extends Ue{constructor(){super(...arguments);U(this,"address",`CE-IP-${this.id}`);U(this,"firstHop",new Map);U(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});U(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});U(this,"updateAddress",(t,n)=>{const r=this.firstHop.get(t);if(r===void 0){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,r),this.firstHop.delete(t)});U(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop()}get type(){return"CE"}}let Bt=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});U(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}},Ft=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});U(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(n===void 0){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class ke extends Ue{constructor(){super(...arguments);U(this,"FIB",new Ft);U(this,"LIB",new Bt)}receivePacket(t){var r,i,o,s;const n=t.destination;if(t.label===-1){const u=(r=this.FIB.get(n.address))==null?void 0:r.nextHop;if(!u)return;const f=(i=this.FIB.get(n.address))==null?void 0:i.label;if(!f)return;t.label=f;const a=V.getRouter(parseInt(u));if(!a)return;t.nextHop=a}else{const u=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!u)return;const f=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!f)return;t.label=f;const a=V.routers.find(h=>h instanceof ce&&h.address===u);if(!a)return;t.nextHop=a}t.decrementTTL()}get type(){return"LER"}}class Be extends Ue{constructor(){super(...arguments);U(this,"LIB",new Bt)}receivePacket(t){var o,s;const n=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!n)return;const r=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!r)return;t.label=r;const i=V.getRouter(parseInt(n));i&&(t.nextHop=i,t.decrementTTL())}get type(){return"LSR"}}const jt={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class zt{constructor(){U(this,"store",He({routers:[],links:[],packets:[]}));U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_routers",[]);U(this,"_links",[]);U(this,"_packets",[]);U(this,"routerMap",new Map);U(this,"CEMap",new Map);U(this,"routerCounter",1);U(this,"packetCounter",1)}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!jt[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new At(`${e.source.id}-${e.target.id}`,e.source,e.target);this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,r=new ce(n,{label:`CE ${n}`,x:e,y:t});this.addRouter(r)}createLER(e,t){const n=this.routerCounter++,r=new ke(n,{label:`LER ${n}`,x:e,y:t});this.addRouter(r)}createLSR(e,t){const n=this.routerCounter++,r=new Be(n,{label:`LSR ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(r)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof ce&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof ce&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){const n=new Ot(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=1,this.packetCounter=1,this.notify()}notify(){this.store.set(this.networkState)}}const Ut=new zt,V=Ut,Re=He({running:!0,speedMultiplier:1});class Vt{constructor(){U(this,"store",He());U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_map",new Map)}getPath(e,t){const n=this._map.get(e);if(n)return n.get(t)}findShortestPath(e,t){return Ge(e,t)}findShortestPaths(){const e=new Map,t=V.routers.filter(n=>n.type==="CE");for(const n of t){const r=new Map;for(const i of t){if(n===i)continue;const o=Ge(n,i);r.set(i.id,o)}e.set(n.id,r)}this._map=e}notify(){this.store.set(this._map)}}function Ge(l,e){const t=V.routers,n=t.length,r=new Array(n).fill(1/0),i=new Array(n).fill(!1),o=new Array(n).fill(null);r[t.indexOf(l)]=0;let s=!1;for(;!s;){let a=null,h=1/0;for(let c=0;c<n;c++)!i[c]&&r[c]<h&&(a=t[c],h=r[c]);if(!a||a.id===e.id){s=!0;continue}i[t.indexOf(a)]=!0;for(const c of V.links){let m;if(c.source===a)m=c.target;else if(c.target===a)m=c.source;else continue;const _=t.indexOf(m),E=h+c.distance;E<r[_]&&(r[_]=E,o[_]=a)}}const u=[];let f=e;for(;f;){u.unshift(f);const a=t.indexOf(f);f=o[a]}return u}const Yt=new Vt,Tt=Yt,Le=He(!1);function Gt(l){let e,t,n,r;const i=l[2].default,o=wt(i,l,l[1],null);return{c(){e=N("dialog"),o&&o.c(),this.h()},l(s){e=R(s,"DIALOG",{class:!0});var u=A(e);o&&o.l(u),u.forEach(b),this.h()},h(){v(e,"class","svelte-p5wejv")},m(s,u){C(s,e,u),o&&o.m(e,null),l[4](e),t=!0,n||(r=K(e,"close",l[3]),n=!0)},p(s,[u]){o&&o.p&&(!t||u&2)&&Ct(o,i,s,s[1],t?Lt(i,s[1],u,null):It(s[1]),null)},i(s){t||(D(o,s),t=!0)},o(s){B(o,s),t=!1},d(s){s&&b(e),o&&o.d(s),l[4](null),n=!1,r()}}}function qt(l,e,t){let{$$slots:n={},$$scope:r}=e,{dialog:i}=e;function o(u){Nt.call(this,l,u)}function s(u){fe[u?"unshift":"push"](()=>{i=u,t(0,i)})}return l.$$set=u=>{"dialog"in u&&t(0,i=u.dialog),"$$scope"in u&&t(1,r=u.$$scope)},[i,r,n,o,s]}class Ve extends ee{constructor(e){super(),te(this,e,qt,Gt,Z,{dialog:0})}}const qe=16,Xt=2**20-1;function Pt(l,e){const t=l[0];if(!(t instanceof ce)){alert("The path does not start with a CE");return}if(t.firstHop.has(e)){alert("The destination is already in the CE's first hop");return}const n=l.length-2,r=l[n];if(!(r instanceof ke)){alert("Destination CE is not connected directly to a LER");return}let i=Xe(l[n]);r.LIB.receiveEntry(i,-1,e);for(let o=l.length-2;o>0;o--){const s=l[o],u=l[o-1],f=i;i=Xe(s),u instanceof ke?u.FIB.receiveEntry(e,f,s.id.toString()):u instanceof Be&&u.LIB.receiveEntry(i,f,s.id.toString())}t.firstHop.set(e,l[1].id)}function Wt(l,e){return l instanceof Be||l instanceof ke?l.LIB.map.has(e):!1}function Xe(l){let e;do e=Math.floor(Math.random()*(Xt-qe+1)+qe);while(Wt(l,e));return e}function Kt(l){let e,t,n,r;return{c(){e=N("button"),t=le(l[0]),this.h()},l(i){e=R(i,"BUTTON",{class:!0});var o=A(e);t=re(o,l[0]),o.forEach(b),this.h()},h(){v(e,"class","svelte-17itt71")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"click",function(){Rt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&ge(t,l[0])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function Jt(l,e,t){let{text:n}=e,{callback:r}=e;return l.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,r=i.callback)},[n,r]}class Ce extends ee{constructor(e){super(),te(this,e,Jt,Kt,Z,{text:0,callback:1})}}function We(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n}function Ke(l){let e,t,n,r,i,o,s,u,f,a,h,c,m,_;function E(...g){return l[4](l[7],...g)}function d(...g){return l[5](l[7],...g)}function p(){return l[6](l[7])}return a=new Ce({props:{text:"-",callback:p}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),f=H(),G(a.$$.fragment),h=H(),this.h()},l(g){e=R(g,"TR",{});var k=A(e);t=R(k,"TD",{});var T=A(t);n=R(T,"INPUT",{type:!0,placeholder:!0}),T.forEach(b),i=M(k),o=R(k,"TD",{});var x=A(o);s=R(x,"INPUT",{type:!0,placeholder:!0}),x.forEach(b),f=M(k),q(a.$$.fragment,k),h=M(k),k.forEach(b),this.h()},h(){v(n,"type","text"),n.value=r=l[7],v(n,"placeholder","Address"),v(s,"type","text"),s.value=u=l[8],v(s,"placeholder","Link")},m(g,k){C(g,e,k),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),I(e,f),X(a,e,null),I(e,h),c=!0,m||(_=[K(n,"change",E),K(s,"change",d)],m=!0)},p(g,k){l=g,(!c||k&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),(!c||k&1&&u!==(u=l[8])&&s.value!==u)&&(s.value=u);const T={};k&1&&(T.callback=p),a.$set(T)},i(g){c||(D(a.$$.fragment,g),c=!0)},o(g){B(a.$$.fragment,g),c=!1},d(g){g&&b(e),W(a),m=!1,Ne(_)}}}function Qt(l){let e,t="Destinations:",n,r,i,o="<tr><th>Destination</th> <th>First hop</th> <th></th></tr>",s,u,f,a,h,c,m=J([...l[0].firstHop]),_=[];for(let d=0;d<m.length;d+=1)_[d]=Ke(We(l,m,d));const E=d=>B(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=R(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1ixmdgd"&&(e.textContent=t),n=M(d),r=R(d,"TABLE",{});var p=A(r);i=R(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1uq9vp1"&&(i.innerHTML=o),s=M(p),u=R(p,"TBODY",{});var g=A(u);for(let T=0;T<_.length;T+=1)_[T].l(g);g.forEach(b),p.forEach(b),f=M(d),a=R(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(b),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&13){m=J([...d[0].firstHop]);let k;for(k=0;k<m.length;k+=1){const T=We(d,m,k);_[k]?(_[k].p(T,p),D(_[k],1)):(_[k]=Ke(T),_[k].c(),D(_[k],1),_[k].m(u,null))}for(ue(),k=m.length;k<_.length;k+=1)E(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<m.length;p+=1)D(_[p]);D(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)B(_[p]);B(h.$$.fragment,d),c=!1},d(d){d&&(b(e),b(n),b(r),b(f),b(a)),we(_,d),W(h)}}}function Zt(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=a.target.value.toUpperCase(),m=V.getCERouter(c);if(!m){alert("Destination router not found.");return}const _=Tt.findShortestPath(n,m);n.deleteEntry(h),Pt(_,c),t(0,n)}function o(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=parseInt(a.target.value);n.firstHop.set(h,c)}const s=(a,h)=>{i(h,a)},u=(a,h)=>{o(h,a)},f=a=>{n.firstHop.delete(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class en extends ee{constructor(e){super(),te(this,e,Zt,Qt,Z,{router:0})}}function Je(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Qe(l){let e,t,n,r,i,o,s,u,f,a,h,c,m,_,E,d;function p(...x){return l[3](l[7],...x)}function g(){l[4].call(s,l[9],l[10])}function k(){l[5].call(a,l[9],l[10])}function T(){return l[6](l[7])}return c=new Ce({props:{text:"-",callback:T}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),u=H(),f=N("td"),a=N("input"),h=H(),G(c.$$.fragment),m=H(),this.h()},l(x){e=R(x,"TR",{});var L=A(e);t=R(L,"TD",{});var y=A(t);n=R(y,"INPUT",{type:!0}),y.forEach(b),i=M(L),o=R(L,"TD",{});var j=A(o);s=R(j,"INPUT",{type:!0}),j.forEach(b),u=M(L),f=R(L,"TD",{});var P=A(f);a=R(P,"INPUT",{type:!0}),P.forEach(b),h=M(L),q(c.$$.fragment,L),m=M(L),L.forEach(b),this.h()},h(){v(n,"type","number"),n.value=r=l[7],v(s,"type","number"),v(a,"type","text")},m(x,L){C(x,e,L),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),oe(s,l[8].outgoingLabel),I(e,u),I(e,f),I(f,a),oe(a,l[8].nextHop),I(e,h),X(c,e,null),I(e,m),_=!0,E||(d=[K(n,"change",p),K(s,"input",g),K(a,"input",k)],E=!0)},p(x,L){l=x,(!_||L&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),L&1&&me(s.value)!==l[8].outgoingLabel&&oe(s,l[8].outgoingLabel),L&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const y={};L&1&&(y.callback=T),c.$set(y)},i(x){_||(D(c.$$.fragment,x),_=!0)},o(x){B(c.$$.fragment,x),_=!1},d(x){x&&b(e),W(c),E=!1,Ne(d)}}}function tn(l){let e,t="LIB:",n,r,i,o="<tr><th>Incoming</th> <th>Outgoing</th> <th>Next hop</th> <th></th></tr>",s,u,f,a,h,c,m=J([...l[0].LIB.map]),_=[];for(let d=0;d<m.length;d+=1)_[d]=Qe(Je(l,m,d));const E=d=>B(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].LIB.addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=R(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1j64kst"&&(e.textContent=t),n=M(d),r=R(d,"TABLE",{});var p=A(r);i=R(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1fy2y89"&&(i.innerHTML=o),s=M(p),u=R(p,"TBODY",{});var g=A(u);for(let T=0;T<_.length;T+=1)_[T].l(g);g.forEach(b),p.forEach(b),f=M(d),a=R(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(b),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&5){m=J([...d[0].LIB.map]);let k;for(k=0;k<m.length;k+=1){const T=Je(d,m,k);_[k]?(_[k].p(T,p),D(_[k],1)):(_[k]=Qe(T),_[k].c(),D(_[k],1),_[k].m(u,null))}for(ue(),k=m.length;k<_.length;k+=1)E(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].LIB.addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<m.length;p+=1)D(_[p]);D(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)B(_[p]);B(h.$$.fragment,d),c=!1},d(d){d&&(b(e),b(n),b(r),b(f),b(a)),we(_,d),W(h)}}}function nn(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=parseInt(a.target.value);n.LIB.updateLabel(h,c)}const o=(a,h)=>{i(h,a)};function s(a,h){a[h][1].outgoingLabel=me(this.value),t(0,n)}function u(a,h){a[h][1].nextHop=this.value,t(0,n)}const f=a=>{n.LIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class ln extends ee{constructor(e){super(),te(this,e,nn,tn,Z,{router:0})}}function Ze(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function et(l){let e,t,n,r,i,o,s,u,f,a,h,c,m,_,E,d;function p(...x){return l[3](l[7],...x)}function g(){l[4].call(s,l[9],l[10])}function k(){l[5].call(a,l[9],l[10])}function T(){return l[6](l[7])}return c=new Ce({props:{text:"-",callback:T}}),{c(){e=N("tr"),t=N("td"),n=N("input"),i=H(),o=N("td"),s=N("input"),u=H(),f=N("td"),a=N("input"),h=H(),G(c.$$.fragment),m=H(),this.h()},l(x){e=R(x,"TR",{});var L=A(e);t=R(L,"TD",{});var y=A(t);n=R(y,"INPUT",{type:!0}),y.forEach(b),i=M(L),o=R(L,"TD",{});var j=A(o);s=R(j,"INPUT",{type:!0}),j.forEach(b),u=M(L),f=R(L,"TD",{});var P=A(f);a=R(P,"INPUT",{type:!0}),P.forEach(b),h=M(L),q(c.$$.fragment,L),m=M(L),L.forEach(b),this.h()},h(){v(n,"type","text"),n.value=r=l[7],v(s,"type","number"),v(a,"type","text")},m(x,L){C(x,e,L),I(e,t),I(t,n),I(e,i),I(e,o),I(o,s),oe(s,l[8].label),I(e,u),I(e,f),I(f,a),oe(a,l[8].nextHop),I(e,h),X(c,e,null),I(e,m),_=!0,E||(d=[K(n,"change",p),K(s,"input",g),K(a,"input",k)],E=!0)},p(x,L){l=x,(!_||L&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),L&1&&me(s.value)!==l[8].label&&oe(s,l[8].label),L&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const y={};L&1&&(y.callback=T),c.$set(y)},i(x){_||(D(c.$$.fragment,x),_=!0)},o(x){B(c.$$.fragment,x),_=!1},d(x){x&&b(e),W(c),E=!1,Ne(d)}}}function rn(l){let e,t="FIB:",n,r,i,o="<tr><th>Address</th> <th>Label</th> <th>Next hop</th> <th></th></tr>",s,u,f,a,h,c,m=J([...l[0].FIB.map]),_=[];for(let d=0;d<m.length;d+=1)_[d]=et(Ze(l,m,d));const E=d=>B(_[d],1,1,()=>{_[d]=null});return h=new Ce({props:{text:"+",callback:l[1](l[0].FIB.addEmptyEntry)}}),{c(){e=N("p"),e.textContent=t,n=H(),r=N("table"),i=N("thead"),i.innerHTML=o,s=H(),u=N("tbody");for(let d=0;d<_.length;d+=1)_[d].c();f=H(),a=N("div"),G(h.$$.fragment),this.h()},l(d){e=R(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1j6bdhj"&&(e.textContent=t),n=M(d),r=R(d,"TABLE",{});var p=A(r);i=R(p,"THEAD",{"data-svelte-h":!0}),ie(i)!=="svelte-1qhs6t7"&&(i.innerHTML=o),s=M(p),u=R(p,"TBODY",{});var g=A(u);for(let T=0;T<_.length;T+=1)_[T].l(g);g.forEach(b),p.forEach(b),f=M(d),a=R(d,"DIV",{class:!0});var k=A(a);q(h.$$.fragment,k),k.forEach(b),this.h()},h(){v(a,"class","svelte-f8qi58")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,i),I(r,s),I(r,u);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(u,null);C(d,f,p),C(d,a,p),X(h,a,null),c=!0},p(d,[p]){if(p&5){m=J([...d[0].FIB.map]);let k;for(k=0;k<m.length;k+=1){const T=Ze(d,m,k);_[k]?(_[k].p(T,p),D(_[k],1)):(_[k]=et(T),_[k].c(),D(_[k],1),_[k].m(u,null))}for(ue(),k=m.length;k<_.length;k+=1)E(k);ae()}const g={};p&1&&(g.callback=d[1](d[0].FIB.addEmptyEntry)),h.$set(g)},i(d){if(!c){for(let p=0;p<m.length;p+=1)D(_[p]);D(h.$$.fragment,d),c=!0}},o(d){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)B(_[p]);B(h.$$.fragment,d),c=!1},d(d){d&&(b(e),b(n),b(r),b(f),b(a)),we(_,d),W(h)}}}function on(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,h){if(!(a.target instanceof HTMLInputElement))return;const c=a.target.value;n.FIB.updateAddress(h,c)}const o=(a,h)=>{i(h,a)};function s(a,h){a[h][1].label=me(this.value),t(0,n)}function u(a,h){a[h][1].nextHop=this.value,t(0,n)}const f=a=>{n.FIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,f]}class sn extends ee{constructor(e){super(),te(this,e,on,rn,Z,{router:0})}}function un(l){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=N("p"),e.textContent=t},l(n){e=R(n,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&b(e)}}}function an(l){let e,t,n,r,i,o,s,u,f,a,h,c,m,_,E=l[0].id+"",d,p,g,k,T,x,L,y,j,P,F=l[0]instanceof ce&&tt(l),$=l[0]instanceof ke&&nt(l),O=(l[0]instanceof ke||l[0]instanceof Be)&&lt(l);return L=new Ce({props:{text:"Delete Router",callback:l[3]}}),{c(){e=N("div"),t=N("div"),n=N("label"),r=le(`Label:
          `),i=N("input"),o=H(),s=N("label"),u=le(`Position:
        `),f=N("input"),a=H(),h=N("input"),c=H(),m=N("p"),_=le("ID: "),d=le(E),p=H(),F&&F.c(),g=H(),$&&$.c(),k=H(),O&&O.c(),T=H(),x=N("div"),G(L.$$.fragment),this.h()},l(S){e=R(S,"DIV",{});var z=A(e);t=R(z,"DIV",{});var ve=A(t);n=R(ve,"LABEL",{});var be=A(n);r=re(be,`Label:
          `),i=R(be,"INPUT",{type:!0,class:!0}),be.forEach(b),ve.forEach(b),o=M(z),s=R(z,"LABEL",{});var Ie=A(s);u=re(Ie,`Position:
        `),f=R(Ie,"INPUT",{type:!0,class:!0}),a=M(Ie),h=R(Ie,"INPUT",{type:!0,class:!0}),Ie.forEach(b),c=M(z),m=R(z,"P",{});var Te=A(m);_=re(Te,"ID: "),d=re(Te,E),Te.forEach(b),z.forEach(b),p=M(S),F&&F.l(S),g=M(S),$&&$.l(S),k=M(S),O&&O.l(S),T=M(S),x=R(S,"DIV",{class:!0});var Pe=A(x);q(L.$$.fragment,Pe),Pe.forEach(b),this.h()},h(){v(i,"type","text"),v(i,"class","svelte-cihl2i"),v(f,"type","number"),f.disabled=l[2],v(f,"class","svelte-cihl2i"),v(h,"type","number"),h.disabled=l[2],v(h,"class","svelte-cihl2i"),v(x,"class","margin-top svelte-cihl2i")},m(S,z){C(S,e,z),I(e,t),I(t,n),I(n,r),I(n,i),oe(i,l[0].node.label),I(e,o),I(e,s),I(s,u),I(s,f),oe(f,l[0].node.x),I(s,a),I(s,h),oe(h,l[0].node.y),I(e,c),I(e,m),I(m,_),I(m,d),C(S,p,z),F&&F.m(S,z),C(S,g,z),$&&$.m(S,z),C(S,k,z),O&&O.m(S,z),C(S,T,z),C(S,x,z),X(L,x,null),y=!0,j||(P=[K(i,"input",l[4]),K(f,"input",l[5]),K(h,"input",l[6]),K(e,"input",l[7])],j=!0)},p(S,z){z&1&&i.value!==S[0].node.label&&oe(i,S[0].node.label),(!y||z&4)&&(f.disabled=S[2]),z&1&&me(f.value)!==S[0].node.x&&oe(f,S[0].node.x),(!y||z&4)&&(h.disabled=S[2]),z&1&&me(h.value)!==S[0].node.y&&oe(h,S[0].node.y),(!y||z&1)&&E!==(E=S[0].id+"")&&ge(d,E),S[0]instanceof ce?F?(F.p(S,z),z&1&&D(F,1)):(F=tt(S),F.c(),D(F,1),F.m(g.parentNode,g)):F&&(ue(),B(F,1,1,()=>{F=null}),ae()),S[0]instanceof ke?$?($.p(S,z),z&1&&D($,1)):($=nt(S),$.c(),D($,1),$.m(k.parentNode,k)):$&&(ue(),B($,1,1,()=>{$=null}),ae()),S[0]instanceof ke||S[0]instanceof Be?O?(O.p(S,z),z&1&&D(O,1)):(O=lt(S),O.c(),D(O,1),O.m(T.parentNode,T)):O&&(ue(),B(O,1,1,()=>{O=null}),ae())},i(S){y||(D(F),D($),D(O),D(L.$$.fragment,S),y=!0)},o(S){B(F),B($),B(O),B(L.$$.fragment,S),y=!1},d(S){S&&(b(e),b(p),b(g),b(k),b(T),b(x)),F&&F.d(S),$&&$.d(S),O&&O.d(S),W(L),j=!1,Ne(P)}}}function tt(l){let e,t="Address:",n,r,i=l[0].address+"",o,s,u,f,a,h,c,m;function _(d){l[9](d)}let E={};return l[0]!==void 0&&(E.router=l[0]),f=new en({props:E}),fe.push(()=>_e(f,"router",_)),{c(){e=N("p"),e.textContent=t,n=H(),r=N("button"),o=le(i),s=H(),u=N("div"),G(f.$$.fragment),this.h()},l(d){e=R(d,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-18hoeeh"&&(e.textContent=t),n=M(d),r=R(d,"BUTTON",{class:!0});var p=A(r);o=re(p,i),p.forEach(b),s=M(d),u=R(d,"DIV",{class:!0});var g=A(u);q(f.$$.fragment,g),g.forEach(b),this.h()},h(){De(e,"display","inline"),v(r,"class","svelte-cihl2i"),v(u,"class","margin-top svelte-cihl2i")},m(d,p){C(d,e,p),C(d,n,p),C(d,r,p),I(r,o),C(d,s,p),C(d,u,p),X(f,u,null),h=!0,c||(m=K(r,"click",l[8]),c=!0)},p(d,p){(!h||p&1)&&i!==(i=d[0].address+"")&&ge(o,i);const g={};!a&&p&1&&(a=!0,g.router=d[0],pe(()=>a=!1)),f.$set(g)},i(d){h||(D(f.$$.fragment,d),h=!0)},o(d){B(f.$$.fragment,d),h=!1},d(d){d&&(b(e),b(n),b(r),b(s),b(u)),W(f),c=!1,m()}}}function nt(l){let e,t,n,r;function i(s){l[10](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new sn({props:o}),fe.push(()=>_e(t,"router",i)),{c(){e=N("div"),G(t.$$.fragment),this.h()},l(s){e=R(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(b),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const f={};!n&&u&1&&(n=!0,f.router=s[0],pe(()=>n=!1)),t.$set(f)},i(s){r||(D(t.$$.fragment,s),r=!0)},o(s){B(t.$$.fragment,s),r=!1},d(s){s&&b(e),W(t)}}}function lt(l){let e,t,n,r;function i(s){l[11](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new ln({props:o}),fe.push(()=>_e(t,"router",i)),{c(){e=N("div"),G(t.$$.fragment),this.h()},l(s){e=R(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(b),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const f={};!n&&u&1&&(n=!0,f.router=s[0],pe(()=>n=!1)),t.$set(f)},i(s){r||(D(t.$$.fragment,s),r=!0)},o(s){B(t.$$.fragment,s),r=!1},d(s){s&&b(e),W(t)}}}function fn(l){let e,t,n,r;const i=[an,un],o=[];function s(u,f){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,f){o[e].m(u,f),C(u,n,f),r=!0},p(u,f){let a=e;e=s(u),e===a?o[e].p(u,f):(ue(),B(o[a],1,1,()=>{o[a]=null}),ae(),t=o[e],t?t.p(u,f):(t=o[e]=i[e](u),t.c()),D(t,1),t.m(n.parentNode,n))},i(u){r||(D(t),r=!0)},o(u){B(t),r=!1},d(u){u&&b(n),o[e].d(u)}}}function cn(l){let e,t,n;function r(o){l[12](o)}let i={$$slots:{default:[fn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>_e(e,"dialog",r)),e.$on("close",l[13]),{c(){G(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&16389&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],pe(()=>t=!1)),e.$set(u)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){B(e.$$.fragment,o),n=!1},d(o){W(e,o)}}}function dn(l,e,t){let n;he(l,Le,p=>t(2,n=p));let{router:r}=e,{dialog:i}=e;function o(){!n&&r?confirm("Are you sure you want to delete this router?")&&(V.deleteRouter(r.id),i.close()):alert("You can't delete a router while the network is locked.")}function s(){r.node.label=this.value,t(0,r)}function u(){r.node.x=me(this.value),t(0,r)}function f(){r.node.y=me(this.value),t(0,r)}const a=()=>{V.notify()},h=async()=>{r instanceof ce&&await navigator.clipboard.writeText(r.address)};function c(p){r=p,t(0,r)}function m(p){r=p,t(0,r)}function _(p){r=p,t(0,r)}function E(p){i=p,t(1,i)}const d=()=>{if(r instanceof ce)for(const p of r.firstHop.keys())p===""&&r.firstHop.delete(p);V.notify()};return l.$$set=p=>{"router"in p&&t(0,r=p.router),"dialog"in p&&t(1,i=p.dialog)},[r,i,n,o,s,u,f,a,h,c,m,_,E,d]}class hn extends ee{constructor(e){super(),te(this,e,dn,cn,Z,{router:0,dialog:1})}}function pn(l){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=N("p"),e.textContent=t},l(n){e=R(n,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&b(e)}}}function _n(l){let e,t=l[0].distance+"",n,r,i,o,s,u,f,a,h,c,m;return a=new Ce({props:{text:"Delete Link",callback:l[3]}}),{c(){e=le("Distance: "),n=le(t),r=le(` km
    `),i=N("label"),o=le(`Bandwidth:
      `),s=N("input"),u=H(),f=N("div"),G(a.$$.fragment),this.h()},l(_){e=re(_,"Distance: "),n=re(_,t),r=re(_,` km
    `),i=R(_,"LABEL",{class:!0});var E=A(i);o=re(E,`Bandwidth:
      `),s=R(E,"INPUT",{type:!0,class:!0}),E.forEach(b),u=M(_),f=R(_,"DIV",{class:!0});var d=A(f);q(a.$$.fragment,d),d.forEach(b),this.h()},h(){v(s,"type","number"),s.disabled=l[2],v(s,"class","svelte-11gx5jd"),v(i,"class","svelte-11gx5jd"),v(f,"class","svelte-11gx5jd")},m(_,E){C(_,e,E),C(_,n,E),C(_,r,E),C(_,i,E),I(i,o),I(i,s),oe(s,l[0].bandwidth),C(_,u,E),C(_,f,E),X(a,f,null),h=!0,c||(m=K(s,"input",l[4]),c=!0)},p(_,E){(!h||E&1)&&t!==(t=_[0].distance+"")&&ge(n,t),(!h||E&4)&&(s.disabled=_[2]),E&1&&me(s.value)!==_[0].bandwidth&&oe(s,_[0].bandwidth)},i(_){h||(D(a.$$.fragment,_),h=!0)},o(_){B(a.$$.fragment,_),h=!1},d(_){_&&(b(e),b(n),b(r),b(i),b(u),b(f)),W(a),c=!1,m()}}}function gn(l){let e,t,n,r;const i=[_n,pn],o=[];function s(u,f){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,f){o[e].m(u,f),C(u,n,f),r=!0},p(u,f){let a=e;e=s(u),e===a?o[e].p(u,f):(ue(),B(o[a],1,1,()=>{o[a]=null}),ae(),t=o[e],t?t.p(u,f):(t=o[e]=i[e](u),t.c()),D(t,1),t.m(n.parentNode,n))},i(u){r||(D(t),r=!0)},o(u){B(t),r=!1},d(u){u&&b(n),o[e].d(u)}}}function mn(l){let e,t,n;function r(o){l[5](o)}let i={$$slots:{default:[gn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>_e(e,"dialog",r)),e.$on("close",l[6]),{c(){G(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&133&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],pe(()=>t=!1)),e.$set(u)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){B(e.$$.fragment,o),n=!1},d(o){W(e,o)}}}function bn(l,e,t){let n;he(l,Le,a=>t(2,n=a));let{link:r}=e,{dialog:i}=e;function o(){!n&&r&&confirm("Are you sure you want to delete this link?")&&(V.deleteLink(r.id),i.close())}function s(){r.bandwidth=me(this.value),t(0,r)}function u(a){i=a,t(1,i)}const f=()=>{V.notify()};return l.$$set=a=>{"link"in a&&t(0,r=a.link),"dialog"in a&&t(1,i=a.dialog)},[r,i,n,o,s,u,f]}class kn extends ee{constructor(e){super(),te(this,e,bn,mn,Z,{link:0,dialog:1})}}function rt(l){let e,t="Loading...";return{c(){e=N("p"),e.textContent=t,this.h()},l(n){e=R(n,"P",{style:!0,"data-svelte-h":!0}),ie(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){De(e,"font-size","200px")},m(n,r){C(n,e,r)},d(n){n&&b(e)}}}function it(l){let e,t,n,r,i,o;return{c(){e=Ee("line"),this.h()},l(s){e=ye(s,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),A(e).forEach(b),this.h()},h(){v(e,"class","preview"),v(e,"x1",t=l[4].node.x),v(e,"y1",n=l[4].node.y),v(e,"x2",r=l[17](l[2].x)),v(e,"y2",i=l[18](l[2].y)),v(e,"stroke",o=[l[11].CONNECTING,l[11].MASS_CONNECTING].includes(l[6])?"green":"blue")},m(s,u){C(s,e,u)},p(s,u){u[0]&16&&t!==(t=s[4].node.x)&&v(e,"x1",t),u[0]&16&&n!==(n=s[4].node.y)&&v(e,"y1",n),u[0]&4&&r!==(r=s[17](s[2].x))&&v(e,"x2",r),u[0]&4&&i!==(i=s[18](s[2].y))&&v(e,"y2",i),u[0]&64&&o!==(o=[s[11].CONNECTING,s[11].MASS_CONNECTING].includes(s[6])?"green":"blue")&&v(e,"stroke",o)},d(s){s&&b(e)}}}function vn(l){let e,t,n=(!l[0]&&l[6]===l[11].CONNECTING||[l[11].MASS_CONNECTING,l[11].ADDING_DESTINATION].includes(l[6]))&&l[4],r,i,o,s,u,f,a,h,c,m,_,E,d,p=!l[9]&&rt(),g=n&&it(l);const k=l[21].default,T=wt(k,l,l[20],null);function x($){l[24]($)}function L($){l[25]($)}let y={};l[4]!==void 0&&(y.router=l[4]),l[7]!==void 0&&(y.dialog=l[7]),s=new hn({props:y}),fe.push(()=>_e(s,"router",x)),fe.push(()=>_e(s,"dialog",L));function j($){l[26]($)}function P($){l[27]($)}let F={};return l[5]!==void 0&&(F.link=l[5]),l[8]!==void 0&&(F.dialog=l[8]),h=new kn({props:F}),fe.push(()=>_e(h,"link",j)),fe.push(()=>_e(h,"dialog",P)),{c(){p&&p.c(),e=H(),t=Ee("svg"),g&&g.c(),r=Q(),T&&T.c(),o=H(),G(s.$$.fragment),a=H(),G(h.$$.fragment),this.h()},l($){p&&p.l($),e=M($),t=ye($,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var O=A(t);g&&g.l(O),r=Q(),T&&T.l(O),O.forEach(b),o=M($),q(s.$$.fragment,$),a=M($),q(h.$$.fragment,$),this.h()},h(){v(t,"viewBox",i=`${l[1].x} ${l[1].y} ${l[1].width} ${l[1].height}`),v(t,"role","button"),v(t,"tabindex","-1"),v(t,"class","svelte-1cmb9l6"),De(t,"cursor",l[10][l[6]])},m($,O){p&&p.m($,O),C($,e,O),C($,t,O),g&&g.m(t,null),I(t,r),T&&T.m(t,null),l[23](t),C($,o,O),X(s,$,O),C($,a,O),X(h,$,O),_=!0,E||(d=[K(t,"pointerdown",l[12]),K(t,"pointerup",l[13]),K(t,"wheel",l[14]),K(t,"dblclick",l[15]),K(t,"dragover",St(l[22])),K(t,"drop",l[16])],E=!0)},p($,O){$[9]?p&&(p.d(1),p=null):p||(p=rt(),p.c(),p.m(e.parentNode,e)),O[0]&81&&(n=(!$[0]&&$[6]===$[11].CONNECTING||[$[11].MASS_CONNECTING,$[11].ADDING_DESTINATION].includes($[6]))&&$[4]),n?g?g.p($,O):(g=it($),g.c(),g.m(t,r)):g&&(g.d(1),g=null),T&&T.p&&(!_||O[0]&1048576)&&Ct(T,k,$,$[20],_?Lt(k,$[20],O,null):It($[20]),null),(!_||O[0]&2&&i!==(i=`${$[1].x} ${$[1].y} ${$[1].width} ${$[1].height}`))&&v(t,"viewBox",i),O[0]&1088&&De(t,"cursor",$[10][$[6]]);const S={};!u&&O[0]&16&&(u=!0,S.router=$[4],pe(()=>u=!1)),!f&&O[0]&128&&(f=!0,S.dialog=$[7],pe(()=>f=!1)),s.$set(S);const z={};!c&&O[0]&32&&(c=!0,z.link=$[5],pe(()=>c=!1)),!m&&O[0]&256&&(m=!0,z.dialog=$[8],pe(()=>m=!1)),h.$set(z)},i($){_||(D(T,$),D(s.$$.fragment,$),D(h.$$.fragment,$),_=!0)},o($){B(T,$),B(s.$$.fragment,$),B(h.$$.fragment,$),_=!1},d($){$&&(b(e),b(t),b(o),b(a)),p&&p.d($),g&&g.d(),T&&T.d($),l[23](null),W(s,$),W(h,$),E=!1,Ne(d)}}}function En(l,e,t){let n,r;he(l,Le,w=>t(0,r=w));let{$$slots:i={},$$scope:o}=e;var s=(w=>(w[w.NONE=0]="NONE",w[w.DRAGGING=1]="DRAGGING",w[w.PANNING=2]="PANNING",w[w.CONNECTING=3]="CONNECTING",w[w.MASS_CONNECTING=4]="MASS_CONNECTING",w[w.ADDING_DESTINATION=5]="ADDING_DESTINATION",w))(s||{});const u={x:0,y:0,width:0,height:0,get scale(){return h?this.width/h.getBoundingClientRect().width:1}},f={x:0,y:0},a={x:0,y:0};let h=null,c=null,m=null,_=0,E,d,p=!1;Dt(()=>{if(!h)return;new ResizeObserver(g).observe(h),requestAnimationFrame(()=>{h&&(t(1,u.x=h.getBoundingClientRect().width/-2,u),t(1,u.y=h.getBoundingClientRect().height/-2,u))}),t(9,p=!0)});function g(){if(!h)return;const w=u.scale||1;t(1,u.width=h.getBoundingClientRect().width*w,u),t(1,u.height=h.getBoundingClientRect().height*w,u)}function k(w){if(!(w.target instanceof Element))return;w.preventDefault(),h==null||h.addEventListener("pointermove",x),h==null||h.setPointerCapture(w.pointerId);const Y=w.target.id;if(Y){if(t(4,c=V.getRouter(parseInt(Y))||null),!c)return;w.shiftKey?t(6,_=3):w.altKey?t(6,_=4):w.ctrlKey&&c instanceof ce?t(6,_=5):(a.x=c.node.x,a.y=c.node.y,t(6,_=1))}else t(6,_=2);t(2,f.x=w.clientX,f),t(2,f.y=w.clientY,f)}function T(w){if(w.target instanceof Element){if(w.preventDefault(),c){if(!r&&_===3){const Y=document.elementFromPoint(w.clientX,w.clientY),se=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,de=V.getRouter(parseInt(se??""));de&&V.addLink({source:c,target:de})}else if(_===5){const Y=document.elementFromPoint(w.clientX,w.clientY),se=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,de=V.getRouter(parseInt(se??""));if(de instanceof ce){const Ht=Tt.findShortestPath(c,de);Pt(Ht,de.address.toUpperCase()),V.notify()}else alert("Destination must be a CE")}}t(6,_=0),t(4,c=null),h==null||h.releasePointerCapture(w.pointerId),h==null||h.removeEventListener("pointermove",x)}}function x(w){w.preventDefault();const Y={x:(w.clientX-f.x)*u.scale,y:(w.clientY-f.y)*u.scale};if(!r&&_===1&&c)t(4,c.node.x=Math.round(a.x+Y.x),c),t(4,c.node.y=Math.round(a.y+Y.y),c),V.notify();else if(_===2)t(2,f.x=w.clientX,f),t(2,f.y=w.clientY,f),t(1,u.x-=Y.x,u),t(1,u.y-=Y.y,u);else if(!r&&_===3||_===5)t(2,f.x=w.clientX,f),t(2,f.y=w.clientY,f);else if(!r&&_===4){t(2,f.x=w.clientX,f),t(2,f.y=w.clientY,f);const se=document.elementFromPoint(w.clientX,w.clientY);if(!se)return;const de=V.getRouter(parseInt(se.id));se.tagName==="circle"&&de&&c&&(V.addLink({source:c,target:de}),t(4,c=de))}}function L(w){w.preventDefault(),t(2,f.x=w.clientX,f),t(2,f.y=w.clientY,f);const Y=w.deltaY>0?1.025:.975;y(Y,f)}function y(w,Y){if(!h||u.scale<.1&&w<1||u.scale>5&&w>1)return;const se=h.getBoundingClientRect(),de={x:(Y.x-se.left)/se.width,y:(Y.y-se.top)/se.height};t(1,u.x-=u.width*(w-1)*de.x,u),t(1,u.y-=u.height*(w-1)*de.y,u),t(1,u.width*=w,u),t(1,u.height*=w,u)}function j(w){if(!(w.target instanceof Element))return;w.preventDefault();const Y=document.elementFromPoint(w.clientX,w.clientY);Y&&(Y.tagName==="circle"?P(Y.id):Y.tagName==="rect"&&F(Y.id))}function P(w){const Y=V.getRouter(parseInt(w));Y&&(t(4,c=Y),E.showModal())}function F(w){const Y=V.links.find(se=>w===se.id);Y&&(t(5,m=Y),d.showModal())}function $(w){var se;w.preventDefault();const Y=(se=w.dataTransfer)==null?void 0:se.getData("text/plain");if(Y)switch(Y){case"CE":V.createCE(O(w.clientX),S(w.clientY));break;case"LER":V.createLER(O(w.clientX),S(w.clientY));break;case"LSR":V.createLSR(O(w.clientX),S(w.clientY));break}}function O(w){return h?(w-h.getBoundingClientRect().left)*u.scale+u.x:w}function S(w){return h?(w-h.getBoundingClientRect().top)*u.scale+u.y:w}function z(w){Nt.call(this,l,w)}function ve(w){fe[w?"unshift":"push"](()=>{h=w,t(3,h)})}function be(w){c=w,t(4,c)}function Ie(w){E=w,t(7,E)}function Te(w){m=w,t(5,m)}function Pe(w){d=w,t(8,d)}return l.$$set=w=>{"$$scope"in w&&t(20,o=w.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1&&t(10,n={0:"move",1:r?"not-allowed":"grabbing",2:"grabbing",3:r?"not-allowed":"crosshair",4:r?"not-allowed":"crosshair",5:"crosshair"})},[r,u,f,h,c,m,_,E,d,p,n,s,k,T,L,j,$,O,S,y,o,i,z,ve,be,Ie,Te,Pe]}class yn extends ee{constructor(e){super(),te(this,e,En,vn,Z,{zoom:19},null,[-1,-1])}get zoom(){return this.$$.ctx[19]}}function $n(l){let e,t,n,r;return{c(){e=N("button"),t=le(l[0]),this.h()},l(i){e=R(i,"BUTTON",{style:!0,class:!0});var o=A(e);t=re(o,l[0]),o.forEach(b),this.h()},h(){v(e,"style",l[2]),v(e,"class","svelte-v6s8rg")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"click",function(){Rt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&ge(t,l[0]),o&4&&v(e,"style",l[2])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function wn(l,e,t){let{text:n}=e,{callback:r=()=>{}}=e,{style:i=void 0}=e;return l.$$set=o=>{"text"in o&&t(0,n=o.text),"callback"in o&&t(1,r=o.callback),"style"in o&&t(2,i=o.style)},[n,r,i]}class $e extends ee{constructor(e){super(),te(this,e,wn,$n,Z,{text:0,callback:1,style:2})}}function Cn(l){let e,t,n=l[0].address+"",r,i,o,s="â†’",u,f,a=l[1].address+"",h,c,m,_;return m=new $e({props:{text:"Play",callback:l[2]}}),{c(){e=N("div"),t=N("p"),r=le(n),i=H(),o=N("p"),o.textContent=s,u=H(),f=N("p"),h=le(a),c=H(),G(m.$$.fragment),this.h()},l(E){e=R(E,"DIV",{class:!0});var d=A(e);t=R(d,"P",{});var p=A(t);r=re(p,n),p.forEach(b),i=M(d),o=R(d,"P",{"data-svelte-h":!0}),ie(o)!=="svelte-1giyjq6"&&(o.textContent=s),u=M(d),f=R(d,"P",{});var g=A(f);h=re(g,a),g.forEach(b),c=M(d),q(m.$$.fragment,d),d.forEach(b),this.h()},h(){v(e,"class","svelte-phufxh")},m(E,d){C(E,e,d),I(e,t),I(t,r),I(e,i),I(e,o),I(e,u),I(e,f),I(f,h),I(e,c),X(m,e,null),_=!0},p(E,[d]){(!_||d&1)&&n!==(n=E[0].address+"")&&ge(r,n),(!_||d&2)&&a!==(a=E[1].address+"")&&ge(h,a)},i(E){_||(D(m.$$.fragment,E),_=!0)},o(E){B(m.$$.fragment,E),_=!1},d(E){E&&b(e),W(m)}}}function In(l,e,t){let{source:n}=e,{destination:r}=e;function i(){V.addPacket(n,r)}return l.$$set=o=>{"source"in o&&t(0,n=o.source),"destination"in o&&t(1,r=o.destination)},[n,r,i]}class Ln extends ee{constructor(e){super(),te(this,e,In,Cn,Z,{source:0,destination:1})}}function ot(l,e,t){const n=l.slice();return n[2]=e[t],n}function st(l,e,t){const n=l.slice();return n[5]=e[t][0],n}function ut(l){let e,t;return e=new Ln({props:{source:l[2],destination:V.getSureCERouter(l[5])}}),{c(){G(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p(n,r){const i={};r&1&&(i.source=n[2]),r&1&&(i.destination=V.getSureCERouter(n[5])),e.$set(i)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function at(l){let e,t,n=J([...l[2].firstHop]),r=[];for(let o=0;o<n.length;o+=1)r[o]=ut(st(l,n,o));const i=o=>B(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,s){if(s&1){n=J([...o[2].firstHop]);let u;for(u=0;u<n.length;u+=1){const f=st(o,n,u);r[u]?(r[u].p(f,s),D(r[u],1)):(r[u]=ut(f),r[u].c(),D(r[u],1),r[u].m(e.parentNode,e))}for(ue(),u=n.length;u<r.length;u+=1)i(u);ae()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)D(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)B(r[s]);t=!1},d(o){o&&b(e),we(r,o)}}}function Nn(l){let e,t,n=J(l[0]),r=[];for(let o=0;o<n.length;o+=1)r[o]=at(ot(l,n,o));const i=o=>B(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,[s]){if(s&1){n=J(o[0]);let u;for(u=0;u<n.length;u+=1){const f=ot(o,n,u);r[u]?(r[u].p(f,s),D(r[u],1)):(r[u]=at(f),r[u].c(),D(r[u],1),r[u].m(e.parentNode,e))}for(ue(),u=n.length;u<r.length;u+=1)i(u);ae()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)D(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)B(r[s]);t=!1},d(o){o&&b(e),we(r,o)}}}function Rn(l,e,t){let n,r;return he(l,V,i=>t(1,r=i)),l.$$.update=()=>{l.$$.dirty&2&&t(0,n=r.routers.filter(i=>i instanceof ce))},[n,r]}class Dn extends ee{constructor(e){super(),te(this,e,Rn,Nn,Z,{})}}function ft(l,e,t){const n=l.slice();return n[13]=e[t],n}function ct(l){let e,t;const n=[l[13],{style:"padding: 10px 20px"}];let r={};for(let i=0;i<n.length;i+=1)r=Fe(r,n[i]);return e=new $e({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&32?je(n,[ze(i[13]),n[1]]):{};e.$set(s)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){B(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function Bn(l){let e,t,n,r,i,o,s,u,f,a,h,c=l[1].speedMultiplier+"",m,_,E,d,p,g,k,T,x,L=J(l[5]),y=[];for(let P=0;P<L.length;P+=1)y[P]=ct(ft(l,L,P));const j=P=>B(y[P],1,1,()=>{y[P]=null});return p=new Dn({}),{c(){e=N("div"),t=N("div"),r=H(),i=N("div"),o=N("div"),s=N("div");for(let P=0;P<y.length;P+=1)y[P].c();u=H(),f=N("div"),a=N("p"),h=le("Speed Multiplier: "),m=le(c),_=H(),E=N("input"),d=H(),G(p.$$.fragment),this.h()},l(P){e=R(P,"DIV",{id:!0,style:!0,class:!0});var F=A(e);t=R(F,"DIV",{id:!0,class:!0}),A(t).forEach(b),F.forEach(b),r=M(P),i=R(P,"DIV",{id:!0,style:!0,class:!0});var $=A(i);o=R($,"DIV",{id:!0,class:!0});var O=A(o);s=R(O,"DIV",{id:!0,class:!0});var S=A(s);for(let be=0;be<y.length;be+=1)y[be].l(S);S.forEach(b),u=M(O),f=R(O,"DIV",{id:!0,class:!0});var z=A(f);a=R(z,"P",{});var ve=A(a);h=re(ve,"Speed Multiplier: "),m=re(ve,c),ve.forEach(b),_=M(z),E=R(z,"INPUT",{type:!0,min:!0,max:!0,step:!0}),z.forEach(b),d=M(O),q(p.$$.fragment,O),O.forEach(b),$.forEach(b),this.h()},h(){v(t,"id","resize-bar"),v(t,"class","svelte-1jmh3n8"),v(e,"id","visual-resize-bar"),v(e,"style",n=`width: ${l[0]?1:0}px`),v(e,"class","svelte-1jmh3n8"),v(s,"id","control-panel-buttons"),v(s,"class","svelte-1jmh3n8"),v(E,"type","range"),v(E,"min","0.1"),v(E,"max","2"),v(E,"step","0.1"),v(f,"id","slider"),v(f,"class","svelte-1jmh3n8"),v(o,"id","control-panel-content"),v(o,"class","svelte-1jmh3n8"),v(i,"id","control-panel"),v(i,"style",g=`width: ${l[4]}px; transition: ${l[3]};`),v(i,"class","svelte-1jmh3n8")},m(P,F){C(P,e,F),I(e,t),l[9](t),C(P,r,F),C(P,i,F),I(i,o),I(o,s);for(let $=0;$<y.length;$+=1)y[$]&&y[$].m(s,null);I(o,u),I(o,f),I(f,a),I(a,h),I(a,m),I(f,_),I(f,E),oe(E,l[1].speedMultiplier),I(o,d),X(p,o,null),k=!0,T||(x=[K(t,"pointerdown",l[6]),K(E,"change",l[10]),K(E,"input",l[10])],T=!0)},p(P,[F]){if((!k||F&1&&n!==(n=`width: ${P[0]?1:0}px`))&&v(e,"style",n),F&32){L=J(P[5]);let $;for($=0;$<L.length;$+=1){const O=ft(P,L,$);y[$]?(y[$].p(O,F),D(y[$],1)):(y[$]=ct(O),y[$].c(),D(y[$],1),y[$].m(s,null))}for(ue(),$=L.length;$<y.length;$+=1)j($);ae()}(!k||F&2)&&c!==(c=P[1].speedMultiplier+"")&&ge(m,c),F&2&&oe(E,P[1].speedMultiplier),(!k||F&24&&g!==(g=`width: ${P[4]}px; transition: ${P[3]};`))&&v(i,"style",g)},i(P){if(!k){for(let F=0;F<L.length;F+=1)D(y[F]);D(p.$$.fragment,P),k=!0}},o(P){y=y.filter(Boolean);for(let F=0;F<y.length;F+=1)B(y[F]);B(p.$$.fragment,P),k=!1},d(P){P&&(b(e),b(r),b(i)),l[9](null),we(y,P),W(p),T=!1,Ne(x)}}}function Tn(l,e,t){let n,r,i,o,s,u;he(l,Le,d=>t(0,o=d)),he(l,Re,d=>t(1,s=d)),he(l,V,d=>t(8,u=d));let f,a="width 250ms";function h(d){o&&(t(3,a="none"),f.setPointerCapture(d.pointerId),f.addEventListener("pointermove",c),f.addEventListener("pointerup",m))}function c(d){t(4,i=window.innerWidth-d.clientX),i<=20&&t(4,i=0),i>=window.innerWidth-20&&t(4,i=window.innerWidth-20)}function m(d){f.removeEventListener("pointermove",c),f.removeEventListener("pointerup",m),f.releasePointerCapture(d.pointerId),t(3,a="width 250ms")}function _(d){fe[d?"unshift":"push"](()=>{f=d,t(2,f)})}function E(){s.speedMultiplier=me(this.value),Re.set(s)}return l.$$.update=()=>{l.$$.dirty&256&&t(7,n=u.routers.filter(d=>d instanceof ce)),l.$$.dirty&130&&t(5,r=[{text:s.running?"Pause":"Resume",callback:()=>{Oe(Re,s.running=!s.running,s)}},{text:"Reset",callback:()=>{V.clearPackets()}},{text:"Play All",callback:()=>{for(const d of n)for(const[p]of d.firstHop)V.addPacket(d,V.getSureCERouter(p))}}]),l.$$.dirty&1&&t(4,i=o?300:0)},[o,s,f,a,i,r,h,n,u,_,E]}class Pn extends ee{constructor(e){super(),te(this,e,Tn,Bn,Z,{})}}function Hn(l){let e;return{c(){e=Ee("circle"),this.h()},l(t){e=ye(t,"circle",{r:!0,class:!0}),A(e).forEach(b),this.h()},h(){v(e,"r","5"),v(e,"class","svelte-rvo2j9"),Ye(e,"labeled",l[0].label!==-1)},m(t,n){C(t,e,n),l[4](e)},p(t,[n]){n&1&&Ye(e,"labeled",t[0].label!==-1)},i:ne,o:ne,d(t){t&&b(e),l[4](null)}}}function Mn(l,e,t){let n;he(l,Re,c=>t(3,n=c));let{packet:r}=e,i,o,s;function u(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}const c=Math.sqrt((r.node.x-r.nextHop.node.x)**2+(r.node.y-r.nextHop.node.y)**2);i=Math.round(c/250*1e3)}function f(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}u(),s&&(t(2,o=s.animate([{transform:`translate(${r.node.x}px, ${r.node.y}px)`},{transform:`translate(${r.nextHop.node.x}px, ${r.nextHop.node.y}px)`}],{duration:i,easing:"linear"})),t(2,o.onfinish=a,o))}function a(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}t(0,r.node=r.nextHop.node,r),r.nextHop.receivePacket(r),f()}requestAnimationFrame(f);function h(c){fe[c?"unshift":"push"](()=>{s=c,t(1,s)})}return l.$$set=c=>{"packet"in c&&t(0,r=c.packet)},l.$$.update=()=>{l.$$.dirty&12&&o&&t(2,o.playbackRate=n.speedMultiplier,o),l.$$.dirty&12&&o&&(n.running?o.play():o.pause())},[r,s,o,n,h]}class xn extends ee{constructor(e){super(),te(this,e,Mn,Hn,Z,{packet:0})}}function Sn(l){let e,t,n,r,i,o,s,u,f=l[0].distance+"",a,h,c,m;return{c(){e=Ee("line"),t=H(),n=Ee("rect"),s=H(),u=Ee("text"),a=le(f),h=le(" km"),this.h()},l(_){e=ye(_,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),A(e).forEach(b),t=M(_),n=ye(_,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),A(n).forEach(b),s=M(_),u=ye(_,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var E=A(u);a=re(E,f),h=re(E," km"),E.forEach(b),this.h()},h(){v(e,"x1",l[4]),v(e,"y1",l[2]),v(e,"x2",l[3]),v(e,"y2",l[1]),v(n,"id",r=l[0].id),v(n,"x",i=l[5].x-Se/2),v(n,"y",o=l[5].y-Ae/2),v(n,"width",Se),v(n,"height",Ae),v(n,"class","svelte-zjn2k6"),v(u,"x",c=l[5].x),v(u,"y",m=l[5].y),v(u,"dominant-baseline","central"),v(u,"class","svelte-zjn2k6")},m(_,E){C(_,e,E),C(_,t,E),C(_,n,E),C(_,s,E),C(_,u,E),I(u,a),I(u,h)},p(_,[E]){E&16&&v(e,"x1",_[4]),E&4&&v(e,"y1",_[2]),E&8&&v(e,"x2",_[3]),E&2&&v(e,"y2",_[1]),E&1&&r!==(r=_[0].id)&&v(n,"id",r),E&32&&i!==(i=_[5].x-Se/2)&&v(n,"x",i),E&32&&o!==(o=_[5].y-Ae/2)&&v(n,"y",o),E&1&&f!==(f=_[0].distance+"")&&ge(a,f),E&32&&c!==(c=_[5].x)&&v(u,"x",c),E&32&&m!==(m=_[5].y)&&v(u,"y",m)},i:ne,o:ne,d(_){_&&(b(e),b(t),b(n),b(s),b(u))}}}const Se=50,Ae=20;function dt(l,e){return(l+e)/2}function An(l,e,t){let n,r,i,o,s,{link:u}=e;return l.$$set=f=>{"link"in f&&t(0,u=f.link)},l.$$.update=()=>{l.$$.dirty&1&&t(4,n=u.source.node.x),l.$$.dirty&1&&t(3,r=u.target.node.x),l.$$.dirty&1&&t(2,i=u.source.node.y),l.$$.dirty&1&&t(1,o=u.target.node.y),l.$$.dirty&30&&t(5,s={x:dt(n,r),y:dt(i,o)})},[u,o,i,r,n,s]}class On extends ee{constructor(e){super(),te(this,e,An,Sn,Z,{link:0})}}function Fn(l){let e,t,n,r,i,o,s,u=l[0].node.label+"",f,a,h;return{c(){e=Ee("circle"),o=H(),s=Ee("text"),f=le(u),this.h()},l(c){e=ye(c,"circle",{id:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),A(e).forEach(b),o=M(c),s=ye(c,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var m=A(s);f=re(m,u),m.forEach(b),this.h()},h(){v(e,"id",t=l[0].id.toString()),v(e,"cx",n=l[0].node.x),v(e,"cy",r=l[0].node.y),v(e,"r","20"),v(e,"fill",i=l[1][l[0].type]),v(e,"class","svelte-17jcsko"),v(s,"x",a=l[0].node.x),v(s,"y",h=l[0].node.y),v(s,"dominant-baseline","central"),v(s,"font-size","smaller"),v(s,"class","svelte-17jcsko")},m(c,m){C(c,e,m),C(c,o,m),C(c,s,m),I(s,f)},p(c,[m]){m&1&&t!==(t=c[0].id.toString())&&v(e,"id",t),m&1&&n!==(n=c[0].node.x)&&v(e,"cx",n),m&1&&r!==(r=c[0].node.y)&&v(e,"cy",r),m&1&&i!==(i=c[1][c[0].type])&&v(e,"fill",i),m&1&&u!==(u=c[0].node.label+"")&&ge(f,u),m&1&&a!==(a=c[0].node.x)&&v(s,"x",a),m&1&&h!==(h=c[0].node.y)&&v(s,"y",h)},i:ne,o:ne,d(c){c&&(b(e),b(o),b(s))}}}function jn(l,e,t){let{router:n}=e;const r={CE:"#7FC8F8",LER:"#FFE45E",LSR:"#FF6392"};return l.$$set=i=>{"router"in i&&t(0,n=i.router)},[n,r]}class zn extends ee{constructor(e){super(),te(this,e,jn,Fn,Z,{router:0})}}function Un(l){let e,t,n,r;return{c(){e=N("div"),t=le(l[0]),this.h()},l(i){e=R(i,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var o=A(e);t=re(o,l[0]),o.forEach(b),this.h()},h(){v(e,"draggable","true"),v(e,"role","button"),v(e,"tabindex","-1"),De(e,"background-color",l[1]),v(e,"class","svelte-blffat")},m(i,o){C(i,e,o),I(e,t),n||(r=K(e,"dragstart",l[2]),n=!0)},p(i,[o]){o&1&&ge(t,i[0]),o&2&&De(e,"background-color",i[1])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function Vn(l,e,t){let n;he(l,Le,u=>t(4,n=u));let{text:r}=e,{type:i}=e,{color:o}=e;function s(u){var f;if(n){alert("Network is locked.");return}(f=u.dataTransfer)==null||f.setData("text/plain",i)}return l.$$set=u=>{"text"in u&&t(0,r=u.text),"type"in u&&t(3,i=u.type),"color"in u&&t(1,o=u.color)},[r,o,s,i]}class Yn extends ee{constructor(e){super(),te(this,e,Vn,Un,Z,{text:0,type:3,color:1})}}function ht(l,e,t){const n=l.slice();return n[5]=e[t],n}function pt(l,e,t){const n=l.slice();return n[8]=e[t],n}function _t(l){let e,t,n,r=J(l[2]),i=[];for(let a=0;a<r.length;a+=1)i[a]=gt(pt(l,r,a));const o=a=>B(i[a],1,1,()=>{i[a]=null});let s=J(l[1]),u=[];for(let a=0;a<s.length;a+=1)u[a]=mt(ht(l,s,a));const f=a=>B(u[a],1,1,()=>{u[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=H();for(let a=0;a<u.length;a+=1)u[a].c();t=Q()},l(a){for(let h=0;h<i.length;h+=1)i[h].l(a);e=M(a);for(let h=0;h<u.length;h+=1)u[h].l(a);t=Q()},m(a,h){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,h);C(a,e,h);for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(a,h);C(a,t,h),n=!0},p(a,h){if(h&4){r=J(a[2]);let c;for(c=0;c<r.length;c+=1){const m=pt(a,r,c);i[c]?(i[c].p(m,h),D(i[c],1)):(i[c]=gt(m),i[c].c(),D(i[c],1),i[c].m(e.parentNode,e))}for(ue(),c=r.length;c<i.length;c+=1)o(c);ae()}if(h&2){s=J(a[1]);let c;for(c=0;c<s.length;c+=1){const m=ht(a,s,c);u[c]?(u[c].p(m,h),D(u[c],1)):(u[c]=mt(m),u[c].c(),D(u[c],1),u[c].m(t.parentNode,t))}for(ue(),c=s.length;c<u.length;c+=1)f(c);ae()}},i(a){if(!n){for(let h=0;h<r.length;h+=1)D(i[h]);for(let h=0;h<s.length;h+=1)D(u[h]);n=!0}},o(a){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)B(i[h]);u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)B(u[h]);n=!1},d(a){a&&(b(e),b(t)),we(i,a),we(u,a)}}}function gt(l){let e,t;const n=[l[8]];let r={};for(let i=0;i<n.length;i+=1)r=Fe(r,n[i]);return e=new Yn({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&4?je(n,[ze(i[8])]):{};e.$set(s)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){B(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function mt(l){let e,t;const n=[l[5]];let r={};for(let i=0;i<n.length;i+=1)r=Fe(r,n[i]);return e=new $e({props:r}),{c(){G(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&2?je(n,[ze(i[5])]):{};e.$set(s)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){B(e.$$.fragment,i),t=!1},d(i){W(e,i)}}}function Gn(l){let e,t,n,r;e=new $e({props:{text:l[0]?"Edit":"Simulation",callback:l[4],style:`width: 100px; background-color: ${l[0]?"#3CB371":"#6495ED"};`}});let i=!l[0]&&_t(l);return{c(){G(e.$$.fragment),t=H(),i&&i.c(),n=Q()},l(o){q(e.$$.fragment,o),t=M(o),i&&i.l(o),n=Q()},m(o,s){X(e,o,s),C(o,t,s),i&&i.m(o,s),C(o,n,s),r=!0},p(o,[s]){const u={};s&1&&(u.text=o[0]?"Edit":"Simulation"),s&1&&(u.callback=o[4]),s&1&&(u.style=`width: 100px; background-color: ${o[0]?"#3CB371":"#6495ED"};`),e.$set(u),o[0]?i&&(ue(),B(i,1,1,()=>{i=null}),ae()):i?(i.p(o,s),s&1&&D(i,1)):(i=_t(o),i.c(),D(i,1),i.m(n.parentNode,n))},i(o){r||(D(e.$$.fragment,o),D(i),r=!0)},o(o){B(e.$$.fragment,o),B(i),r=!1},d(o){o&&(b(t),b(n)),W(e,o),i&&i.d(o)}}}function qn(l,e,t){let n,r,i;he(l,V,u=>t(3,r=u)),he(l,Le,u=>t(0,i=u));const o=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],s=()=>{Oe(Le,i=!i,i),V.clearPackets()};return l.$$.update=()=>{l.$$.dirty&9&&t(1,n=[{text:"Clear",callback:()=>{if(i){alert("Network is locked.");return}confirm("Are you sure you want to clear the network?")&&V.clear()}},{text:"Export",callback:()=>{const u={routers:r.routers.map(m=>{if(m instanceof ce)return{...m,type:m.type,firstHop:Object.fromEntries(m.firstHop)};if(m instanceof ke)return{...m,type:m.type,FIB:Object.fromEntries(m.FIB.map),LIB:Object.fromEntries(m.LIB.map)};if(m instanceof Be)return{...m,type:m.type,LIB:Object.fromEntries(m.LIB.map)}}),links:r.links.map(m=>({...m,source:m.source.id,target:m.target.id}))},f=JSON.stringify(u,null,2),a=new Blob([f],{type:"application/json"}),h=window.URL.createObjectURL(a),c=document.createElement("a");c.href=h,c.download="network.json",c.click(),window.URL.revokeObjectURL(h)}}])},[i,n,o,r,s]}class Xn extends ee{constructor(e){super(),te(this,e,qn,Gn,Z,{})}}function Wn(l){let e,t="Drag and drop routers to add them to the network.",n,r,i="Hold the shift key and drag routers to make a singular link.",o,s,u="Hold the alt key and drag routers to make continous links.",f,a,h="Hold the ctrl key and drag CE's to add destinations.",c,m,_="Double click a router to configure it.",E,d,p="The clear button will delete the entire network.",g,k,T,x,L="Press Esc to close this popup.";return{c(){e=N("p"),e.textContent=t,n=H(),r=N("p"),r.textContent=i,o=H(),s=N("p"),s.textContent=u,f=H(),a=N("p"),a.textContent=h,c=H(),m=N("p"),m.textContent=_,E=H(),d=N("p"),d.textContent=p,g=H(),k=N("br"),T=H(),x=N("p"),x.textContent=L},l(y){e=R(y,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-bhocp0"&&(e.textContent=t),n=M(y),r=R(y,"P",{"data-svelte-h":!0}),ie(r)!=="svelte-11o7jqf"&&(r.textContent=i),o=M(y),s=R(y,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-g9ilhz"&&(s.textContent=u),f=M(y),a=R(y,"P",{"data-svelte-h":!0}),ie(a)!=="svelte-33j76o"&&(a.textContent=h),c=M(y),m=R(y,"P",{"data-svelte-h":!0}),ie(m)!=="svelte-11scjjz"&&(m.textContent=_),E=M(y),d=R(y,"P",{"data-svelte-h":!0}),ie(d)!=="svelte-vcl8s3"&&(d.textContent=p),g=M(y),k=R(y,"BR",{}),T=M(y),x=R(y,"P",{"data-svelte-h":!0}),ie(x)!=="svelte-1dvt5v1"&&(x.textContent=L)},m(y,j){C(y,e,j),C(y,n,j),C(y,r,j),C(y,o,j),C(y,s,j),C(y,f,j),C(y,a,j),C(y,c,j),C(y,m,j),C(y,E,j),C(y,d,j),C(y,g,j),C(y,k,j),C(y,T,j),C(y,x,j)},p:ne,d(y){y&&(b(e),b(n),b(r),b(o),b(s),b(f),b(a),b(c),b(m),b(E),b(d),b(g),b(k),b(T),b(x))}}}function Kn(l){let e,t,n,r,i,o;t=new $e({props:{text:"Help",callback:l[1]}});function s(f){l[2](f)}let u={$$slots:{default:[Wn]},$$scope:{ctx:l}};return l[0]!==void 0&&(u.dialog=l[0]),r=new Ve({props:u}),fe.push(()=>_e(r,"dialog",s)),{c(){e=N("div"),G(t.$$.fragment),n=H(),G(r.$$.fragment)},l(f){e=R(f,"DIV",{});var a=A(e);q(t.$$.fragment,a),a.forEach(b),n=M(f),q(r.$$.fragment,f)},m(f,a){C(f,e,a),X(t,e,null),C(f,n,a),X(r,f,a),o=!0},p(f,[a]){const h={};a&1&&(h.callback=f[1]),t.$set(h);const c={};a&8&&(c.$$scope={dirty:a,ctx:f}),!i&&a&1&&(i=!0,c.dialog=f[0],pe(()=>i=!1)),r.$set(c)},i(f){o||(D(t.$$.fragment,f),D(r.$$.fragment,f),o=!0)},o(f){B(t.$$.fragment,f),B(r.$$.fragment,f),o=!1},d(f){f&&(b(e),b(n)),W(t),W(r,f)}}}function Jn(l,e,t){let n;const r=()=>{n.showModal()};function i(o){n=o,t(0,n)}return[n,r,i]}class Qn extends ee{constructor(e){super(),te(this,e,Jn,Kn,Z,{})}}function Zn(l){let e,t,n,r,i,o;return e=new $e({props:{text:" - ",callback:l[1]}}),n=new $e({props:{text:"Fullscreen",callback:l[2]}}),i=new $e({props:{text:" + ",callback:l[3]}}),{c(){G(e.$$.fragment),t=H(),G(n.$$.fragment),r=H(),G(i.$$.fragment)},l(s){q(e.$$.fragment,s),t=M(s),q(n.$$.fragment,s),r=M(s),q(i.$$.fragment,s)},m(s,u){X(e,s,u),C(s,t,u),X(n,s,u),C(s,r,u),X(i,s,u),o=!0},p(s,[u]){const f={};u&1&&(f.callback=s[1]),e.$set(f);const a={};u&1&&(a.callback=s[3]),i.$set(a)},i(s){o||(D(e.$$.fragment,s),D(n.$$.fragment,s),D(i.$$.fragment,s),o=!0)},o(s){B(e.$$.fragment,s),B(n.$$.fragment,s),B(i.$$.fragment,s),o=!1},d(s){s&&(b(t),b(r)),W(e,s),W(n,s),W(i,s)}}}function el(l,e,t){let{zoom:n}=e;const r=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,s)},i=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},o=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,s)};return l.$$set=s=>{"zoom"in s&&t(0,n=s.zoom)},[n,r,i,o]}class tl extends ee{constructor(e){super(),te(this,e,el,Zn,Z,{zoom:0})}}function bt(l,e,t){const n=l.slice();return n[5]=e[t],n}function kt(l,e,t){const n=l.slice();return n[8]=e[t],n}function vt(l,e,t){const n=l.slice();return n[11]=e[t],n}function Et(l,e){let t,n,r;return n=new On({props:{link:e[11]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.link=e[11]),n.$set(s)},i(i){r||(D(n.$$.fragment,i),r=!0)},o(i){B(n.$$.fragment,i),r=!1},d(i){i&&b(t),W(n,i)}}}function yt(l,e){let t,n,r;return n=new zn({props:{router:e[8]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.router=e[8]),n.$set(s)},i(i){r||(D(n.$$.fragment,i),r=!0)},o(i){B(n.$$.fragment,i),r=!1},d(i){i&&b(t),W(n,i)}}}function $t(l,e){let t,n,r;return n=new xn({props:{packet:e[5]}}),{key:l,first:null,c(){t=Q(),G(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.packet=e[5]),n.$set(s)},i(i){r||(D(n.$$.fragment,i),r=!0)},o(i){B(n.$$.fragment,i),r=!1},d(i){i&&b(t),W(n,i)}}}function nl(l){let e=[],t=new Map,n,r=[],i=new Map,o,s=[],u=new Map,f,a,h=J(l[1].links);const c=p=>p[11].id;for(let p=0;p<h.length;p+=1){let g=vt(l,h,p),k=c(g);t.set(k,e[p]=Et(k,g))}let m=J(l[1].routers);const _=p=>p[8].id;for(let p=0;p<m.length;p+=1){let g=kt(l,m,p),k=_(g);i.set(k,r[p]=yt(k,g))}let E=J(l[1].packets);const d=p=>p[5].id;for(let p=0;p<E.length;p+=1){let g=bt(l,E,p),k=d(g);u.set(k,s[p]=$t(k,g))}return{c(){for(let p=0;p<e.length;p+=1)e[p].c();n=H();for(let p=0;p<r.length;p+=1)r[p].c();o=H();for(let p=0;p<s.length;p+=1)s[p].c();f=Q()},l(p){for(let g=0;g<e.length;g+=1)e[g].l(p);n=M(p);for(let g=0;g<r.length;g+=1)r[g].l(p);o=M(p);for(let g=0;g<s.length;g+=1)s[g].l(p);f=Q()},m(p,g){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(p,g);C(p,n,g);for(let k=0;k<r.length;k+=1)r[k]&&r[k].m(p,g);C(p,o,g);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(p,g);C(p,f,g),a=!0},p(p,g){g&2&&(h=J(p[1].links),ue(),e=xe(e,g,c,1,p,h,t,n.parentNode,Me,Et,n,vt),ae()),g&2&&(m=J(p[1].routers),ue(),r=xe(r,g,_,1,p,m,i,o.parentNode,Me,yt,o,kt),ae()),g&2&&(E=J(p[1].packets),ue(),s=xe(s,g,d,1,p,E,u,f.parentNode,Me,$t,f,bt),ae())},i(p){if(!a){for(let g=0;g<h.length;g+=1)D(e[g]);for(let g=0;g<m.length;g+=1)D(r[g]);for(let g=0;g<E.length;g+=1)D(s[g]);a=!0}},o(p){for(let g=0;g<e.length;g+=1)B(e[g]);for(let g=0;g<r.length;g+=1)B(r[g]);for(let g=0;g<s.length;g+=1)B(s[g]);a=!1},d(p){p&&(b(n),b(o),b(f));for(let g=0;g<e.length;g+=1)e[g].d(p);for(let g=0;g<r.length;g+=1)r[g].d(p);for(let g=0;g<s.length;g+=1)s[g].d(p)}}}function ll(l){let e,t,n,r,i,o,s,u,f,a,h,c,m,_,E,d,p;function g(L){l[2](L)}let k={$$slots:{default:[nl]},$$scope:{ctx:l}};l[0]!==void 0&&(k.zoom=l[0]),n=new yn({props:k}),fe.push(()=>_e(n,"zoom",g)),s=new Xn({}),a=new Qn({});function T(L){l[3](L)}let x={};return l[0]!==void 0&&(x.zoom=l[0]),m=new tl({props:x}),fe.push(()=>_e(m,"zoom",T)),d=new Pn({}),{c(){e=N("div"),t=N("div"),G(n.$$.fragment),i=H(),o=N("div"),G(s.$$.fragment),u=H(),f=N("div"),G(a.$$.fragment),h=H(),c=N("div"),G(m.$$.fragment),E=H(),G(d.$$.fragment),this.h()},l(L){e=R(L,"DIV",{id:!0,class:!0});var y=A(e);t=R(y,"DIV",{id:!0,class:!0});var j=A(t);q(n.$$.fragment,j),i=M(j),o=R(j,"DIV",{id:!0,class:!0});var P=A(o);q(s.$$.fragment,P),P.forEach(b),u=M(j),f=R(j,"DIV",{id:!0,class:!0});var F=A(f);q(a.$$.fragment,F),F.forEach(b),h=M(j),c=R(j,"DIV",{id:!0,class:!0});var $=A(c);q(m.$$.fragment,$),$.forEach(b),j.forEach(b),E=M(y),q(d.$$.fragment,y),y.forEach(b),this.h()},h(){v(o,"id","top-left-bar"),v(o,"class","absolute-flex svelte-1kpnzxr"),v(f,"id","bottom-left-bar"),v(f,"class","absolute-flex svelte-1kpnzxr"),v(c,"id","bottom-right-bar"),v(c,"class","absolute-flex svelte-1kpnzxr"),v(t,"id","network"),v(t,"class","svelte-1kpnzxr"),v(e,"id","mpls"),v(e,"class","svelte-1kpnzxr")},m(L,y){C(L,e,y),I(e,t),X(n,t,null),I(t,i),I(t,o),X(s,o,null),I(t,u),I(t,f),X(a,f,null),I(t,h),I(t,c),X(m,c,null),I(e,E),X(d,e,null),p=!0},p(L,[y]){const j={};y&16386&&(j.$$scope={dirty:y,ctx:L}),!r&&y&1&&(r=!0,j.zoom=L[0],pe(()=>r=!1)),n.$set(j);const P={};!_&&y&1&&(_=!0,P.zoom=L[0],pe(()=>_=!1)),m.$set(P)},i(L){p||(D(n.$$.fragment,L),D(s.$$.fragment,L),D(a.$$.fragment,L),D(m.$$.fragment,L),D(d.$$.fragment,L),p=!0)},o(L){B(n.$$.fragment,L),B(s.$$.fragment,L),B(a.$$.fragment,L),B(m.$$.fragment,L),B(d.$$.fragment,L),p=!1},d(L){L&&b(e),W(n),W(s),W(a),W(m),W(d)}}}function rl(l,e,t){let n,r;he(l,Re,u=>t(4,n=u)),he(l,V,u=>t(1,r=u));let i;Dt(()=>{window.addEventListener("visibilitychanged",()=>{Oe(Re,n.running=!document.hidden,n)})});function o(u){i=u,t(0,i)}function s(u){i=u,t(0,i)}return[i,r,o,s]}class il extends ee{constructor(e){super(),te(this,e,rl,ll,Z,{})}}function ol(l){let e,t;return e=new il({}),{c(){G(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p:ne,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}class gl extends ee{constructor(e){super(),te(this,e,null,ol,Z,{})}}export{gl as component};
