var dt=Object.defineProperty;var ht=(n,e,t)=>e in n?dt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var z=(n,e,t)=>(ht(n,typeof e!="symbol"?e+"":e,t),t);import{s as ae,a as lt,u as ot,g as st,b as it,x as rt,e as he,n as le,c as Ce,i as Le,r as be,y as _e,o as _t,z as pt,A as ut}from"../chunks/scheduler.C5v8YK5g.js";import{S as fe,i as ce,e as w,c as B,a as O,d as g,l as p,g as C,z as H,m as X,n as V,o as de,A as Q,s as M,B as G,f as U,h as I,C as ge,D as q,E as pe,v as oe,w as se,x as ie,y as re,r as Te,p as Re,t as ee,b as te,j as Ee,F as ve,G as ke,q as Ne,H as gt}from"../chunks/index.quBbCW_3.js";import{w as Me}from"../chunks/index.CD1dNpfE.js";function ne(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function at(n,e){const t={},l={},o={$$scope:1};let s=n.length;for(;s--;){const u=n[s],a=e[s];if(a){for(const r in u)r in a||(l[r]=1);for(const r in a)o[r]||(t[r]=a[r],o[r]=1);n[s]=a}else for(const r in u)o[r]=1}for(const u in l)u in t||(t[u]=void 0);return t}function ft(n){return typeof n=="object"&&n!==null?n:{}}let Ue=class{constructor(e,t){this.id=e,this.node=t}};class me extends Ue{constructor(){super(...arguments);z(this,"FIB",new Map);z(this,"LIB",new Map);z(this,"allowedConnections",["CE","LSR"]);z(this,"addEmptyFIBEntry",()=>{this.FIB.set("0",{label:0,nextHop:"0"})});z(this,"addEmptyLIBEntry",()=>{this.LIB.set(0,{outgoingLabel:0,nextHop:"0"})});z(this,"updateFIBAddress",(t,l)=>{const o=this.FIB.get(t);if(!o)throw new Error(`Unable to update old FIB address '${t}' to '${l}'.`);this.FIB.set(l,o),this.FIB.delete(t)});z(this,"updateLIBLabel",(t,l)=>{const o=this.LIB.get(t);if(!o)throw new Error(`Unable to update old LIB label '${t}' to '${l}'.`);this.LIB.set(l,o),this.LIB.delete(t)});z(this,"deleteFIBEntry",t=>{this.FIB.delete(t)});z(this,"deleteLIBEntry",t=>{this.LIB.delete(t)});z(this,"receiveFIBEntry",(t,l,o)=>{this.FIB.set(t,{label:l,nextHop:o})});z(this,"receiveLIBEntry",(t,l,o)=>{this.LIB.set(t,{outgoingLabel:l,nextHop:o})})}get type(){return"LER"}}class Ie extends Ue{constructor(){super(...arguments);z(this,"LIB",new Map);z(this,"allowedConnections",["LSR","LER"]);z(this,"addEmptyLIBEntry",()=>{this.LIB.set(0,{outgoingLabel:0,nextHop:"0"})});z(this,"updateLIBLabel",(t,l)=>{const o=this.LIB.get(t);if(!o)throw new Error(`Unable to update old LIB label '${t}' to '${l}'.`);this.LIB.set(l,o),this.LIB.delete(t)});z(this,"deleteLIBEntry",t=>{this.LIB.delete(t)});z(this,"receiveLIBEntry",(t,l,o)=>{this.LIB.set(t,{outgoingLabel:l,nextHop:o})})}get type(){return"LSR"}}class ye extends Ue{constructor(){super(...arguments);z(this,"flows",[]);z(this,"address",`${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}.${Math.floor(Math.random()*256)}`);z(this,"nextHop");z(this,"allowedConnections",["LER"]);z(this,"addEmptyFlow",()=>{this.flows.push({size:0,destination:""})});z(this,"deleteFlow",t=>{this.flows.splice(t,1)})}get type(){return"CE"}}class bt{constructor(){z(this,"store",Me({routers:[],connections:[]}));z(this,"set",this.store.set);z(this,"update",this.store.update);z(this,"subscribe",this.store.subscribe);z(this,"_routers",[]);z(this,"_connections",[]);z(this,"routerMap",new Map);z(this,"counter",0)}get routers(){return this._routers}get connections(){return this._connections}get networkState(){return{routers:this.routers,connections:this.connections}}addConnection(e){e.source!==e.target&&e.source.allowedConnections.includes(e.target.type)&&(this.doesConnectionExist(e)||this.doesConnectionExist({source:e.target,target:e.source})||(this._connections.push({id:`connection-${e.source.id}-${e.target.id}`,...e,bandwidth:0,distance:0,weight:0}),this.fastUpdate()))}deleteConnection(e){this._connections=this._connections.filter(t=>t.id!==e),this.fastUpdate()}doesConnectionExist(e){return this._connections.some(t=>t.source===e.source&&t.target===e.target)}createCE(e){const t=new ye(this.counter++,e);this.addRouter(t)}createLER(e){const t=new me(this.counter++,e);this.addRouter(t)}createLSR(e){const t=new Ie(this.counter++,e);this.addRouter(t)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),this.fastUpdate()}deleteRouter(e){this.getRouter(e)&&(this._routers=this._routers.filter(l=>l.id!==e),this._connections=this._connections.filter(l=>l.source.id!==e&&l.target.id!==e),this.routerMap.delete(e),this.fastUpdate())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}clear(){this._routers=[],this._connections=[],this.routerMap.clear(),this.counter=0,this.fastUpdate()}fastUpdate(){this.store.set(this.networkState)}}const mt=new bt,J=mt,we=Me(!1);function vt(n){let e,t,l,o;const s=n[2].default,u=lt(s,n,n[1],null);return{c(){e=w("dialog"),u&&u.c(),this.h()},l(a){e=B(a,"DIALOG",{class:!0});var r=O(e);u&&u.l(r),r.forEach(g),this.h()},h(){p(e,"class","svelte-414ocx")},m(a,r){C(a,e,r),u&&u.m(e,null),n[4](e),t=!0,l||(o=H(e,"close",n[3]),l=!0)},p(a,[r]){u&&u.p&&(!t||r&2)&&ot(u,s,a,a[1],t?it(s,a[1],r,null):st(a[1]),null)},i(a){t||(X(u,a),t=!0)},o(a){V(u,a),t=!1},d(a){a&&g(e),u&&u.d(a),n[4](null),l=!1,o()}}}function kt(n,e,t){let{$$slots:l={},$$scope:o}=e,{dialog:s}=e;function u(r){rt.call(this,n,r)}function a(r){he[r?"unshift":"push"](()=>{s=r,t(0,s)})}return n.$$set=r=>{"dialog"in r&&t(0,s=r.dialog),"$$scope"in r&&t(1,o=r.$$scope)},[s,o,l,u,a]}class $e extends fe{constructor(e){super(),ce(this,e,kt,vt,ae,{dialog:0})}}function Fe(n,e){const t=J.routers,l=t.length,o=new Array(l).fill(1/0),s=new Array(l).fill(!1),u=new Array(l).fill(null);o[t.indexOf(n)]=0;let a=!1;for(;!a;){let f=null,c=1/0;for(let i=0;i<l;i++)!s[i]&&o[i]<c&&(f=t[i],c=o[i]);if(f===null||f.id===e.id){a=!0;continue}s[t.indexOf(f)]=!0;for(const i of J.connections){let h;if(i.source===f)h=i.target;else if(i.target===f)h=i.source;else continue;const k=t.indexOf(h),b=c+i.distance;b<o[k]&&(o[k]=b,u[k]=f)}}const r=[];let _=e;for(;_;){r.unshift(_);const f=t.indexOf(_);_=u[f]}return r}class yt{constructor(){z(this,"store",Me());z(this,"set",this.store.set);z(this,"update",this.store.update);z(this,"subscribe",this.store.subscribe);z(this,"_map",new Map)}setRawNestedMap(e){this._map=e,this.set(this._map),this.fastUpdate()}getPath(e,t){const l=this._map.get(e);if(l)return l.get(t)}findShortestPath(e,t){return Fe(e,t)}findShortestPaths(){const e=new Map,t=J.routers.filter(l=>l.type==="CE");for(const l of t){const o=new Map;for(const s of t){if(l===s)continue;const u=Fe(l,s);o.set(s.id,u)}e.set(l.id,o)}this.setRawNestedMap(e)}fastUpdate(){this.store.set(this._map)}}const Et=new yt,ct=Et;function Oe(n,e,t){const l=n.slice();return l[25]=e[t][0],l[26]=e[t][1],l[32]=e,l[33]=t,l}function He(n,e,t){const l=n.slice();return l[25]=e[t][0],l[26]=e[t][1],l[27]=e,l[28]=t,l}function Ae(n,e,t){const l=n.slice();return l[29]=e[t][0],l[26]=e[t][1],l[30]=e,l[31]=t,l}function ze(n,e,t){const l=n.slice();return l[22]=e[t],l[23]=e,l[24]=t,l}function Ct(n){let e,t="LIB:",l,o,s,u='<th class="svelte-71n8bk">Incoming</th> <th class="svelte-71n8bk">Outgoing</th> <th class="svelte-71n8bk">Next hop</th>',a,r,_,f="+",c,i,h=ne([...n[0].LIB]),k=[];for(let b=0;b<h.length;b+=1)k[b]=Se(Oe(n,h,b));return{c(){e=w("p"),e.textContent=t,l=M(),o=w("table"),s=w("tr"),s.innerHTML=u,a=M();for(let b=0;b<k.length;b+=1)k[b].c();r=M(),_=w("button"),_.textContent=f,this.h()},l(b){e=B(b,"P",{"data-svelte-h":!0}),G(e)!=="svelte-1j64kst"&&(e.textContent=t),l=U(b),o=B(b,"TABLE",{class:!0});var E=O(o);s=B(E,"TR",{"data-svelte-h":!0}),G(s)!=="svelte-1nxelgl"&&(s.innerHTML=u),a=U(E);for(let d=0;d<k.length;d+=1)k[d].l(E);E.forEach(g),r=U(b),_=B(b,"BUTTON",{class:!0,"data-svelte-h":!0}),G(_)!=="svelte-tb5kpv"&&(_.textContent=f),this.h()},h(){p(o,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk")},m(b,E){C(b,e,E),C(b,l,E),C(b,o,E),I(o,s),I(o,a);for(let d=0;d<k.length;d+=1)k[d]&&k[d].m(o,null);C(b,r,E),C(b,_,E),c||(i=H(_,"click",function(){Le(n[1](n[0].addEmptyLIBEntry))&&n[1](n[0].addEmptyLIBEntry).apply(this,arguments)}),c=!0)},p(b,E){if(n=b,E[0]&9){h=ne([...n[0].LIB]);let d;for(d=0;d<h.length;d+=1){const N=Oe(n,h,d);k[d]?k[d].p(N,E):(k[d]=Se(N),k[d].c(),k[d].m(o,null))}for(;d<k.length;d+=1)k[d].d(1);k.length=h.length}},d(b){b&&(g(e),g(l),g(o),g(r),g(_)),ge(k,b),c=!1,i()}}}function wt(n){let e,t="FIB:",l,o,s,u='<th class="svelte-71n8bk">Address</th> <th class="svelte-71n8bk">Label</th> <th class="svelte-71n8bk">Next hop</th>',a,r,_,f="+",c,i,h="LIB:",k,b,E,d='<th class="svelte-71n8bk">Incoming</th> <th class="svelte-71n8bk">Outgoing</th> <th class="svelte-71n8bk">Next hop</th>',N,$,j,F="+",L,W,x=ne([...n[0].FIB]),y=[];for(let R=0;R<x.length;R+=1)y[R]=Ye(Ae(n,x,R));let m=ne([...n[0].LIB]),D=[];for(let R=0;R<m.length;R+=1)D[R]=je(He(n,m,R));return{c(){e=w("p"),e.textContent=t,l=M(),o=w("table"),s=w("tr"),s.innerHTML=u,a=M();for(let R=0;R<y.length;R+=1)y[R].c();r=M(),_=w("button"),_.textContent=f,c=M(),i=w("p"),i.textContent=h,k=M(),b=w("table"),E=w("tr"),E.innerHTML=d,N=M();for(let R=0;R<D.length;R+=1)D[R].c();$=M(),j=w("button"),j.textContent=F,this.h()},l(R){e=B(R,"P",{"data-svelte-h":!0}),G(e)!=="svelte-1j6bdhj"&&(e.textContent=t),l=U(R),o=B(R,"TABLE",{class:!0});var S=O(o);s=B(S,"TR",{"data-svelte-h":!0}),G(s)!=="svelte-9j9p47"&&(s.innerHTML=u),a=U(S);for(let K=0;K<y.length;K+=1)y[K].l(S);S.forEach(g),r=U(R),_=B(R,"BUTTON",{class:!0,"data-svelte-h":!0}),G(_)!=="svelte-j46m6p"&&(_.textContent=f),c=U(R),i=B(R,"P",{"data-svelte-h":!0}),G(i)!=="svelte-1j64kst"&&(i.textContent=h),k=U(R),b=B(R,"TABLE",{class:!0});var T=O(b);E=B(T,"TR",{"data-svelte-h":!0}),G(E)!=="svelte-1nxelgl"&&(E.innerHTML=d),N=U(T);for(let K=0;K<D.length;K+=1)D[K].l(T);T.forEach(g),$=U(R),j=B(R,"BUTTON",{class:!0,"data-svelte-h":!0}),G(j)!=="svelte-tb5kpv"&&(j.textContent=F),this.h()},h(){p(o,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk"),p(b,"class","svelte-71n8bk"),p(j,"class","svelte-71n8bk")},m(R,S){C(R,e,S),C(R,l,S),C(R,o,S),I(o,s),I(o,a);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(o,null);C(R,r,S),C(R,_,S),C(R,c,S),C(R,i,S),C(R,k,S),C(R,b,S),I(b,E),I(b,N);for(let T=0;T<D.length;T+=1)D[T]&&D[T].m(b,null);C(R,$,S),C(R,j,S),L||(W=[H(_,"click",function(){Le(n[1](n[0].addEmptyFIBEntry))&&n[1](n[0].addEmptyFIBEntry).apply(this,arguments)}),H(j,"click",function(){Le(n[1](n[0].addEmptyLIBEntry))&&n[1](n[0].addEmptyLIBEntry).apply(this,arguments)})],L=!0)},p(R,S){if(n=R,S[0]&5){x=ne([...n[0].FIB]);let T;for(T=0;T<x.length;T+=1){const K=Ae(n,x,T);y[T]?y[T].p(K,S):(y[T]=Ye(K),y[T].c(),y[T].m(o,null))}for(;T<y.length;T+=1)y[T].d(1);y.length=x.length}if(S[0]&9){m=ne([...n[0].LIB]);let T;for(T=0;T<m.length;T+=1){const K=He(n,m,T);D[T]?D[T].p(K,S):(D[T]=je(K),D[T].c(),D[T].m(b,null))}for(;T<D.length;T+=1)D[T].d(1);D.length=m.length}},d(R){R&&(g(e),g(l),g(o),g(r),g(_),g(c),g(i),g(k),g(b),g($),g(j)),ge(y,R),ge(D,R),L=!1,be(W)}}}function Bt(n){let e,t="Flows:",l,o,s,u='<th class="svelte-71n8bk">Size (Megabits)</th> <th class="svelte-71n8bk">Destination</th>',a,r,_,f="+",c,i,h=ne(n[0].flows),k=[];for(let b=0;b<h.length;b+=1)k[b]=Xe(ze(n,h,b));return{c(){e=w("p"),e.textContent=t,l=M(),o=w("table"),s=w("tr"),s.innerHTML=u,a=M();for(let b=0;b<k.length;b+=1)k[b].c();r=M(),_=w("button"),_.textContent=f,this.h()},l(b){e=B(b,"P",{"data-svelte-h":!0}),G(e)!=="svelte-twjhxn"&&(e.textContent=t),l=U(b),o=B(b,"TABLE",{class:!0});var E=O(o);s=B(E,"TR",{"data-svelte-h":!0}),G(s)!=="svelte-1aanzqs"&&(s.innerHTML=u),a=U(E);for(let d=0;d<k.length;d+=1)k[d].l(E);E.forEach(g),r=U(b),_=B(b,"BUTTON",{class:!0,"data-svelte-h":!0}),G(_)!=="svelte-bqeh8i"&&(_.textContent=f),this.h()},h(){p(o,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk")},m(b,E){C(b,e,E),C(b,l,E),C(b,o,E),I(o,s),I(o,a);for(let d=0;d<k.length;d+=1)k[d]&&k[d].m(o,null);C(b,r,E),C(b,_,E),c||(i=H(_,"click",function(){Le(n[1](n[0].addEmptyFlow))&&n[1](n[0].addEmptyFlow).apply(this,arguments)}),c=!0)},p(b,E){if(n=b,E[0]&17){h=ne(n[0].flows);let d;for(d=0;d<h.length;d+=1){const N=ze(n,h,d);k[d]?k[d].p(N,E):(k[d]=Xe(N),k[d].c(),k[d].m(o,null))}for(;d<k.length;d+=1)k[d].d(1);k.length=h.length}},d(b){b&&(g(e),g(l),g(o),g(r),g(_)),ge(k,b),c=!1,i()}}}function Se(n){let e,t,l,o,s,u,a,r,_,f,c,i,h="-",k,b,E;function d(...F){return n[17](n[25],...F)}function N(){n[18].call(a,n[32],n[33])}function $(){n[19].call(f,n[32],n[33])}function j(){return n[20](n[25])}return{c(){e=w("tr"),t=w("td"),l=w("input"),s=M(),u=w("td"),a=w("input"),r=M(),_=w("td"),f=w("input"),c=M(),i=w("button"),i.textContent=h,k=M(),this.h()},l(F){e=B(F,"TR",{});var L=O(e);t=B(L,"TD",{class:!0});var W=O(t);l=B(W,"INPUT",{type:!0,class:!0}),W.forEach(g),s=U(L),u=B(L,"TD",{class:!0});var x=O(u);a=B(x,"INPUT",{type:!0,class:!0}),x.forEach(g),r=U(L),_=B(L,"TD",{class:!0});var y=O(_);f=B(y,"INPUT",{type:!0,class:!0}),y.forEach(g),c=U(L),i=B(L,"BUTTON",{class:!0,"data-svelte-h":!0}),G(i)!=="svelte-1jia542"&&(i.textContent=h),k=U(L),L.forEach(g),this.h()},h(){p(l,"type","number"),l.value=o=n[25],p(l,"class","svelte-71n8bk"),p(t,"class","svelte-71n8bk"),p(a,"type","number"),p(a,"class","svelte-71n8bk"),p(u,"class","svelte-71n8bk"),p(f,"type","text"),p(f,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk"),p(i,"class","svelte-71n8bk")},m(F,L){C(F,e,L),I(e,t),I(t,l),I(e,s),I(e,u),I(u,a),q(a,n[26].outgoingLabel),I(e,r),I(e,_),I(_,f),q(f,n[26].nextHop),I(e,c),I(e,i),I(e,k),b||(E=[H(l,"change",d),H(a,"input",N),H(f,"input",$),H(i,"click",j)],b=!0)},p(F,L){n=F,L[0]&1&&o!==(o=n[25])&&l.value!==o&&(l.value=o),L[0]&1&&Q(a.value)!==n[26].outgoingLabel&&q(a,n[26].outgoingLabel),L[0]&1&&f.value!==n[26].nextHop&&q(f,n[26].nextHop)},d(F){F&&g(e),b=!1,be(E)}}}function Ye(n){let e,t,l,o,s,u,a,r,_,f,c,i,h="-",k,b,E;function d(...F){return n[9](n[29],...F)}function N(){n[10].call(a,n[30],n[31])}function $(){n[11].call(f,n[30],n[31])}function j(){return n[12](n[29])}return{c(){e=w("tr"),t=w("td"),l=w("input"),s=M(),u=w("td"),a=w("input"),r=M(),_=w("td"),f=w("input"),c=M(),i=w("button"),i.textContent=h,k=M(),this.h()},l(F){e=B(F,"TR",{});var L=O(e);t=B(L,"TD",{class:!0});var W=O(t);l=B(W,"INPUT",{type:!0,class:!0}),W.forEach(g),s=U(L),u=B(L,"TD",{class:!0});var x=O(u);a=B(x,"INPUT",{type:!0,class:!0}),x.forEach(g),r=U(L),_=B(L,"TD",{class:!0});var y=O(_);f=B(y,"INPUT",{type:!0,class:!0}),y.forEach(g),c=U(L),i=B(L,"BUTTON",{class:!0,"data-svelte-h":!0}),G(i)!=="svelte-t02fbo"&&(i.textContent=h),k=U(L),L.forEach(g),this.h()},h(){p(l,"type","text"),l.value=o=n[29],p(l,"class","svelte-71n8bk"),p(t,"class","svelte-71n8bk"),p(a,"type","number"),p(a,"class","svelte-71n8bk"),p(u,"class","svelte-71n8bk"),p(f,"type","text"),p(f,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk"),p(i,"class","svelte-71n8bk")},m(F,L){C(F,e,L),I(e,t),I(t,l),I(e,s),I(e,u),I(u,a),q(a,n[26].label),I(e,r),I(e,_),I(_,f),q(f,n[26].nextHop),I(e,c),I(e,i),I(e,k),b||(E=[H(l,"change",d),H(a,"input",N),H(f,"input",$),H(i,"click",j)],b=!0)},p(F,L){n=F,L[0]&1&&o!==(o=n[29])&&l.value!==o&&(l.value=o),L[0]&1&&Q(a.value)!==n[26].label&&q(a,n[26].label),L[0]&1&&f.value!==n[26].nextHop&&q(f,n[26].nextHop)},d(F){F&&g(e),b=!1,be(E)}}}function je(n){let e,t,l,o,s,u,a,r,_,f,c,i,h="-",k,b,E;function d(...F){return n[13](n[25],...F)}function N(){n[14].call(a,n[27],n[28])}function $(){n[15].call(f,n[27],n[28])}function j(){return n[16](n[25])}return{c(){e=w("tr"),t=w("td"),l=w("input"),s=M(),u=w("td"),a=w("input"),r=M(),_=w("td"),f=w("input"),c=M(),i=w("button"),i.textContent=h,k=M(),this.h()},l(F){e=B(F,"TR",{});var L=O(e);t=B(L,"TD",{class:!0});var W=O(t);l=B(W,"INPUT",{type:!0,class:!0}),W.forEach(g),s=U(L),u=B(L,"TD",{class:!0});var x=O(u);a=B(x,"INPUT",{type:!0,class:!0}),x.forEach(g),r=U(L),_=B(L,"TD",{class:!0});var y=O(_);f=B(y,"INPUT",{type:!0,class:!0}),y.forEach(g),c=U(L),i=B(L,"BUTTON",{class:!0,"data-svelte-h":!0}),G(i)!=="svelte-19m5ayk"&&(i.textContent=h),k=U(L),L.forEach(g),this.h()},h(){p(l,"type","number"),l.value=o=n[25],p(l,"class","svelte-71n8bk"),p(t,"class","svelte-71n8bk"),p(a,"type","number"),p(a,"class","svelte-71n8bk"),p(u,"class","svelte-71n8bk"),p(f,"type","text"),p(f,"class","svelte-71n8bk"),p(_,"class","svelte-71n8bk"),p(i,"class","svelte-71n8bk")},m(F,L){C(F,e,L),I(e,t),I(t,l),I(e,s),I(e,u),I(u,a),q(a,n[26].outgoingLabel),I(e,r),I(e,_),I(_,f),q(f,n[26].nextHop),I(e,c),I(e,i),I(e,k),b||(E=[H(l,"change",d),H(a,"input",N),H(f,"input",$),H(i,"click",j)],b=!0)},p(F,L){n=F,L[0]&1&&o!==(o=n[25])&&l.value!==o&&(l.value=o),L[0]&1&&Q(a.value)!==n[26].outgoingLabel&&q(a,n[26].outgoingLabel),L[0]&1&&f.value!==n[26].nextHop&&q(f,n[26].nextHop)},d(F){F&&g(e),b=!1,be(E)}}}function Xe(n){let e,t,l,o,s,u,a,r,_="-",f,c,i;function h(){n[5].call(l,n[23],n[24])}function k(){n[6].call(u,n[23],n[24])}function b(){return n[8](n[24])}return{c(){e=w("tr"),t=w("td"),l=w("input"),o=M(),s=w("td"),u=w("input"),a=M(),r=w("button"),r.textContent=_,f=M(),this.h()},l(E){e=B(E,"TR",{});var d=O(e);t=B(d,"TD",{class:!0});var N=O(t);l=B(N,"INPUT",{type:!0,class:!0}),N.forEach(g),o=U(d),s=B(d,"TD",{class:!0});var $=O(s);u=B($,"INPUT",{type:!0,placeholder:!0,class:!0}),$.forEach(g),a=U(d),r=B(d,"BUTTON",{class:!0,"data-svelte-h":!0}),G(r)!=="svelte-1px6e5a"&&(r.textContent=_),f=U(d),d.forEach(g),this.h()},h(){p(l,"type","number"),p(l,"class","svelte-71n8bk"),p(t,"class","svelte-71n8bk"),p(u,"type","text"),p(u,"placeholder","Address"),p(u,"class","svelte-71n8bk"),p(s,"class","svelte-71n8bk"),p(r,"class","svelte-71n8bk")},m(E,d){C(E,e,d),I(e,t),I(t,l),q(l,n[22].size),I(e,o),I(e,s),I(s,u),q(u,n[22].destination),I(e,a),I(e,r),I(e,f),c||(i=[H(l,"input",h),H(u,"input",k),H(u,"change",n[7]),H(r,"click",b)],c=!0)},p(E,d){n=E,d[0]&1&&Q(l.value)!==n[22].size&&q(l,n[22].size),d[0]&1&&u.value!==n[22].destination&&q(u,n[22].destination)},d(E){E&&g(e),c=!1,be(i)}}}function It(n){let e;function t(s,u){if(s[0]instanceof ye)return Bt;if(s[0]instanceof me)return wt;if(s[0]instanceof Ie)return Ct}let l=t(n),o=l&&l(n);return{c(){o&&o.c(),e=de()},l(s){o&&o.l(s),e=de()},m(s,u){o&&o.m(s,u),C(s,e,u)},p(s,u){l===(l=t(s))&&o?o.p(s,u):(o&&o.d(1),o=l&&l(s),o&&(o.c(),o.m(e.parentNode,e)))},i:le,o:le,d(s){s&&g(e),o&&o.d(s)}}}function Lt(n,e,t){let l;Ce(n,J,y=>t(21,l=y));let{router:o}=e;function s(y){return()=>{y(),t(0,o)}}function u(y,m){if(!(y.target instanceof HTMLInputElement)||!(o instanceof me))return;const D=y.target.value;if(o.FIB.get(D)){alert("Address already exists in FIB.");return}o.updateFIBAddress(m,D)}function a(y,m){if(!(y.target instanceof HTMLInputElement)||!(o instanceof Ie))return;const D=parseInt(y.target.value);if(o.LIB.get(D)){alert("Label already exists in LIB.");return}o.updateLIBLabel(m,D)}function r(y){if(!(y.target instanceof HTMLInputElement)||!(o instanceof ye))return;const m=y.target.value,R=l.routers.filter(ue=>ue instanceof ye).find(ue=>ue.address===m);if(!R){alert("Destination router not found.");return}const S=ct.findShortestPath(o,R);let T,K=!0;for(let ue=S.length-1;ue>0;ue--){const P=S[ue],A=S[ue-1],v=T??Math.floor(Math.random()*((P.id+1)*1e3));T=Math.floor(Math.random()*((A.id+1)*1e3)),A instanceof me&&K?(A.receiveLIBEntry(T,-1,m),K=!1):A instanceof me&&!K?A.receiveFIBEntry(m,v,P.id.toString()):A instanceof Ie&&A.receiveLIBEntry(T,v,P.id.toString())}}function _(y,m){y[m].size=Q(this.value),t(0,o)}function f(y,m){y[m].destination=this.value,t(0,o)}const c=y=>{r(y)},i=y=>{o instanceof ye&&(o.deleteFlow(y),t(0,o))},h=(y,m)=>{u(m,y)};function k(y,m){y[m][1].label=Q(this.value),t(0,o)}function b(y,m){y[m][1].nextHop=this.value,t(0,o)}const E=y=>{o instanceof me&&(o.deleteFIBEntry(y),t(0,o))},d=(y,m)=>{a(m,y)};function N(y,m){y[m][1].outgoingLabel=Q(this.value),t(0,o)}function $(y,m){y[m][1].nextHop=this.value,t(0,o)}const j=y=>{o instanceof me&&(o.deleteLIBEntry(y),t(0,o))},F=(y,m)=>{a(m,y)};function L(y,m){y[m][1].outgoingLabel=Q(this.value),t(0,o)}function W(y,m){y[m][1].nextHop=this.value,t(0,o)}const x=y=>{o instanceof Ie&&(o.deleteLIBEntry(y),t(0,o))};return n.$$set=y=>{"router"in y&&t(0,o=y.router)},[o,s,u,a,r,_,f,c,i,h,k,b,E,d,N,$,j,F,L,W,x]}class Tt extends fe{constructor(e){super(),ce(this,e,Lt,It,ae,{router:0},null,[-1,-1])}}function Rt(n){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=w("p"),e.textContent=t},l(l){e=B(l,"P",{"data-svelte-h":!0}),G(e)!=="svelte-1214eal"&&(e.textContent=t)},m(l,o){C(l,e,o)},p:le,i:le,o:le,d(l){l&&g(e)}}}function Nt(n){let e,t,l,o,s,u,a=n[0].id+"",r,_,f,c,i=n[0].type+"",h,k,b,E,d,N,$,j,F,L,W,x,y,m="Delete Router",D,R,S,T=n[0]instanceof ye&&qe(n);function K(P){n[7](P)}let ue={};return n[0]!==void 0&&(ue.router=n[0]),L=new Tt({props:ue}),he.push(()=>pe(L,"router",K)),{c(){e=w("label"),t=ee(`Label:
      `),l=w("input"),o=M(),s=w("p"),u=ee("ID: "),r=ee(a),_=M(),f=w("p"),c=ee("Type: "),h=ee(i),k=M(),b=w("label"),E=ee(`Position:
      `),d=w("input"),N=M(),$=w("input"),j=M(),T&&T.c(),F=M(),oe(L.$$.fragment),x=M(),y=w("button"),y.textContent=m,this.h()},l(P){e=B(P,"LABEL",{});var A=O(e);t=te(A,`Label:
      `),l=B(A,"INPUT",{type:!0}),A.forEach(g),o=U(P),s=B(P,"P",{});var v=O(s);u=te(v,"ID: "),r=te(v,a),v.forEach(g),_=U(P),f=B(P,"P",{});var Y=O(f);c=te(Y,"Type: "),h=te(Y,i),Y.forEach(g),k=U(P),b=B(P,"LABEL",{});var Z=O(b);E=te(Z,`Position:
      `),d=B(Z,"INPUT",{type:!0}),N=U(Z),$=B(Z,"INPUT",{type:!0}),Z.forEach(g),j=U(P),T&&T.l(P),F=U(P),se(L.$$.fragment,P),x=U(P),y=B(P,"BUTTON",{"data-svelte-h":!0}),G(y)!=="svelte-ufhzdt"&&(y.textContent=m),this.h()},h(){p(l,"type","text"),p(d,"type","number"),d.disabled=n[2],p($,"type","number"),$.disabled=n[2]},m(P,A){C(P,e,A),I(e,t),I(e,l),q(l,n[0].node.label),C(P,o,A),C(P,s,A),I(s,u),I(s,r),C(P,_,A),C(P,f,A),I(f,c),I(f,h),C(P,k,A),C(P,b,A),I(b,E),I(b,d),q(d,n[0].node.x),I(b,N),I(b,$),q($,n[0].node.y),C(P,j,A),T&&T.m(P,A),C(P,F,A),ie(L,P,A),C(P,x,A),C(P,y,A),D=!0,R||(S=[H(l,"input",n[4]),H(d,"input",n[5]),H($,"input",n[6]),H(y,"click",n[3])],R=!0)},p(P,A){A&1&&l.value!==P[0].node.label&&q(l,P[0].node.label),(!D||A&1)&&a!==(a=P[0].id+"")&&Ee(r,a),(!D||A&1)&&i!==(i=P[0].type+"")&&Ee(h,i),(!D||A&4)&&(d.disabled=P[2]),A&1&&Q(d.value)!==P[0].node.x&&q(d,P[0].node.x),(!D||A&4)&&($.disabled=P[2]),A&1&&Q($.value)!==P[0].node.y&&q($,P[0].node.y),P[0]instanceof ye?T?T.p(P,A):(T=qe(P),T.c(),T.m(F.parentNode,F)):T&&(T.d(1),T=null);const v={};!W&&A&1&&(W=!0,v.router=P[0],_e(()=>W=!1)),L.$set(v)},i(P){D||(X(L.$$.fragment,P),D=!0)},o(P){V(L.$$.fragment,P),D=!1},d(P){P&&(g(e),g(o),g(s),g(_),g(f),g(k),g(b),g(j),g(F),g(x),g(y)),T&&T.d(P),re(L,P),R=!1,be(S)}}}function qe(n){let e,t,l=n[0].address+"",o;return{c(){e=w("p"),t=ee("Address: "),o=ee(l)},l(s){e=B(s,"P",{});var u=O(e);t=te(u,"Address: "),o=te(u,l),u.forEach(g)},m(s,u){C(s,e,u),I(e,t),I(e,o)},p(s,u){u&1&&l!==(l=s[0].address+"")&&Ee(o,l)},d(s){s&&g(e)}}}function Dt(n){let e,t,l,o;const s=[Nt,Rt],u=[];function a(r,_){return r[0]?0:1}return e=a(n),t=u[e]=s[e](n),{c(){t.c(),l=de()},l(r){t.l(r),l=de()},m(r,_){u[e].m(r,_),C(r,l,_),o=!0},p(r,_){let f=e;e=a(r),e===f?u[e].p(r,_):(Te(),V(u[f],1,1,()=>{u[f]=null}),Re(),t=u[e],t?t.p(r,_):(t=u[e]=s[e](r),t.c()),X(t,1),t.m(l.parentNode,l))},i(r){o||(X(t),o=!0)},o(r){V(t),o=!1},d(r){r&&g(l),u[e].d(r)}}}function Pt(n){let e,t,l;function o(u){n[8](u)}let s={$$slots:{default:[Dt]},$$scope:{ctx:n}};return n[1]!==void 0&&(s.dialog=n[1]),e=new $e({props:s}),he.push(()=>pe(e,"dialog",o)),e.$on("close",n[9]),{c(){oe(e.$$.fragment)},l(u){se(e.$$.fragment,u)},m(u,a){ie(e,u,a),l=!0},p(u,[a]){const r={};a&1029&&(r.$$scope={dirty:a,ctx:u}),!t&&a&2&&(t=!0,r.dialog=u[1],_e(()=>t=!1)),e.$set(r)},i(u){l||(X(e.$$.fragment,u),l=!0)},o(u){V(e.$$.fragment,u),l=!1},d(u){re(e,u)}}}function Mt(n,e,t){let l;Ce(n,we,h=>t(2,l=h));let{router:o}=e,{dialog:s}=e;function u(){!l&&o&&confirm("Are you sure you want to delete this router?")&&(J.deleteRouter(o.id),s.close())}function a(){o.node.label=this.value,t(0,o)}function r(){o.node.x=Q(this.value),t(0,o)}function _(){o.node.y=Q(this.value),t(0,o)}function f(h){o=h,t(0,o)}function c(h){s=h,t(1,s)}const i=()=>{J.fastUpdate()};return n.$$set=h=>{"router"in h&&t(0,o=h.router),"dialog"in h&&t(1,s=h.dialog)},[o,s,l,u,a,r,_,f,c,i]}class Ut extends fe{constructor(e){super(),ce(this,e,Mt,Pt,ae,{router:0,dialog:1})}}function $t(n){let e,t="You somehow double-clicked on a connection that can't be found?";return{c(){e=w("p"),e.textContent=t},l(l){e=B(l,"P",{"data-svelte-h":!0}),G(e)!=="svelte-139v24q"&&(e.textContent=t)},m(l,o){C(l,e,o)},p:le,d(l){l&&g(e)}}}function Ft(n){let e,t,l,o,s,u,a,r,_,f,c,i,h,k="Delete Connection",b,E;return{c(){e=w("label"),t=ee(`Bandwidth:
      `),l=w("input"),o=M(),s=w("label"),u=ee(`Distance:
      `),a=w("input"),r=M(),_=w("label"),f=ee(`Weight:
      `),c=w("input"),i=M(),h=w("button"),h.textContent=k,this.h()},l(d){e=B(d,"LABEL",{class:!0});var N=O(e);t=te(N,`Bandwidth:
      `),l=B(N,"INPUT",{type:!0,class:!0}),N.forEach(g),o=U(d),s=B(d,"LABEL",{class:!0});var $=O(s);u=te($,`Distance:
      `),a=B($,"INPUT",{type:!0,class:!0}),$.forEach(g),r=U(d),_=B(d,"LABEL",{class:!0});var j=O(_);f=te(j,`Weight:
      `),c=B(j,"INPUT",{type:!0,class:!0}),j.forEach(g),i=U(d),h=B(d,"BUTTON",{"data-svelte-h":!0}),G(h)!=="svelte-10n96bo"&&(h.textContent=k),this.h()},h(){p(l,"type","number"),l.disabled=n[2],p(l,"class","svelte-mdz6ho"),p(e,"class","svelte-mdz6ho"),p(a,"type","number"),a.disabled=n[2],p(a,"class","svelte-mdz6ho"),p(s,"class","svelte-mdz6ho"),p(c,"type","number"),c.disabled=n[2],p(c,"class","svelte-mdz6ho"),p(_,"class","svelte-mdz6ho")},m(d,N){C(d,e,N),I(e,t),I(e,l),q(l,n[0].bandwidth),C(d,o,N),C(d,s,N),I(s,u),I(s,a),q(a,n[0].distance),C(d,r,N),C(d,_,N),I(_,f),I(_,c),q(c,n[0].weight),C(d,i,N),C(d,h,N),b||(E=[H(l,"input",n[4]),H(a,"input",n[5]),H(c,"input",n[6]),H(h,"click",n[3])],b=!0)},p(d,N){N&4&&(l.disabled=d[2]),N&1&&Q(l.value)!==d[0].bandwidth&&q(l,d[0].bandwidth),N&4&&(a.disabled=d[2]),N&1&&Q(a.value)!==d[0].distance&&q(a,d[0].distance),N&4&&(c.disabled=d[2]),N&1&&Q(c.value)!==d[0].weight&&q(c,d[0].weight)},d(d){d&&(g(e),g(o),g(s),g(r),g(_),g(i),g(h)),b=!1,be(E)}}}function Ot(n){let e;function t(s,u){return s[0]?Ft:$t}let l=t(n),o=l(n);return{c(){o.c(),e=de()},l(s){o.l(s),e=de()},m(s,u){o.m(s,u),C(s,e,u)},p(s,u){l===(l=t(s))&&o?o.p(s,u):(o.d(1),o=l(s),o&&(o.c(),o.m(e.parentNode,e)))},d(s){s&&g(e),o.d(s)}}}function Ht(n){let e,t,l;function o(u){n[7](u)}let s={$$slots:{default:[Ot]},$$scope:{ctx:n}};return n[1]!==void 0&&(s.dialog=n[1]),e=new $e({props:s}),he.push(()=>pe(e,"dialog",o)),e.$on("close",n[8]),{c(){oe(e.$$.fragment)},l(u){se(e.$$.fragment,u)},m(u,a){ie(e,u,a),l=!0},p(u,[a]){const r={};a&517&&(r.$$scope={dirty:a,ctx:u}),!t&&a&2&&(t=!0,r.dialog=u[1],_e(()=>t=!1)),e.$set(r)},i(u){l||(X(e.$$.fragment,u),l=!0)},o(u){V(e.$$.fragment,u),l=!1},d(u){re(e,u)}}}function At(n,e,t){let l;Ce(n,we,i=>t(2,l=i));let{connection:o}=e,{dialog:s}=e;function u(){!l&&o&&confirm("Are you sure you want to delete this connection?")&&(J.deleteConnection(o.id),s.close())}function a(){o.bandwidth=Q(this.value),t(0,o)}function r(){o.distance=Q(this.value),t(0,o)}function _(){o.weight=Q(this.value),t(0,o)}function f(i){s=i,t(1,s)}const c=()=>{J.fastUpdate()};return n.$$set=i=>{"connection"in i&&t(0,o=i.connection),"dialog"in i&&t(1,s=i.dialog)},[o,s,l,u,a,r,_,f,c]}class zt extends fe{constructor(e){super(),ce(this,e,At,Ht,ae,{connection:0,dialog:1})}}function Ge(n){let e,t="Loading...";return{c(){e=w("p"),e.textContent=t,this.h()},l(l){e=B(l,"P",{style:!0,"data-svelte-h":!0}),G(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){Ne(e,"font-size","200px")},m(l,o){C(l,e,o)},d(l){l&&g(e)}}}function xe(n){let e,t,l,o,s;return{c(){e=ve("line"),this.h()},l(u){e=ke(u,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),O(e).forEach(g),this.h()},h(){p(e,"x1",t=n[3].node.x),p(e,"y1",l=n[3].node.y),p(e,"x2",o=n[17](n[1].x)),p(e,"y2",s=n[18](n[1].y)),p(e,"stroke","black")},m(u,a){C(u,e,a)},p(u,a){a[0]&8&&t!==(t=u[3].node.x)&&p(e,"x1",t),a[0]&8&&l!==(l=u[3].node.y)&&p(e,"y1",l),a[0]&2&&o!==(o=u[17](u[1].x))&&p(e,"x2",o),a[0]&2&&s!==(s=u[18](u[1].y))&&p(e,"y2",s)},d(u){u&&g(e)}}}function St(n){let e,t,l,o,s,u,a,r,_,f,c,i,h,k,b,E=!n[8]&&Ge(),d=!n[9]&&n[5]===n[10].CONNECTING&&n[3]&&xe(n);const N=n[20].default,$=lt(N,n,n[19],null);function j(m){n[23](m)}function F(m){n[24](m)}let L={};n[3]!==void 0&&(L.router=n[3]),n[6]!==void 0&&(L.dialog=n[6]),u=new Ut({props:L}),he.push(()=>pe(u,"router",j)),he.push(()=>pe(u,"dialog",F));function W(m){n[25](m)}function x(m){n[26](m)}let y={};return n[4]!==void 0&&(y.connection=n[4]),n[7]!==void 0&&(y.dialog=n[7]),f=new zt({props:y}),he.push(()=>pe(f,"connection",W)),he.push(()=>pe(f,"dialog",x)),{c(){E&&E.c(),e=M(),t=ve("svg"),d&&d.c(),l=de(),$&&$.c(),s=M(),oe(u.$$.fragment),_=M(),oe(f.$$.fragment),this.h()},l(m){E&&E.l(m),e=U(m),t=ke(m,"svg",{viewBox:!0,role:!0,tabindex:!0,style:!0,class:!0});var D=O(t);d&&d.l(D),l=de(),$&&$.l(D),D.forEach(g),s=U(m),se(u.$$.fragment,m),_=U(m),se(f.$$.fragment,m),this.h()},h(){p(t,"viewBox",o=`${n[0].x} ${n[0].y} ${n[0].width} ${n[0].height}`),p(t,"role","button"),p(t,"tabindex","-1"),Ne(t,"cursor",n[9]?"default":n[11][n[5]]),p(t,"class","svelte-1cmb9l6")},m(m,D){E&&E.m(m,D),C(m,e,D),C(m,t,D),d&&d.m(t,null),I(t,l),$&&$.m(t,null),n[22](t),C(m,s,D),ie(u,m,D),C(m,_,D),ie(f,m,D),h=!0,k||(b=[H(t,"pointerdown",n[12]),H(t,"pointerup",n[13]),H(t,"wheel",n[14]),H(t,"dblclick",n[15]),H(t,"dragover",gt(n[21])),H(t,"drop",n[16])],k=!0)},p(m,D){m[8]?E&&(E.d(1),E=null):E||(E=Ge(),E.c(),E.m(e.parentNode,e)),!m[9]&&m[5]===m[10].CONNECTING&&m[3]?d?d.p(m,D):(d=xe(m),d.c(),d.m(t,l)):d&&(d.d(1),d=null),$&&$.p&&(!h||D[0]&524288)&&ot($,N,m,m[19],h?it(N,m[19],D,null):st(m[19]),null),(!h||D[0]&1&&o!==(o=`${m[0].x} ${m[0].y} ${m[0].width} ${m[0].height}`))&&p(t,"viewBox",o),(!h||D[0]&544)&&Ne(t,"cursor",m[9]?"default":m[11][m[5]]);const R={};!a&&D[0]&8&&(a=!0,R.router=m[3],_e(()=>a=!1)),!r&&D[0]&64&&(r=!0,R.dialog=m[6],_e(()=>r=!1)),u.$set(R);const S={};!c&&D[0]&16&&(c=!0,S.connection=m[4],_e(()=>c=!1)),!i&&D[0]&128&&(i=!0,S.dialog=m[7],_e(()=>i=!1)),f.$set(S)},i(m){h||(X($,m),X(u.$$.fragment,m),X(f.$$.fragment,m),h=!0)},o(m){V($,m),V(u.$$.fragment,m),V(f.$$.fragment,m),h=!1},d(m){m&&(g(e),g(t),g(s),g(_)),E&&E.d(m),d&&d.d(),$&&$.d(m),n[22](null),re(u,m),re(f,m),k=!1,be(b)}}}function Yt(n,e,t){let l;Ce(n,we,v=>t(9,l=v));let{$$slots:o={},$$scope:s}=e;var u=(v=>(v[v.NONE=0]="NONE",v[v.DRAGGING=1]="DRAGGING",v[v.PANNING=2]="PANNING",v[v.CONNECTING=3]="CONNECTING",v))(u||{});const a={x:0,y:0,width:0,height:0,get scale(){return c?this.width/c.getBoundingClientRect().width:1}},r={x:0,y:0},_={x:0,y:0},f={0:"move",1:"grabbing",2:"grabbing",3:"crosshair"};let c=null,i=null,h=null,k=0,b,E,d=!1;_t(()=>{if(!c)return;new ResizeObserver(N).observe(c),requestAnimationFrame(()=>{c&&(t(0,a.x=c.getBoundingClientRect().width/-2,a),t(0,a.y=c.getBoundingClientRect().height/-2,a))}),t(8,d=!0)});function N(){if(!c)return;const v=a.scale||1;t(0,a.width=c.getBoundingClientRect().width*v,a),t(0,a.height=c.getBoundingClientRect().height*v,a)}function $(v){if(!(v.target instanceof Element))return;v.preventDefault(),c==null||c.addEventListener("pointermove",F),c==null||c.setPointerCapture(v.pointerId);const Y=v.target.id;if(Y){if(t(3,i=J.getRouter(parseInt(Y))||null),!i)return;v.shiftKey?t(5,k=3):(_.x=i.node.x,_.y=i.node.y,t(5,k=1))}else t(5,k=2);t(1,r.x=v.clientX,r),t(1,r.y=v.clientY,r)}function j(v){if(v.target instanceof Element){if(v.preventDefault(),!l&&k===3&&i){const Y=document.elementFromPoint(v.clientX,v.clientY),Z=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,Be=J.getRouter(parseInt(Z??""));Be&&J.addConnection({source:i,target:Be})}t(5,k=0),t(3,i=null),c==null||c.releasePointerCapture(v.pointerId),c==null||c.removeEventListener("pointermove",F)}}function F(v){v.preventDefault();const Y={x:(v.clientX-r.x)*a.scale,y:(v.clientY-r.y)*a.scale};!l&&k===1&&i?(t(3,i.node.x=_.x+Y.x,i),t(3,i.node.y=_.y+Y.y,i),J.fastUpdate()):k===2?(t(1,r.x=v.clientX,r),t(1,r.y=v.clientY,r),t(0,a.x-=Y.x,a),t(0,a.y-=Y.y,a)):!l&&k===3&&(t(1,r.x=v.clientX,r),t(1,r.y=v.clientY,r))}function L(v){if(v.preventDefault(),!c||a.scale<.1&&v.deltaY<=0||a.scale>5&&v.deltaY>=0)return;t(1,r.x=v.clientX,r),t(1,r.y=v.clientY,r);const Y=c.getBoundingClientRect(),Z=v.deltaY>0?1+.025:1-.025,Be={x:(r.x-Y.left)/Y.width,y:(r.y-Y.top)/Y.height};t(0,a.x-=a.width*(Z-1)*Be.x,a),t(0,a.y-=a.height*(Z-1)*Be.y,a),t(0,a.width*=Z,a),t(0,a.height*=Z,a)}function W(v){if(!(v.target instanceof Element))return;v.preventDefault();const Y=document.elementFromPoint(v.clientX,v.clientY);Y&&(Y.tagName==="circle"?x(Y.id):Y.tagName==="rect"&&y(Y.id))}function x(v){const Y=J.getRouter(parseInt(v));Y&&(t(3,i=Y),b.showModal())}function y(v){const Y=J.connections.find(Z=>v===Z.id);Y&&(t(4,h=Y),E.showModal())}function m(v){var Z;switch(v.preventDefault(),(Z=v.dataTransfer)==null?void 0:Z.getData("text/plain")){case"CE":J.createCE({label:"CE",x:D(v.clientX),y:R(v.clientY)});break;case"LER":J.createLER({label:"LER",x:D(v.clientX),y:R(v.clientY)});break;case"LSR":J.createLSR({label:"LSR",x:D(v.clientX),y:R(v.clientY)});break}}function D(v){return c?(v-c.getBoundingClientRect().left)*a.scale+a.x:v}function R(v){return c?(v-c.getBoundingClientRect().top)*a.scale+a.y:v}function S(v){rt.call(this,n,v)}function T(v){he[v?"unshift":"push"](()=>{c=v,t(2,c)})}function K(v){i=v,t(3,i)}function ue(v){b=v,t(6,b)}function P(v){h=v,t(4,h)}function A(v){E=v,t(7,E)}return n.$$set=v=>{"$$scope"in v&&t(19,s=v.$$scope)},[a,r,c,i,h,k,b,E,d,l,u,f,$,j,L,W,m,D,R,s,o,S,T,K,ue,P,A]}class jt extends fe{constructor(e){super(),ce(this,e,Yt,St,ae,{},null,[-1,-1])}}function Xt(n){let e,t,l,o,s,u,a,r,_=n[0].distance+"",f,c;return{c(){e=ve("line"),t=M(),l=ve("rect"),a=M(),r=ve("text"),f=ee(_),c=ee(" km"),this.h()},l(i){e=ke(i,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),O(e).forEach(g),t=U(i),l=ke(i,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0}),O(l).forEach(g),a=U(i),r=ke(i,"text",{x:!0,y:!0,"text-anchor":!0,"dominant-baseline":!0,fill:!0,"font-size":!0,class:!0});var h=O(r);f=te(h,_),c=te(h," km"),h.forEach(g),this.h()},h(){p(e,"x1",n[4]),p(e,"y1",n[2]),p(e,"x2",n[3]),p(e,"y2",n[1]),p(e,"stroke","black"),p(l,"id",o=n[0].id),p(l,"x",s=n[6]-De/2),p(l,"y",u=n[5]-Pe/2),p(l,"width",De),p(l,"height",Pe),p(l,"fill","#222222"),p(l,"stroke","white"),p(r,"x",n[6]),p(r,"y",n[5]),p(r,"text-anchor","middle"),p(r,"dominant-baseline","middle"),p(r,"fill","white"),p(r,"font-size","12px"),p(r,"class","svelte-1ndjud8")},m(i,h){C(i,e,h),C(i,t,h),C(i,l,h),C(i,a,h),C(i,r,h),I(r,f),I(r,c)},p(i,[h]){h&16&&p(e,"x1",i[4]),h&4&&p(e,"y1",i[2]),h&8&&p(e,"x2",i[3]),h&2&&p(e,"y2",i[1]),h&1&&o!==(o=i[0].id)&&p(l,"id",o),h&64&&s!==(s=i[6]-De/2)&&p(l,"x",s),h&32&&u!==(u=i[5]-Pe/2)&&p(l,"y",u),h&1&&_!==(_=i[0].distance+"")&&Ee(f,_),h&64&&p(r,"x",i[6]),h&32&&p(r,"y",i[5])},i:le,o:le,d(i){i&&(g(e),g(t),g(l),g(a),g(r))}}}const De=50,Pe=20;function Ve(n,e){return(n+e)/2}function qt(n,e,t){let l,o,s,u,a,r,{connection:_}=e;return n.$$set=f=>{"connection"in f&&t(0,_=f.connection)},n.$$.update=()=>{n.$$.dirty&1&&t(4,l=_.source.node.x),n.$$.dirty&1&&t(3,o=_.target.node.x),n.$$.dirty&1&&t(2,s=_.source.node.y),n.$$.dirty&1&&t(1,u=_.target.node.y),n.$$.dirty&24&&t(6,a=Ve(l,o)),n.$$.dirty&6&&t(5,r=Ve(s,u))},[_,u,s,o,l,r,a]}class Gt extends fe{constructor(e){super(),ce(this,e,qt,Xt,ae,{connection:0})}}function xt(n){let e,t,l,o,s,u,a,r=n[0].node.label+"",_,f,c;return{c(){e=ve("circle"),u=M(),a=ve("text"),_=ee(r),this.h()},l(i){e=ke(i,"circle",{id:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),O(e).forEach(g),u=U(i),a=ke(i,"text",{x:!0,y:!0,"text-anchor":!0,"dominant-baseline":!0,class:!0});var h=O(a);_=te(h,r),h.forEach(g),this.h()},h(){p(e,"id",t=n[0].id.toString()),p(e,"cx",l=n[0].node.x),p(e,"cy",o=n[0].node.y),p(e,"r","20"),p(e,"fill",s=n[1][n[0].type]),p(e,"class","svelte-11bg7m5"),p(a,"x",f=n[0].node.x),p(a,"y",c=n[0].node.y),p(a,"text-anchor","middle"),p(a,"dominant-baseline","middle"),p(a,"class","svelte-11bg7m5")},m(i,h){C(i,e,h),C(i,u,h),C(i,a,h),I(a,_)},p(i,[h]){h&1&&t!==(t=i[0].id.toString())&&p(e,"id",t),h&1&&l!==(l=i[0].node.x)&&p(e,"cx",l),h&1&&o!==(o=i[0].node.y)&&p(e,"cy",o),h&1&&s!==(s=i[1][i[0].type])&&p(e,"fill",s),h&1&&r!==(r=i[0].node.label+"")&&Ee(_,r),h&1&&f!==(f=i[0].node.x)&&p(a,"x",f),h&1&&c!==(c=i[0].node.y)&&p(a,"y",c)},i:le,o:le,d(i){i&&(g(e),g(u),g(a))}}}function Vt(n,e,t){let{router:l}=e;const o={CE:"lightgreen",LER:"cyan",LSR:"hotpink"};return n.$$set=s=>{"router"in s&&t(0,l=s.router)},[l,o]}class Wt extends fe{constructor(e){super(),ce(this,e,Vt,xt,ae,{router:0})}}function Kt(n){let e,t,l,o;return{c(){e=w("div"),t=ee(n[0]),this.h()},l(s){e=B(s,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var u=O(e);t=te(u,n[0]),u.forEach(g),this.h()},h(){p(e,"draggable","true"),p(e,"role","button"),p(e,"tabindex","-1"),Ne(e,"background-color",n[1]),p(e,"class","svelte-17iodfq")},m(s,u){C(s,e,u),I(e,t),l||(o=H(e,"dragstart",n[2]),l=!0)},p(s,[u]){u&1&&Ee(t,s[0]),u&2&&Ne(e,"background-color",s[1])},i:le,o:le,d(s){s&&g(e),l=!1,o()}}}function Jt(n,e,t){let l;Ce(n,we,r=>t(4,l=r));let{text:o}=e,{type:s}=e,{color:u}=e;function a(r){var _;if(l){alert("Network is locked.");return}(_=r.dataTransfer)==null||_.setData("text/plain",s)}return n.$$set=r=>{"text"in r&&t(0,o=r.text),"type"in r&&t(3,s=r.type),"color"in r&&t(1,u=r.color)},[o,u,a,s]}class Qt extends fe{constructor(e){super(),ce(this,e,Jt,Kt,ae,{text:0,type:3,color:1})}}function Zt(n){let e,t,l,o;return{c(){e=w("button"),t=ee(n[0]),this.h()},l(s){e=B(s,"BUTTON",{class:!0});var u=O(e);t=te(u,n[0]),u.forEach(g),this.h()},h(){p(e,"class","svelte-1mil06r")},m(s,u){C(s,e,u),I(e,t),l||(o=H(e,"click",function(){Le(n[1])&&n[1].apply(this,arguments)}),l=!0)},p(s,[u]){n=s,u&1&&Ee(t,n[0])},i:le,o:le,d(s){s&&g(e),l=!1,o()}}}function en(n,e,t){let{text:l}=e,{callback:o=()=>{}}=e;return n.$$set=s=>{"text"in s&&t(0,l=s.text),"callback"in s&&t(1,o=s.callback)},[l,o]}class tn extends fe{constructor(e){super(),ce(this,e,en,Zt,ae,{text:0,callback:1})}}function We(n,e,t){const l=n.slice();return l[3]=e[t],l}function Ke(n,e,t){const l=n.slice();return l[6]=e[t],l}function Je(n){let e,t;const l=[n[6]];let o={};for(let s=0;s<l.length;s+=1)o=ut(o,l[s]);return e=new Qt({props:o}),{c(){oe(e.$$.fragment)},l(s){se(e.$$.fragment,s)},m(s,u){ie(e,s,u),t=!0},p(s,u){const a=u&2?at(l,[ft(s[6])]):{};e.$set(a)},i(s){t||(X(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Qe(n){let e,t;const l=[n[3]];let o={};for(let s=0;s<l.length;s+=1)o=ut(o,l[s]);return e=new tn({props:o}),{c(){oe(e.$$.fragment)},l(s){se(e.$$.fragment,s)},m(s,u){ie(e,s,u),t=!0},p(s,u){const a=u&1?at(l,[ft(s[3])]):{};e.$set(a)},i(s){t||(X(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function nn(n){let e,t,l,o=ne(n[1]),s=[];for(let f=0;f<o.length;f+=1)s[f]=Je(Ke(n,o,f));const u=f=>V(s[f],1,1,()=>{s[f]=null});let a=ne(n[0]),r=[];for(let f=0;f<a.length;f+=1)r[f]=Qe(We(n,a,f));const _=f=>V(r[f],1,1,()=>{r[f]=null});return{c(){for(let f=0;f<s.length;f+=1)s[f].c();e=M();for(let f=0;f<r.length;f+=1)r[f].c();t=de()},l(f){for(let c=0;c<s.length;c+=1)s[c].l(f);e=U(f);for(let c=0;c<r.length;c+=1)r[c].l(f);t=de()},m(f,c){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(f,c);C(f,e,c);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(f,c);C(f,t,c),l=!0},p(f,[c]){if(c&2){o=ne(f[1]);let i;for(i=0;i<o.length;i+=1){const h=Ke(f,o,i);s[i]?(s[i].p(h,c),X(s[i],1)):(s[i]=Je(h),s[i].c(),X(s[i],1),s[i].m(e.parentNode,e))}for(Te(),i=o.length;i<s.length;i+=1)u(i);Re()}if(c&1){a=ne(f[0]);let i;for(i=0;i<a.length;i+=1){const h=We(f,a,i);r[i]?(r[i].p(h,c),X(r[i],1)):(r[i]=Qe(h),r[i].c(),X(r[i],1),r[i].m(t.parentNode,t))}for(Te(),i=a.length;i<r.length;i+=1)_(i);Re()}},i(f){if(!l){for(let c=0;c<o.length;c+=1)X(s[c]);for(let c=0;c<a.length;c+=1)X(r[c]);l=!0}},o(f){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)V(s[c]);r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)V(r[c]);l=!1},d(f){f&&(g(e),g(t)),ge(s,f),ge(r,f)}}}function ln(n,e,t){let l,o;Ce(n,we,u=>t(2,o=u));const s=[{text:"+ Customer",type:"CE",color:"lightgreen"},{text:"+ Edge",type:"LER",color:"cyan"},{text:"+ Switch",type:"LSR",color:"hotpink"}];return n.$$.update=()=>{n.$$.dirty&4&&t(0,l=[{text:o?"Unlock":"Lock",callback:()=>{pt(we,o=!o,o)}},{text:"Clear",callback:()=>{if(o){alert("Network is locked.");return}confirm("Are you sure you want to clear the network?")&&J.clear()}},{text:"LDP (actually Dijkstra)",callback:()=>{ct.findShortestPaths()}}])},[l,s,o]}class on extends fe{constructor(e){super(),ce(this,e,ln,nn,ae,{})}}function sn(n){let e,t="Drag and drop routers that you want to add.",l,o,s="Hold the shift key and drag routers to make connections between the routers.",u,a,r="Double press a router to configure/delete it.",_,f,c="The clear button will delete everything.",i,h,k,b,E="Press Esc to close this popup.";return{c(){e=w("p"),e.textContent=t,l=M(),o=w("p"),o.textContent=s,u=M(),a=w("p"),a.textContent=r,_=M(),f=w("p"),f.textContent=c,i=M(),h=w("br"),k=M(),b=w("p"),b.textContent=E},l(d){e=B(d,"P",{"data-svelte-h":!0}),G(e)!=="svelte-1e52y96"&&(e.textContent=t),l=U(d),o=B(d,"P",{"data-svelte-h":!0}),G(o)!=="svelte-b60b0b"&&(o.textContent=s),u=U(d),a=B(d,"P",{"data-svelte-h":!0}),G(a)!=="svelte-zhn422"&&(a.textContent=r),_=U(d),f=B(d,"P",{"data-svelte-h":!0}),G(f)!=="svelte-epfgnc"&&(f.textContent=c),i=U(d),h=B(d,"BR",{}),k=U(d),b=B(d,"P",{"data-svelte-h":!0}),G(b)!=="svelte-1dvt5v1"&&(b.textContent=E)},m(d,N){C(d,e,N),C(d,l,N),C(d,o,N),C(d,u,N),C(d,a,N),C(d,_,N),C(d,f,N),C(d,i,N),C(d,h,N),C(d,k,N),C(d,b,N)},p:le,d(d){d&&(g(e),g(l),g(o),g(u),g(a),g(_),g(f),g(i),g(h),g(k),g(b))}}}function rn(n){let e,t,l="Help",o,s,u,a,r,_;function f(i){n[2](i)}let c={$$slots:{default:[sn]},$$scope:{ctx:n}};return n[0]!==void 0&&(c.dialog=n[0]),s=new $e({props:c}),he.push(()=>pe(s,"dialog",f)),{c(){e=w("div"),t=w("button"),t.textContent=l,o=M(),oe(s.$$.fragment),this.h()},l(i){e=B(i,"DIV",{});var h=O(e);t=B(h,"BUTTON",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1l58twh"&&(t.textContent=l),h.forEach(g),o=U(i),se(s.$$.fragment,i),this.h()},h(){p(t,"class","svelte-g8xfna")},m(i,h){C(i,e,h),I(e,t),C(i,o,h),ie(s,i,h),a=!0,r||(_=H(t,"click",n[1]),r=!0)},p(i,[h]){const k={};h&8&&(k.$$scope={dirty:h,ctx:i}),!u&&h&1&&(u=!0,k.dialog=i[0],_e(()=>u=!1)),s.$set(k)},i(i){a||(X(s.$$.fragment,i),a=!0)},o(i){V(s.$$.fragment,i),a=!1},d(i){i&&(g(e),g(o)),re(s,i),r=!1,_()}}}function un(n,e,t){let l;const o=()=>{l.showModal()};function s(u){l=u,t(0,l)}return[l,o,s]}class an extends fe{constructor(e){super(),ce(this,e,un,rn,ae,{})}}function Ze(n,e,t){const l=n.slice();return l[1]=e[t],l}function et(n,e,t){const l=n.slice();return l[4]=e[t],l}function tt(n){let e,t;return e=new Gt({props:{connection:n[4]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,o){ie(e,l,o),t=!0},p(l,o){const s={};o&1&&(s.connection=l[4]),e.$set(s)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}function nt(n){let e,t;return e=new Wt({props:{router:n[1]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,o){ie(e,l,o),t=!0},p(l,o){const s={};o&1&&(s.router=l[1]),e.$set(s)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}function fn(n){let e,t,l,o=ne(n[0].connections),s=[];for(let f=0;f<o.length;f+=1)s[f]=tt(et(n,o,f));const u=f=>V(s[f],1,1,()=>{s[f]=null});let a=ne(n[0].routers),r=[];for(let f=0;f<a.length;f+=1)r[f]=nt(Ze(n,a,f));const _=f=>V(r[f],1,1,()=>{r[f]=null});return{c(){for(let f=0;f<s.length;f+=1)s[f].c();e=M();for(let f=0;f<r.length;f+=1)r[f].c();t=de()},l(f){for(let c=0;c<s.length;c+=1)s[c].l(f);e=U(f);for(let c=0;c<r.length;c+=1)r[c].l(f);t=de()},m(f,c){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(f,c);C(f,e,c);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(f,c);C(f,t,c),l=!0},p(f,c){if(c&1){o=ne(f[0].connections);let i;for(i=0;i<o.length;i+=1){const h=et(f,o,i);s[i]?(s[i].p(h,c),X(s[i],1)):(s[i]=tt(h),s[i].c(),X(s[i],1),s[i].m(e.parentNode,e))}for(Te(),i=o.length;i<s.length;i+=1)u(i);Re()}if(c&1){a=ne(f[0].routers);let i;for(i=0;i<a.length;i+=1){const h=Ze(f,a,i);r[i]?(r[i].p(h,c),X(r[i],1)):(r[i]=nt(h),r[i].c(),X(r[i],1),r[i].m(t.parentNode,t))}for(Te(),i=a.length;i<r.length;i+=1)_(i);Re()}},i(f){if(!l){for(let c=0;c<o.length;c+=1)X(s[c]);for(let c=0;c<a.length;c+=1)X(r[c]);l=!0}},o(f){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)V(s[c]);r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)V(r[c]);l=!1},d(f){f&&(g(e),g(t)),ge(s,f),ge(r,f)}}}function cn(n){let e,t,l,o,s,u,a,r,_;return t=new jt({props:{$$slots:{default:[fn]},$$scope:{ctx:n}}}),s=new on({}),r=new an({}),{c(){e=w("div"),oe(t.$$.fragment),l=M(),o=w("div"),oe(s.$$.fragment),u=M(),a=w("div"),oe(r.$$.fragment),this.h()},l(f){e=B(f,"DIV",{id:!0,class:!0});var c=O(e);se(t.$$.fragment,c),l=U(c),o=B(c,"DIV",{id:!0,class:!0});var i=O(o);se(s.$$.fragment,i),i.forEach(g),u=U(c),a=B(c,"DIV",{id:!0,class:!0});var h=O(a);se(r.$$.fragment,h),h.forEach(g),c.forEach(g),this.h()},h(){p(o,"id","top-left-bar"),p(o,"class","absolute-flex svelte-ixqfsc"),p(a,"id","bottom-left-bar"),p(a,"class","absolute-flex svelte-ixqfsc"),p(e,"id","network"),p(e,"class","svelte-ixqfsc")},m(f,c){C(f,e,c),ie(t,e,null),I(e,l),I(e,o),ie(s,o,null),I(e,u),I(e,a),ie(r,a,null),_=!0},p(f,[c]){const i={};c&129&&(i.$$scope={dirty:c,ctx:f}),t.$set(i)},i(f){_||(X(t.$$.fragment,f),X(s.$$.fragment,f),X(r.$$.fragment,f),_=!0)},o(f){V(t.$$.fragment,f),V(s.$$.fragment,f),V(r.$$.fragment,f),_=!1},d(f){f&&g(e),re(t),re(s),re(r)}}}function dn(n,e,t){let l;return Ce(n,J,o=>t(0,l=o)),[l]}class hn extends fe{constructor(e){super(),ce(this,e,dn,cn,ae,{})}}function _n(n){let e,t;return e=new hn({}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,o){ie(e,l,o),t=!0},p:le,i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){re(e,l)}}}class kn extends fe{constructor(e){super(),ce(this,e,null,_n,ae,{})}}export{kn as component};
