var Tr=Object.defineProperty;var Rr=(r,e,t)=>e in r?Tr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var oe=(r,e,t)=>(Rr(r,typeof e!="symbol"?e+"":e,t),t);import{r as mt,x as lr,s as $e,a as or,u as ur,g as cr,b as dr,y as fr,e as Oe,i as hr,n as Ie,z as Ve,c as je,o as pr,A as qe,B as en}from"../chunks/scheduler.DYvwBUv9.js";import{n as H,m as O,S as Te,i as Re,e as C,c as $,a as M,d as p,l as b,g as w,z as fe,t as pe,b as me,h as T,j as ze,s as P,v as ee,A as de,f as S,w as te,q as rt,x as ne,r as Se,p as De,B as lt,y as re,C as Le,D as We,E as Fe,o as Ce,F as tt,G as nt,H as Ir,I as Cn}from"../chunks/index.CEZ_BoqP.js";import{w as tn}from"../chunks/index.DX-KyX9r.js";function be(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function dn(r,e){H(r,1,1,()=>{e.delete(r.key)})}function fn(r,e,t,n,s,i,a,l,o,c,u,h){let f=r.length,m=i.length,g=f;const k={};for(;g--;)k[r[g].key]=g;const v=[],y=new Map,d=new Map,E=[];for(g=m;g--;){const N=h(s,i,g),L=t(N);let Y=a.get(L);Y?n&&E.push(()=>Y.p(N,e)):(Y=c(L,N),Y.c()),y.set(L,v[g]=Y),L in k&&d.set(L,Math.abs(g-k[L]))}const B=new Set,R=new Set;function Z(N){O(N,1),N.m(l,u),a.set(N.key,N),u=N.first,m--}for(;f&&m;){const N=v[m-1],L=r[f-1],Y=N.key,A=L.key;N===L?(u=N.first,f--,m--):y.has(A)?!a.has(Y)||B.has(Y)?Z(N):R.has(A)?f--:d.get(Y)>d.get(A)?(R.add(Y),Z(N)):(B.add(A),f--):(o(L,a),f--)}for(;f--;){const N=r[f];y.has(N.key)||o(N,a)}for(;m;)Z(v[m-1]);return mt(E),v}function nn(r,e){const t={},n={},s={$$scope:1};let i=r.length;for(;i--;){const a=r[i],l=e[i];if(l){for(const o in a)o in l||(n[o]=1);for(const o in l)s[o]||(t[o]=l[o],s[o]=1);r[i]=l}else for(const o in a)s[o]=1}for(const a in n)a in t||(t[a]=void 0);return t}function rn(r){return typeof r=="object"&&r!==null?r:{}}var he;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),a={};for(const l of i)a[l]=s[l];return r.objectValues(a)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},r.find=(s,i)=>{for(const a of s)if(i(a))return a},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(he||(he={}));var _n;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(_n||(_n={}));const U=he.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ct=r=>{switch(typeof r){case"undefined":return U.undefined;case"string":return U.string;case"number":return isNaN(r)?U.nan:U.number;case"boolean":return U.boolean;case"function":return U.function;case"bigint":return U.bigint;case"symbol":return U.symbol;case"object":return Array.isArray(r)?U.array:r===null?U.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?U.promise:typeof Map<"u"&&r instanceof Map?U.map:typeof Set<"u"&&r instanceof Set?U.set:typeof Date<"u"&&r instanceof Date?U.date:U.object;default:return U.unknown}},j=he.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Lr=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Je extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)n._errors.push(t(a));else{let l=n,o=0;for(;o<a.path.length;){const c=a.path[o];o===a.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(t(a))):l[c]=l[c]||{_errors:[]},l=l[c],o++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,he.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Je.create=r=>new Je(r);const Tt=(r,e)=>{let t;switch(r.code){case j.invalid_type:r.received===U.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case j.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,he.jsonStringifyReplacer)}`;break;case j.unrecognized_keys:t=`Unrecognized key(s) in object: ${he.joinValues(r.keys,", ")}`;break;case j.invalid_union:t="Invalid input";break;case j.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${he.joinValues(r.options)}`;break;case j.invalid_enum_value:t=`Invalid enum value. Expected ${he.joinValues(r.options)}, received '${r.received}'`;break;case j.invalid_arguments:t="Invalid function arguments";break;case j.invalid_return_type:t="Invalid function return type";break;case j.invalid_date:t="Invalid date";break;case j.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:he.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case j.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case j.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case j.custom:t="Invalid input";break;case j.invalid_intersection_types:t="Intersection results could not be merged";break;case j.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case j.not_finite:t="Number must be finite";break;default:t=e.defaultError,he.assertNever(r)}return{message:t}};let mr=Tt;function Nr(r){mr=r}function Ut(){return mr}const qt=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],a={...s,path:i};let l="";const o=n.filter(c=>!!c).slice().reverse();for(const c of o)l=c(a,{data:e,defaultError:l}).message;return{...s,path:i,message:s.message||l}},Pr=[];function q(r,e){const t=qt({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Ut(),Tt].filter(n=>!!n)});r.common.issues.push(t)}class Ze{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return K;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t)n.push({key:await s.key,value:await s.value});return Ze.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return K;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(n[i.value]=a.value)}return{status:e.value,value:n}}}const K=Object.freeze({status:"aborted"}),_r=r=>({status:"dirty",value:r}),Me=r=>({status:"valid",value:r}),gn=r=>r.status==="aborted",vn=r=>r.status==="dirty",Rt=r=>r.status==="valid",Yt=r=>typeof Promise<"u"&&r instanceof Promise;var G;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(G||(G={}));class st{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const $n=(r,e)=>{if(Rt(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Je(r.common.issues);return this._error=t,this._error}}};function se(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,l)=>a.code!=="invalid_type"?{message:l.defaultError}:typeof l.data>"u"?{message:n??l.defaultError}:{message:t??l.defaultError},description:s}}class ae{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ct(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ze,ctx:{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Yt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},i=this._parseSync({data:e,path:s.path,parent:s});return $n(s,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Yt(s)?s:Promise.resolve(s));return $n(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const a=e(s),l=()=>i.addIssue({code:j.custom,...n(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(o=>o?!0:(l(),!1)):a?!0:(l(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new et({schema:this,typeName:J.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return at.create(this,this._def)}nullable(){return bt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ke.create(this,this._def)}promise(){return $t.create(this,this._def)}or(e){return Pt.create([this,e],this._def)}and(e){return St.create(this,e,this._def)}transform(e){return new et({...se(this._def),schema:this,typeName:J.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Zt({...se(this._def),innerType:this,defaultValue:t,typeName:J.ZodDefault})}brand(){return new vr({typeName:J.ZodBranded,type:this,...se(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Jt({...se(this._def),innerType:this,catchValue:t,typeName:J.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return At.create(this,e)}readonly(){return Qt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Sr=/^c[^\s-]{8,}$/i,Dr=/^[a-z][a-z0-9]*$/,Or=/^[0-9A-HJKMNP-TV-Z]{26}$/,Br=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,jr=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Zr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hn;const Ar=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Mr=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,zr=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Hr(r,e){return!!((e==="v4"||!e)&&Ar.test(r)||(e==="v6"||!e)&&Mr.test(r))}class Xe extends ae{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==U.string){const i=this._getOrReturnCtx(e);return q(i,{code:j.invalid_type,expected:U.string,received:i.parsedType}),K}const n=new Ze;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:j.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:j.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,l=e.data.length<i.value;(a||l)&&(s=this._getOrReturnCtx(e,s),a?q(s,{code:j.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&q(s,{code:j.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")jr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"email",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")hn||(hn=new RegExp(Zr,"u")),hn.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"emoji",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Br.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"uuid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Sr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"cuid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Dr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"cuid2",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")Or.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"ulid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),q(s,{validation:"url",code:j.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"regex",code:j.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),q(s,{code:j.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),q(s,{code:j.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),q(s,{code:j.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?zr(i).test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{code:j.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?Hr(e.data,i.version)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"ip",code:j.invalid_string,message:i.message}),n.dirty()):he.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:j.invalid_string,...G.errToObj(n)})}_addCheck(e){return new Xe({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...G.errToObj(e)})}url(e){return this._addCheck({kind:"url",...G.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...G.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...G.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...G.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...G.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...G.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...G.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...G.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...G.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...G.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...G.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...G.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...G.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...G.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...G.errToObj(t)})}nonempty(e){return this.min(1,G.errToObj(e))}trim(){return new Xe({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Xe({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Xe({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Xe.create=r=>{var e;return new Xe({checks:[],typeName:J.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...se(r)})};function Vr(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class dt extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==U.number){const i=this._getOrReturnCtx(e);return q(i,{code:j.invalid_type,expected:U.number,received:i.parsedType}),K}let n;const s=new Ze;for(const i of this._def.checks)i.kind==="int"?he.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),q(n,{code:j.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Vr(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),q(n,{code:j.not_finite,message:i.message}),s.dirty()):he.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,s){return new dt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(s)}]})}_addCheck(e){return new dt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:G.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:G.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:G.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:G.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&he.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}dt.create=r=>new dt({checks:[],typeName:J.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...se(r)});class ft extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==U.bigint){const i=this._getOrReturnCtx(e);return q(i,{code:j.invalid_type,expected:U.bigint,received:i.parsedType}),K}let n;const s=new Ze;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),q(n,{code:j.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):he.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,s){return new ft({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(s)}]})}_addCheck(e){return new ft({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ft.create=r=>{var e;return new ft({checks:[],typeName:J.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...se(r)})};class It extends ae{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==U.boolean){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.boolean,received:n.parsedType}),K}return Me(e.data)}}It.create=r=>new It({typeName:J.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...se(r)});class vt extends ae{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==U.date){const i=this._getOrReturnCtx(e);return q(i,{code:j.invalid_type,expected:U.date,received:i.parsedType}),K}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return q(i,{code:j.invalid_date}),K}const n=new Ze;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:j.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:j.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):he.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new vt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:G.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:G.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}vt.create=r=>new vt({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:J.ZodDate,...se(r)});class Wt extends ae{_parse(e){if(this._getType(e)!==U.symbol){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.symbol,received:n.parsedType}),K}return Me(e.data)}}Wt.create=r=>new Wt({typeName:J.ZodSymbol,...se(r)});class Lt extends ae{_parse(e){if(this._getType(e)!==U.undefined){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.undefined,received:n.parsedType}),K}return Me(e.data)}}Lt.create=r=>new Lt({typeName:J.ZodUndefined,...se(r)});class Nt extends ae{_parse(e){if(this._getType(e)!==U.null){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.null,received:n.parsedType}),K}return Me(e.data)}}Nt.create=r=>new Nt({typeName:J.ZodNull,...se(r)});class Ct extends ae{constructor(){super(...arguments),this._any=!0}_parse(e){return Me(e.data)}}Ct.create=r=>new Ct({typeName:J.ZodAny,...se(r)});class gt extends ae{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Me(e.data)}}gt.create=r=>new gt({typeName:J.ZodUnknown,...se(r)});class ot extends ae{_parse(e){const t=this._getOrReturnCtx(e);return q(t,{code:j.invalid_type,expected:U.never,received:t.parsedType}),K}}ot.create=r=>new ot({typeName:J.ZodNever,...se(r)});class Gt extends ae{_parse(e){if(this._getType(e)!==U.undefined){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.void,received:n.parsedType}),K}return Me(e.data)}}Gt.create=r=>new Gt({typeName:J.ZodVoid,...se(r)});class Ke extends ae{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==U.array)return q(t,{code:j.invalid_type,expected:U.array,received:t.parsedType}),K;if(s.exactLength!==null){const a=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(a||l)&&(q(t,{code:a?j.too_big:j.too_small,minimum:l?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(q(t,{code:j.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(q(t,{code:j.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((a,l)=>s.type._parseAsync(new st(t,a,t.path,l)))).then(a=>Ze.mergeArray(n,a));const i=[...t.data].map((a,l)=>s.type._parseSync(new st(t,a,t.path,l)));return Ze.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new Ke({...this._def,minLength:{value:e,message:G.toString(t)}})}max(e,t){return new Ke({...this._def,maxLength:{value:e,message:G.toString(t)}})}length(e,t){return new Ke({...this._def,exactLength:{value:e,message:G.toString(t)}})}nonempty(e){return this.min(1,e)}}Ke.create=(r,e)=>new Ke({type:r,minLength:null,maxLength:null,exactLength:null,typeName:J.ZodArray,...se(e)});function xt(r){if(r instanceof Ee){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=at.create(xt(n))}return new Ee({...r._def,shape:()=>e})}else return r instanceof Ke?new Ke({...r._def,type:xt(r.element)}):r instanceof at?at.create(xt(r.unwrap())):r instanceof bt?bt.create(xt(r.unwrap())):r instanceof it?it.create(r.items.map(e=>xt(e))):r}class Ee extends ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=he.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==U.object){const c=this._getOrReturnCtx(e);return q(c,{code:j.invalid_type,expected:U.object,received:c.parsedType}),K}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),l=[];if(!(this._def.catchall instanceof ot&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||l.push(c);const o=[];for(const c of a){const u=i[c],h=s.data[c];o.push({key:{status:"valid",value:c},value:u._parse(new st(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof ot){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of l)o.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")l.length>0&&(q(s,{code:j.unrecognized_keys,keys:l}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of l){const h=s.data[u];o.push({key:{status:"valid",value:u},value:c._parse(new st(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of o){const h=await u.key;c.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return c}).then(c=>Ze.mergeObjectSync(n,c)):Ze.mergeObjectSync(n,o)}get shape(){return this._def.shape()}strict(e){return G.errToObj,new Ee({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,a,l;const o=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&a!==void 0?a:n.defaultError;return t.code==="unrecognized_keys"?{message:(l=G.errToObj(e).message)!==null&&l!==void 0?l:o}:{message:o}}}:{}})}strip(){return new Ee({...this._def,unknownKeys:"strip"})}passthrough(){return new Ee({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ee({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ee({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:J.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ee({...this._def,catchall:e})}pick(e){const t={};return he.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new Ee({...this._def,shape:()=>t})}omit(e){const t={};return he.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new Ee({...this._def,shape:()=>t})}deepPartial(){return xt(this)}partial(e){const t={};return he.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new Ee({...this._def,shape:()=>t})}required(e){const t={};return he.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof at;)i=i._def.innerType;t[n]=i}}),new Ee({...this._def,shape:()=>t})}keyof(){return gr(he.objectKeys(this.shape))}}Ee.create=(r,e)=>new Ee({shape:()=>r,unknownKeys:"strip",catchall:ot.create(),typeName:J.ZodObject,...se(e)});Ee.strictCreate=(r,e)=>new Ee({shape:()=>r,unknownKeys:"strict",catchall:ot.create(),typeName:J.ZodObject,...se(e)});Ee.lazycreate=(r,e)=>new Ee({shape:r,unknownKeys:"strip",catchall:ot.create(),typeName:J.ZodObject,...se(e)});class Pt extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const a=i.map(l=>new Je(l.ctx.common.issues));return q(t,{code:j.invalid_union,unionErrors:a}),K}if(t.common.async)return Promise.all(n.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const o of n){const c={...t,common:{...t.common,issues:[]},parent:null},u=o._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const l=a.map(o=>new Je(o));return q(t,{code:j.invalid_union,unionErrors:l}),K}}get options(){return this._def.options}}Pt.create=(r,e)=>new Pt({options:r,typeName:J.ZodUnion,...se(e)});const Ft=r=>r instanceof Ot?Ft(r.schema):r instanceof et?Ft(r.innerType()):r instanceof Bt?[r.value]:r instanceof ht?r.options:r instanceof jt?Object.keys(r.enum):r instanceof Zt?Ft(r._def.innerType):r instanceof Lt?[void 0]:r instanceof Nt?[null]:null;class sn extends ae{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.object)return q(t,{code:j.invalid_type,expected:U.object,received:t.parsedType}),K;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(q(t,{code:j.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),K)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const a=Ft(i.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const l of a){if(s.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);s.set(l,i)}}return new sn({typeName:J.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...se(n)})}}function yn(r,e){const t=ct(r),n=ct(e);if(r===e)return{valid:!0,data:r};if(t===U.object&&n===U.object){const s=he.objectKeys(e),i=he.objectKeys(r).filter(l=>s.indexOf(l)!==-1),a={...r,...e};for(const l of i){const o=yn(r[l],e[l]);if(!o.valid)return{valid:!1};a[l]=o.data}return{valid:!0,data:a}}else if(t===U.array&&n===U.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const a=r[i],l=e[i],o=yn(a,l);if(!o.valid)return{valid:!1};s.push(o.data)}return{valid:!0,data:s}}else return t===U.date&&n===U.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class St extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,a)=>{if(gn(i)||gn(a))return K;const l=yn(i.value,a.value);return l.valid?((vn(i)||vn(a))&&t.dirty(),{status:t.value,value:l.data}):(q(n,{code:j.invalid_intersection_types}),K)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}St.create=(r,e,t)=>new St({left:r,right:e,typeName:J.ZodIntersection,...se(t)});class it extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.array)return q(n,{code:j.invalid_type,expected:U.array,received:n.parsedType}),K;if(n.data.length<this._def.items.length)return q(n,{code:j.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),K;!this._def.rest&&n.data.length>this._def.items.length&&(q(n,{code:j.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((a,l)=>{const o=this._def.items[l]||this._def.rest;return o?o._parse(new st(n,a,n.path,l)):null}).filter(a=>!!a);return n.common.async?Promise.all(i).then(a=>Ze.mergeArray(t,a)):Ze.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new it({...this._def,rest:e})}}it.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new it({items:r,typeName:J.ZodTuple,rest:null,...se(e)})};class Dt extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.object)return q(n,{code:j.invalid_type,expected:U.object,received:n.parsedType}),K;const s=[],i=this._def.keyType,a=this._def.valueType;for(const l in n.data)s.push({key:i._parse(new st(n,l,n.path,l)),value:a._parse(new st(n,n.data[l],n.path,l))});return n.common.async?Ze.mergeObjectAsync(t,s):Ze.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof ae?new Dt({keyType:e,valueType:t,typeName:J.ZodRecord,...se(n)}):new Dt({keyType:Xe.create(),valueType:e,typeName:J.ZodRecord,...se(t)})}}class Xt extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.map)return q(n,{code:j.invalid_type,expected:U.map,received:n.parsedType}),K;const s=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([l,o],c)=>({key:s._parse(new st(n,l,n.path,[c,"key"])),value:i._parse(new st(n,o,n.path,[c,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const o of a){const c=await o.key,u=await o.value;if(c.status==="aborted"||u.status==="aborted")return K;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),l.set(c.value,u.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const o of a){const c=o.key,u=o.value;if(c.status==="aborted"||u.status==="aborted")return K;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),l.set(c.value,u.value)}return{status:t.value,value:l}}}}Xt.create=(r,e,t)=>new Xt({valueType:e,keyType:r,typeName:J.ZodMap,...se(t)});class yt extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.set)return q(n,{code:j.invalid_type,expected:U.set,received:n.parsedType}),K;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(q(n,{code:j.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(q(n,{code:j.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function a(o){const c=new Set;for(const u of o){if(u.status==="aborted")return K;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}const l=[...n.data.values()].map((o,c)=>i._parse(new st(n,o,n.path,c)));return n.common.async?Promise.all(l).then(o=>a(o)):a(l)}min(e,t){return new yt({...this._def,minSize:{value:e,message:G.toString(t)}})}max(e,t){return new yt({...this._def,maxSize:{value:e,message:G.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}yt.create=(r,e)=>new yt({valueType:r,minSize:null,maxSize:null,typeName:J.ZodSet,...se(e)});class Et extends ae{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.function)return q(t,{code:j.invalid_type,expected:U.function,received:t.parsedType}),K;function n(l,o){return qt({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ut(),Tt].filter(c=>!!c),issueData:{code:j.invalid_arguments,argumentsError:o}})}function s(l,o){return qt({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ut(),Tt].filter(c=>!!c),issueData:{code:j.invalid_return_type,returnTypeError:o}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof $t){const l=this;return Me(async function(...o){const c=new Je([]),u=await l._def.args.parseAsync(o,i).catch(m=>{throw c.addIssue(n(o,m)),c}),h=await Reflect.apply(a,this,u);return await l._def.returns._def.type.parseAsync(h,i).catch(m=>{throw c.addIssue(s(h,m)),c})})}else{const l=this;return Me(function(...o){const c=l._def.args.safeParse(o,i);if(!c.success)throw new Je([n(o,c.error)]);const u=Reflect.apply(a,this,c.data),h=l._def.returns.safeParse(u,i);if(!h.success)throw new Je([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Et({...this._def,args:it.create(e).rest(gt.create())})}returns(e){return new Et({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Et({args:e||it.create([]).rest(gt.create()),returns:t||gt.create(),typeName:J.ZodFunction,...se(n)})}}class Ot extends ae{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ot.create=(r,e)=>new Ot({getter:r,typeName:J.ZodLazy,...se(e)});class Bt extends ae{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return q(t,{received:t.data,code:j.invalid_literal,expected:this._def.value}),K}return{status:"valid",value:e.data}}get value(){return this._def.value}}Bt.create=(r,e)=>new Bt({value:r,typeName:J.ZodLiteral,...se(e)});function gr(r,e){return new ht({values:r,typeName:J.ZodEnum,...se(e)})}class ht extends ae{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return q(t,{expected:he.joinValues(n),received:t.parsedType,code:j.invalid_type}),K}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return q(t,{received:t.data,code:j.invalid_enum_value,options:n}),K}return Me(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ht.create(e)}exclude(e){return ht.create(this.options.filter(t=>!e.includes(t)))}}ht.create=gr;class jt extends ae{_parse(e){const t=he.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==U.string&&n.parsedType!==U.number){const s=he.objectValues(t);return q(n,{expected:he.joinValues(s),received:n.parsedType,code:j.invalid_type}),K}if(t.indexOf(e.data)===-1){const s=he.objectValues(t);return q(n,{received:n.data,code:j.invalid_enum_value,options:s}),K}return Me(e.data)}get enum(){return this._def.values}}jt.create=(r,e)=>new jt({values:r,typeName:J.ZodNativeEnum,...se(e)});class $t extends ae{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.promise&&t.common.async===!1)return q(t,{code:j.invalid_type,expected:U.promise,received:t.parsedType}),K;const n=t.parsedType===U.promise?t.data:Promise.resolve(t.data);return Me(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}$t.create=(r,e)=>new $t({type:r,typeName:J.ZodPromise,...se(e)});class et extends ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===J.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{q(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(a).then(l=>this._def.schema._parseAsync({data:l,path:n.path,parent:n})):this._def.schema._parseSync({data:a,path:n.path,parent:n})}if(s.type==="refinement"){const a=l=>{const o=s.refinement(l,i);if(n.common.async)return Promise.resolve(o);if(o instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?K:(l.status==="dirty"&&t.dirty(),a(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?K:(l.status==="dirty"&&t.dirty(),a(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Rt(a))return a;const l=s.transform(a.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Rt(a)?Promise.resolve(s.transform(a.value,i)).then(l=>({status:t.value,value:l})):a);he.assertNever(s)}}et.create=(r,e,t)=>new et({schema:r,typeName:J.ZodEffects,effect:e,...se(t)});et.createWithPreprocess=(r,e,t)=>new et({schema:e,effect:{type:"preprocess",transform:r},typeName:J.ZodEffects,...se(t)});class at extends ae{_parse(e){return this._getType(e)===U.undefined?Me(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}at.create=(r,e)=>new at({innerType:r,typeName:J.ZodOptional,...se(e)});class bt extends ae{_parse(e){return this._getType(e)===U.null?Me(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}bt.create=(r,e)=>new bt({innerType:r,typeName:J.ZodNullable,...se(e)});class Zt extends ae{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===U.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Zt.create=(r,e)=>new Zt({innerType:r,typeName:J.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...se(e)});class Jt extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Yt(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Jt.create=(r,e)=>new Jt({innerType:r,typeName:J.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...se(e)});class Kt extends ae{_parse(e){if(this._getType(e)!==U.nan){const n=this._getOrReturnCtx(e);return q(n,{code:j.invalid_type,expected:U.nan,received:n.parsedType}),K}return{status:"valid",value:e.data}}}Kt.create=r=>new Kt({typeName:J.ZodNaN,...se(r)});const Fr=Symbol("zod_brand");class vr extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class At extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?K:i.status==="dirty"?(t.dirty(),_r(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?K:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new At({in:e,out:t,typeName:J.ZodPipeline})}}class Qt extends ae{_parse(e){const t=this._def.innerType._parse(e);return Rt(t)&&(t.value=Object.freeze(t.value)),t}}Qt.create=(r,e)=>new Qt({innerType:r,typeName:J.ZodReadonly,...se(e)});const yr=(r,e={},t)=>r?Ct.create().superRefine((n,s)=>{var i,a;if(!r(n)){const l=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,o=(a=(i=l.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,c=typeof l=="string"?{message:l}:l;s.addIssue({code:"custom",...c,fatal:o})}}):Ct.create(),Ur={object:Ee.lazycreate};var J;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(J||(J={}));const qr=(r,e={message:`Input not instance of ${r.name}`})=>yr(t=>t instanceof r,e),br=Xe.create,kr=dt.create,Yr=Kt.create,Wr=ft.create,wr=It.create,Gr=vt.create,Xr=Wt.create,Jr=Lt.create,Kr=Nt.create,Qr=Ct.create,es=gt.create,ts=ot.create,ns=Gt.create,rs=Ke.create,ss=Ee.create,is=Ee.strictCreate,as=Pt.create,ls=sn.create,os=St.create,us=it.create,cs=Dt.create,ds=Xt.create,fs=yt.create,hs=Et.create,ps=Ot.create,ms=Bt.create,_s=ht.create,gs=jt.create,vs=$t.create,Tn=et.create,ys=at.create,bs=bt.create,ks=et.createWithPreprocess,ws=At.create,xs=()=>br().optional(),Es=()=>kr().optional(),Cs=()=>wr().optional(),$s={string:r=>Xe.create({...r,coerce:!0}),number:r=>dt.create({...r,coerce:!0}),boolean:r=>It.create({...r,coerce:!0}),bigint:r=>ft.create({...r,coerce:!0}),date:r=>vt.create({...r,coerce:!0})},Ts=K;var ue=Object.freeze({__proto__:null,defaultErrorMap:Tt,setErrorMap:Nr,getErrorMap:Ut,makeIssue:qt,EMPTY_PATH:Pr,addIssueToContext:q,ParseStatus:Ze,INVALID:K,DIRTY:_r,OK:Me,isAborted:gn,isDirty:vn,isValid:Rt,isAsync:Yt,get util(){return he},get objectUtil(){return _n},ZodParsedType:U,getParsedType:ct,ZodType:ae,ZodString:Xe,ZodNumber:dt,ZodBigInt:ft,ZodBoolean:It,ZodDate:vt,ZodSymbol:Wt,ZodUndefined:Lt,ZodNull:Nt,ZodAny:Ct,ZodUnknown:gt,ZodNever:ot,ZodVoid:Gt,ZodArray:Ke,ZodObject:Ee,ZodUnion:Pt,ZodDiscriminatedUnion:sn,ZodIntersection:St,ZodTuple:it,ZodRecord:Dt,ZodMap:Xt,ZodSet:yt,ZodFunction:Et,ZodLazy:Ot,ZodLiteral:Bt,ZodEnum:ht,ZodNativeEnum:jt,ZodPromise:$t,ZodEffects:et,ZodTransformer:et,ZodOptional:at,ZodNullable:bt,ZodDefault:Zt,ZodCatch:Jt,ZodNaN:Kt,BRAND:Fr,ZodBranded:vr,ZodPipeline:At,ZodReadonly:Qt,custom:yr,Schema:ae,ZodSchema:ae,late:Ur,get ZodFirstPartyTypeKind(){return J},coerce:$s,any:Qr,array:rs,bigint:Wr,boolean:wr,date:Gr,discriminatedUnion:ls,effect:Tn,enum:_s,function:hs,instanceof:qr,intersection:os,lazy:ps,literal:ms,map:ds,nan:Yr,nativeEnum:gs,never:ts,null:Kr,nullable:bs,number:kr,object:ss,oboolean:Cs,onumber:Es,optional:ys,ostring:xs,pipeline:ws,preprocess:ks,promise:vs,record:cs,set:fs,strictObject:is,string:br,symbol:Xr,transformer:Tn,tuple:us,undefined:Jr,union:as,unknown:es,void:ns,NEVER:Ts,ZodIssueCode:j,quotelessJson:Lr,ZodError:Je});const Rs=[{id:1,node:{label:"CE 1",x:-350,y:-25},address:"CE-IP-1",firstHop:{"CE-IP-5":2,"CE-IP-6":2},type:"CE"},{id:2,node:{label:"LER 2",x:-200,y:-25},FIB:{"CE-IP-5":{label:306030,nextHop:"3"},"CE-IP-6":{label:61379,nextHop:"3"}},LFIB:{},type:"LER"},{id:3,node:{label:"LSR 3",x:-100,y:-25},LFIB:{61379:{outgoingLabel:974214,nextHop:"4"},306030:{outgoingLabel:349733,nextHop:"4"}},type:"LSR"},{id:4,node:{label:"LER 4",x:0,y:-25},FIB:{},LFIB:{349733:{outgoingLabel:-1,nextHop:"CE-IP-5"},974214:{outgoingLabel:-1,nextHop:"CE-IP-6"}},type:"LER"},{id:5,node:{label:"CE 5",x:125,y:-100},address:"CE-IP-5",firstHop:{},type:"CE"},{id:6,node:{label:"CE 6",x:125,y:50},address:"CE-IP-6",firstHop:{},type:"CE"}],Is=[{bandwidth:0,id:"1-2",source:1,target:2},{bandwidth:0,id:"2-3",source:2,target:3},{bandwidth:0,id:"3-4",source:3,target:4},{bandwidth:0,id:"4-5",source:4,target:5},{bandwidth:0,id:"4-6",source:4,target:6}],Ls={routers:Rs,links:Is},Ns=ue.object({label:ue.string(),x:ue.number(),y:ue.number()}),xr=ue.record(ue.coerce.number(),ue.object({outgoingLabel:ue.number(),nextHop:ue.string()})),Ps=ue.record(ue.string(),ue.object({label:ue.number(),nextHop:ue.string()})),Ss=ue.record(ue.number()),Ds=ue.object({address:ue.string(),firstHop:Ss.or(ue.object({})),type:ue.literal("CE")}),Os=ue.object({LFIB:xr.or(ue.object({})),FIB:Ps.or(ue.object({})),type:ue.literal("LER")}),Bs=ue.object({LFIB:xr.or(ue.object({})),type:ue.literal("LSR")}),js=ue.object({id:ue.number(),node:Ns}).and(ue.union([Ds,Os,Bs])),Zs=ue.object({id:ue.string(),source:ue.number(),target:ue.number(),bandwidth:ue.number()}),As=ue.object({routers:ue.array(js),links:ue.array(Zs)}),Vt=As.safeParse(Ls),Ge=tn({running:!0,enableFallback:!1,speedMultiplier:1,maxPackets:100});let Ms=class{constructor(e,t,n){oe(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},bn=class{constructor(e,t){this.id=e,this.node=t}};class Ae extends bn{constructor(){super(...arguments);oe(this,"address",`CE-IP-${this.id}`);oe(this,"firstHop",new Map);oe(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});oe(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});oe(this,"updateAddress",(t,n)=>{const s=this.firstHop.get(t);if(s===void 0){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,s),this.firstHop.delete(t)});oe(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop("CE received packet. Dropping.")}clearTables(){this.firstHop.clear()}get type(){return"CE"}}let zs=class{constructor(e=void 0){oe(this,"map");oe(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});oe(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});oe(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(n===void 0){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});oe(this,"deleteEntry",e=>{this.map.delete(e)});this.map=e||new Map}get(e){return this.map.get(e)}},Er=class{constructor(){oe(this,"map",new Map);oe(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});oe(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});oe(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LFIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});oe(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class Ye extends bn{constructor(){super(...arguments);oe(this,"FIB",new zs);oe(this,"LFIB",new Er)}receivePacket(t){var n,s,i,a;if(t.fallbackRoute)return t.fallback(this);if(t.label===-1){const l=t.destination,o=(n=this.FIB.get(l.address))==null?void 0:n.nextHop;if(!o)return t.fallback(this);const c=(s=this.FIB.get(l.address))==null?void 0:s.label;if(!c)return t.fallback(this);t.label=c;const u=W.getRouter(parseInt(o));if(!u)return t.fallback(this);t.nextHop=u}else{const l=(i=this.LFIB.get(t.label))==null?void 0:i.nextHop;if(!l)return t.fallback(this);const o=(a=this.LFIB.get(t.label))==null?void 0:a.outgoingLabel;if(!o)return t.fallback(this);t.label=o;const c=W.getCERouter(l);if(!c)return t.fallback(this);t.nextHop=c}t.decrementTTL()}clearTables(){this.FIB.map.clear(),this.LFIB.map.clear()}get type(){return"LER"}}function kn(r,e){const t=W.routers,n=t.length,s=new Array(n).fill(1/0),i=new Array(n).fill(!1),a=new Array(n).fill(null);s[t.indexOf(r)]=0;let l=!1,o=!1;for(;!l;){let h=null,f=1/0;for(const[m,g]of t.entries())if(!i[m]&&s[m]<f){if(g instanceof Ye){if(!o)o=!0;else if(!W.links.some(v=>v.source===g&&v.target===e||v.target===g&&v.source===e))continue}h=g,f=s[m]}if(!h||h.id===e.id){l=!0;continue}i[t.indexOf(h)]=!0;for(const m of W.links){let g;if(m.source===h)g=m.target;else if(m.target===h)g=m.source;else continue;const k=t.indexOf(g),v=f+m.distance;v<s[k]&&(s[k]=v,a[k]=h)}}const c=[];let u=e;for(;u;){c.unshift(u);const h=t.indexOf(u);u=a[h]}return c}let Hs=class{constructor(e,t,n,s){oe(this,"ttl",32);oe(this,"label",-1);oe(this,"fallbackRoute");oe(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=s;const i=t.firstHop.get(n.address);if(!i){this.drop("No next hop router id found.");return}const a=W.getRouter(i);if(!a){this.drop("No next hop router found.");return}this.nextHop=a}decrementTTL(){--this.ttl<=0&&this.drop()}fallback(e){if(!lr(Ge).enableFallback)return this.drop("Fallback is disabled.");if(this.label=-1,this.decrementTTL(),this.fallbackRoute)return this.setFallbackNextHop();if(this.fallbackRoute=kn(e,this.destination),!(this.fallbackRoute[this.fallbackRoute.length-1]instanceof Ae))return this.drop("The destination is not a CE.");this.fallbackRoute.shift(),this.setFallbackNextHop()}validateNextHop(e){return W.doesLinkExist({source:e,target:this.nextHop})||W.doesLinkExist({source:this.nextHop,target:e})}setFallbackNextHop(){var t;const e=(t=this.fallbackRoute)==null?void 0:t.shift();this.fallbackRoute&&e?this.nextHop=e:this.drop("Unable to set fallback IP routing next hop")}drop(e="Unknown"){console.warn("Packet dropped: ",e),W.deletePacket(this.id)}};class kt extends bn{constructor(){super(...arguments);oe(this,"LFIB",new Er)}receivePacket(t){var a,l;if(t.fallbackRoute)return t.fallback(this);const n=(a=this.LFIB.get(t.label))==null?void 0:a.nextHop;if(!n)return t.fallback(this);const s=(l=this.LFIB.get(t.label))==null?void 0:l.outgoingLabel;if(!s)return t.fallback(this);t.label=s;const i=W.getRouter(parseInt(n));if(!i)return t.fallback(this);t.nextHop=i,t.decrementTTL()}clearTables(){this.LFIB.map.clear()}get type(){return"LSR"}}const Vs={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class Fs{constructor(){oe(this,"store",tn({routers:[],links:[],packets:[]}));oe(this,"set",this.store.set);oe(this,"update",this.store.update);oe(this,"subscribe",this.store.subscribe);oe(this,"_routers",[]);oe(this,"_links",[]);oe(this,"_packets",[]);oe(this,"routerMap",new Map);oe(this,"CEMap",new Map);oe(this,"routerCounter",1);oe(this,"packetCounter",1);oe(this,"maxPackets",lr(Ge).maxPackets);oe(this,"setRouterCount",e=>this.routerCounter=e);Ge.subscribe(e=>{this.maxPackets=e.maxPackets,this._packets=this._packets.slice(-this.maxPackets),this.notify()})}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!Vs[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new Ms(`${e.source.id}-${e.target.id}`,e.source,e.target);e.bandwidth!==void 0&&(t.bandwidth=e.bandwidth),this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,s=new Ae(n,{label:`CE ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}createLER(e,t){const n=this.routerCounter++,s=new Ye(n,{label:`LER ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}createLSR(e,t){const n=this.routerCounter++,s=new kt(n,{label:`LSR ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof Ae&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof Ae&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){if(this._packets.length>=this.maxPackets)return;const n=new Hs(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearTables(){for(const e of this._routers)e.clearTables();this.notify()}clearLinks(){this._links=[],this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=1,this.packetCounter=1,this.notify()}notify(){this.store.set(this.networkState)}}const Us=new Fs,W=Us;function qs(){if(!Vt.success)throw Vt.error;let r=0;for(const e of Vt.data.routers)switch(r=Math.max(r,e.id),e.type){case"LER":{const t=new Ye(e.id,e.node);Object.entries(e.LFIB).forEach(([n,s])=>{t.LFIB.receiveEntry(parseInt(n),s.outgoingLabel,s.nextHop)}),Object.entries(e.FIB).forEach(([n,s])=>{t.FIB.receiveEntry(n,s.label,s.nextHop)}),W.addRouter(t);break}case"LSR":{const t=new kt(e.id,e.node);Object.entries(e.LFIB).forEach(([n,s])=>{t.LFIB.receiveEntry(parseInt(n),s.outgoingLabel,s.nextHop)}),W.addRouter(t);break}case"CE":{const t=new Ae(e.id,e.node);Object.entries(e.firstHop).forEach(([n,s])=>{t.receiveEntry(n,s)}),W.addRouter(t);break}}W.setRouterCount(r+1);for(const e of Vt.data.links){const t=W.getRouter(e.source),n=W.getRouter(e.target);t&&n&&W.addLink({source:t,target:n,bandwidth:e.bandwidth})}}const Ys={placing:null},Ue=tn(Ys),pt=tn(!1);function Ws(r){let e,t,n,s;const i=r[2].default,a=or(i,r,r[1],null);return{c(){e=C("dialog"),a&&a.c(),this.h()},l(l){e=$(l,"DIALOG",{class:!0});var o=M(e);a&&a.l(o),o.forEach(p),this.h()},h(){b(e,"class","svelte-p5wejv")},m(l,o){w(l,e,o),a&&a.m(e,null),r[4](e),t=!0,n||(s=fe(e,"close",r[3]),n=!0)},p(l,[o]){a&&a.p&&(!t||o&2)&&ur(a,i,l,l[1],t?dr(i,l[1],o,null):cr(l[1]),null)},i(l){t||(O(a,l),t=!0)},o(l){H(a,l),t=!1},d(l){l&&p(e),a&&a.d(l),r[4](null),n=!1,s()}}}function Gs(r,e,t){let{$$slots:n={},$$scope:s}=e,{dialog:i}=e;function a(o){fr.call(this,r,o)}function l(o){Oe[o?"unshift":"push"](()=>{i=o,t(0,i)})}return r.$$set=o=>{"dialog"in o&&t(0,i=o.dialog),"$$scope"in o&&t(1,s=o.$$scope)},[i,s,n,a,l]}class an extends Te{constructor(e){super(),Re(this,e,Gs,Ws,$e,{dialog:0})}}const Rn=16,Xs=2**20-1;function Cr(r,e){const t=r[0];if(!(t instanceof Ae)){alert("The path does not start with a CE");return}const n=r[1];if(!(n instanceof Ye)){alert("The source CE is not directly connected to an LER");return}if(t.firstHop.set(e,n.id),n.FIB.get(e))return;const s=r.length-2,i=r[s];if(!(i instanceof Ye)){alert("Destination CE is not connected directly to a LER");return}let a=In(r[s]);i.LFIB.receiveEntry(a,-1,e);for(let l=r.length-2;l>0;l--){const o=r[l],c=r[l-1],u=a;a=In(o),c instanceof Ye?c.FIB.receiveEntry(e,u,o.id.toString()):c instanceof kt&&c.LFIB.receiveEntry(a,u,o.id.toString())}}function Js(r,e){return r instanceof kt||r instanceof Ye?r.LFIB.map.has(e):!1}function In(r){let e;do e=Math.floor(Math.random()*(Xs-Rn+1)+Rn);while(Js(r,e));return e}function Ks(r){let e,t,n,s;return{c(){e=C("button"),t=pe(r[0]),this.h()},l(i){e=$(i,"BUTTON",{class:!0});var a=M(e);t=me(a,r[0]),a.forEach(p),this.h()},h(){b(e,"class","svelte-17itt71")},m(i,a){w(i,e,a),T(e,t),n||(s=fe(e,"click",function(){hr(r[1])&&r[1].apply(this,arguments)}),n=!0)},p(i,[a]){r=i,a&1&&ze(t,r[0])},i:Ie,o:Ie,d(i){i&&p(e),n=!1,s()}}}function Qs(r,e,t){let{text:n}=e,{callback:s}=e;return r.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,s=i.callback)},[n,s]}class ut extends Te{constructor(e){super(),Re(this,e,Qs,Ks,$e,{text:0,callback:1})}}function Ln(r,e,t){const n=r.slice();return n[9]=e[t][0],n[10]=e[t][1],n}function Nn(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k,v,y,d;function E(...N){return r[5](r[9],...N)}function B(...N){return r[6](r[9],...N)}function R(){return r[7](r[9])}h=new ut({props:{text:"LDP",callback:R}});function Z(){return r[8](r[9])}return g=new ut({props:{text:"-",callback:Z}}),{c(){e=C("tr"),t=C("td"),n=C("input"),i=P(),a=C("td"),l=C("input"),c=P(),u=C("td"),ee(h.$$.fragment),f=P(),m=C("td"),ee(g.$$.fragment),k=P(),this.h()},l(N){e=$(N,"TR",{});var L=M(e);t=$(L,"TD",{});var Y=M(t);n=$(Y,"INPUT",{type:!0,placeholder:!0}),Y.forEach(p),i=S(L),a=$(L,"TD",{});var A=M(a);l=$(A,"INPUT",{type:!0,placeholder:!0}),A.forEach(p),c=S(L),u=$(L,"TD",{title:!0});var x=M(u);te(h.$$.fragment,x),x.forEach(p),f=S(L),m=$(L,"TD",{});var V=M(m);te(g.$$.fragment,V),V.forEach(p),k=S(L),L.forEach(p),this.h()},h(){b(n,"type","text"),n.value=s=r[9],b(n,"placeholder","Address"),b(l,"type","text"),l.value=o=r[10],b(l,"placeholder","Link"),b(u,"title","Generates shortest path")},m(N,L){w(N,e,L),T(e,t),T(t,n),T(e,i),T(e,a),T(a,l),T(e,c),T(e,u),ne(h,u,null),T(e,f),T(e,m),ne(g,m,null),T(e,k),v=!0,y||(d=[fe(n,"change",E),fe(l,"change",B)],y=!0)},p(N,L){r=N,(!v||L&1&&s!==(s=r[9])&&n.value!==s)&&(n.value=s),(!v||L&1&&o!==(o=r[10])&&l.value!==o)&&(l.value=o);const Y={};L&1&&(Y.callback=R),h.$set(Y);const A={};L&1&&(A.callback=Z),g.$set(A)},i(N){v||(O(h.$$.fragment,N),O(g.$$.fragment,N),v=!0)},o(N){H(h.$$.fragment,N),H(g.$$.fragment,N),v=!1},d(N){N&&p(e),re(h),re(g),y=!1,mt(d)}}}function ei(r){let e,t,n,s="(?)",i,a,l,o,c,u="Destination",h,f,m="First hop",g,k,v,y="(?)",d,E,B,R,Z,N,L,Y,A=be([...r[0].firstHop]),x=[];for(let I=0;I<A.length;I+=1)x[I]=Nn(Ln(r,A,I));const V=I=>H(x[I],1,1,()=>{x[I]=null});return L=new ut({props:{text:"+",callback:r[1](r[0].addEmptyEntry)}}),{c(){e=C("p"),t=pe("Destinations: "),n=C("span"),n.textContent=s,i=P(),a=C("table"),l=C("thead"),o=C("tr"),c=C("th"),c.textContent=u,h=P(),f=C("th"),f.textContent=m,g=P(),k=C("th"),v=C("span"),v.textContent=y,d=P(),E=C("th"),B=P(),R=C("tbody");for(let I=0;I<x.length;I+=1)x[I].c();Z=P(),N=C("div"),ee(L.$$.fragment),this.h()},l(I){e=$(I,"P",{title:!0});var F=M(e);t=me(F,"Destinations: "),n=$(F,"SPAN",{"data-svelte-h":!0}),de(n)!=="svelte-1w7wt1o"&&(n.textContent=s),F.forEach(p),i=S(I),a=$(I,"TABLE",{});var ce=M(a);l=$(ce,"THEAD",{});var X=M(l);o=$(X,"TR",{});var Q=M(o);c=$(Q,"TH",{class:!0,"data-svelte-h":!0}),de(c)!=="svelte-1o2x94e"&&(c.textContent=u),h=S(Q),f=$(Q,"TH",{class:!0,"data-svelte-h":!0}),de(f)!=="svelte-131gjt9"&&(f.textContent=m),g=S(Q),k=$(Q,"TH",{class:!0});var ke=M(k);v=$(ke,"SPAN",{title:!0,"data-svelte-h":!0}),de(v)!=="svelte-1vkgmco"&&(v.textContent=y),ke.forEach(p),d=S(Q),E=$(Q,"TH",{class:!0}),M(E).forEach(p),Q.forEach(p),X.forEach(p),B=S(ce),R=$(ce,"TBODY",{});var _e=M(R);for(let Be=0;Be<x.length;Be+=1)x[Be].l(_e);_e.forEach(p),ce.forEach(p),Z=S(I),N=$(I,"DIV",{class:!0});var ge=M(N);te(L.$$.fragment,ge),ge.forEach(p),this.h()},h(){rt(n,"color","grey"),b(e,"title","Maps IP addresses to IDs of the first LERs in the LSPs found by Dijkstra's"),b(c,"class","svelte-1d4gizi"),b(f,"class","svelte-1d4gizi"),b(v,"title","Generates shortest path"),rt(v,"color","grey"),b(k,"class","svelte-1d4gizi"),b(E,"class","svelte-1d4gizi"),b(N,"class","svelte-1d4gizi")},m(I,F){w(I,e,F),T(e,t),T(e,n),w(I,i,F),w(I,a,F),T(a,l),T(l,o),T(o,c),T(o,h),T(o,f),T(o,g),T(o,k),T(k,v),T(o,d),T(o,E),T(a,B),T(a,R);for(let ce=0;ce<x.length;ce+=1)x[ce]&&x[ce].m(R,null);w(I,Z,F),w(I,N,F),ne(L,N,null),Y=!0},p(I,[F]){if(F&29){A=be([...I[0].firstHop]);let X;for(X=0;X<A.length;X+=1){const Q=Ln(I,A,X);x[X]?(x[X].p(Q,F),O(x[X],1)):(x[X]=Nn(Q),x[X].c(),O(x[X],1),x[X].m(R,null))}for(Se(),X=A.length;X<x.length;X+=1)V(X);De()}const ce={};F&1&&(ce.callback=I[1](I[0].addEmptyEntry)),L.$set(ce)},i(I){if(!Y){for(let F=0;F<A.length;F+=1)O(x[F]);O(L.$$.fragment,I),Y=!0}},o(I){x=x.filter(Boolean);for(let F=0;F<x.length;F+=1)H(x[F]);H(L.$$.fragment,I),Y=!1},d(I){I&&(p(e),p(i),p(a),p(Z),p(N)),lt(x,I),re(L)}}}function ti(r,e,t){let{router:n}=e;function s(f){return()=>{f(),t(0,n)}}function i(f,m){if(!(f.target instanceof HTMLInputElement))return;const g=f.target.value.toUpperCase(),k=W.getCERouter(g);if(n.address===g){alert("Destination router cannot be the same as the source router.");return}if(!k){alert("Destination router not found.");return}n.updateAddress(m,g),t(0,n)}function a(f){const m=W.getCERouter(f);if(!m){alert("Destination router not found.");return}const g=kn(n,m);if(g.length<=1){alert("No path found");return}Cr(g,f),t(0,n)}function l(f,m){if(!(f.target instanceof HTMLInputElement))return;const g=parseInt(f.target.value);n.firstHop.set(m,g)}const o=(f,m)=>{i(m,f)},c=(f,m)=>{l(m,f)},u=f=>{a(f)},h=f=>{n.firstHop.delete(f),t(0,n)};return r.$$set=f=>{"router"in f&&t(0,n=f.router)},[n,s,i,a,l,o,c,u,h]}class ni extends Te{constructor(e){super(),Re(this,e,ti,ei,$e,{router:0})}}function Pn(r,e,t){const n=r.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Sn(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k,v;function y(...R){return r[3](r[7],...R)}function d(){r[4].call(l,r[9],r[10])}function E(){r[5].call(u,r[9],r[10])}function B(){return r[6](r[7])}return f=new ut({props:{text:"-",callback:B}}),{c(){e=C("tr"),t=C("td"),n=C("input"),i=P(),a=C("td"),l=C("input"),o=P(),c=C("td"),u=C("input"),h=P(),ee(f.$$.fragment),m=P(),this.h()},l(R){e=$(R,"TR",{});var Z=M(e);t=$(Z,"TD",{});var N=M(t);n=$(N,"INPUT",{type:!0}),N.forEach(p),i=S(Z),a=$(Z,"TD",{});var L=M(a);l=$(L,"INPUT",{type:!0}),L.forEach(p),o=S(Z),c=$(Z,"TD",{});var Y=M(c);u=$(Y,"INPUT",{type:!0}),Y.forEach(p),h=S(Z),te(f.$$.fragment,Z),m=S(Z),Z.forEach(p),this.h()},h(){b(n,"type","number"),n.value=s=r[7],b(l,"type","number"),b(u,"type","text")},m(R,Z){w(R,e,Z),T(e,t),T(t,n),T(e,i),T(e,a),T(a,l),Le(l,r[8].outgoingLabel),T(e,o),T(e,c),T(c,u),Le(u,r[8].nextHop),T(e,h),ne(f,e,null),T(e,m),g=!0,k||(v=[fe(n,"change",y),fe(l,"input",d),fe(u,"input",E)],k=!0)},p(R,Z){r=R,(!g||Z&1&&s!==(s=r[7])&&n.value!==s)&&(n.value=s),Z&1&&We(l.value)!==r[8].outgoingLabel&&Le(l,r[8].outgoingLabel),Z&1&&u.value!==r[8].nextHop&&Le(u,r[8].nextHop);const N={};Z&1&&(N.callback=B),f.$set(N)},i(R){g||(O(f.$$.fragment,R),g=!0)},o(R){H(f.$$.fragment,R),g=!1},d(R){R&&p(e),re(f),k=!1,mt(v)}}}function ri(r){let e,t,n,s="(?)",i,a,l,o="<tr><th>Incoming</th> <th>Outgoing</th> <th>Next hop</th> <th></th></tr>",c,u,h,f,m,g,k=be([...r[0].LFIB.map]),v=[];for(let d=0;d<k.length;d+=1)v[d]=Sn(Pn(r,k,d));const y=d=>H(v[d],1,1,()=>{v[d]=null});return m=new ut({props:{text:"+",callback:r[1](r[0].LFIB.addEmptyEntry)}}),{c(){e=C("p"),t=pe("LFIB: "),n=C("span"),n.textContent=s,i=P(),a=C("table"),l=C("thead"),l.innerHTML=o,c=P(),u=C("tbody");for(let d=0;d<v.length;d+=1)v[d].c();h=P(),f=C("div"),ee(m.$$.fragment),this.h()},l(d){e=$(d,"P",{title:!0});var E=M(e);t=me(E,"LFIB: "),n=$(E,"SPAN",{"data-svelte-h":!0}),de(n)!=="svelte-1w7wt1o"&&(n.textContent=s),E.forEach(p),i=S(d),a=$(d,"TABLE",{});var B=M(a);l=$(B,"THEAD",{"data-svelte-h":!0}),de(l)!=="svelte-1fy2y89"&&(l.innerHTML=o),c=S(B),u=$(B,"TBODY",{});var R=M(u);for(let N=0;N<v.length;N+=1)v[N].l(R);R.forEach(p),B.forEach(p),h=S(d),f=$(d,"DIV",{class:!0});var Z=M(f);te(m.$$.fragment,Z),Z.forEach(p),this.h()},h(){rt(n,"color","grey"),b(e,"title","Maps incoming labels to outgoing labels and router IDs"),b(f,"class","svelte-f8qi58")},m(d,E){w(d,e,E),T(e,t),T(e,n),w(d,i,E),w(d,a,E),T(a,l),T(a,c),T(a,u);for(let B=0;B<v.length;B+=1)v[B]&&v[B].m(u,null);w(d,h,E),w(d,f,E),ne(m,f,null),g=!0},p(d,[E]){if(E&5){k=be([...d[0].LFIB.map]);let R;for(R=0;R<k.length;R+=1){const Z=Pn(d,k,R);v[R]?(v[R].p(Z,E),O(v[R],1)):(v[R]=Sn(Z),v[R].c(),O(v[R],1),v[R].m(u,null))}for(Se(),R=k.length;R<v.length;R+=1)y(R);De()}const B={};E&1&&(B.callback=d[1](d[0].LFIB.addEmptyEntry)),m.$set(B)},i(d){if(!g){for(let E=0;E<k.length;E+=1)O(v[E]);O(m.$$.fragment,d),g=!0}},o(d){v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)H(v[E]);H(m.$$.fragment,d),g=!1},d(d){d&&(p(e),p(i),p(a),p(h),p(f)),lt(v,d),re(m)}}}function si(r,e,t){let{router:n}=e;function s(u){return()=>{u(),t(0,n)}}function i(u,h){if(!(u.target instanceof HTMLInputElement))return;const f=parseInt(u.target.value);n.LFIB.updateLabel(h,f)}const a=(u,h)=>{i(h,u)};function l(u,h){u[h][1].outgoingLabel=We(this.value),t(0,n)}function o(u,h){u[h][1].nextHop=this.value,t(0,n)}const c=u=>{n.LFIB.deleteEntry(u),t(0,n)};return r.$$set=u=>{"router"in u&&t(0,n=u.router)},[n,s,i,a,l,o,c]}class ii extends Te{constructor(e){super(),Re(this,e,si,ri,$e,{router:0})}}function Dn(r,e,t){const n=r.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function On(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k,v;function y(...R){return r[3](r[7],...R)}function d(){r[4].call(l,r[9],r[10])}function E(){r[5].call(u,r[9],r[10])}function B(){return r[6](r[7])}return f=new ut({props:{text:"-",callback:B}}),{c(){e=C("tr"),t=C("td"),n=C("input"),i=P(),a=C("td"),l=C("input"),o=P(),c=C("td"),u=C("input"),h=P(),ee(f.$$.fragment),m=P(),this.h()},l(R){e=$(R,"TR",{});var Z=M(e);t=$(Z,"TD",{});var N=M(t);n=$(N,"INPUT",{type:!0}),N.forEach(p),i=S(Z),a=$(Z,"TD",{});var L=M(a);l=$(L,"INPUT",{type:!0}),L.forEach(p),o=S(Z),c=$(Z,"TD",{});var Y=M(c);u=$(Y,"INPUT",{type:!0}),Y.forEach(p),h=S(Z),te(f.$$.fragment,Z),m=S(Z),Z.forEach(p),this.h()},h(){b(n,"type","text"),n.value=s=r[7],b(l,"type","number"),b(u,"type","text")},m(R,Z){w(R,e,Z),T(e,t),T(t,n),T(e,i),T(e,a),T(a,l),Le(l,r[8].label),T(e,o),T(e,c),T(c,u),Le(u,r[8].nextHop),T(e,h),ne(f,e,null),T(e,m),g=!0,k||(v=[fe(n,"change",y),fe(l,"input",d),fe(u,"input",E)],k=!0)},p(R,Z){r=R,(!g||Z&1&&s!==(s=r[7])&&n.value!==s)&&(n.value=s),Z&1&&We(l.value)!==r[8].label&&Le(l,r[8].label),Z&1&&u.value!==r[8].nextHop&&Le(u,r[8].nextHop);const N={};Z&1&&(N.callback=B),f.$set(N)},i(R){g||(O(f.$$.fragment,R),g=!0)},o(R){H(f.$$.fragment,R),g=!1},d(R){R&&p(e),re(f),k=!1,mt(v)}}}function ai(r){let e,t,n,s="(?)",i,a,l,o="<tr><th>Address</th> <th>Label</th> <th>Next hop</th> <th></th></tr>",c,u,h,f,m,g,k=be([...r[0].FIB.map]),v=[];for(let d=0;d<k.length;d+=1)v[d]=On(Dn(r,k,d));const y=d=>H(v[d],1,1,()=>{v[d]=null});return m=new ut({props:{text:"+",callback:r[1](r[0].FIB.addEmptyEntry)}}),{c(){e=C("p"),t=pe("FIB: "),n=C("span"),n.textContent=s,i=P(),a=C("table"),l=C("thead"),l.innerHTML=o,c=P(),u=C("tbody");for(let d=0;d<v.length;d+=1)v[d].c();h=P(),f=C("div"),ee(m.$$.fragment),this.h()},l(d){e=$(d,"P",{title:!0});var E=M(e);t=me(E,"FIB: "),n=$(E,"SPAN",{"data-svelte-h":!0}),de(n)!=="svelte-1w7wt1o"&&(n.textContent=s),E.forEach(p),i=S(d),a=$(d,"TABLE",{});var B=M(a);l=$(B,"THEAD",{"data-svelte-h":!0}),de(l)!=="svelte-1qhs6t7"&&(l.innerHTML=o),c=S(B),u=$(B,"TBODY",{});var R=M(u);for(let N=0;N<v.length;N+=1)v[N].l(R);R.forEach(p),B.forEach(p),h=S(d),f=$(d,"DIV",{class:!0});var Z=M(f);te(m.$$.fragment,Z),Z.forEach(p),this.h()},h(){rt(n,"color","grey"),b(e,"title","Maps IP addresses to labels and router IDs"),b(f,"class","svelte-f8qi58")},m(d,E){w(d,e,E),T(e,t),T(e,n),w(d,i,E),w(d,a,E),T(a,l),T(a,c),T(a,u);for(let B=0;B<v.length;B+=1)v[B]&&v[B].m(u,null);w(d,h,E),w(d,f,E),ne(m,f,null),g=!0},p(d,[E]){if(E&5){k=be([...d[0].FIB.map]);let R;for(R=0;R<k.length;R+=1){const Z=Dn(d,k,R);v[R]?(v[R].p(Z,E),O(v[R],1)):(v[R]=On(Z),v[R].c(),O(v[R],1),v[R].m(u,null))}for(Se(),R=k.length;R<v.length;R+=1)y(R);De()}const B={};E&1&&(B.callback=d[1](d[0].FIB.addEmptyEntry)),m.$set(B)},i(d){if(!g){for(let E=0;E<k.length;E+=1)O(v[E]);O(m.$$.fragment,d),g=!0}},o(d){v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)H(v[E]);H(m.$$.fragment,d),g=!1},d(d){d&&(p(e),p(i),p(a),p(h),p(f)),lt(v,d),re(m)}}}function li(r,e,t){let{router:n}=e;function s(u){return()=>{u(),t(0,n)}}function i(u,h){if(!(u.target instanceof HTMLInputElement))return;const f=u.target.value;n.FIB.updateAddress(h,f)}const a=(u,h)=>{i(h,u)};function l(u,h){u[h][1].label=We(this.value),t(0,n)}function o(u,h){u[h][1].nextHop=this.value,t(0,n)}const c=u=>{n.FIB.deleteEntry(u),t(0,n)};return r.$$set=u=>{"router"in u&&t(0,n=u.router)},[n,s,i,a,l,o,c]}class oi extends Te{constructor(e){super(),Re(this,e,li,ai,$e,{router:0})}}function ui(r){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=C("p"),e.textContent=t},l(n){e=$(n,"P",{"data-svelte-h":!0}),de(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,s){w(n,e,s)},p:Ie,i:Ie,o:Ie,d(n){n&&p(e)}}}function ci(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k=r[0].id+"",v,y,d,E,B,R,Z,N,L,Y,A=r[0]instanceof Ae&&Bn(r),x=r[0]instanceof Ye&&jn(r),V=(r[0]instanceof Ye||r[0]instanceof kt)&&Zn(r);return Z=new ut({props:{text:"Delete Router",callback:r[3]}}),{c(){e=C("div"),t=C("div"),n=C("label"),s=pe(`Label:
          `),i=C("input"),a=P(),l=C("label"),o=pe(`Position:
        `),c=C("input"),u=P(),h=C("input"),f=P(),m=C("p"),g=pe("ID: "),v=pe(k),y=P(),A&&A.c(),d=P(),x&&x.c(),E=P(),V&&V.c(),B=P(),R=C("div"),ee(Z.$$.fragment),this.h()},l(I){e=$(I,"DIV",{});var F=M(e);t=$(F,"DIV",{});var ce=M(t);n=$(ce,"LABEL",{});var X=M(n);s=me(X,`Label:
          `),i=$(X,"INPUT",{type:!0,class:!0}),X.forEach(p),ce.forEach(p),a=S(F),l=$(F,"LABEL",{});var Q=M(l);o=me(Q,`Position:
        `),c=$(Q,"INPUT",{type:!0,class:!0}),u=S(Q),h=$(Q,"INPUT",{type:!0,class:!0}),Q.forEach(p),f=S(F),m=$(F,"P",{});var ke=M(m);g=me(ke,"ID: "),v=me(ke,k),ke.forEach(p),F.forEach(p),y=S(I),A&&A.l(I),d=S(I),x&&x.l(I),E=S(I),V&&V.l(I),B=S(I),R=$(I,"DIV",{class:!0});var _e=M(R);te(Z.$$.fragment,_e),_e.forEach(p),this.h()},h(){b(i,"type","text"),b(i,"class","svelte-cihl2i"),b(c,"type","number"),c.disabled=r[2],b(c,"class","svelte-cihl2i"),b(h,"type","number"),h.disabled=r[2],b(h,"class","svelte-cihl2i"),b(R,"class","margin-top svelte-cihl2i")},m(I,F){w(I,e,F),T(e,t),T(t,n),T(n,s),T(n,i),Le(i,r[0].node.label),T(e,a),T(e,l),T(l,o),T(l,c),Le(c,r[0].node.x),T(l,u),T(l,h),Le(h,r[0].node.y),T(e,f),T(e,m),T(m,g),T(m,v),w(I,y,F),A&&A.m(I,F),w(I,d,F),x&&x.m(I,F),w(I,E,F),V&&V.m(I,F),w(I,B,F),w(I,R,F),ne(Z,R,null),N=!0,L||(Y=[fe(i,"input",r[4]),fe(c,"input",r[5]),fe(h,"input",r[6]),fe(e,"input",r[7])],L=!0)},p(I,F){F&1&&i.value!==I[0].node.label&&Le(i,I[0].node.label),(!N||F&4)&&(c.disabled=I[2]),F&1&&We(c.value)!==I[0].node.x&&Le(c,I[0].node.x),(!N||F&4)&&(h.disabled=I[2]),F&1&&We(h.value)!==I[0].node.y&&Le(h,I[0].node.y),(!N||F&1)&&k!==(k=I[0].id+"")&&ze(v,k),I[0]instanceof Ae?A?(A.p(I,F),F&1&&O(A,1)):(A=Bn(I),A.c(),O(A,1),A.m(d.parentNode,d)):A&&(Se(),H(A,1,1,()=>{A=null}),De()),I[0]instanceof Ye?x?(x.p(I,F),F&1&&O(x,1)):(x=jn(I),x.c(),O(x,1),x.m(E.parentNode,E)):x&&(Se(),H(x,1,1,()=>{x=null}),De()),I[0]instanceof Ye||I[0]instanceof kt?V?(V.p(I,F),F&1&&O(V,1)):(V=Zn(I),V.c(),O(V,1),V.m(B.parentNode,B)):V&&(Se(),H(V,1,1,()=>{V=null}),De())},i(I){N||(O(A),O(x),O(V),O(Z.$$.fragment,I),N=!0)},o(I){H(A),H(x),H(V),H(Z.$$.fragment,I),N=!1},d(I){I&&(p(e),p(y),p(d),p(E),p(B),p(R)),A&&A.d(I),x&&x.d(I),V&&V.d(I),re(Z),L=!1,mt(Y)}}}function Bn(r){let e,t="Address:",n,s,i=r[0].address+"",a,l,o,c,u,h,f,m;function g(v){r[9](v)}let k={};return r[0]!==void 0&&(k.router=r[0]),c=new ni({props:k}),Oe.push(()=>Fe(c,"router",g)),{c(){e=C("p"),e.textContent=t,n=P(),s=C("button"),a=pe(i),l=P(),o=C("div"),ee(c.$$.fragment),this.h()},l(v){e=$(v,"P",{"data-svelte-h":!0}),de(e)!=="svelte-18hoeeh"&&(e.textContent=t),n=S(v),s=$(v,"BUTTON",{class:!0});var y=M(s);a=me(y,i),y.forEach(p),l=S(v),o=$(v,"DIV",{class:!0});var d=M(o);te(c.$$.fragment,d),d.forEach(p),this.h()},h(){rt(e,"display","inline"),b(s,"class","svelte-cihl2i"),b(o,"class","margin-top svelte-cihl2i")},m(v,y){w(v,e,y),w(v,n,y),w(v,s,y),T(s,a),w(v,l,y),w(v,o,y),ne(c,o,null),h=!0,f||(m=fe(s,"click",r[8]),f=!0)},p(v,y){(!h||y&1)&&i!==(i=v[0].address+"")&&ze(a,i);const d={};!u&&y&1&&(u=!0,d.router=v[0],Ve(()=>u=!1)),c.$set(d)},i(v){h||(O(c.$$.fragment,v),h=!0)},o(v){H(c.$$.fragment,v),h=!1},d(v){v&&(p(e),p(n),p(s),p(l),p(o)),re(c),f=!1,m()}}}function jn(r){let e,t,n,s;function i(l){r[10](l)}let a={};return r[0]!==void 0&&(a.router=r[0]),t=new oi({props:a}),Oe.push(()=>Fe(t,"router",i)),{c(){e=C("div"),ee(t.$$.fragment),this.h()},l(l){e=$(l,"DIV",{class:!0});var o=M(e);te(t.$$.fragment,o),o.forEach(p),this.h()},h(){b(e,"class","margin-top svelte-cihl2i")},m(l,o){w(l,e,o),ne(t,e,null),s=!0},p(l,o){const c={};!n&&o&1&&(n=!0,c.router=l[0],Ve(()=>n=!1)),t.$set(c)},i(l){s||(O(t.$$.fragment,l),s=!0)},o(l){H(t.$$.fragment,l),s=!1},d(l){l&&p(e),re(t)}}}function Zn(r){let e,t,n,s;function i(l){r[11](l)}let a={};return r[0]!==void 0&&(a.router=r[0]),t=new ii({props:a}),Oe.push(()=>Fe(t,"router",i)),{c(){e=C("div"),ee(t.$$.fragment),this.h()},l(l){e=$(l,"DIV",{class:!0});var o=M(e);te(t.$$.fragment,o),o.forEach(p),this.h()},h(){b(e,"class","margin-top svelte-cihl2i")},m(l,o){w(l,e,o),ne(t,e,null),s=!0},p(l,o){const c={};!n&&o&1&&(n=!0,c.router=l[0],Ve(()=>n=!1)),t.$set(c)},i(l){s||(O(t.$$.fragment,l),s=!0)},o(l){H(t.$$.fragment,l),s=!1},d(l){l&&p(e),re(t)}}}function di(r){let e,t,n,s;const i=[ci,ui],a=[];function l(o,c){return o[0]?0:1}return e=l(r),t=a[e]=i[e](r),{c(){t.c(),n=Ce()},l(o){t.l(o),n=Ce()},m(o,c){a[e].m(o,c),w(o,n,c),s=!0},p(o,c){let u=e;e=l(o),e===u?a[e].p(o,c):(Se(),H(a[u],1,1,()=>{a[u]=null}),De(),t=a[e],t?t.p(o,c):(t=a[e]=i[e](o),t.c()),O(t,1),t.m(n.parentNode,n))},i(o){s||(O(t),s=!0)},o(o){H(t),s=!1},d(o){o&&p(n),a[e].d(o)}}}function fi(r){let e,t,n;function s(a){r[12](a)}let i={$$slots:{default:[di]},$$scope:{ctx:r}};return r[1]!==void 0&&(i.dialog=r[1]),e=new an({props:i}),Oe.push(()=>Fe(e,"dialog",s)),e.$on("close",r[13]),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,l){ne(e,a,l),n=!0},p(a,[l]){const o={};l&16389&&(o.$$scope={dirty:l,ctx:a}),!t&&l&2&&(t=!0,o.dialog=a[1],Ve(()=>t=!1)),e.$set(o)},i(a){n||(O(e.$$.fragment,a),n=!0)},o(a){H(e.$$.fragment,a),n=!1},d(a){re(e,a)}}}function hi(r,e,t){let n;je(r,pt,y=>t(2,n=y));let{router:s}=e,{dialog:i}=e;function a(){if(!n&&s){if(!confirm("Are you sure you want to delete this router?"))return;W.deleteRouter(s.id),i.close()}else alert("You can't delete a router while the network is locked.")}function l(){s.node.label=this.value,t(0,s)}function o(){s.node.x=We(this.value),t(0,s)}function c(){s.node.y=We(this.value),t(0,s)}const u=()=>{W.notify()},h=async()=>{s instanceof Ae&&await navigator.clipboard.writeText(s.address)};function f(y){s=y,t(0,s)}function m(y){s=y,t(0,s)}function g(y){s=y,t(0,s)}function k(y){i=y,t(1,i)}const v=()=>{if(s instanceof Ae)for(const y of s.firstHop.keys())y===""&&s.firstHop.delete(y);W.notify()};return r.$$set=y=>{"router"in y&&t(0,s=y.router),"dialog"in y&&t(1,i=y.dialog)},[s,i,n,a,l,o,c,u,h,f,m,g,k,v]}class pi extends Te{constructor(e){super(),Re(this,e,hi,fi,$e,{router:0,dialog:1})}}function mi(r){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=C("p"),e.textContent=t},l(n){e=$(n,"P",{"data-svelte-h":!0}),de(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,s){w(n,e,s)},p:Ie,i:Ie,o:Ie,d(n){n&&p(e)}}}function _i(r){let e,t=r[0].distance+"",n,s,i,a,l,o,c,u,h,f,m;return u=new ut({props:{text:"Delete Link",callback:r[3]}}),{c(){e=pe("Distance: "),n=pe(t),s=pe(` km
    `),i=C("label"),a=pe(`Bandwidth:
      `),l=C("input"),o=P(),c=C("div"),ee(u.$$.fragment),this.h()},l(g){e=me(g,"Distance: "),n=me(g,t),s=me(g,` km
    `),i=$(g,"LABEL",{class:!0});var k=M(i);a=me(k,`Bandwidth:
      `),l=$(k,"INPUT",{type:!0,class:!0}),k.forEach(p),o=S(g),c=$(g,"DIV",{class:!0});var v=M(c);te(u.$$.fragment,v),v.forEach(p),this.h()},h(){b(l,"type","number"),l.disabled=r[2],b(l,"class","svelte-11gx5jd"),b(i,"class","svelte-11gx5jd"),b(c,"class","svelte-11gx5jd")},m(g,k){w(g,e,k),w(g,n,k),w(g,s,k),w(g,i,k),T(i,a),T(i,l),Le(l,r[0].bandwidth),w(g,o,k),w(g,c,k),ne(u,c,null),h=!0,f||(m=fe(l,"input",r[4]),f=!0)},p(g,k){(!h||k&1)&&t!==(t=g[0].distance+"")&&ze(n,t),(!h||k&4)&&(l.disabled=g[2]),k&1&&We(l.value)!==g[0].bandwidth&&Le(l,g[0].bandwidth)},i(g){h||(O(u.$$.fragment,g),h=!0)},o(g){H(u.$$.fragment,g),h=!1},d(g){g&&(p(e),p(n),p(s),p(i),p(o),p(c)),re(u),f=!1,m()}}}function gi(r){let e,t,n,s;const i=[_i,mi],a=[];function l(o,c){return o[0]?0:1}return e=l(r),t=a[e]=i[e](r),{c(){t.c(),n=Ce()},l(o){t.l(o),n=Ce()},m(o,c){a[e].m(o,c),w(o,n,c),s=!0},p(o,c){let u=e;e=l(o),e===u?a[e].p(o,c):(Se(),H(a[u],1,1,()=>{a[u]=null}),De(),t=a[e],t?t.p(o,c):(t=a[e]=i[e](o),t.c()),O(t,1),t.m(n.parentNode,n))},i(o){s||(O(t),s=!0)},o(o){H(t),s=!1},d(o){o&&p(n),a[e].d(o)}}}function vi(r){let e,t,n;function s(a){r[5](a)}let i={$$slots:{default:[gi]},$$scope:{ctx:r}};return r[1]!==void 0&&(i.dialog=r[1]),e=new an({props:i}),Oe.push(()=>Fe(e,"dialog",s)),e.$on("close",r[6]),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,l){ne(e,a,l),n=!0},p(a,[l]){const o={};l&133&&(o.$$scope={dirty:l,ctx:a}),!t&&l&2&&(t=!0,o.dialog=a[1],Ve(()=>t=!1)),e.$set(o)},i(a){n||(O(e.$$.fragment,a),n=!0)},o(a){H(e.$$.fragment,a),n=!1},d(a){re(e,a)}}}function yi(r,e,t){let n;je(r,pt,u=>t(2,n=u));let{link:s}=e,{dialog:i}=e;function a(){if(!n&&s){if(!confirm("Are you sure you want to delete this link?"))return;W.deleteLink(s.id),i.close()}else alert("You can't delete a link while the network is locked.")}function l(){s.bandwidth=We(this.value),t(0,s)}function o(u){i=u,t(1,i)}const c=()=>{W.notify()};return r.$$set=u=>{"link"in u&&t(0,s=u.link),"dialog"in u&&t(1,i=u.dialog)},[s,i,n,a,l,o,c]}class bi extends Te{constructor(e){super(),Re(this,e,yi,vi,$e,{link:0,dialog:1})}}function An(r){let e,t="Loading...";return{c(){e=C("p"),e.textContent=t,this.h()},l(n){e=$(n,"P",{style:!0,"data-svelte-h":!0}),de(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){rt(e,"font-size","200px")},m(n,s){w(n,e,s)},d(n){n&&p(e)}}}function Mn(r){let e,t,n,s,i,a;return{c(){e=tt("line"),this.h()},l(l){e=nt(l,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),M(e).forEach(p),this.h()},h(){b(e,"class","preview"),b(e,"x1",t=r[5].node.x),b(e,"y1",n=r[5].node.y),b(e,"x2",s=r[21](r[2].x)),b(e,"y2",i=r[22](r[2].y)),b(e,"stroke",a=r[7]===r[13].CONNECTING?"green":"blue")},m(l,o){w(l,e,o)},p(l,o){o[0]&32&&t!==(t=l[5].node.x)&&b(e,"x1",t),o[0]&32&&n!==(n=l[5].node.y)&&b(e,"y1",n),o[0]&4&&s!==(s=l[21](l[2].x))&&b(e,"x2",s),o[0]&4&&i!==(i=l[22](l[2].y))&&b(e,"y2",i),o[0]&128&&a!==(a=l[7]===l[13].CONNECTING?"green":"blue")&&b(e,"stroke",a)},d(l){l&&p(e)}}}function zn(r){let e,t,n,s,i,a=r[12].placing+"",l,o,c;return{c(){e=tt("image"),i=tt("text"),l=pe(a),this.h()},l(u){e=nt(u,"image",{x:!0,y:!0,width:!0,height:!0,href:!0}),M(e).forEach(p),i=nt(u,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var h=M(i);l=me(h,a),h.forEach(p),this.h()},h(){b(e,"x",t=r[21](r[3].x)-45/2),b(e,"y",n=r[22](r[3].y)-45/2),b(e,"width","45"),b(e,"height","45"),b(e,"href",s=`Router/${r[12].placing}.svg`),b(i,"x",o=r[21](r[3].x)),b(i,"y",c=r[22](r[3].y)),b(i,"dominant-baseline","central"),b(i,"font-size","smaller"),b(i,"class","svelte-huetud")},m(u,h){w(u,e,h),w(u,i,h),T(i,l)},p(u,h){h[0]&8&&t!==(t=u[21](u[3].x)-45/2)&&b(e,"x",t),h[0]&8&&n!==(n=u[22](u[3].y)-45/2)&&b(e,"y",n),h[0]&4096&&s!==(s=`Router/${u[12].placing}.svg`)&&b(e,"href",s),h[0]&4096&&a!==(a=u[12].placing+"")&&ze(l,a),h[0]&8&&o!==(o=u[21](u[3].x))&&b(i,"x",o),h[0]&8&&c!==(c=u[22](u[3].y))&&b(i,"y",c)},d(u){u&&(p(e),p(i))}}}function ki(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k,v=!r[10]&&An(),y=(!r[0]&&r[7]===r[13].CONNECTING||r[7]===r[13].ADDING_DESTINATION)&&r[5]&&Mn(r);const d=r[25].default,E=or(d,r,r[24],null);let B=r[7]===r[13].ADDING_ROUTERS&&r[12].placing&&zn(r);function R(x){r[28](x)}function Z(x){r[29](x)}let N={};r[5]!==void 0&&(N.router=r[5]),r[8]!==void 0&&(N.dialog=r[8]),a=new pi({props:N}),Oe.push(()=>Fe(a,"router",R)),Oe.push(()=>Fe(a,"dialog",Z));function L(x){r[30](x)}function Y(x){r[31](x)}let A={};return r[6]!==void 0&&(A.link=r[6]),r[9]!==void 0&&(A.dialog=r[9]),u=new bi({props:A}),Oe.push(()=>Fe(u,"link",L)),Oe.push(()=>Fe(u,"dialog",Y)),{c(){v&&v.c(),e=P(),t=tt("svg"),y&&y.c(),n=Ce(),E&&E.c(),B&&B.c(),i=P(),ee(a.$$.fragment),c=P(),ee(u.$$.fragment),this.h()},l(x){v&&v.l(x),e=S(x),t=nt(x,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var V=M(t);y&&y.l(V),n=Ce(),E&&E.l(V),B&&B.l(V),V.forEach(p),i=S(x),te(a.$$.fragment,x),c=S(x),te(u.$$.fragment,x),this.h()},h(){b(t,"viewBox",s=`${r[1].x} ${r[1].y} ${r[1].width} ${r[1].height}`),b(t,"role","button"),b(t,"tabindex","-1"),b(t,"class","svelte-huetud"),rt(t,"cursor",r[11][r[7]])},m(x,V){v&&v.m(x,V),w(x,e,V),w(x,t,V),y&&y.m(t,null),T(t,n),E&&E.m(t,null),B&&B.m(t,null),r[27](t),w(x,i,V),ne(a,x,V),w(x,c,V),ne(u,x,V),m=!0,g||(k=[fe(window,"keydown",r[15]),fe(t,"pointerdown",r[16]),fe(t,"pointermove",r[14]),fe(t,"pointerup",r[17]),fe(t,"wheel",r[18]),fe(t,"dblclick",r[19]),fe(t,"dragover",Ir(r[26])),fe(t,"drop",r[20])],g=!0)},p(x,V){x[10]?v&&(v.d(1),v=null):v||(v=An(),v.c(),v.m(e.parentNode,e)),(!x[0]&&x[7]===x[13].CONNECTING||x[7]===x[13].ADDING_DESTINATION)&&x[5]?y?y.p(x,V):(y=Mn(x),y.c(),y.m(t,n)):y&&(y.d(1),y=null),E&&E.p&&(!m||V[0]&16777216)&&ur(E,d,x,x[24],m?dr(d,x[24],V,null):cr(x[24]),null),x[7]===x[13].ADDING_ROUTERS&&x[12].placing?B?B.p(x,V):(B=zn(x),B.c(),B.m(t,null)):B&&(B.d(1),B=null),(!m||V[0]&2&&s!==(s=`${x[1].x} ${x[1].y} ${x[1].width} ${x[1].height}`))&&b(t,"viewBox",s),V[0]&2176&&rt(t,"cursor",x[11][x[7]]);const I={};!l&&V[0]&32&&(l=!0,I.router=x[5],Ve(()=>l=!1)),!o&&V[0]&256&&(o=!0,I.dialog=x[8],Ve(()=>o=!1)),a.$set(I);const F={};!h&&V[0]&64&&(h=!0,F.link=x[6],Ve(()=>h=!1)),!f&&V[0]&512&&(f=!0,F.dialog=x[9],Ve(()=>f=!1)),u.$set(F)},i(x){m||(O(E,x),O(a.$$.fragment,x),O(u.$$.fragment,x),m=!0)},o(x){H(E,x),H(a.$$.fragment,x),H(u.$$.fragment,x),m=!1},d(x){x&&(p(e),p(t),p(i),p(c)),v&&v.d(x),y&&y.d(),E&&E.d(x),B&&B.d(),r[27](null),re(a,x),re(u,x),g=!1,mt(k)}}}function wi(r,e,t){let n,s,i;je(r,pt,_=>t(0,s=_)),je(r,Ue,_=>t(12,i=_));let{$$slots:a={},$$scope:l}=e;var o=(_=>(_[_.NONE=0]="NONE",_[_.DRAGGING=1]="DRAGGING",_[_.PANNING=2]="PANNING",_[_.CONNECTING=3]="CONNECTING",_[_.ADDING_DESTINATION=4]="ADDING_DESTINATION",_[_.ADDING_ROUTERS=5]="ADDING_ROUTERS",_))(o||{});const c={x:0,y:0,width:0,height:0,get scale(){return m?this.width/m.getBoundingClientRect().width:1}},u={x:0,y:0},h={x:0,y:0},f={x:0,y:0};let m=null,g=null,k=null,v=0,y,d,E=!1;Ue.subscribe(_=>{_.placing&&["CE","LER","LSR"].includes(_.placing)?t(7,v=5):t(7,v=0)}),pr(()=>{if(!m)return;new ResizeObserver(B).observe(m),requestAnimationFrame(()=>{m&&(t(1,c.x=m.getBoundingClientRect().width/-2,c),t(1,c.y=m.getBoundingClientRect().height/-2,c))}),t(10,E=!0)});function B(){if(!m)return;const _=c.scale||1;t(1,c.width=m.getBoundingClientRect().width*_,c),t(1,c.height=m.getBoundingClientRect().height*_,c)}function R(_){t(3,f.x=_.clientX,f),t(3,f.y=_.clientY,f)}function Z(_){switch(_.code){case"Escape":qe(Ue,i.placing=null,i);break;case"Space":_.preventDefault(),qe(pt,s=!s,s),qe(Ue,i.placing=null,i),W.clearPackets();break;case"Digit1":qe(Ue,i.placing="CE",i);break;case"Digit2":qe(Ue,i.placing="LER",i);break;case"Digit3":qe(Ue,i.placing="LSR",i);break}}function N(_){if(!(_.target instanceof Element))return;if(_.preventDefault(),v===5){switch(i.placing){case"CE":W.createCE(X(_.clientX),Q(_.clientY));break;case"LER":W.createLER(X(_.clientX),Q(_.clientY));break;case"LSR":W.createLSR(X(_.clientX),Q(_.clientY));break}_.shiftKey||qe(Ue,i.placing=null,i);return}m==null||m.addEventListener("pointermove",Y),m==null||m.setPointerCapture(_.pointerId);const z=_.target.id;if(z){if(t(5,g=W.getRouter(parseInt(z))||null),!g)return;_.shiftKey?t(7,v=3):_.altKey&&g instanceof Ae?t(7,v=4):(h.x=g.node.x,h.y=g.node.y,t(7,v=1))}else t(7,v=2);t(2,u.x=_.clientX,u),t(2,u.y=_.clientY,u)}function L(_){if(_.target instanceof Element&&v!==5){_.preventDefault();e:if(g&&v===4){const z=document.elementFromPoint(_.clientX,_.clientY),we=(z==null?void 0:z.tagName)==="image"?z.id:null,D=W.getRouter(parseInt(we??""));if(!D||g===D)break e;if(!(D instanceof Ae)){alert("Destination must be a CE");break e}const ie=kn(g,D);if(ie.length<=1){alert("No path found");break e}Cr(ie,D.address),W.notify()}t(7,v=0),t(5,g=null),m==null||m.releasePointerCapture(_.pointerId),m==null||m.removeEventListener("pointermove",Y)}}function Y(_){_.preventDefault();const z={x:(_.clientX-u.x)*c.scale,y:(_.clientY-u.y)*c.scale};if(!s&&v===1&&g)t(5,g.node.x=Math.round(h.x+z.x),g),t(5,g.node.y=Math.round(h.y+z.y),g),W.notify();else if(v===2)t(2,u.x=_.clientX,u),t(2,u.y=_.clientY,u),t(1,c.x-=z.x,c),t(1,c.y-=z.y,c);else if(v===4)t(2,u.x=_.clientX,u),t(2,u.y=_.clientY,u);else if(!s&&v===3){t(2,u.x=_.clientX,u),t(2,u.y=_.clientY,u);const we=document.elementFromPoint(_.clientX,_.clientY);if(!we)return;const D=W.getRouter(parseInt(we.id));we.tagName==="image"&&D&&g&&(W.addLink({source:g,target:D}),t(5,g=D))}}function A(_){_.preventDefault(),t(2,u.x=_.clientX,u),t(2,u.y=_.clientY,u);const z=_.deltaY>0?1.025:.975;x(z,u)}function x(_,z){if(!m||c.scale<.1&&_<1||c.scale>5&&_>1)return;const we=m.getBoundingClientRect(),D={x:(z.x-we.left)/we.width,y:(z.y-we.top)/we.height};t(1,c.x-=c.width*(_-1)*D.x,c),t(1,c.y-=c.height*(_-1)*D.y,c),t(1,c.width*=_,c),t(1,c.height*=_,c)}function V(_){if(!(_.target instanceof Element))return;_.preventDefault();const z=document.elementFromPoint(_.clientX,_.clientY);z&&(z.tagName==="image"?I(z.id):z.tagName==="rect"&&F(z.id))}function I(_){const z=W.getRouter(parseInt(_));z&&(t(5,g=z),y.showModal())}function F(_){const z=W.links.find(we=>_===we.id);z&&(t(6,k=z),d.showModal())}function ce(_){var we;_.preventDefault();const z=(we=_.dataTransfer)==null?void 0:we.getData("text/plain");if(z)switch(z){case"CE":W.createCE(X(_.clientX),Q(_.clientY));break;case"LER":W.createLER(X(_.clientX),Q(_.clientY));break;case"LSR":W.createLSR(X(_.clientX),Q(_.clientY));break}}function X(_){return m?(_-m.getBoundingClientRect().left)*c.scale+c.x:_}function Q(_){return m?(_-m.getBoundingClientRect().top)*c.scale+c.y:_}function ke(_){fr.call(this,r,_)}function _e(_){Oe[_?"unshift":"push"](()=>{m=_,t(4,m)})}function ge(_){g=_,t(5,g)}function Be(_){y=_,t(8,y)}function Ne(_){k=_,t(6,k)}function Pe(_){d=_,t(9,d)}return r.$$set=_=>{"$$scope"in _&&t(24,l=_.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&1&&t(11,n={0:"move",1:s?"not-allowed":"grabbing",2:"grabbing",3:s?"not-allowed":"crosshair",4:"crosshair",5:"none"})},[s,c,u,f,m,g,k,v,y,d,E,n,i,o,R,Z,N,L,A,V,ce,X,Q,x,l,a,ke,_e,ge,Be,Ne,Pe]}class xi extends Te{constructor(e){super(),Re(this,e,wi,ki,$e,{zoom:23},null,[-1,-1])}get zoom(){return this.$$.ctx[23]}}function Ei(r){let e,t,n,s;return{c(){e=C("button"),t=pe(r[0]),this.h()},l(i){e=$(i,"BUTTON",{style:!0,class:!0});var a=M(e);t=me(a,r[0]),a.forEach(p),this.h()},h(){b(e,"style",r[2]),b(e,"class","svelte-v6s8rg")},m(i,a){w(i,e,a),T(e,t),n||(s=fe(e,"click",function(){hr(r[1])&&r[1].apply(this,arguments)}),n=!0)},p(i,[a]){r=i,a&1&&ze(t,r[0]),a&4&&b(e,"style",r[2])},i:Ie,o:Ie,d(i){i&&p(e),n=!1,s()}}}function Ci(r,e,t){let{text:n}=e,{callback:s=()=>{}}=e,{style:i=void 0}=e;return r.$$set=a=>{"text"in a&&t(0,n=a.text),"callback"in a&&t(1,s=a.callback),"style"in a&&t(2,i=a.style)},[n,s,i]}class Qe extends Te{constructor(e){super(),Re(this,e,Ci,Ei,$e,{text:0,callback:1,style:2})}}function $i(r){let e,t,n=r[0].address+"",s,i,a,l="→",o,c,u=r[1].address+"",h,f,m,g,k,v;return m=new Qe({props:{text:"Play",callback:r[2]}}),k=new Qe({props:{text:"Delete",callback:r[3]}}),{c(){e=C("div"),t=C("p"),s=pe(n),i=P(),a=C("p"),a.textContent=l,o=P(),c=C("p"),h=pe(u),f=P(),ee(m.$$.fragment),g=P(),ee(k.$$.fragment),this.h()},l(y){e=$(y,"DIV",{class:!0});var d=M(e);t=$(d,"P",{class:!0});var E=M(t);s=me(E,n),E.forEach(p),i=S(d),a=$(d,"P",{class:!0,"data-svelte-h":!0}),de(a)!=="svelte-1giyjq6"&&(a.textContent=l),o=S(d),c=$(d,"P",{class:!0});var B=M(c);h=me(B,u),B.forEach(p),f=S(d),te(m.$$.fragment,d),g=S(d),te(k.$$.fragment,d),d.forEach(p),this.h()},h(){b(t,"class","svelte-ikhsiz"),b(a,"class","svelte-ikhsiz"),b(c,"class","svelte-ikhsiz"),b(e,"class","svelte-ikhsiz")},m(y,d){w(y,e,d),T(e,t),T(t,s),T(e,i),T(e,a),T(e,o),T(e,c),T(c,h),T(e,f),ne(m,e,null),T(e,g),ne(k,e,null),v=!0},p(y,[d]){(!v||d&1)&&n!==(n=y[0].address+"")&&ze(s,n),(!v||d&2)&&u!==(u=y[1].address+"")&&ze(h,u)},i(y){v||(O(m.$$.fragment,y),O(k.$$.fragment,y),v=!0)},o(y){H(m.$$.fragment,y),H(k.$$.fragment,y),v=!1},d(y){y&&p(e),re(m),re(k)}}}function Ti(r,e,t){let{source:n}=e,{destination:s}=e;function i(){W.addPacket(n,s)}function a(){confirm("Are you sure you want to delete this LSP?")&&(n.deleteEntry(s.address),W.notify())}return r.$$set=l=>{"source"in l&&t(0,n=l.source),"destination"in l&&t(1,s=l.destination)},[n,s,i,a]}class Ri extends Te{constructor(e){super(),Re(this,e,Ti,$i,$e,{source:0,destination:1})}}function Hn(r,e,t){const n=r.slice();return n[2]=e[t],n}function Vn(r,e,t){const n=r.slice();return n[5]=e[t][0],n}function Fn(r){let e,t;return e=new Ri({props:{source:r[2],destination:W.getSureCERouter(r[5])}}),{c(){ee(e.$$.fragment)},l(n){te(e.$$.fragment,n)},m(n,s){ne(e,n,s),t=!0},p(n,s){const i={};s&1&&(i.source=n[2]),s&1&&(i.destination=W.getSureCERouter(n[5])),e.$set(i)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){re(e,n)}}}function Un(r){let e,t,n=be([...r[2].firstHop]),s=[];for(let a=0;a<n.length;a+=1)s[a]=Fn(Vn(r,n,a));const i=a=>H(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Ce()},l(a){for(let l=0;l<s.length;l+=1)s[l].l(a);e=Ce()},m(a,l){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(a,l);w(a,e,l),t=!0},p(a,l){if(l&1){n=be([...a[2].firstHop]);let o;for(o=0;o<n.length;o+=1){const c=Vn(a,n,o);s[o]?(s[o].p(c,l),O(s[o],1)):(s[o]=Fn(c),s[o].c(),O(s[o],1),s[o].m(e.parentNode,e))}for(Se(),o=n.length;o<s.length;o+=1)i(o);De()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)O(s[l]);t=!0}},o(a){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(a){a&&p(e),lt(s,a)}}}function Ii(r){let e,t,n=be(r[0]),s=[];for(let a=0;a<n.length;a+=1)s[a]=Un(Hn(r,n,a));const i=a=>H(s[a],1,1,()=>{s[a]=null});return{c(){e=C("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=$(a,"DIV",{class:!0});var l=M(e);for(let o=0;o<s.length;o+=1)s[o].l(l);l.forEach(p),this.h()},h(){b(e,"class","svelte-kwkmok")},m(a,l){w(a,e,l);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(a,[l]){if(l&1){n=be(a[0]);let o;for(o=0;o<n.length;o+=1){const c=Hn(a,n,o);s[o]?(s[o].p(c,l),O(s[o],1)):(s[o]=Un(c),s[o].c(),O(s[o],1),s[o].m(e,null))}for(Se(),o=n.length;o<s.length;o+=1)i(o);De()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)O(s[l]);t=!0}},o(a){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(a){a&&p(e),lt(s,a)}}}function Li(r,e,t){let n,s;return je(r,W,i=>t(1,s=i)),r.$$.update=()=>{r.$$.dirty&2&&t(0,n=s.routers.filter(i=>i instanceof Ae))},[n,s]}class Ni extends Te{constructor(e){super(),Re(this,e,Li,Ii,$e,{})}}function qn(r,e,t){const n=r.slice();return n[15]=e[t],n}function Yn(r){let e,t;const n=[r[15],{style:"padding: 10px 20px"}];let s={};for(let i=0;i<n.length;i+=1)s=en(s,n[i]);return e=new Qe({props:s}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,a){const l=a&64?nn(n,[rn(i[15]),n[1]]):{};e.$set(l)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Pi(r){let e,t,n,s,i,a,l,o="Packet Controls",c,u,h,f=r[2].packets.length+"",m,g,k,v,y,d,E,B,R=r[1].speedMultiplier.toFixed(1)+"",Z,N,L,Y,A,x,V,I=r[1].maxPackets+"",F,ce,X,Q,ke,_e,ge,Be="Fallback to normal IP routing?",Ne,Pe,_,z,we,D,ie,wn,_t=be(r[6]),ye=[];for(let le=0;le<_t.length;le+=1)ye[le]=Yn(qn(r,_t,le));const $r=le=>H(ye[le],1,1,()=>{ye[le]=null});return z=new Ni({}),{c(){e=C("div"),t=C("div"),s=P(),i=C("div"),a=C("div"),l=C("p"),l.textContent=o,c=P(),u=C("p"),h=pe("Count: "),m=pe(f),g=P(),k=C("div");for(let le=0;le<ye.length;le+=1)ye[le].c();v=P(),y=C("div"),d=C("div"),E=C("p"),B=pe("Speed Multiplier: "),Z=pe(R),N=P(),L=C("input"),Y=P(),A=C("div"),x=C("p"),V=pe("Max Packets: "),F=pe(I),ce=P(),X=C("input"),Q=P(),ke=C("div"),_e=C("label"),ge=C("p"),ge.textContent=Be,Ne=P(),Pe=C("input"),_=P(),ee(z.$$.fragment),this.h()},l(le){e=$(le,"DIV",{id:!0,style:!0,class:!0});var ve=M(e);t=$(ve,"DIV",{id:!0,class:!0}),M(t).forEach(p),ve.forEach(p),s=S(le),i=$(le,"DIV",{id:!0,style:!0,class:!0});var xe=M(i);a=$(xe,"DIV",{id:!0,class:!0});var He=M(a);l=$(He,"P",{id:!0,class:!0,"data-svelte-h":!0}),de(l)!=="svelte-1cfybk8"&&(l.textContent=o),c=S(He),u=$(He,"P",{id:!0,class:!0});var ln=M(u);h=me(ln,"Count: "),m=me(ln,f),ln.forEach(p),g=S(He),k=$(He,"DIV",{id:!0,class:!0});var xn=M(k);for(let cn=0;cn<ye.length;cn+=1)ye[cn].l(xn);xn.forEach(p),v=S(He),y=$(He,"DIV",{class:!0});var wt=M(y);d=$(wt,"DIV",{class:!0});var Mt=M(d);E=$(Mt,"P",{class:!0});var on=M(E);B=me(on,"Speed Multiplier: "),Z=me(on,R),on.forEach(p),N=S(Mt),L=$(Mt,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Mt.forEach(p),Y=S(wt),A=$(wt,"DIV",{class:!0});var zt=M(A);x=$(zt,"P",{class:!0});var un=M(x);V=me(un,"Max Packets: "),F=me(un,I),un.forEach(p),ce=S(zt),X=$(zt,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),zt.forEach(p),Q=S(wt),ke=$(wt,"DIV",{class:!0});var En=M(ke);_e=$(En,"LABEL",{class:!0});var Ht=M(_e);ge=$(Ht,"P",{class:!0,"data-svelte-h":!0}),de(ge)!=="svelte-1re47ui"&&(ge.textContent=Be),Ne=S(Ht),Pe=$(Ht,"INPUT",{type:!0,class:!0}),Ht.forEach(p),En.forEach(p),wt.forEach(p),_=S(He),te(z.$$.fragment,He),He.forEach(p),xe.forEach(p),this.h()},h(){b(t,"id","resize-bar"),b(t,"class","svelte-1jfhuaz"),b(e,"id","visual-resize-bar"),b(e,"style",n=`width: ${r[0]?1:0}px`),b(e,"class","svelte-1jfhuaz"),b(l,"id","packet-controls-title"),b(l,"class","svelte-1jfhuaz"),b(u,"id","packet-controls-count"),b(u,"class","svelte-1jfhuaz"),b(k,"id","control-panel-buttons"),b(k,"class","svelte-1jfhuaz"),b(E,"class","svelte-1jfhuaz"),b(L,"type","range"),b(L,"min","0.1"),b(L,"max","2"),b(L,"step","0.001"),b(L,"class","svelte-1jfhuaz"),b(d,"class","input-box svelte-1jfhuaz"),b(x,"class","svelte-1jfhuaz"),b(X,"type","range"),b(X,"min","1"),b(X,"max","500"),b(X,"step","1"),b(X,"class","svelte-1jfhuaz"),b(A,"class","input-box svelte-1jfhuaz"),b(ge,"class","svelte-1jfhuaz"),b(Pe,"type","checkbox"),b(Pe,"class","svelte-1jfhuaz"),b(_e,"class","svelte-1jfhuaz"),b(ke,"class","input-box svelte-1jfhuaz"),b(y,"class","inputs svelte-1jfhuaz"),b(a,"id","control-panel-content"),b(a,"class","svelte-1jfhuaz"),b(i,"id","control-panel"),b(i,"style",we=`width: ${r[5]}px; transition: ${r[4]};`),b(i,"class","svelte-1jfhuaz")},m(le,ve){w(le,e,ve),T(e,t),r[9](t),w(le,s,ve),w(le,i,ve),T(i,a),T(a,l),T(a,c),T(a,u),T(u,h),T(u,m),T(a,g),T(a,k);for(let xe=0;xe<ye.length;xe+=1)ye[xe]&&ye[xe].m(k,null);T(a,v),T(a,y),T(y,d),T(d,E),T(E,B),T(E,Z),T(d,N),T(d,L),Le(L,r[1].speedMultiplier),T(y,Y),T(y,A),T(A,x),T(x,V),T(x,F),T(A,ce),T(A,X),Le(X,r[1].maxPackets),T(y,Q),T(y,ke),T(ke,_e),T(_e,ge),T(_e,Ne),T(_e,Pe),Pe.checked=r[1].enableFallback,T(a,_),ne(z,a,null),D=!0,ie||(wn=[fe(t,"pointerdown",r[7]),fe(L,"change",r[10]),fe(L,"input",r[10]),fe(X,"change",r[11]),fe(X,"input",r[11]),fe(Pe,"change",r[12])],ie=!0)},p(le,[ve]){if((!D||ve&1&&n!==(n=`width: ${le[0]?1:0}px`))&&b(e,"style",n),(!D||ve&4)&&f!==(f=le[2].packets.length+"")&&ze(m,f),ve&64){_t=be(le[6]);let xe;for(xe=0;xe<_t.length;xe+=1){const He=qn(le,_t,xe);ye[xe]?(ye[xe].p(He,ve),O(ye[xe],1)):(ye[xe]=Yn(He),ye[xe].c(),O(ye[xe],1),ye[xe].m(k,null))}for(Se(),xe=_t.length;xe<ye.length;xe+=1)$r(xe);De()}(!D||ve&2)&&R!==(R=le[1].speedMultiplier.toFixed(1)+"")&&ze(Z,R),ve&2&&Le(L,le[1].speedMultiplier),(!D||ve&2)&&I!==(I=le[1].maxPackets+"")&&ze(F,I),ve&2&&Le(X,le[1].maxPackets),ve&2&&(Pe.checked=le[1].enableFallback),(!D||ve&48&&we!==(we=`width: ${le[5]}px; transition: ${le[4]};`))&&b(i,"style",we)},i(le){if(!D){for(let ve=0;ve<_t.length;ve+=1)O(ye[ve]);O(z.$$.fragment,le),D=!0}},o(le){ye=ye.filter(Boolean);for(let ve=0;ve<ye.length;ve+=1)H(ye[ve]);H(z.$$.fragment,le),D=!1},d(le){le&&(p(e),p(s),p(i)),r[9](null),lt(ye,le),re(z),ie=!1,mt(wn)}}}function Si(r,e,t){let n,s,i,a,l,o;je(r,pt,d=>t(0,a=d)),je(r,Ge,d=>t(1,l=d)),je(r,W,d=>t(2,o=d));let c,u="width 250ms";function h(d){a&&(t(4,u="none"),c.setPointerCapture(d.pointerId),c.addEventListener("pointermove",f),c.addEventListener("pointerup",m))}function f(d){t(5,i=window.innerWidth-d.clientX),i<=20&&t(5,i=0),i>=window.innerWidth-350&&t(5,i=window.innerWidth-350)}function m(d){c.removeEventListener("pointermove",f),c.removeEventListener("pointerup",m),c.releasePointerCapture(d.pointerId),t(4,u="width 250ms")}function g(d){Oe[d?"unshift":"push"](()=>{c=d,t(3,c)})}function k(){l.speedMultiplier=We(this.value),Ge.set(l)}function v(){l.maxPackets=We(this.value),Ge.set(l)}function y(){l.enableFallback=this.checked,Ge.set(l)}return r.$$.update=()=>{r.$$.dirty&4&&t(8,n=o.routers.filter(d=>d instanceof Ae)),r.$$.dirty&258&&t(6,s=[{text:l.running?"Pause":"Resume",callback:()=>{qe(Ge,l.running=!l.running,l)}},{text:"Reset",callback:()=>{W.clearPackets()}},{text:"Play All",callback:()=>{for(const d of n)for(const[E]of d.firstHop)W.addPacket(d,W.getSureCERouter(E))}}]),r.$$.dirty&1&&t(5,i=a?350:0)},[a,l,o,c,u,i,s,h,n,g,k,v,y]}class Di extends Te{constructor(e){super(),Re(this,e,Si,Pi,$e,{})}}function Oi(r){let e;return{c(){e=tt("circle"),this.h()},l(t){e=nt(t,"circle",{r:!0,class:!0}),M(e).forEach(p),this.h()},h(){b(e,"r","5"),b(e,"class","svelte-rvo2j9"),Cn(e,"labeled",r[0].label!==-1)},m(t,n){w(t,e,n),r[4](e)},p(t,[n]){n&1&&Cn(e,"labeled",t[0].label!==-1)},i:Ie,o:Ie,d(t){t&&p(e),r[4](null)}}}function Bi(r,e,t){let n;je(r,Ge,f=>t(3,n=f));let{packet:s}=e,i,a,l;function o(){const f=Math.sqrt((s.node.x-s.nextHop.node.x)**2+(s.node.y-s.nextHop.node.y)**2);i=Math.round(f/250*1e3)}function c(){if(o(),!l)return;const f=s.node,m=s.nextHop.node;t(2,a=l.animate({transform:[`translate(${f.x}px, ${f.y}px)`,`translate(${m.x}px, ${m.y}px)`]},{duration:i,easing:"linear"})),t(2,a.onfinish=u,a)}function u(){t(0,s.node=s.nextHop.node,s);const f=s.nextHop;if(f.receivePacket(s),f!==s.nextHop){if(!s.validateNextHop(f))return s.drop("Invalid next hop");c()}}requestAnimationFrame(c);function h(f){Oe[f?"unshift":"push"](()=>{l=f,t(1,l)})}return r.$$set=f=>{"packet"in f&&t(0,s=f.packet)},r.$$.update=()=>{r.$$.dirty&12&&a&&t(2,a.playbackRate=n.speedMultiplier,a),r.$$.dirty&12&&a&&(n.running?a.play():a.pause())},[s,l,a,n,h]}class ji extends Te{constructor(e){super(),Re(this,e,Bi,Oi,$e,{packet:0})}}function Zi(r){let e,t,n,s,i,a,l,o,c=r[0].distance+"",u,h,f,m;return{c(){e=tt("line"),t=P(),n=tt("rect"),l=P(),o=tt("text"),u=pe(c),h=pe(" km"),this.h()},l(g){e=nt(g,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),M(e).forEach(p),t=S(g),n=nt(g,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),M(n).forEach(p),l=S(g),o=nt(g,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var k=M(o);u=me(k,c),h=me(k," km"),k.forEach(p),this.h()},h(){b(e,"x1",r[4]),b(e,"y1",r[2]),b(e,"x2",r[3]),b(e,"y2",r[1]),b(n,"id",s=r[0].id),b(n,"x",i=r[5].x-pn/2),b(n,"y",a=r[5].y-mn/2),b(n,"width",pn),b(n,"height",mn),b(n,"class","svelte-zjn2k6"),b(o,"x",f=r[5].x),b(o,"y",m=r[5].y),b(o,"dominant-baseline","central"),b(o,"class","svelte-zjn2k6")},m(g,k){w(g,e,k),w(g,t,k),w(g,n,k),w(g,l,k),w(g,o,k),T(o,u),T(o,h)},p(g,[k]){k&16&&b(e,"x1",g[4]),k&4&&b(e,"y1",g[2]),k&8&&b(e,"x2",g[3]),k&2&&b(e,"y2",g[1]),k&1&&s!==(s=g[0].id)&&b(n,"id",s),k&32&&i!==(i=g[5].x-pn/2)&&b(n,"x",i),k&32&&a!==(a=g[5].y-mn/2)&&b(n,"y",a),k&1&&c!==(c=g[0].distance+"")&&ze(u,c),k&32&&f!==(f=g[5].x)&&b(o,"x",f),k&32&&m!==(m=g[5].y)&&b(o,"y",m)},i:Ie,o:Ie,d(g){g&&(p(e),p(t),p(n),p(l),p(o))}}}const pn=50,mn=20;function Wn(r,e){return(r+e)/2}function Ai(r,e,t){let n,s,i,a,l,{link:o}=e;return r.$$set=c=>{"link"in c&&t(0,o=c.link)},r.$$.update=()=>{r.$$.dirty&1&&t(4,n=o.source.node.x),r.$$.dirty&1&&t(3,s=o.target.node.x),r.$$.dirty&1&&t(2,i=o.source.node.y),r.$$.dirty&1&&t(1,a=o.target.node.y),r.$$.dirty&30&&t(5,l={x:Wn(n,s),y:Wn(i,a)})},[o,a,i,s,n,l]}class Mi extends Te{constructor(e){super(),Re(this,e,Ai,Zi,$e,{link:0})}}function zi(r){let e,t,n,s,i,a,l,o=r[0].node.label+"",c,u,h;return{c(){e=tt("image"),a=P(),l=tt("text"),c=pe(o),this.h()},l(f){e=nt(f,"image",{id:!0,x:!0,y:!0,width:!0,height:!0,href:!0,class:!0}),M(e).forEach(p),a=S(f),l=nt(f,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var m=M(l);c=me(m,o),m.forEach(p),this.h()},h(){b(e,"id",t=r[0].id.toString()),b(e,"x",n=r[0].node.x-45/2),b(e,"y",s=r[0].node.y-45/2),b(e,"width","45"),b(e,"height","45"),b(e,"href",i=`Router/${r[0].type}.svg`),b(e,"class","svelte-1eo9fnr"),b(l,"x",u=r[0].node.x),b(l,"y",h=r[0].node.y+10),b(l,"dominant-baseline","central"),b(l,"font-size","smaller"),b(l,"class","svelte-1eo9fnr")},m(f,m){w(f,e,m),w(f,a,m),w(f,l,m),T(l,c)},p(f,[m]){m&1&&t!==(t=f[0].id.toString())&&b(e,"id",t),m&1&&n!==(n=f[0].node.x-45/2)&&b(e,"x",n),m&1&&s!==(s=f[0].node.y-45/2)&&b(e,"y",s),m&1&&i!==(i=`Router/${f[0].type}.svg`)&&b(e,"href",i),m&1&&o!==(o=f[0].node.label+"")&&ze(c,o),m&1&&u!==(u=f[0].node.x)&&b(l,"x",u),m&1&&h!==(h=f[0].node.y+10)&&b(l,"y",h)},i:Ie,o:Ie,d(f){f&&(p(e),p(a),p(l))}}}function Hi(r,e,t){let{router:n}=e;return r.$$set=s=>{"router"in s&&t(0,n=s.router)},[n]}class Vi extends Te{constructor(e){super(),Re(this,e,Hi,zi,$e,{router:0})}}function Fi(r){let e,t,n,s;return{c(){e=C("div"),t=pe(r[0]),this.h()},l(i){e=$(i,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var a=M(e);t=me(a,r[0]),a.forEach(p),this.h()},h(){b(e,"draggable","true"),b(e,"role","button"),b(e,"tabindex","-1"),rt(e,"background-color",r[1]),b(e,"class","svelte-dfkep2")},m(i,a){w(i,e,a),T(e,t),n||(s=[fe(e,"dragstart",r[2]),fe(e,"click",r[3])],n=!0)},p(i,[a]){a&1&&ze(t,i[0]),a&2&&rt(e,"background-color",i[1])},i:Ie,o:Ie,d(i){i&&p(e),n=!1,mt(s)}}}function Ui(r,e,t){let n,s;je(r,Ue,u=>t(5,n=u)),je(r,pt,u=>t(6,s=u));let{text:i}=e,{type:a}=e,{color:l}=e;function o(u){var h;if(s){alert("Network is locked.");return}(h=u.dataTransfer)==null||h.setData("text/plain",a)}function c(){qe(Ue,n.placing=a,n)}return r.$$set=u=>{"text"in u&&t(0,i=u.text),"type"in u&&t(4,a=u.type),"color"in u&&t(1,l=u.color)},[i,l,o,c,a]}class qi extends Te{constructor(e){super(),Re(this,e,Ui,Fi,$e,{text:0,type:4,color:1})}}function Gn(r,e,t){const n=r.slice();return n[7]=e[t],n}function Xn(r,e,t){const n=r.slice();return n[7]=e[t],n}function Jn(r,e,t){const n=r.slice();return n[10]=e[t],n}function Yi(r){let e,t,n=be(r[0]),s=[];for(let a=0;a<n.length;a+=1)s[a]=Kn(Gn(r,n,a));const i=a=>H(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Ce()},l(a){for(let l=0;l<s.length;l+=1)s[l].l(a);e=Ce()},m(a,l){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(a,l);w(a,e,l),t=!0},p(a,l){if(l&1){n=be(a[0]);let o;for(o=0;o<n.length;o+=1){const c=Gn(a,n,o);s[o]?(s[o].p(c,l),O(s[o],1)):(s[o]=Kn(c),s[o].c(),O(s[o],1),s[o].m(e.parentNode,e))}for(Se(),o=n.length;o<s.length;o+=1)i(o);De()}},i(a){if(!t){for(let l=0;l<n.length;l+=1)O(s[l]);t=!0}},o(a){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(a){a&&p(e),lt(s,a)}}}function Wi(r){let e,t,n,s=be(r[4]),i=[];for(let u=0;u<s.length;u+=1)i[u]=Qn(Jn(r,s,u));const a=u=>H(i[u],1,1,()=>{i[u]=null});let l=be(r[1]),o=[];for(let u=0;u<l.length;u+=1)o[u]=er(Xn(r,l,u));const c=u=>H(o[u],1,1,()=>{o[u]=null});return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=P();for(let u=0;u<o.length;u+=1)o[u].c();t=Ce()},l(u){for(let h=0;h<i.length;h+=1)i[h].l(u);e=S(u);for(let h=0;h<o.length;h+=1)o[h].l(u);t=Ce()},m(u,h){for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(u,h);w(u,e,h);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(u,h);w(u,t,h),n=!0},p(u,h){if(h&16){s=be(u[4]);let f;for(f=0;f<s.length;f+=1){const m=Jn(u,s,f);i[f]?(i[f].p(m,h),O(i[f],1)):(i[f]=Qn(m),i[f].c(),O(i[f],1),i[f].m(e.parentNode,e))}for(Se(),f=s.length;f<i.length;f+=1)a(f);De()}if(h&2){l=be(u[1]);let f;for(f=0;f<l.length;f+=1){const m=Xn(u,l,f);o[f]?(o[f].p(m,h),O(o[f],1)):(o[f]=er(m),o[f].c(),O(o[f],1),o[f].m(t.parentNode,t))}for(Se(),f=l.length;f<o.length;f+=1)c(f);De()}},i(u){if(!n){for(let h=0;h<s.length;h+=1)O(i[h]);for(let h=0;h<l.length;h+=1)O(o[h]);n=!0}},o(u){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)H(i[h]);o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)H(o[h]);n=!1},d(u){u&&(p(e),p(t)),lt(i,u),lt(o,u)}}}function Kn(r){let e,t;const n=[r[7]];let s={};for(let i=0;i<n.length;i+=1)s=en(s,n[i]);return e=new Qe({props:s}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,a){const l=a&1?nn(n,[rn(i[7])]):{};e.$set(l)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Qn(r){let e,t;const n=[r[10]];let s={};for(let i=0;i<n.length;i+=1)s=en(s,n[i]);return e=new qi({props:s}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,a){const l=a&16?nn(n,[rn(i[10])]):{};e.$set(l)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function er(r){let e,t;const n=[r[7]];let s={};for(let i=0;i<n.length;i+=1)s=en(s,n[i]);return e=new Qe({props:s}),{c(){ee(e.$$.fragment)},l(i){te(e.$$.fragment,i)},m(i,a){ne(e,i,a),t=!0},p(i,a){const l=a&2?nn(n,[rn(i[7])]):{};e.$set(l)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){re(e,i)}}}function Gi(r){let e,t,n,s,i,a;e=new Qe({props:{text:r[2]?"Edit":"Simulation",callback:r[6],style:`width: 100px; background-color: ${r[2]?"#3CB371":"#6495ED"};`}});const l=[Wi,Yi],o=[];function c(u,h){return u[2]?1:0}return n=c(r),s=o[n]=l[n](r),{c(){ee(e.$$.fragment),t=P(),s.c(),i=Ce()},l(u){te(e.$$.fragment,u),t=S(u),s.l(u),i=Ce()},m(u,h){ne(e,u,h),w(u,t,h),o[n].m(u,h),w(u,i,h),a=!0},p(u,[h]){const f={};h&4&&(f.text=u[2]?"Edit":"Simulation"),h&12&&(f.callback=u[6]),h&4&&(f.style=`width: 100px; background-color: ${u[2]?"#3CB371":"#6495ED"};`),e.$set(f);let m=n;n=c(u),n===m?o[n].p(u,h):(Se(),H(o[m],1,1,()=>{o[m]=null}),De(),s=o[n],s?s.p(u,h):(s=o[n]=l[n](u),s.c()),O(s,1),s.m(i.parentNode,i))},i(u){a||(O(e.$$.fragment,u),O(s),a=!0)},o(u){H(e.$$.fragment,u),H(s),a=!1},d(u){u&&(p(t),p(i)),re(e,u),o[n].d(u)}}}function Xi(r,e,t){let n,s,i,a,l;je(r,W,u=>t(5,i=u)),je(r,pt,u=>t(2,a=u)),je(r,Ue,u=>t(3,l=u));const o=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],c=()=>{qe(pt,a=!a,a),qe(Ue,l.placing=null,l),W.clearPackets()};return r.$$.update=()=>{r.$$.dirty&32&&t(0,s=[{text:"Clear Tables",callback:()=>{confirm("Are you sure you want to clear the routing tables?")&&W.clearTables()}},{text:"Export",callback:()=>{const u={routers:i.routers.map(k=>{if(k instanceof Ae)return{...k,type:k.type,firstHop:Object.fromEntries(k.firstHop)};if(k instanceof Ye)return{...k,type:k.type,FIB:Object.fromEntries(k.FIB.map),LFIB:Object.fromEntries(k.LFIB.map)};if(k instanceof kt)return{...k,type:k.type,LFIB:Object.fromEntries(k.LFIB.map)}}),links:i.links.map(k=>({...k,source:k.source.id,target:k.target.id}))},h=JSON.stringify(u,null,2),f=new Blob([h],{type:"application/json"}),m=window.URL.createObjectURL(f),g=document.createElement("a");g.href=m,g.download="network.json",g.click(),window.URL.revokeObjectURL(m)}}]),r.$$.dirty&1&&t(1,n=[{text:"Clear Network",callback:()=>{confirm("Are you sure you want to clear the network?")&&W.clear()}},{text:"Clear Links",callback:()=>{confirm("Are you sure you want to clear the links?")&&W.clearLinks()}},...s])},[s,n,a,l,o,i,c]}class Ji extends Te{constructor(e){super(),Re(this,e,Xi,Gi,$e,{})}}function Ki(r){let e,t="Drag and drop routers to add them to the network.",n,s,i,a,l=`Instead of drag and drop, you can also click and hold shift while continuously clicking to add
    many routers.`,o,c,u,h,f=`Pressing 1, 2 or 3 will respectively select CE, LER or LSR, this works with the holding of shift
    to insert routers.`,m,g,k,v,y="Hold the shift key and drag routers to make links.",d,E,B,R,Z="Hold the ctrl key and drag CE's to add destinations.",N,L,Y,A,x="Double click a router or link to configure it.",V,I,F,ce,X="The clear button will delete the entire network.",Q,ke,_e,ge,Be="The export button will download your network as a .json file",Ne,Pe,_,z,we="Press Esc to close this popup.";return{c(){e=C("p"),e.textContent=t,n=P(),s=C("br"),i=P(),a=C("p"),a.textContent=l,o=P(),c=C("br"),u=P(),h=C("p"),h.textContent=f,m=P(),g=C("br"),k=P(),v=C("p"),v.textContent=y,d=P(),E=C("br"),B=P(),R=C("p"),R.textContent=Z,N=P(),L=C("br"),Y=P(),A=C("p"),A.textContent=x,V=P(),I=C("br"),F=P(),ce=C("p"),ce.textContent=X,Q=P(),ke=C("br"),_e=P(),ge=C("p"),ge.textContent=Be,Ne=P(),Pe=C("br"),_=P(),z=C("p"),z.textContent=we},l(D){e=$(D,"P",{"data-svelte-h":!0}),de(e)!=="svelte-bhocp0"&&(e.textContent=t),n=S(D),s=$(D,"BR",{}),i=S(D),a=$(D,"P",{"data-svelte-h":!0}),de(a)!=="svelte-12tzi3f"&&(a.textContent=l),o=S(D),c=$(D,"BR",{}),u=S(D),h=$(D,"P",{"data-svelte-h":!0}),de(h)!=="svelte-1gxe9lx"&&(h.textContent=f),m=S(D),g=$(D,"BR",{}),k=S(D),v=$(D,"P",{"data-svelte-h":!0}),de(v)!=="svelte-ddjc2m"&&(v.textContent=y),d=S(D),E=$(D,"BR",{}),B=S(D),R=$(D,"P",{"data-svelte-h":!0}),de(R)!=="svelte-33j76o"&&(R.textContent=Z),N=S(D),L=$(D,"BR",{}),Y=S(D),A=$(D,"P",{"data-svelte-h":!0}),de(A)!=="svelte-qvtprs"&&(A.textContent=x),V=S(D),I=$(D,"BR",{}),F=S(D),ce=$(D,"P",{"data-svelte-h":!0}),de(ce)!=="svelte-vcl8s3"&&(ce.textContent=X),Q=S(D),ke=$(D,"BR",{}),_e=S(D),ge=$(D,"P",{"data-svelte-h":!0}),de(ge)!=="svelte-1ww5ij7"&&(ge.textContent=Be),Ne=S(D),Pe=$(D,"BR",{}),_=S(D),z=$(D,"P",{"data-svelte-h":!0}),de(z)!=="svelte-1dvt5v1"&&(z.textContent=we)},m(D,ie){w(D,e,ie),w(D,n,ie),w(D,s,ie),w(D,i,ie),w(D,a,ie),w(D,o,ie),w(D,c,ie),w(D,u,ie),w(D,h,ie),w(D,m,ie),w(D,g,ie),w(D,k,ie),w(D,v,ie),w(D,d,ie),w(D,E,ie),w(D,B,ie),w(D,R,ie),w(D,N,ie),w(D,L,ie),w(D,Y,ie),w(D,A,ie),w(D,V,ie),w(D,I,ie),w(D,F,ie),w(D,ce,ie),w(D,Q,ie),w(D,ke,ie),w(D,_e,ie),w(D,ge,ie),w(D,Ne,ie),w(D,Pe,ie),w(D,_,ie),w(D,z,ie)},p:Ie,d(D){D&&(p(e),p(n),p(s),p(i),p(a),p(o),p(c),p(u),p(h),p(m),p(g),p(k),p(v),p(d),p(E),p(B),p(R),p(N),p(L),p(Y),p(A),p(V),p(I),p(F),p(ce),p(Q),p(ke),p(_e),p(ge),p(Ne),p(Pe),p(_),p(z))}}}function Qi(r){let e,t,n,s,i,a;t=new Qe({props:{text:"Help",callback:r[1]}});function l(c){r[2](c)}let o={$$slots:{default:[Ki]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.dialog=r[0]),s=new an({props:o}),Oe.push(()=>Fe(s,"dialog",l)),{c(){e=C("div"),ee(t.$$.fragment),n=P(),ee(s.$$.fragment)},l(c){e=$(c,"DIV",{});var u=M(e);te(t.$$.fragment,u),u.forEach(p),n=S(c),te(s.$$.fragment,c)},m(c,u){w(c,e,u),ne(t,e,null),w(c,n,u),ne(s,c,u),a=!0},p(c,[u]){const h={};u&1&&(h.callback=c[1]),t.$set(h);const f={};u&8&&(f.$$scope={dirty:u,ctx:c}),!i&&u&1&&(i=!0,f.dialog=c[0],Ve(()=>i=!1)),s.$set(f)},i(c){a||(O(t.$$.fragment,c),O(s.$$.fragment,c),a=!0)},o(c){H(t.$$.fragment,c),H(s.$$.fragment,c),a=!1},d(c){c&&(p(e),p(n)),re(t),re(s,c)}}}function ea(r,e,t){let n;const s=()=>{n.showModal()};function i(a){n=a,t(0,n)}return[n,s,i]}class ta extends Te{constructor(e){super(),Re(this,e,ea,Qi,$e,{})}}function na(r){let e,t,n,s,i,a;return e=new Qe({props:{text:" - ",callback:r[1]}}),n=new Qe({props:{text:"Fullscreen",callback:r[2]}}),i=new Qe({props:{text:" + ",callback:r[3]}}),{c(){ee(e.$$.fragment),t=P(),ee(n.$$.fragment),s=P(),ee(i.$$.fragment)},l(l){te(e.$$.fragment,l),t=S(l),te(n.$$.fragment,l),s=S(l),te(i.$$.fragment,l)},m(l,o){ne(e,l,o),w(l,t,o),ne(n,l,o),w(l,s,o),ne(i,l,o),a=!0},p(l,[o]){const c={};o&1&&(c.callback=l[1]),e.$set(c);const u={};o&1&&(u.callback=l[3]),i.$set(u)},i(l){a||(O(e.$$.fragment,l),O(n.$$.fragment,l),O(i.$$.fragment,l),a=!0)},o(l){H(e.$$.fragment,l),H(n.$$.fragment,l),H(i.$$.fragment,l),a=!1},d(l){l&&(p(t),p(s)),re(e,l),re(n,l),re(i,l)}}}function ra(r,e,t){let{zoom:n}=e;const s=()=>{const l={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,l)},i=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},a=()=>{const l={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,l)};return r.$$set=l=>{"zoom"in l&&t(0,n=l.zoom)},[n,s,i,a]}class sa extends Te{constructor(e){super(),Re(this,e,ra,na,$e,{zoom:0})}}function ia(r){let e,t="Attribution: The following Icon has been used",n,s,i,a,l="https://commons.wikimedia.org/wiki/File:Router.svg#",o,c,u,h,f="Share Alike: We hereby grant permission to",m,g,k=`Copy, distribute and/or modify this document under the terms of the GNU Free Documentation
    License.`,v,y,d="Version 1.2 or any later version published by the Free Software Foundation;",E,B,R="with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.",Z,N,L="A copy of the license is included in the section entitled GNU Free Documentation License.",Y,A,x,V,I="The Icon used for CE routers is almost identical to the on on Wikimedia (aspect ratio changed)",F,ce,X,Q,ke=`The Icon used for LSR/LER routers is almost identical, except with different colors. (aspect
    ratio changed)`,_e,ge,Be,Ne,Pe="Press Esc to close this popup";return{c(){e=C("p"),e.textContent=t,n=P(),s=C("br"),i=P(),a=C("p"),a.textContent=l,o=P(),c=C("br"),u=P(),h=C("p"),h.textContent=f,m=P(),g=C("p"),g.textContent=k,v=P(),y=C("p"),y.textContent=d,E=P(),B=C("p"),B.textContent=R,Z=P(),N=C("p"),N.textContent=L,Y=P(),A=C("br"),x=P(),V=C("p"),V.textContent=I,F=P(),ce=C("br"),X=P(),Q=C("p"),Q.textContent=ke,_e=P(),ge=C("br"),Be=P(),Ne=C("p"),Ne.textContent=Pe},l(_){e=$(_,"P",{"data-svelte-h":!0}),de(e)!=="svelte-t8z8ph"&&(e.textContent=t),n=S(_),s=$(_,"BR",{}),i=S(_),a=$(_,"P",{"data-svelte-h":!0}),de(a)!=="svelte-dbjryl"&&(a.textContent=l),o=S(_),c=$(_,"BR",{}),u=S(_),h=$(_,"P",{"data-svelte-h":!0}),de(h)!=="svelte-1y4tl2"&&(h.textContent=f),m=S(_),g=$(_,"P",{"data-svelte-h":!0}),de(g)!=="svelte-17660lf"&&(g.textContent=k),v=S(_),y=$(_,"P",{"data-svelte-h":!0}),de(y)!=="svelte-vqht9l"&&(y.textContent=d),E=S(_),B=$(_,"P",{"data-svelte-h":!0}),de(B)!=="svelte-1x9q3li"&&(B.textContent=R),Z=S(_),N=$(_,"P",{"data-svelte-h":!0}),de(N)!=="svelte-hnn81q"&&(N.textContent=L),Y=S(_),A=$(_,"BR",{}),x=S(_),V=$(_,"P",{"data-svelte-h":!0}),de(V)!=="svelte-pqeqwb"&&(V.textContent=I),F=S(_),ce=$(_,"BR",{}),X=S(_),Q=$(_,"P",{"data-svelte-h":!0}),de(Q)!=="svelte-vmr7sg"&&(Q.textContent=ke),_e=S(_),ge=$(_,"BR",{}),Be=S(_),Ne=$(_,"P",{"data-svelte-h":!0}),de(Ne)!=="svelte-mgckcf"&&(Ne.textContent=Pe)},m(_,z){w(_,e,z),w(_,n,z),w(_,s,z),w(_,i,z),w(_,a,z),w(_,o,z),w(_,c,z),w(_,u,z),w(_,h,z),w(_,m,z),w(_,g,z),w(_,v,z),w(_,y,z),w(_,E,z),w(_,B,z),w(_,Z,z),w(_,N,z),w(_,Y,z),w(_,A,z),w(_,x,z),w(_,V,z),w(_,F,z),w(_,ce,z),w(_,X,z),w(_,Q,z),w(_,_e,z),w(_,ge,z),w(_,Be,z),w(_,Ne,z)},p:Ie,d(_){_&&(p(e),p(n),p(s),p(i),p(a),p(o),p(c),p(u),p(h),p(m),p(g),p(v),p(y),p(E),p(B),p(Z),p(N),p(Y),p(A),p(x),p(V),p(F),p(ce),p(X),p(Q),p(_e),p(ge),p(Be),p(Ne))}}}function aa(r){let e,t,n,s,i,a;t=new Qe({props:{text:"Credits",callback:r[1]}});function l(c){r[2](c)}let o={$$slots:{default:[ia]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.dialog=r[0]),s=new an({props:o}),Oe.push(()=>Fe(s,"dialog",l)),{c(){e=C("div"),ee(t.$$.fragment),n=P(),ee(s.$$.fragment)},l(c){e=$(c,"DIV",{});var u=M(e);te(t.$$.fragment,u),u.forEach(p),n=S(c),te(s.$$.fragment,c)},m(c,u){w(c,e,u),ne(t,e,null),w(c,n,u),ne(s,c,u),a=!0},p(c,[u]){const h={};u&1&&(h.callback=c[1]),t.$set(h);const f={};u&8&&(f.$$scope={dirty:u,ctx:c}),!i&&u&1&&(i=!0,f.dialog=c[0],Ve(()=>i=!1)),s.$set(f)},i(c){a||(O(t.$$.fragment,c),O(s.$$.fragment,c),a=!0)},o(c){H(t.$$.fragment,c),H(s.$$.fragment,c),a=!1},d(c){c&&(p(e),p(n)),re(t),re(s,c)}}}function la(r,e,t){let n;const s=()=>{n.showModal()};function i(a){n=a,t(0,n)}return[n,s,i]}class oa extends Te{constructor(e){super(),Re(this,e,la,aa,$e,{})}}function tr(r,e,t){const n=r.slice();return n[5]=e[t],n}function nr(r,e,t){const n=r.slice();return n[8]=e[t],n}function rr(r,e,t){const n=r.slice();return n[11]=e[t],n}function sr(r,e){let t,n,s;return n=new Mi({props:{link:e[11]}}),{key:r,first:null,c(){t=Ce(),ee(n.$$.fragment),this.h()},l(i){t=Ce(),te(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){w(i,t,a),ne(n,i,a),s=!0},p(i,a){e=i;const l={};a&2&&(l.link=e[11]),n.$set(l)},i(i){s||(O(n.$$.fragment,i),s=!0)},o(i){H(n.$$.fragment,i),s=!1},d(i){i&&p(t),re(n,i)}}}function ir(r,e){let t,n,s;return n=new Vi({props:{router:e[8]}}),{key:r,first:null,c(){t=Ce(),ee(n.$$.fragment),this.h()},l(i){t=Ce(),te(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){w(i,t,a),ne(n,i,a),s=!0},p(i,a){e=i;const l={};a&2&&(l.router=e[8]),n.$set(l)},i(i){s||(O(n.$$.fragment,i),s=!0)},o(i){H(n.$$.fragment,i),s=!1},d(i){i&&p(t),re(n,i)}}}function ar(r,e){let t,n,s;return n=new ji({props:{packet:e[5]}}),{key:r,first:null,c(){t=Ce(),ee(n.$$.fragment),this.h()},l(i){t=Ce(),te(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){w(i,t,a),ne(n,i,a),s=!0},p(i,a){e=i;const l={};a&2&&(l.packet=e[5]),n.$set(l)},i(i){s||(O(n.$$.fragment,i),s=!0)},o(i){H(n.$$.fragment,i),s=!1},d(i){i&&p(t),re(n,i)}}}function ua(r){let e=[],t=new Map,n,s=[],i=new Map,a,l=[],o=new Map,c,u,h=be(r[1].links);const f=y=>y[11].id;for(let y=0;y<h.length;y+=1){let d=rr(r,h,y),E=f(d);t.set(E,e[y]=sr(E,d))}let m=be(r[1].routers);const g=y=>y[8].id;for(let y=0;y<m.length;y+=1){let d=nr(r,m,y),E=g(d);i.set(E,s[y]=ir(E,d))}let k=be(r[1].packets);const v=y=>y[5].id;for(let y=0;y<k.length;y+=1){let d=tr(r,k,y),E=v(d);o.set(E,l[y]=ar(E,d))}return{c(){for(let y=0;y<e.length;y+=1)e[y].c();n=P();for(let y=0;y<s.length;y+=1)s[y].c();a=P();for(let y=0;y<l.length;y+=1)l[y].c();c=Ce()},l(y){for(let d=0;d<e.length;d+=1)e[d].l(y);n=S(y);for(let d=0;d<s.length;d+=1)s[d].l(y);a=S(y);for(let d=0;d<l.length;d+=1)l[d].l(y);c=Ce()},m(y,d){for(let E=0;E<e.length;E+=1)e[E]&&e[E].m(y,d);w(y,n,d);for(let E=0;E<s.length;E+=1)s[E]&&s[E].m(y,d);w(y,a,d);for(let E=0;E<l.length;E+=1)l[E]&&l[E].m(y,d);w(y,c,d),u=!0},p(y,d){d&2&&(h=be(y[1].links),Se(),e=fn(e,d,f,1,y,h,t,n.parentNode,dn,sr,n,rr),De()),d&2&&(m=be(y[1].routers),Se(),s=fn(s,d,g,1,y,m,i,a.parentNode,dn,ir,a,nr),De()),d&2&&(k=be(y[1].packets),Se(),l=fn(l,d,v,1,y,k,o,c.parentNode,dn,ar,c,tr),De())},i(y){if(!u){for(let d=0;d<h.length;d+=1)O(e[d]);for(let d=0;d<m.length;d+=1)O(s[d]);for(let d=0;d<k.length;d+=1)O(l[d]);u=!0}},o(y){for(let d=0;d<e.length;d+=1)H(e[d]);for(let d=0;d<s.length;d+=1)H(s[d]);for(let d=0;d<l.length;d+=1)H(l[d]);u=!1},d(y){y&&(p(n),p(a),p(c));for(let d=0;d<e.length;d+=1)e[d].d(y);for(let d=0;d<s.length;d+=1)s[d].d(y);for(let d=0;d<l.length;d+=1)l[d].d(y)}}}function ca(r){let e,t,n,s,i,a,l,o,c,u,h,f,m,g,k,v,y,d,E;function B(L){r[2](L)}let R={$$slots:{default:[ua]},$$scope:{ctx:r}};r[0]!==void 0&&(R.zoom=r[0]),n=new xi({props:R}),Oe.push(()=>Fe(n,"zoom",B)),l=new Ji({}),u=new ta({}),f=new oa({});function Z(L){r[3](L)}let N={};return r[0]!==void 0&&(N.zoom=r[0]),k=new sa({props:N}),Oe.push(()=>Fe(k,"zoom",Z)),d=new Di({}),{c(){e=C("div"),t=C("div"),ee(n.$$.fragment),i=P(),a=C("div"),ee(l.$$.fragment),o=P(),c=C("div"),ee(u.$$.fragment),h=P(),ee(f.$$.fragment),m=P(),g=C("div"),ee(k.$$.fragment),y=P(),ee(d.$$.fragment),this.h()},l(L){e=$(L,"DIV",{id:!0,class:!0});var Y=M(e);t=$(Y,"DIV",{id:!0,class:!0});var A=M(t);te(n.$$.fragment,A),i=S(A),a=$(A,"DIV",{id:!0,class:!0});var x=M(a);te(l.$$.fragment,x),x.forEach(p),o=S(A),c=$(A,"DIV",{id:!0,class:!0});var V=M(c);te(u.$$.fragment,V),h=S(V),te(f.$$.fragment,V),V.forEach(p),m=S(A),g=$(A,"DIV",{id:!0,class:!0});var I=M(g);te(k.$$.fragment,I),I.forEach(p),A.forEach(p),y=S(Y),te(d.$$.fragment,Y),Y.forEach(p),this.h()},h(){b(a,"id","top-left-bar"),b(a,"class","absolute-flex svelte-1kpnzxr"),b(c,"id","bottom-left-bar"),b(c,"class","absolute-flex svelte-1kpnzxr"),b(g,"id","bottom-right-bar"),b(g,"class","absolute-flex svelte-1kpnzxr"),b(t,"id","network"),b(t,"class","svelte-1kpnzxr"),b(e,"id","mpls"),b(e,"class","svelte-1kpnzxr")},m(L,Y){w(L,e,Y),T(e,t),ne(n,t,null),T(t,i),T(t,a),ne(l,a,null),T(t,o),T(t,c),ne(u,c,null),T(c,h),ne(f,c,null),T(t,m),T(t,g),ne(k,g,null),T(e,y),ne(d,e,null),E=!0},p(L,[Y]){const A={};Y&16386&&(A.$$scope={dirty:Y,ctx:L}),!s&&Y&1&&(s=!0,A.zoom=L[0],Ve(()=>s=!1)),n.$set(A);const x={};!v&&Y&1&&(v=!0,x.zoom=L[0],Ve(()=>v=!1)),k.$set(x)},i(L){E||(O(n.$$.fragment,L),O(l.$$.fragment,L),O(u.$$.fragment,L),O(f.$$.fragment,L),O(k.$$.fragment,L),O(d.$$.fragment,L),E=!0)},o(L){H(n.$$.fragment,L),H(l.$$.fragment,L),H(u.$$.fragment,L),H(f.$$.fragment,L),H(k.$$.fragment,L),H(d.$$.fragment,L),E=!1},d(L){L&&p(e),re(n),re(l),re(u),re(f),re(k),re(d)}}}function da(r,e,t){let n,s;je(r,Ge,o=>t(4,n=o)),je(r,W,o=>t(1,s=o));let i;pr(()=>{window.addEventListener("visibilitychanged",()=>{qe(Ge,n.running=!document.hidden,n)})}),qs();function a(o){i=o,t(0,i)}function l(o){i=o,t(0,i)}return[i,s,a,l]}class fa extends Te{constructor(e){super(),Re(this,e,da,ca,$e,{})}}function ha(r){let e,t;return e=new fa({}),{c(){ee(e.$$.fragment)},l(n){te(e.$$.fragment,n)},m(n,s){ne(e,n,s),t=!0},p:Ie,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){re(e,n)}}}class xa extends Te{constructor(e){super(),Re(this,e,null,ha,$e,{})}}export{xa as component};
