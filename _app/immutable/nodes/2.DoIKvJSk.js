var Rr=Object.defineProperty;var Tr=(r,e,t)=>e in r?Rr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ce=(r,e,t)=>(Tr(r,typeof e!="symbol"?e+"":e,t),t);import{r as xt,x as dr,s as Ie,i as fr,n as Pe,a as hr,u as pr,g as mr,b as gr,y as _r,e as Oe,z as Ue,o as wn,A as Yt,c as je,B as We}from"../chunks/scheduler.CY_Sai-S.js";import{n as Z,m as D,S as $e,i as Le,e as E,t as ve,c as C,a as M,b as ke,d as f,l as v,g as k,h as $,z as he,j as Ye,A as qe,v as Q,w as ee,x as te,y as ne,s as T,B as le,f as P,r as Se,p as Be,C as ut,q as ct,D as Ne,E as et,o as Re,F as ot,G as lt,H as Pr,I as $n}from"../chunks/index.B338ho9k.js";import{w as cn}from"../chunks/index.DXlJru-X.js";function we(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function hn(r,e){Z(r,1,1,()=>{e.delete(r.key)})}function pn(r,e,t,n,s,i,a,o,l,c,u,d){let h=r.length,y=i.length,b=h;const g={};for(;b--;)g[r[b].key]=b;const _=[],m=new Map,p=new Map,I=[];for(b=y;b--;){const N=d(s,i,b),z=t(N);let G=a.get(z);G?n&&I.push(()=>G.p(N,e)):(G=c(z,N),G.c()),m.set(z,_[b]=G),z in g&&p.set(z,Math.abs(b-g[z]))}const H=new Set,L=new Set;function j(N){D(N,1),N.m(o,u),a.set(N.key,N),u=N.first,y--}for(;h&&y;){const N=_[y-1],z=r[h-1],G=N.key,S=z.key;N===z?(u=N.first,h--,y--):m.has(S)?!a.has(G)||H.has(G)?j(N):L.has(S)?h--:p.get(G)>p.get(S)?(L.add(G),j(N)):(H.add(S),h--):(l(z,a),h--)}for(;h--;){const N=r[h];m.has(N.key)||l(N,a)}for(;y;)j(_[y-1]);return xt(I),_}function Wt(r,e){const t={},n={},s={$$scope:1};let i=r.length;for(;i--;){const a=r[i],o=e[i];if(o){for(const l in a)l in o||(n[l]=1);for(const l in o)s[l]||(t[l]=o[l],s[l]=1);r[i]=o}else for(const l in a)s[l]=1}for(const a in n)a in t||(t[a]=void 0);return t}function Gt(r){return typeof r=="object"&&r!==null?r:{}}const Ge=cn({running:!0,enableFallback:!1,speedMultiplier:1,maxPackets:100});let Nr=class{constructor(e,t,n){ce(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},En=class{constructor(e,t){this.id=e,this.node=t}};class ze extends En{constructor(){super(...arguments);ce(this,"address",`CE-IP-${this.id}`);ce(this,"firstHop",new Map);ce(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});ce(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});ce(this,"updateAddress",(t,n)=>{const s=this.firstHop.get(t);if(s===void 0){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,s),this.firstHop.delete(t)});ce(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop("CE received packet. Dropping.")}clearTables(){this.firstHop.clear()}get type(){return"CE"}}let Sr=class{constructor(e=void 0){ce(this,"map");ce(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});ce(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});ce(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(n===void 0){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});ce(this,"deleteEntry",e=>{this.map.delete(e)});this.map=e||new Map}get(e){return this.map.get(e)}},br=class{constructor(){ce(this,"map",new Map);ce(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});ce(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});ce(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LFIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});ce(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class Ke extends En{constructor(){super(...arguments);ce(this,"FIB",new Sr);ce(this,"LFIB",new br)}receivePacket(t){var n,s,i,a;if(t.fallbackRoute)return t.fallback(this);if(t.label===-1){const o=t.destination,l=(n=this.FIB.get(o.address))==null?void 0:n.nextHop;if(!l)return t.fallback(this);const c=(s=this.FIB.get(o.address))==null?void 0:s.label;if(!c)return t.fallback(this);t.label=c;const u=Y.getRouter(parseInt(l));if(!u)return t.fallback(this);t.nextHop=u}else{const o=(i=this.LFIB.get(t.label))==null?void 0:i.nextHop;if(!o)return t.fallback(this);const l=(a=this.LFIB.get(t.label))==null?void 0:a.outgoingLabel;if(!l)return t.fallback(this);t.label=l;const c=Y.getCERouter(o);if(!c)return t.fallback(this);t.nextHop=c}t.decrementTTL()}clearTables(){this.FIB.map.clear(),this.LFIB.map.clear()}get type(){return"LER"}}function Cn(r,e){const t=Y.routers,n=t.length,s=new Array(n).fill(1/0),i=new Array(n).fill(!1),a=new Array(n).fill(null);s[t.indexOf(r)]=0;let o=!1,l=!1;for(;!o;){let d=null,h=1/0;for(const[y,b]of t.entries())if(!i[y]&&s[y]<h){if(b instanceof Ke){if(!l)l=!0;else if(!Y.links.some(_=>_.source===b&&_.target===e||_.target===b&&_.source===e))continue}d=b,h=s[y]}if(!d||d.id===e.id){o=!0;continue}i[t.indexOf(d)]=!0;for(const y of Y.links){let b;if(y.source===d)b=y.target;else if(y.target===d)b=y.source;else continue;const g=t.indexOf(b),_=h+y.distance;_<s[g]&&(s[g]=_,a[g]=d)}}const c=[];let u=e;for(;u;){c.unshift(u);const d=t.indexOf(u);u=a[d]}return c}let Br=class{constructor(e,t,n,s){ce(this,"ttl",32);ce(this,"label",-1);ce(this,"fallbackRoute");ce(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=s;const i=t.firstHop.get(n.address);if(!i){this.drop("No next hop router id found.");return}const a=Y.getRouter(i);if(!a){this.drop("No next hop router found.");return}this.nextHop=a}decrementTTL(){--this.ttl<=0&&this.drop()}fallback(e){if(!dr(Ge).enableFallback)return this.drop("Fallback is disabled.");if(this.label=-1,this.decrementTTL(),this.fallbackRoute)return this.setFallbackNextHop();if(this.fallbackRoute=Cn(e,this.destination),!(this.fallbackRoute[this.fallbackRoute.length-1]instanceof ze))return this.drop("The destination is not a CE.");this.fallbackRoute.shift(),this.setFallbackNextHop()}validateNextHop(e){return Y.doesLinkExist({source:e,target:this.nextHop})||Y.doesLinkExist({source:this.nextHop,target:e})}setFallbackNextHop(){var t;const e=(t=this.fallbackRoute)==null?void 0:t.shift();this.fallbackRoute&&e?this.nextHop=e:this.drop("Unable to set fallback IP routing next hop")}drop(e="Unknown"){console.warn("Packet dropped: ",e),Y.deletePacket(this.id)}};class Ct extends En{constructor(){super(...arguments);ce(this,"LFIB",new br)}receivePacket(t){var a,o;if(t.fallbackRoute)return t.fallback(this);const n=(a=this.LFIB.get(t.label))==null?void 0:a.nextHop;if(!n)return t.fallback(this);const s=(o=this.LFIB.get(t.label))==null?void 0:o.outgoingLabel;if(!s)return t.fallback(this);t.label=s;const i=Y.getRouter(parseInt(n));if(!i)return t.fallback(this);t.nextHop=i,t.decrementTTL()}clearTables(){this.LFIB.map.clear()}get type(){return"LSR"}}const Dr={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class Hr{constructor(){ce(this,"store",cn({routers:[],links:[],packets:[]}));ce(this,"set",this.store.set);ce(this,"update",this.store.update);ce(this,"subscribe",this.store.subscribe);ce(this,"_routers",[]);ce(this,"_links",[]);ce(this,"_packets",[]);ce(this,"routerMap",new Map);ce(this,"CEMap",new Map);ce(this,"routerCounter",1);ce(this,"packetCounter",1);ce(this,"maxPackets",dr(Ge).maxPackets);ce(this,"setRouterCount",e=>this.routerCounter=e);Ge.subscribe(e=>{this.maxPackets=e.maxPackets,this._packets=this._packets.slice(-this.maxPackets),this.notify()})}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!Dr[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new Nr(`${e.source.id}-${e.target.id}`,e.source,e.target);e.bandwidth!==void 0&&(t.bandwidth=e.bandwidth),this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,s=new ze(n,{label:`CE ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}createLER(e,t){const n=this.routerCounter++,s=new Ke(n,{label:`LER ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}createLSR(e,t){const n=this.routerCounter++,s=new Ct(n,{label:`LSR ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(s)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof ze&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof ze&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){if(this._packets.length>=this.maxPackets)return;const n=new Br(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearTables(){for(const e of this._routers)e.clearTables();this.notify()}clearLinks(){this._links=[],this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=1,this.packetCounter=1,this.notify()}notify(){this.store.set(this.networkState)}}const Or=new Hr,Y=Or;var pe;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return r.objectValues(a)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},r.find=(s,i)=>{for(const a of s)if(i(a))return a},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(pe||(pe={}));var yn;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(yn||(yn={}));const U=pe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),_t=r=>{switch(typeof r){case"undefined":return U.undefined;case"string":return U.string;case"number":return isNaN(r)?U.nan:U.number;case"boolean":return U.boolean;case"function":return U.function;case"bigint":return U.bigint;case"symbol":return U.symbol;case"object":return Array.isArray(r)?U.array:r===null?U.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?U.promise:typeof Map<"u"&&r instanceof Map?U.map:typeof Set<"u"&&r instanceof Set?U.set:typeof Date<"u"&&r instanceof Date?U.date:U.object;default:return U.unknown}},O=pe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),jr=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class rt extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)n._errors.push(t(a));else{let o=n,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,pe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}rt.create=r=>new rt(r);const Dt=(r,e)=>{let t;switch(r.code){case O.invalid_type:r.received===U.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case O.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,pe.jsonStringifyReplacer)}`;break;case O.unrecognized_keys:t=`Unrecognized key(s) in object: ${pe.joinValues(r.keys,", ")}`;break;case O.invalid_union:t="Invalid input";break;case O.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${pe.joinValues(r.options)}`;break;case O.invalid_enum_value:t=`Invalid enum value. Expected ${pe.joinValues(r.options)}, received '${r.received}'`;break;case O.invalid_arguments:t="Invalid function arguments";break;case O.invalid_return_type:t="Invalid function return type";break;case O.invalid_date:t="Invalid date";break;case O.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:pe.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case O.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case O.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case O.custom:t="Invalid input";break;case O.invalid_intersection_types:t="Intersection results could not be merged";break;case O.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case O.not_finite:t="Number must be finite";break;default:t=e.defaultError,pe.assertNever(r)}return{message:t}};let yr=Dt;function Zr(r){yr=r}function en(){return yr}const tn=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],a={...s,path:i};let o="";const l=n.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...s,path:i,message:s.message||o}},Ar=[];function q(r,e){const t=tn({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,en(),Dt].filter(n=>!!n)});r.common.issues.push(t)}class Me{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return re;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t)n.push({key:await s.key,value:await s.value});return Me.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return re;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(n[i.value]=a.value)}return{status:e.value,value:n}}}const re=Object.freeze({status:"aborted"}),vr=r=>({status:"dirty",value:r}),Ve=r=>({status:"valid",value:r}),vn=r=>r.status==="aborted",kn=r=>r.status==="dirty",Ht=r=>r.status==="valid",nn=r=>typeof Promise<"u"&&r instanceof Promise;var W;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(W||(W={}));class dt{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ln=(r,e)=>{if(Ht(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new rt(r.common.issues);return this._error=t,this._error}}};function ae(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>a.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:n??o.defaultError}:{message:t??o.defaultError},description:s}}class ue{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return _t(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:_t(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Me,ctx:{common:e.parent.common,data:e.data,parsedType:_t(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(nn(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_t(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Ln(s,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_t(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(nn(s)?s:Promise.resolve(s));return Ln(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:O.custom,...n(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new it({schema:this,typeName:J.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ht.create(this,this._def)}nullable(){return Lt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return st.create(this,this._def)}promise(){return Bt.create(this,this._def)}or(e){return At.create([this,e],this._def)}and(e){return Mt.create(this,e,this._def)}transform(e){return new it({...ae(this._def),schema:this,typeName:J.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new qt({...ae(this._def),innerType:this,defaultValue:t,typeName:J.ZodDefault})}brand(){return new xr({typeName:J.ZodBranded,type:this,...ae(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new on({...ae(this._def),innerType:this,catchValue:t,typeName:J.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Xt.create(this,e)}readonly(){return un.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Mr=/^c[^\s-]{8,}$/i,Fr=/^[a-z][a-z0-9]*$/,zr=/^[0-9A-HJKMNP-TV-Z]{26}$/,Vr=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ur=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,qr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let mn;const Yr=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Wr=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Gr=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Xr(r,e){return!!((e==="v4"||!e)&&Yr.test(r)||(e==="v6"||!e)&&Wr.test(r))}class nt extends ue{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==U.string){const i=this._getOrReturnCtx(e);return q(i,{code:O.invalid_type,expected:U.string,received:i.parsedType}),re}const n=new Me;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:O.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:O.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?q(s,{code:O.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&q(s,{code:O.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Ur.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"email",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")mn||(mn=new RegExp(qr,"u")),mn.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"emoji",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Vr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"uuid",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Mr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"cuid",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Fr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"cuid2",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")zr.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"ulid",code:O.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),q(s,{validation:"url",code:O.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"regex",code:O.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),q(s,{code:O.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),q(s,{code:O.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),q(s,{code:O.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Gr(i).test(e.data)||(s=this._getOrReturnCtx(e,s),q(s,{code:O.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?Xr(e.data,i.version)||(s=this._getOrReturnCtx(e,s),q(s,{validation:"ip",code:O.invalid_string,message:i.message}),n.dirty()):pe.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:O.invalid_string,...W.errToObj(n)})}_addCheck(e){return new nt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...W.errToObj(e)})}url(e){return this._addCheck({kind:"url",...W.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...W.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...W.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...W.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...W.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...W.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...W.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...W.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...W.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...W.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...W.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...W.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...W.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...W.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...W.errToObj(t)})}nonempty(e){return this.min(1,W.errToObj(e))}trim(){return new nt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new nt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new nt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}nt.create=r=>{var e;return new nt({checks:[],typeName:J.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...ae(r)})};function Jr(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class bt extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==U.number){const i=this._getOrReturnCtx(e);return q(i,{code:O.invalid_type,expected:U.number,received:i.parsedType}),re}let n;const s=new Me;for(const i of this._def.checks)i.kind==="int"?pe.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),q(n,{code:O.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Jr(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),q(n,{code:O.not_finite,message:i.message}),s.dirty()):pe.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,W.toString(t))}gt(e,t){return this.setLimit("min",e,!1,W.toString(t))}lte(e,t){return this.setLimit("max",e,!0,W.toString(t))}lt(e,t){return this.setLimit("max",e,!1,W.toString(t))}setLimit(e,t,n,s){return new bt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:W.toString(s)}]})}_addCheck(e){return new bt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:W.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:W.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:W.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:W.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:W.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:W.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:W.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:W.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:W.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&pe.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}bt.create=r=>new bt({checks:[],typeName:J.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...ae(r)});class yt extends ue{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==U.bigint){const i=this._getOrReturnCtx(e);return q(i,{code:O.invalid_type,expected:U.bigint,received:i.parsedType}),re}let n;const s=new Me;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),q(n,{code:O.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):pe.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,W.toString(t))}gt(e,t){return this.setLimit("min",e,!1,W.toString(t))}lte(e,t){return this.setLimit("max",e,!0,W.toString(t))}lt(e,t){return this.setLimit("max",e,!1,W.toString(t))}setLimit(e,t,n,s){return new yt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:W.toString(s)}]})}_addCheck(e){return new yt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:W.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:W.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:W.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:W.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:W.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}yt.create=r=>{var e;return new yt({checks:[],typeName:J.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...ae(r)})};class Ot extends ue{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==U.boolean){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.boolean,received:n.parsedType}),re}return Ve(e.data)}}Ot.create=r=>new Ot({typeName:J.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...ae(r)});class It extends ue{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==U.date){const i=this._getOrReturnCtx(e);return q(i,{code:O.invalid_type,expected:U.date,received:i.parsedType}),re}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return q(i,{code:O.invalid_date}),re}const n=new Me;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:O.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),q(s,{code:O.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):pe.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new It({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:W.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:W.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}It.create=r=>new It({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:J.ZodDate,...ae(r)});class rn extends ue{_parse(e){if(this._getType(e)!==U.symbol){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.symbol,received:n.parsedType}),re}return Ve(e.data)}}rn.create=r=>new rn({typeName:J.ZodSymbol,...ae(r)});class jt extends ue{_parse(e){if(this._getType(e)!==U.undefined){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.undefined,received:n.parsedType}),re}return Ve(e.data)}}jt.create=r=>new jt({typeName:J.ZodUndefined,...ae(r)});class Zt extends ue{_parse(e){if(this._getType(e)!==U.null){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.null,received:n.parsedType}),re}return Ve(e.data)}}Zt.create=r=>new Zt({typeName:J.ZodNull,...ae(r)});class St extends ue{constructor(){super(...arguments),this._any=!0}_parse(e){return Ve(e.data)}}St.create=r=>new St({typeName:J.ZodAny,...ae(r)});class Et extends ue{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ve(e.data)}}Et.create=r=>new Et({typeName:J.ZodUnknown,...ae(r)});class pt extends ue{_parse(e){const t=this._getOrReturnCtx(e);return q(t,{code:O.invalid_type,expected:U.never,received:t.parsedType}),re}}pt.create=r=>new pt({typeName:J.ZodNever,...ae(r)});class sn extends ue{_parse(e){if(this._getType(e)!==U.undefined){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.void,received:n.parsedType}),re}return Ve(e.data)}}sn.create=r=>new sn({typeName:J.ZodVoid,...ae(r)});class st extends ue{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==U.array)return q(t,{code:O.invalid_type,expected:U.array,received:t.parsedType}),re;if(s.exactLength!==null){const a=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(a||o)&&(q(t,{code:a?O.too_big:O.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(q(t,{code:O.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(q(t,{code:O.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>s.type._parseAsync(new dt(t,a,t.path,o)))).then(a=>Me.mergeArray(n,a));const i=[...t.data].map((a,o)=>s.type._parseSync(new dt(t,a,t.path,o)));return Me.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new st({...this._def,minLength:{value:e,message:W.toString(t)}})}max(e,t){return new st({...this._def,maxLength:{value:e,message:W.toString(t)}})}length(e,t){return new st({...this._def,exactLength:{value:e,message:W.toString(t)}})}nonempty(e){return this.min(1,e)}}st.create=(r,e)=>new st({type:r,minLength:null,maxLength:null,exactLength:null,typeName:J.ZodArray,...ae(e)});function Pt(r){if(r instanceof Ce){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=ht.create(Pt(n))}return new Ce({...r._def,shape:()=>e})}else return r instanceof st?new st({...r._def,type:Pt(r.element)}):r instanceof ht?ht.create(Pt(r.unwrap())):r instanceof Lt?Lt.create(Pt(r.unwrap())):r instanceof ft?ft.create(r.items.map(e=>Pt(e))):r}class Ce extends ue{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=pe.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==U.object){const c=this._getOrReturnCtx(e);return q(c,{code:O.invalid_type,expected:U.object,received:c.parsedType}),re}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof pt&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new dt(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof pt){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(q(s,{code:O.unrecognized_keys,keys:o}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new dt(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key;c.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return c}).then(c=>Me.mergeObjectSync(n,c)):Me.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return W.errToObj,new Ce({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,a,o;const l=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&a!==void 0?a:n.defaultError;return t.code==="unrecognized_keys"?{message:(o=W.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new Ce({...this._def,unknownKeys:"strip"})}passthrough(){return new Ce({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ce({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ce({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:J.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ce({...this._def,catchall:e})}pick(e){const t={};return pe.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new Ce({...this._def,shape:()=>t})}omit(e){const t={};return pe.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new Ce({...this._def,shape:()=>t})}deepPartial(){return Pt(this)}partial(e){const t={};return pe.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new Ce({...this._def,shape:()=>t})}required(e){const t={};return pe.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof ht;)i=i._def.innerType;t[n]=i}}),new Ce({...this._def,shape:()=>t})}keyof(){return kr(pe.objectKeys(this.shape))}}Ce.create=(r,e)=>new Ce({shape:()=>r,unknownKeys:"strip",catchall:pt.create(),typeName:J.ZodObject,...ae(e)});Ce.strictCreate=(r,e)=>new Ce({shape:()=>r,unknownKeys:"strict",catchall:pt.create(),typeName:J.ZodObject,...ae(e)});Ce.lazycreate=(r,e)=>new Ce({shape:r,unknownKeys:"strip",catchall:pt.create(),typeName:J.ZodObject,...ae(e)});class At extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new rt(o.ctx.common.issues));return q(t,{code:O.invalid_union,unionErrors:a}),re}if(t.common.async)return Promise.all(n.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of n){const c={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new rt(l));return q(t,{code:O.invalid_union,unionErrors:o}),re}}get options(){return this._def.options}}At.create=(r,e)=>new At({options:r,typeName:J.ZodUnion,...ae(e)});const Qt=r=>r instanceof zt?Qt(r.schema):r instanceof it?Qt(r.innerType()):r instanceof Vt?[r.value]:r instanceof vt?r.options:r instanceof Ut?Object.keys(r.enum):r instanceof qt?Qt(r._def.innerType):r instanceof jt?[void 0]:r instanceof Zt?[null]:null;class dn extends ue{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.object)return q(t,{code:O.invalid_type,expected:U.object,received:t.parsedType}),re;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(q(t,{code:O.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const a=Qt(i.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new dn({typeName:J.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...ae(n)})}}function xn(r,e){const t=_t(r),n=_t(e);if(r===e)return{valid:!0,data:r};if(t===U.object&&n===U.object){const s=pe.objectKeys(e),i=pe.objectKeys(r).filter(o=>s.indexOf(o)!==-1),a={...r,...e};for(const o of i){const l=xn(r[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===U.array&&n===U.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const a=r[i],o=e[i],l=xn(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return t===U.date&&n===U.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Mt extends ue{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,a)=>{if(vn(i)||vn(a))return re;const o=xn(i.value,a.value);return o.valid?((kn(i)||kn(a))&&t.dirty(),{status:t.value,value:o.data}):(q(n,{code:O.invalid_intersection_types}),re)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Mt.create=(r,e,t)=>new Mt({left:r,right:e,typeName:J.ZodIntersection,...ae(t)});class ft extends ue{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.array)return q(n,{code:O.invalid_type,expected:U.array,received:n.parsedType}),re;if(n.data.length<this._def.items.length)return q(n,{code:O.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),re;!this._def.rest&&n.data.length>this._def.items.length&&(q(n,{code:O.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new dt(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(i).then(a=>Me.mergeArray(t,a)):Me.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ft({...this._def,rest:e})}}ft.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ft({items:r,typeName:J.ZodTuple,rest:null,...ae(e)})};class Ft extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.object)return q(n,{code:O.invalid_type,expected:U.object,received:n.parsedType}),re;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new dt(n,o,n.path,o)),value:a._parse(new dt(n,n.data[o],n.path,o))});return n.common.async?Me.mergeObjectAsync(t,s):Me.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof ue?new Ft({keyType:e,valueType:t,typeName:J.ZodRecord,...ae(n)}):new Ft({keyType:nt.create(),valueType:e,typeName:J.ZodRecord,...ae(t)})}}class an extends ue{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.map)return q(n,{code:O.invalid_type,expected:U.map,received:n.parsedType}),re;const s=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,l],c)=>({key:s._parse(new dt(n,o,n.path,[c,"key"])),value:i._parse(new dt(n,l,n.path,[c,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return re;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return re;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(c.value,u.value)}return{status:t.value,value:o}}}}an.create=(r,e,t)=>new an({valueType:e,keyType:r,typeName:J.ZodMap,...ae(t)});class $t extends ue{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==U.set)return q(n,{code:O.invalid_type,expected:U.set,received:n.parsedType}),re;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(q(n,{code:O.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(q(n,{code:O.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return re;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}const o=[...n.data.values()].map((l,c)=>i._parse(new dt(n,l,n.path,c)));return n.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new $t({...this._def,minSize:{value:e,message:W.toString(t)}})}max(e,t){return new $t({...this._def,maxSize:{value:e,message:W.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}$t.create=(r,e)=>new $t({valueType:r,minSize:null,maxSize:null,typeName:J.ZodSet,...ae(e)});class Nt extends ue{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.function)return q(t,{code:O.invalid_type,expected:U.function,received:t.parsedType}),re;function n(o,l){return tn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,en(),Dt].filter(c=>!!c),issueData:{code:O.invalid_arguments,argumentsError:l}})}function s(o,l){return tn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,en(),Dt].filter(c=>!!c),issueData:{code:O.invalid_return_type,returnTypeError:l}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Bt){const o=this;return Ve(async function(...l){const c=new rt([]),u=await o._def.args.parseAsync(l,i).catch(y=>{throw c.addIssue(n(l,y)),c}),d=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(d,i).catch(y=>{throw c.addIssue(s(d,y)),c})})}else{const o=this;return Ve(function(...l){const c=o._def.args.safeParse(l,i);if(!c.success)throw new rt([n(l,c.error)]);const u=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(u,i);if(!d.success)throw new rt([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Nt({...this._def,args:ft.create(e).rest(Et.create())})}returns(e){return new Nt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Nt({args:e||ft.create([]).rest(Et.create()),returns:t||Et.create(),typeName:J.ZodFunction,...ae(n)})}}class zt extends ue{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}zt.create=(r,e)=>new zt({getter:r,typeName:J.ZodLazy,...ae(e)});class Vt extends ue{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return q(t,{received:t.data,code:O.invalid_literal,expected:this._def.value}),re}return{status:"valid",value:e.data}}get value(){return this._def.value}}Vt.create=(r,e)=>new Vt({value:r,typeName:J.ZodLiteral,...ae(e)});function kr(r,e){return new vt({values:r,typeName:J.ZodEnum,...ae(e)})}class vt extends ue{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return q(t,{expected:pe.joinValues(n),received:t.parsedType,code:O.invalid_type}),re}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return q(t,{received:t.data,code:O.invalid_enum_value,options:n}),re}return Ve(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return vt.create(e)}exclude(e){return vt.create(this.options.filter(t=>!e.includes(t)))}}vt.create=kr;class Ut extends ue{_parse(e){const t=pe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==U.string&&n.parsedType!==U.number){const s=pe.objectValues(t);return q(n,{expected:pe.joinValues(s),received:n.parsedType,code:O.invalid_type}),re}if(t.indexOf(e.data)===-1){const s=pe.objectValues(t);return q(n,{received:n.data,code:O.invalid_enum_value,options:s}),re}return Ve(e.data)}get enum(){return this._def.values}}Ut.create=(r,e)=>new Ut({values:r,typeName:J.ZodNativeEnum,...ae(e)});class Bt extends ue{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.promise&&t.common.async===!1)return q(t,{code:O.invalid_type,expected:U.promise,received:t.parsedType}),re;const n=t.parsedType===U.promise?t.data:Promise.resolve(t.data);return Ve(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Bt.create=(r,e)=>new Bt({type:r,typeName:J.ZodPromise,...ae(e)});class it extends ue{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===J.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{q(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(a).then(o=>this._def.schema._parseAsync({data:o,path:n.path,parent:n})):this._def.schema._parseSync({data:a,path:n.path,parent:n})}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?re:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?re:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ht(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Ht(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);pe.assertNever(s)}}it.create=(r,e,t)=>new it({schema:r,typeName:J.ZodEffects,effect:e,...ae(t)});it.createWithPreprocess=(r,e,t)=>new it({schema:e,effect:{type:"preprocess",transform:r},typeName:J.ZodEffects,...ae(t)});class ht extends ue{_parse(e){return this._getType(e)===U.undefined?Ve(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ht.create=(r,e)=>new ht({innerType:r,typeName:J.ZodOptional,...ae(e)});class Lt extends ue{_parse(e){return this._getType(e)===U.null?Ve(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Lt.create=(r,e)=>new Lt({innerType:r,typeName:J.ZodNullable,...ae(e)});class qt extends ue{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===U.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}qt.create=(r,e)=>new qt({innerType:r,typeName:J.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ae(e)});class on extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return nn(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new rt(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new rt(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}on.create=(r,e)=>new on({innerType:r,typeName:J.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ae(e)});class ln extends ue{_parse(e){if(this._getType(e)!==U.nan){const n=this._getOrReturnCtx(e);return q(n,{code:O.invalid_type,expected:U.nan,received:n.parsedType}),re}return{status:"valid",value:e.data}}}ln.create=r=>new ln({typeName:J.ZodNaN,...ae(r)});const Kr=Symbol("zod_brand");class xr extends ue{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Xt extends ue{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?re:i.status==="dirty"?(t.dirty(),vr(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?re:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new Xt({in:e,out:t,typeName:J.ZodPipeline})}}class un extends ue{_parse(e){const t=this._def.innerType._parse(e);return Ht(t)&&(t.value=Object.freeze(t.value)),t}}un.create=(r,e)=>new un({innerType:r,typeName:J.ZodReadonly,...ae(e)});const wr=(r,e={},t)=>r?St.create().superRefine((n,s)=>{var i,a;if(!r(n)){const o=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,l=(a=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,c=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...c,fatal:l})}}):St.create(),Qr={object:Ce.lazycreate};var J;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(J||(J={}));const es=(r,e={message:`Input not instance of ${r.name}`})=>wr(t=>t instanceof r,e),Er=nt.create,Cr=bt.create,ts=ln.create,ns=yt.create,Ir=Ot.create,rs=It.create,ss=rn.create,is=jt.create,as=Zt.create,os=St.create,ls=Et.create,us=pt.create,cs=sn.create,ds=st.create,fs=Ce.create,hs=Ce.strictCreate,ps=At.create,ms=dn.create,gs=Mt.create,_s=ft.create,bs=Ft.create,ys=an.create,vs=$t.create,ks=Nt.create,xs=zt.create,ws=Vt.create,Es=vt.create,Cs=Ut.create,Is=Bt.create,Rn=it.create,$s=ht.create,Ls=Lt.create,Rs=it.createWithPreprocess,Ts=Xt.create,Ps=()=>Er().optional(),Ns=()=>Cr().optional(),Ss=()=>Ir().optional(),Bs={string:r=>nt.create({...r,coerce:!0}),number:r=>bt.create({...r,coerce:!0}),boolean:r=>Ot.create({...r,coerce:!0}),bigint:r=>yt.create({...r,coerce:!0}),date:r=>It.create({...r,coerce:!0})},Ds=re;var de=Object.freeze({__proto__:null,defaultErrorMap:Dt,setErrorMap:Zr,getErrorMap:en,makeIssue:tn,EMPTY_PATH:Ar,addIssueToContext:q,ParseStatus:Me,INVALID:re,DIRTY:vr,OK:Ve,isAborted:vn,isDirty:kn,isValid:Ht,isAsync:nn,get util(){return pe},get objectUtil(){return yn},ZodParsedType:U,getParsedType:_t,ZodType:ue,ZodString:nt,ZodNumber:bt,ZodBigInt:yt,ZodBoolean:Ot,ZodDate:It,ZodSymbol:rn,ZodUndefined:jt,ZodNull:Zt,ZodAny:St,ZodUnknown:Et,ZodNever:pt,ZodVoid:sn,ZodArray:st,ZodObject:Ce,ZodUnion:At,ZodDiscriminatedUnion:dn,ZodIntersection:Mt,ZodTuple:ft,ZodRecord:Ft,ZodMap:an,ZodSet:$t,ZodFunction:Nt,ZodLazy:zt,ZodLiteral:Vt,ZodEnum:vt,ZodNativeEnum:Ut,ZodPromise:Bt,ZodEffects:it,ZodTransformer:it,ZodOptional:ht,ZodNullable:Lt,ZodDefault:qt,ZodCatch:on,ZodNaN:ln,BRAND:Kr,ZodBranded:xr,ZodPipeline:Xt,ZodReadonly:un,custom:wr,Schema:ue,ZodSchema:ue,late:Qr,get ZodFirstPartyTypeKind(){return J},coerce:Bs,any:os,array:ds,bigint:ns,boolean:Ir,date:rs,discriminatedUnion:ms,effect:Rn,enum:Es,function:ks,instanceof:es,intersection:gs,lazy:xs,literal:ws,map:ys,nan:ts,nativeEnum:Cs,never:us,null:as,nullable:Ls,number:Cr,object:fs,oboolean:Ss,onumber:Ns,optional:$s,ostring:Ps,pipeline:Ts,preprocess:Rs,promise:Is,record:bs,set:vs,strictObject:hs,string:Er,symbol:ss,transformer:Rn,tuple:_s,undefined:is,union:ps,unknown:ls,void:cs,NEVER:Ds,ZodIssueCode:O,quotelessJson:jr,ZodError:rt});const Hs=de.object({label:de.string(),x:de.number(),y:de.number()}),$r=de.record(de.coerce.number(),de.object({outgoingLabel:de.number(),nextHop:de.string()})),Os=de.record(de.string(),de.object({label:de.number(),nextHop:de.string()})),js=de.record(de.number()),Zs=de.object({address:de.string(),firstHop:js.or(de.object({})),type:de.literal("CE")}),As=de.object({LFIB:$r.or(de.object({})),FIB:Os.or(de.object({})),type:de.literal("LER")}),Ms=de.object({LFIB:$r.or(de.object({})),type:de.literal("LSR")}),Fs=de.object({id:de.number(),node:Hs}).and(de.union([Zs,As,Ms])),zs=de.object({id:de.string(),source:de.number(),target:de.number(),bandwidth:de.number()}),Vs=de.object({routers:de.array(Fs),links:de.array(zs)});function gn(r){Y.clear();const e=Vs.safeParse(r);if(!e.success)return console.warn("Failed to load network data",e.error),!1;let t=0;for(const n of e.data.routers)switch(t=Math.max(t,n.id),n.type){case"LER":{const s=new Ke(n.id,n.node);Object.entries(n.LFIB).forEach(([i,a])=>{s.LFIB.receiveEntry(parseInt(i),a.outgoingLabel,a.nextHop)}),Object.entries(n.FIB).forEach(([i,a])=>{s.FIB.receiveEntry(i,a.label,a.nextHop)}),Y.addRouter(s);break}case"LSR":{const s=new Ct(n.id,n.node);Object.entries(n.LFIB).forEach(([i,a])=>{s.LFIB.receiveEntry(parseInt(i),a.outgoingLabel,a.nextHop)}),Y.addRouter(s);break}case"CE":{const s=new ze(n.id,n.node);Object.entries(n.firstHop).forEach(([i,a])=>{s.receiveEntry(i,a)}),Y.addRouter(s);break}}Y.setRouterCount(t+1);for(const n of e.data.links){const s=Y.getRouter(n.source),i=Y.getRouter(n.target);s&&i&&Y.addLink({source:s,target:i,bandwidth:n.bandwidth})}return!0}function Us(r){let e,t,n,s;return{c(){e=E("button"),t=ve(r[0]),this.h()},l(i){e=C(i,"BUTTON",{style:!0,class:!0});var a=M(e);t=ke(a,r[0]),a.forEach(f),this.h()},h(){v(e,"style",r[2]),v(e,"class","svelte-13ziii4")},m(i,a){k(i,e,a),$(e,t),n||(s=he(e,"click",function(){fr(r[1])&&r[1].apply(this,arguments)}),n=!0)},p(i,[a]){r=i,a&1&&Ye(t,r[0]),a&4&&v(e,"style",r[2])},i:Pe,o:Pe,d(i){i&&f(e),n=!1,s()}}}function qs(r,e,t){let{text:n}=e,{callback:s=()=>{}}=e,{style:i=void 0}=e;return r.$$set=a=>{"text"in a&&t(0,n=a.text),"callback"in a&&t(1,s=a.callback),"style"in a&&t(2,i=a.style)},[n,s,i]}class Qe extends $e{constructor(e){super(),Le(this,e,qs,Us,Ie,{text:0,callback:1,style:2})}}function Ys(r){let e,t,n,s;const i=r[2].default,a=hr(i,r,r[1],null);return{c(){e=E("dialog"),a&&a.c(),this.h()},l(o){e=C(o,"DIALOG",{class:!0});var l=M(e);a&&a.l(l),l.forEach(f),this.h()},h(){v(e,"class","svelte-p5wejv")},m(o,l){k(o,e,l),a&&a.m(e,null),r[4](e),t=!0,n||(s=he(e,"close",r[3]),n=!0)},p(o,[l]){a&&a.p&&(!t||l&2)&&pr(a,i,o,o[1],t?gr(i,o[1],l,null):mr(o[1]),null)},i(o){t||(D(a,o),t=!0)},o(o){Z(a,o),t=!1},d(o){o&&f(e),a&&a.d(o),r[4](null),n=!1,s()}}}function Ws(r,e,t){let{$$slots:n={},$$scope:s}=e,{dialog:i}=e;function a(l){_r.call(this,r,l)}function o(l){Oe[l?"unshift":"push"](()=>{i=l,t(0,i)})}return r.$$set=l=>{"dialog"in l&&t(0,i=l.dialog),"$$scope"in l&&t(1,s=l.$$scope)},[i,s,n,a,o]}class Jt extends $e{constructor(e){super(),Le(this,e,Ws,Ys,Ie,{dialog:0})}}const Gs=[{id:1,node:{label:"CE 1",x:-350,y:-25},address:"CE-IP-1",firstHop:{"CE-IP-5":2,"CE-IP-6":2},type:"CE"},{id:2,node:{label:"LER 2",x:-200,y:-25},FIB:{"CE-IP-5":{label:306030,nextHop:"3"},"CE-IP-6":{label:61379,nextHop:"3"}},LFIB:{},type:"LER"},{id:3,node:{label:"LSR 3",x:-100,y:-25},LFIB:{61379:{outgoingLabel:974214,nextHop:"4"},306030:{outgoingLabel:349733,nextHop:"4"}},type:"LSR"},{id:4,node:{label:"LER 4",x:0,y:-25},FIB:{},LFIB:{349733:{outgoingLabel:-1,nextHop:"CE-IP-5"},974214:{outgoingLabel:-1,nextHop:"CE-IP-6"}},type:"LER"},{id:5,node:{label:"CE 5",x:125,y:-100},address:"CE-IP-5",firstHop:{},type:"CE"},{id:6,node:{label:"CE 6",x:125,y:50},address:"CE-IP-6",firstHop:{},type:"CE"}],Xs=[{bandwidth:0,id:"1-2",source:1,target:2},{bandwidth:0,id:"2-3",source:2,target:3},{bandwidth:0,id:"3-4",source:3,target:4},{bandwidth:0,id:"4-5",source:4,target:5},{bandwidth:0,id:"4-6",source:4,target:6}],Js={routers:Gs,links:Xs},Ks=[{id:1,node:{label:"LSR 1",x:45,y:-189},LFIB:{510069:{outgoingLabel:323562,nextHop:"4"},681382:{outgoingLabel:323540,nextHop:"4"}},type:"LSR"},{id:2,node:{label:"LSR 2",x:-100,y:149},LFIB:{27503:{outgoingLabel:1037790,nextHop:"5"},98952:{outgoingLabel:326833,nextHop:"5"},272693:{outgoingLabel:971198,nextHop:"5"},470359:{outgoingLabel:546541,nextHop:"3"},773817:{outgoingLabel:258109,nextHop:"9"}},type:"LSR"},{id:3,node:{label:"LSR 3",x:-170,y:-60},LFIB:{546541:{outgoingLabel:54803,nextHop:"6"},605492:{outgoingLabel:894316,nextHop:"6"},906528:{outgoingLabel:714735,nextHop:"6"}},type:"LSR"},{id:4,node:{label:"LSR 4",x:246,y:-60},LFIB:{206524:{outgoingLabel:916756,nextHop:"15"},323540:{outgoingLabel:900200,nextHop:"15"},323562:{outgoingLabel:974115,nextHop:"5"},445570:{outgoingLabel:207845,nextHop:"14"},848070:{outgoingLabel:807284,nextHop:"15"}},type:"LSR"},{id:5,node:{label:"LSR 5",x:170,y:156},LFIB:{149417:{outgoingLabel:773817,nextHop:"2"},326833:{outgoingLabel:321563,nextHop:"13"},420034:{outgoingLabel:848070,nextHop:"4"},495820:{outgoingLabel:605492,nextHop:"3"},655741:{outgoingLabel:445570,nextHop:"4"},971198:{outgoingLabel:956025,nextHop:"12"},974115:{outgoingLabel:474381,nextHop:"12"},1028802:{outgoingLabel:476950,nextHop:"13"},1037790:{outgoingLabel:206524,nextHop:"4"}},type:"LSR"},{id:6,node:{label:"LER 6",x:-289,y:-78},FIB:{},LFIB:{54803:{outgoingLabel:-1,nextHop:"CE-IP-20"},714735:{outgoingLabel:-1,nextHop:"CE-IP-21"},894316:{outgoingLabel:-1,nextHop:"CE-IP-21"}},type:"LER"},{id:7,node:{label:"LSR 7",x:-58,y:-366},LFIB:{495501:{outgoingLabel:681382,nextHop:"1"},842839:{outgoingLabel:906528,nextHop:"3"},1029149:{outgoingLabel:510069,nextHop:"1"}},type:"LSR"},{id:8,node:{label:"LSR 8",x:140,y:-371},LFIB:{},type:"LSR"},{id:9,node:{label:"LSR 9",x:-127,y:300},LFIB:{258109:{outgoingLabel:1036116,nextHop:"11"},608972:{outgoingLabel:27503,nextHop:"2"},703550:{outgoingLabel:470359,nextHop:"2"},864775:{outgoingLabel:98952,nextHop:"2"}},type:"LSR"},{id:10,node:{label:"LER 10",x:-260,y:324},FIB:{"CE-IP-34":{label:272693,nextHop:"2"}},LFIB:{},type:"LER"},{id:11,node:{label:"LER 11",x:-310,y:223},FIB:{"CE-IP-26":{label:608972,nextHop:"9"},"CE-IP-20":{label:703550,nextHop:"9"},"CE-IP-30":{label:864775,nextHop:"9"}},LFIB:{1036116:{outgoingLabel:-1,nextHop:"CE-IP-24"}},type:"LER"},{id:12,node:{label:"LER 12",x:223,y:263},FIB:{"CE-IP-26":{label:420034,nextHop:"5"},"CE-IP-33":{label:1028802,nextHop:"5"},"CE-IP-24":{label:149417,nextHop:"5"}},LFIB:{474381:{outgoingLabel:-1,nextHop:"CE-IP-34"},956025:{outgoingLabel:-1,nextHop:"CE-IP-34"}},type:"LER"},{id:13,node:{label:"LER 13",x:455,y:271},FIB:{"CE-IP-29":{label:655741,nextHop:"5"},"CE-IP-21":{label:495820,nextHop:"5"}},LFIB:{321563:{outgoingLabel:-1,nextHop:"CE-IP-30"},476950:{outgoingLabel:-1,nextHop:"CE-IP-33"}},type:"LER"},{id:14,node:{label:"LER 14",x:340,y:-19},FIB:{},LFIB:{207845:{outgoingLabel:-1,nextHop:"CE-IP-29"}},type:"LER"},{id:15,node:{label:"LER 15",x:331,y:-99},FIB:{},LFIB:{807284:{outgoingLabel:-1,nextHop:"CE-IP-26"},900200:{outgoingLabel:-1,nextHop:"CE-IP-26"},916756:{outgoingLabel:-1,nextHop:"CE-IP-26"}},type:"LER"},{id:16,node:{label:"LER 16",x:35,y:-484},FIB:{"CE-IP-21":{label:842839,nextHop:"7"},"CE-IP-26":{label:495501,nextHop:"7"},"CE-IP-34":{label:1029149,nextHop:"7"}},LFIB:{},type:"LER"},{id:17,node:{label:"CE 17",x:-52,y:-600},address:"CE-IP-17",firstHop:{"CE-IP-21":16},type:"CE"},{id:18,node:{label:"CE 18",x:34,y:-644},address:"CE-IP-18",firstHop:{"CE-IP-26":16},type:"CE"},{id:19,node:{label:"CE 19",x:122,y:-600},address:"CE-IP-19",firstHop:{"CE-IP-34":16},type:"CE"},{id:20,node:{label:"CE 20",x:-426,y:-47},address:"CE-IP-20",firstHop:{},type:"CE"},{id:21,node:{label:"CE 21",x:-427,y:-134},address:"CE-IP-21",firstHop:{},type:"CE"},{id:22,node:{label:"CE 22",x:-395,y:131},address:"CE-IP-22",firstHop:{"CE-IP-20":11},type:"CE"},{id:23,node:{label:"CE 23",x:-421,y:206},address:"CE-IP-23",firstHop:{"CE-IP-26":11},type:"CE"},{id:24,node:{label:"CE 24",x:-404,y:297},address:"CE-IP-24",firstHop:{"CE-IP-30":11},type:"CE"},{id:25,node:{label:"CE 25",x:-404,y:375},address:"CE-IP-25",firstHop:{"CE-IP-34":10},type:"CE"},{id:26,node:{label:"CE 26",x:466,y:-202},address:"CE-IP-26",firstHop:{},type:"CE"},{id:27,node:{label:"CE 27",x:468,y:-104},address:"CE-IP-27",firstHop:{},type:"CE"},{id:28,node:{label:"CE 28",x:467,y:2},address:"CE-IP-28",firstHop:{},type:"CE"},{id:29,node:{label:"CE 29",x:463,y:90},address:"CE-IP-29",firstHop:{},type:"CE"},{id:30,node:{label:"CE 30",x:618,y:195},address:"CE-IP-30",firstHop:{"CE-IP-29":13,"CE-IP-21":13},type:"CE"},{id:31,node:{label:"CE 31",x:643,y:273},address:"CE-IP-31",firstHop:{},type:"CE"},{id:32,node:{label:"CE 32",x:623,y:355},address:"CE-IP-32",firstHop:{},type:"CE"},{id:33,node:{label:"CE 33",x:540,y:400},address:"CE-IP-33",firstHop:{},type:"CE"},{id:34,node:{label:"CE 34",x:244,y:354},address:"CE-IP-34",firstHop:{"CE-IP-26":12,"CE-IP-33":12,"CE-IP-24":12},type:"CE"}],Qs=[{bandwidth:0,id:"3-1",source:3,target:1},{bandwidth:0,id:"1-4",source:1,target:4},{bandwidth:0,id:"4-5",source:4,target:5},{bandwidth:0,id:"5-2",source:5,target:2},{bandwidth:0,id:"2-3",source:2,target:3},{bandwidth:0,id:"3-5",source:3,target:5},{bandwidth:0,id:"7-1",source:7,target:1},{bandwidth:0,id:"8-1",source:8,target:1},{bandwidth:0,id:"17-16",source:17,target:16},{bandwidth:0,id:"18-16",source:18,target:16},{bandwidth:0,id:"19-16",source:19,target:16},{bandwidth:0,id:"16-7",source:16,target:7},{bandwidth:0,id:"16-8",source:16,target:8},{bandwidth:0,id:"7-3",source:7,target:3},{bandwidth:0,id:"25-10",source:25,target:10},{bandwidth:0,id:"10-9",source:10,target:9},{bandwidth:0,id:"9-2",source:9,target:2},{bandwidth:0,id:"10-2",source:10,target:2},{bandwidth:0,id:"11-9",source:11,target:9},{bandwidth:0,id:"22-11",source:22,target:11},{bandwidth:0,id:"23-11",source:23,target:11},{bandwidth:0,id:"24-11",source:24,target:11},{bandwidth:0,id:"20-6",source:20,target:6},{bandwidth:0,id:"6-3",source:6,target:3},{bandwidth:0,id:"21-6",source:21,target:6},{bandwidth:0,id:"4-15",source:4,target:15},{bandwidth:0,id:"4-14",source:4,target:14},{bandwidth:0,id:"5-13",source:5,target:13},{bandwidth:0,id:"5-12",source:5,target:12},{bandwidth:0,id:"15-27",source:15,target:27},{bandwidth:0,id:"15-26",source:15,target:26},{bandwidth:0,id:"14-28",source:14,target:28},{bandwidth:0,id:"14-29",source:14,target:29},{bandwidth:0,id:"33-13",source:33,target:13},{bandwidth:0,id:"32-13",source:32,target:13},{bandwidth:0,id:"13-31",source:13,target:31},{bandwidth:0,id:"13-30",source:13,target:30},{bandwidth:0,id:"34-12",source:34,target:12}],ei={routers:Ks,links:Qs};function Tn(r,e,t){const n=r.slice();return n[3]=e[t],n}function Pn(r){let e,t;const n=[r[3]];let s={};for(let i=0;i<n.length;i+=1)s=Yt(s,n[i]);return e=new Qe({props:s}),{c(){Q(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){const o=a&2?Wt(n,[Gt(i[3])]):{};e.$set(o)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){Z(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function ti(r){let e,t="Welcome",n,s,i="This tool is designed to mimic the basics of MPLS",a,o,l="Choose a network:",c,u,d,h=we(r[1]),y=[];for(let g=0;g<h.length;g+=1)y[g]=Pn(Tn(r,h,g));const b=g=>Z(y[g],1,1,()=>{y[g]=null});return{c(){e=E("h1"),e.textContent=t,n=T(),s=E("p"),s.textContent=i,a=T(),o=E("p"),o.textContent=l,c=T(),u=E("div");for(let g=0;g<y.length;g+=1)y[g].c();this.h()},l(g){e=C(g,"H1",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-4p3d56"&&(e.textContent=t),n=P(g),s=C(g,"P",{class:!0,"data-svelte-h":!0}),le(s)!=="svelte-1helk6g"&&(s.textContent=i),a=P(g),o=C(g,"P",{class:!0,"data-svelte-h":!0}),le(o)!=="svelte-1vyl31e"&&(o.textContent=l),c=P(g),u=C(g,"DIV",{class:!0});var _=M(u);for(let m=0;m<y.length;m+=1)y[m].l(_);_.forEach(f),this.h()},h(){v(e,"class","svelte-1os0cpz"),v(s,"class","svelte-1os0cpz"),v(o,"class","svelte-1os0cpz"),v(u,"class","buttons svelte-1os0cpz")},m(g,_){k(g,e,_),k(g,n,_),k(g,s,_),k(g,a,_),k(g,o,_),k(g,c,_),k(g,u,_);for(let m=0;m<y.length;m+=1)y[m]&&y[m].m(u,null);d=!0},p(g,_){if(_&2){h=we(g[1]);let m;for(m=0;m<h.length;m+=1){const p=Tn(g,h,m);y[m]?(y[m].p(p,_),D(y[m],1)):(y[m]=Pn(p),y[m].c(),D(y[m],1),y[m].m(u,null))}for(Se(),m=h.length;m<y.length;m+=1)b(m);Be()}},i(g){if(!d){for(let _=0;_<h.length;_+=1)D(y[_]);d=!0}},o(g){y=y.filter(Boolean);for(let _=0;_<y.length;_+=1)Z(y[_]);d=!1},d(g){g&&(f(e),f(n),f(s),f(a),f(o),f(c),f(u)),ut(y,g)}}}function ni(r){let e,t,n;function s(a){r[2](a)}let i={$$slots:{default:[ti]},$$scope:{ctx:r}};return r[0]!==void 0&&(i.dialog=r[0]),e=new Jt({props:i}),Oe.push(()=>qe(e,"dialog",s)),{c(){Q(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),n=!0},p(a,[o]){const l={};o&66&&(l.$$scope={dirty:o,ctx:a}),!t&&o&1&&(t=!0,l.dialog=a[0],Ue(()=>t=!1)),e.$set(l)},i(a){n||(D(e.$$.fragment,a),n=!0)},o(a){Z(e.$$.fragment,a),n=!1},d(a){ne(e,a)}}}function ri(r,e,t){let n,s;wn(()=>{t(0,s.inert=!0,s),s.showModal(),t(0,s.inert=!1,s)});function i(a){s=a,t(0,s)}return r.$$.update=()=>{r.$$.dirty&1&&t(1,n=[{text:"Blank",callback:()=>{s.close()}},{text:"Small",callback:()=>{gn(Js),s.close()}},{text:"Large",callback:()=>{gn(ei),s.close()}},{text:"Import",callback:()=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.onchange=o=>{if(!(o.target instanceof HTMLInputElement)||o.target.files.length===0)return;const l=o.target.files[0],c=new FileReader;c.addEventListener("load",u=>{if(!u.target||typeof u.target.result!="string")return;gn(JSON.parse(u.target.result))&&s.close()}),c.readAsText(l)},a.click()}}])},[s,n,i]}class si extends $e{constructor(e){super(),Le(this,e,ri,ni,Ie,{})}}const ii={placing:null},Je=cn(ii),kt=cn(!1),Nn=16,ai=2**20-1;function Lr(r,e){const t=r[0];if(!(t instanceof ze)){alert("The path does not start with a CE");return}const n=r[1];if(!(n instanceof Ke)){alert("The source CE is not directly connected to an LER");return}if(t.firstHop.set(e,n.id),n.FIB.get(e))return;const s=r.length-2,i=r[s];if(!(i instanceof Ke)){alert("Destination CE is not connected directly to a LER");return}let a=Sn(r[s]);i.LFIB.receiveEntry(a,-1,e);for(let o=r.length-2;o>0;o--){const l=r[o],c=r[o-1],u=a;a=Sn(l),c instanceof Ke?c.FIB.receiveEntry(e,u,l.id.toString()):c instanceof Ct&&c.LFIB.receiveEntry(a,u,l.id.toString())}}function oi(r,e){return r instanceof Ct||r instanceof Ke?r.LFIB.map.has(e):!1}function Sn(r){let e;do e=Math.floor(Math.random()*(ai-Nn+1)+Nn);while(oi(r,e));return e}function li(r){let e,t,n,s;return{c(){e=E("button"),t=ve(r[0]),this.h()},l(i){e=C(i,"BUTTON",{class:!0});var a=M(e);t=ke(a,r[0]),a.forEach(f),this.h()},h(){v(e,"class","svelte-ritw78")},m(i,a){k(i,e,a),$(e,t),n||(s=he(e,"click",function(){fr(r[1])&&r[1].apply(this,arguments)}),n=!0)},p(i,[a]){r=i,a&1&&Ye(t,r[0])},i:Pe,o:Pe,d(i){i&&f(e),n=!1,s()}}}function ui(r,e,t){let{text:n}=e,{callback:s}=e;return r.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,s=i.callback)},[n,s]}class mt extends $e{constructor(e){super(),Le(this,e,ui,li,Ie,{text:0,callback:1})}}function Bn(r,e,t){const n=r.slice();return n[9]=e[t][0],n[10]=e[t][1],n}function Dn(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g,_,m,p;function I(...N){return r[5](r[9],...N)}function H(...N){return r[6](r[9],...N)}function L(){return r[7](r[9])}d=new mt({props:{text:"LDP",callback:L}});function j(){return r[8](r[9])}return b=new mt({props:{text:"-",callback:j}}),{c(){e=E("tr"),t=E("td"),n=E("input"),i=T(),a=E("td"),o=E("input"),c=T(),u=E("td"),Q(d.$$.fragment),h=T(),y=E("td"),Q(b.$$.fragment),g=T(),this.h()},l(N){e=C(N,"TR",{});var z=M(e);t=C(z,"TD",{});var G=M(t);n=C(G,"INPUT",{type:!0,placeholder:!0}),G.forEach(f),i=P(z),a=C(z,"TD",{});var S=M(a);o=C(S,"INPUT",{type:!0,placeholder:!0}),S.forEach(f),c=P(z),u=C(z,"TD",{title:!0});var w=M(u);ee(d.$$.fragment,w),w.forEach(f),h=P(z),y=C(z,"TD",{});var A=M(y);ee(b.$$.fragment,A),A.forEach(f),g=P(z),z.forEach(f),this.h()},h(){v(n,"type","text"),n.value=s=r[9],v(n,"placeholder","Address"),v(o,"type","text"),o.value=l=r[10],v(o,"placeholder","Link"),v(u,"title","Generates shortest path")},m(N,z){k(N,e,z),$(e,t),$(t,n),$(e,i),$(e,a),$(a,o),$(e,c),$(e,u),te(d,u,null),$(e,h),$(e,y),te(b,y,null),$(e,g),_=!0,m||(p=[he(n,"change",I),he(o,"change",H)],m=!0)},p(N,z){r=N,(!_||z&1&&s!==(s=r[9])&&n.value!==s)&&(n.value=s),(!_||z&1&&l!==(l=r[10])&&o.value!==l)&&(o.value=l);const G={};z&1&&(G.callback=L),d.$set(G);const S={};z&1&&(S.callback=j),b.$set(S)},i(N){_||(D(d.$$.fragment,N),D(b.$$.fragment,N),_=!0)},o(N){Z(d.$$.fragment,N),Z(b.$$.fragment,N),_=!1},d(N){N&&f(e),ne(d),ne(b),m=!1,xt(p)}}}function ci(r){let e,t,n,s="(?)",i,a,o,l,c,u="Destination",d,h,y="First hop",b,g,_,m="(?)",p,I,H,L,j,N,z,G,S=we([...r[0].firstHop]),w=[];for(let R=0;R<S.length;R+=1)w[R]=Dn(Bn(r,S,R));const A=R=>Z(w[R],1,1,()=>{w[R]=null});return z=new mt({props:{text:"+",callback:r[1](r[0].addEmptyEntry)}}),{c(){e=E("p"),t=ve("Destinations: "),n=E("span"),n.textContent=s,i=T(),a=E("table"),o=E("thead"),l=E("tr"),c=E("th"),c.textContent=u,d=T(),h=E("th"),h.textContent=y,b=T(),g=E("th"),_=E("span"),_.textContent=m,p=T(),I=E("th"),H=T(),L=E("tbody");for(let R=0;R<w.length;R+=1)w[R].c();j=T(),N=E("div"),Q(z.$$.fragment),this.h()},l(R){e=C(R,"P",{title:!0});var F=M(e);t=ke(F,"Destinations: "),n=C(F,"SPAN",{"data-svelte-h":!0}),le(n)!=="svelte-1w7wt1o"&&(n.textContent=s),F.forEach(f),i=P(R),a=C(R,"TABLE",{});var fe=M(a);o=C(fe,"THEAD",{});var K=M(o);l=C(K,"TR",{});var ie=M(l);c=C(ie,"TH",{class:!0,"data-svelte-h":!0}),le(c)!=="svelte-1o2x94e"&&(c.textContent=u),d=P(ie),h=C(ie,"TH",{class:!0,"data-svelte-h":!0}),le(h)!=="svelte-131gjt9"&&(h.textContent=y),b=P(ie),g=C(ie,"TH",{class:!0});var be=M(g);_=C(be,"SPAN",{title:!0,"data-svelte-h":!0}),le(_)!=="svelte-1vkgmco"&&(_.textContent=m),be.forEach(f),p=P(ie),I=C(ie,"TH",{class:!0}),M(I).forEach(f),ie.forEach(f),K.forEach(f),H=P(fe),L=C(fe,"TBODY",{});var xe=M(L);for(let Ze=0;Ze<w.length;Ze+=1)w[Ze].l(xe);xe.forEach(f),fe.forEach(f),j=P(R),N=C(R,"DIV",{class:!0});var Ee=M(N);ee(z.$$.fragment,Ee),Ee.forEach(f),this.h()},h(){ct(n,"color","grey"),v(e,"title","Maps IP addresses to IDs of the first LERs in the LSPs found by Dijkstra's"),v(c,"class","svelte-1d4gizi"),v(h,"class","svelte-1d4gizi"),v(_,"title","Generates shortest path"),ct(_,"color","grey"),v(g,"class","svelte-1d4gizi"),v(I,"class","svelte-1d4gizi"),v(N,"class","svelte-1d4gizi")},m(R,F){k(R,e,F),$(e,t),$(e,n),k(R,i,F),k(R,a,F),$(a,o),$(o,l),$(l,c),$(l,d),$(l,h),$(l,b),$(l,g),$(g,_),$(l,p),$(l,I),$(a,H),$(a,L);for(let fe=0;fe<w.length;fe+=1)w[fe]&&w[fe].m(L,null);k(R,j,F),k(R,N,F),te(z,N,null),G=!0},p(R,[F]){if(F&29){S=we([...R[0].firstHop]);let K;for(K=0;K<S.length;K+=1){const ie=Bn(R,S,K);w[K]?(w[K].p(ie,F),D(w[K],1)):(w[K]=Dn(ie),w[K].c(),D(w[K],1),w[K].m(L,null))}for(Se(),K=S.length;K<w.length;K+=1)A(K);Be()}const fe={};F&1&&(fe.callback=R[1](R[0].addEmptyEntry)),z.$set(fe)},i(R){if(!G){for(let F=0;F<S.length;F+=1)D(w[F]);D(z.$$.fragment,R),G=!0}},o(R){w=w.filter(Boolean);for(let F=0;F<w.length;F+=1)Z(w[F]);Z(z.$$.fragment,R),G=!1},d(R){R&&(f(e),f(i),f(a),f(j),f(N)),ut(w,R),ne(z)}}}function di(r,e,t){let{router:n}=e;function s(h){return()=>{h(),t(0,n)}}function i(h,y){if(!(h.target instanceof HTMLInputElement))return;const b=h.target.value.toUpperCase(),g=Y.getCERouter(b);if(n.address===b){alert("Destination router cannot be the same as the source router.");return}if(!g){alert("Destination router not found.");return}n.updateAddress(y,b),t(0,n)}function a(h){const y=Y.getCERouter(h);if(!y){alert("Destination router not found.");return}const b=Cn(n,y);if(b.length<=1){alert("No path found");return}Lr(b,h),t(0,n)}function o(h,y){if(!(h.target instanceof HTMLInputElement))return;const b=parseInt(h.target.value);n.firstHop.set(y,b)}const l=(h,y)=>{i(y,h)},c=(h,y)=>{o(y,h)},u=h=>{a(h)},d=h=>{n.firstHop.delete(h),t(0,n)};return r.$$set=h=>{"router"in h&&t(0,n=h.router)},[n,s,i,a,o,l,c,u,d]}class fi extends $e{constructor(e){super(),Le(this,e,di,ci,Ie,{router:0})}}function Hn(r,e,t){const n=r.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function On(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g,_;function m(...L){return r[3](r[7],...L)}function p(){r[4].call(o,r[9],r[10])}function I(){r[5].call(u,r[9],r[10])}function H(){return r[6](r[7])}return h=new mt({props:{text:"-",callback:H}}),{c(){e=E("tr"),t=E("td"),n=E("input"),i=T(),a=E("td"),o=E("input"),l=T(),c=E("td"),u=E("input"),d=T(),Q(h.$$.fragment),y=T(),this.h()},l(L){e=C(L,"TR",{});var j=M(e);t=C(j,"TD",{});var N=M(t);n=C(N,"INPUT",{type:!0}),N.forEach(f),i=P(j),a=C(j,"TD",{});var z=M(a);o=C(z,"INPUT",{type:!0}),z.forEach(f),l=P(j),c=C(j,"TD",{});var G=M(c);u=C(G,"INPUT",{type:!0}),G.forEach(f),d=P(j),ee(h.$$.fragment,j),y=P(j),j.forEach(f),this.h()},h(){v(n,"type","number"),n.value=s=r[7],v(o,"type","number"),v(u,"type","text")},m(L,j){k(L,e,j),$(e,t),$(t,n),$(e,i),$(e,a),$(a,o),Ne(o,r[8].outgoingLabel),$(e,l),$(e,c),$(c,u),Ne(u,r[8].nextHop),$(e,d),te(h,e,null),$(e,y),b=!0,g||(_=[he(n,"change",m),he(o,"input",p),he(u,"input",I)],g=!0)},p(L,j){r=L,(!b||j&1&&s!==(s=r[7])&&n.value!==s)&&(n.value=s),j&1&&et(o.value)!==r[8].outgoingLabel&&Ne(o,r[8].outgoingLabel),j&1&&u.value!==r[8].nextHop&&Ne(u,r[8].nextHop);const N={};j&1&&(N.callback=H),h.$set(N)},i(L){b||(D(h.$$.fragment,L),b=!0)},o(L){Z(h.$$.fragment,L),b=!1},d(L){L&&f(e),ne(h),g=!1,xt(_)}}}function hi(r){let e,t,n,s="(?)",i,a,o,l="<tr><th>Incoming</th> <th>Outgoing</th> <th>Next hop</th> <th></th></tr>",c,u,d,h,y,b,g=we([...r[0].LFIB.map]),_=[];for(let p=0;p<g.length;p+=1)_[p]=On(Hn(r,g,p));const m=p=>Z(_[p],1,1,()=>{_[p]=null});return y=new mt({props:{text:"+",callback:r[1](r[0].LFIB.addEmptyEntry)}}),{c(){e=E("p"),t=ve("LFIB: "),n=E("span"),n.textContent=s,i=T(),a=E("table"),o=E("thead"),o.innerHTML=l,c=T(),u=E("tbody");for(let p=0;p<_.length;p+=1)_[p].c();d=T(),h=E("div"),Q(y.$$.fragment),this.h()},l(p){e=C(p,"P",{title:!0});var I=M(e);t=ke(I,"LFIB: "),n=C(I,"SPAN",{"data-svelte-h":!0}),le(n)!=="svelte-1w7wt1o"&&(n.textContent=s),I.forEach(f),i=P(p),a=C(p,"TABLE",{});var H=M(a);o=C(H,"THEAD",{"data-svelte-h":!0}),le(o)!=="svelte-1fy2y89"&&(o.innerHTML=l),c=P(H),u=C(H,"TBODY",{});var L=M(u);for(let N=0;N<_.length;N+=1)_[N].l(L);L.forEach(f),H.forEach(f),d=P(p),h=C(p,"DIV",{class:!0});var j=M(h);ee(y.$$.fragment,j),j.forEach(f),this.h()},h(){ct(n,"color","grey"),v(e,"title","Maps incoming labels to outgoing labels and router IDs"),v(h,"class","svelte-f8qi58")},m(p,I){k(p,e,I),$(e,t),$(e,n),k(p,i,I),k(p,a,I),$(a,o),$(a,c),$(a,u);for(let H=0;H<_.length;H+=1)_[H]&&_[H].m(u,null);k(p,d,I),k(p,h,I),te(y,h,null),b=!0},p(p,[I]){if(I&5){g=we([...p[0].LFIB.map]);let L;for(L=0;L<g.length;L+=1){const j=Hn(p,g,L);_[L]?(_[L].p(j,I),D(_[L],1)):(_[L]=On(j),_[L].c(),D(_[L],1),_[L].m(u,null))}for(Se(),L=g.length;L<_.length;L+=1)m(L);Be()}const H={};I&1&&(H.callback=p[1](p[0].LFIB.addEmptyEntry)),y.$set(H)},i(p){if(!b){for(let I=0;I<g.length;I+=1)D(_[I]);D(y.$$.fragment,p),b=!0}},o(p){_=_.filter(Boolean);for(let I=0;I<_.length;I+=1)Z(_[I]);Z(y.$$.fragment,p),b=!1},d(p){p&&(f(e),f(i),f(a),f(d),f(h)),ut(_,p),ne(y)}}}function pi(r,e,t){let{router:n}=e;function s(u){return()=>{u(),t(0,n)}}function i(u,d){if(!(u.target instanceof HTMLInputElement))return;const h=parseInt(u.target.value);n.LFIB.updateLabel(d,h)}const a=(u,d)=>{i(d,u)};function o(u,d){u[d][1].outgoingLabel=et(this.value),t(0,n)}function l(u,d){u[d][1].nextHop=this.value,t(0,n)}const c=u=>{n.LFIB.deleteEntry(u),t(0,n)};return r.$$set=u=>{"router"in u&&t(0,n=u.router)},[n,s,i,a,o,l,c]}class mi extends $e{constructor(e){super(),Le(this,e,pi,hi,Ie,{router:0})}}function jn(r,e,t){const n=r.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Zn(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g,_;function m(...L){return r[3](r[7],...L)}function p(){r[4].call(o,r[9],r[10])}function I(){r[5].call(u,r[9],r[10])}function H(){return r[6](r[7])}return h=new mt({props:{text:"-",callback:H}}),{c(){e=E("tr"),t=E("td"),n=E("input"),i=T(),a=E("td"),o=E("input"),l=T(),c=E("td"),u=E("input"),d=T(),Q(h.$$.fragment),y=T(),this.h()},l(L){e=C(L,"TR",{});var j=M(e);t=C(j,"TD",{});var N=M(t);n=C(N,"INPUT",{type:!0}),N.forEach(f),i=P(j),a=C(j,"TD",{});var z=M(a);o=C(z,"INPUT",{type:!0}),z.forEach(f),l=P(j),c=C(j,"TD",{});var G=M(c);u=C(G,"INPUT",{type:!0}),G.forEach(f),d=P(j),ee(h.$$.fragment,j),y=P(j),j.forEach(f),this.h()},h(){v(n,"type","text"),n.value=s=r[7],v(o,"type","number"),v(u,"type","text")},m(L,j){k(L,e,j),$(e,t),$(t,n),$(e,i),$(e,a),$(a,o),Ne(o,r[8].label),$(e,l),$(e,c),$(c,u),Ne(u,r[8].nextHop),$(e,d),te(h,e,null),$(e,y),b=!0,g||(_=[he(n,"change",m),he(o,"input",p),he(u,"input",I)],g=!0)},p(L,j){r=L,(!b||j&1&&s!==(s=r[7])&&n.value!==s)&&(n.value=s),j&1&&et(o.value)!==r[8].label&&Ne(o,r[8].label),j&1&&u.value!==r[8].nextHop&&Ne(u,r[8].nextHop);const N={};j&1&&(N.callback=H),h.$set(N)},i(L){b||(D(h.$$.fragment,L),b=!0)},o(L){Z(h.$$.fragment,L),b=!1},d(L){L&&f(e),ne(h),g=!1,xt(_)}}}function gi(r){let e,t,n,s="(?)",i,a,o,l="<tr><th>Address</th> <th>Label</th> <th>Next hop</th> <th></th></tr>",c,u,d,h,y,b,g=we([...r[0].FIB.map]),_=[];for(let p=0;p<g.length;p+=1)_[p]=Zn(jn(r,g,p));const m=p=>Z(_[p],1,1,()=>{_[p]=null});return y=new mt({props:{text:"+",callback:r[1](r[0].FIB.addEmptyEntry)}}),{c(){e=E("p"),t=ve("FIB: "),n=E("span"),n.textContent=s,i=T(),a=E("table"),o=E("thead"),o.innerHTML=l,c=T(),u=E("tbody");for(let p=0;p<_.length;p+=1)_[p].c();d=T(),h=E("div"),Q(y.$$.fragment),this.h()},l(p){e=C(p,"P",{title:!0});var I=M(e);t=ke(I,"FIB: "),n=C(I,"SPAN",{"data-svelte-h":!0}),le(n)!=="svelte-1w7wt1o"&&(n.textContent=s),I.forEach(f),i=P(p),a=C(p,"TABLE",{});var H=M(a);o=C(H,"THEAD",{"data-svelte-h":!0}),le(o)!=="svelte-1qhs6t7"&&(o.innerHTML=l),c=P(H),u=C(H,"TBODY",{});var L=M(u);for(let N=0;N<_.length;N+=1)_[N].l(L);L.forEach(f),H.forEach(f),d=P(p),h=C(p,"DIV",{class:!0});var j=M(h);ee(y.$$.fragment,j),j.forEach(f),this.h()},h(){ct(n,"color","grey"),v(e,"title","Maps IP addresses to labels and router IDs"),v(h,"class","svelte-f8qi58")},m(p,I){k(p,e,I),$(e,t),$(e,n),k(p,i,I),k(p,a,I),$(a,o),$(a,c),$(a,u);for(let H=0;H<_.length;H+=1)_[H]&&_[H].m(u,null);k(p,d,I),k(p,h,I),te(y,h,null),b=!0},p(p,[I]){if(I&5){g=we([...p[0].FIB.map]);let L;for(L=0;L<g.length;L+=1){const j=jn(p,g,L);_[L]?(_[L].p(j,I),D(_[L],1)):(_[L]=Zn(j),_[L].c(),D(_[L],1),_[L].m(u,null))}for(Se(),L=g.length;L<_.length;L+=1)m(L);Be()}const H={};I&1&&(H.callback=p[1](p[0].FIB.addEmptyEntry)),y.$set(H)},i(p){if(!b){for(let I=0;I<g.length;I+=1)D(_[I]);D(y.$$.fragment,p),b=!0}},o(p){_=_.filter(Boolean);for(let I=0;I<_.length;I+=1)Z(_[I]);Z(y.$$.fragment,p),b=!1},d(p){p&&(f(e),f(i),f(a),f(d),f(h)),ut(_,p),ne(y)}}}function _i(r,e,t){let{router:n}=e;function s(u){return()=>{u(),t(0,n)}}function i(u,d){if(!(u.target instanceof HTMLInputElement))return;const h=u.target.value;n.FIB.updateAddress(d,h)}const a=(u,d)=>{i(d,u)};function o(u,d){u[d][1].label=et(this.value),t(0,n)}function l(u,d){u[d][1].nextHop=this.value,t(0,n)}const c=u=>{n.FIB.deleteEntry(u),t(0,n)};return r.$$set=u=>{"router"in u&&t(0,n=u.router)},[n,s,i,a,o,l,c]}class bi extends $e{constructor(e){super(),Le(this,e,_i,gi,Ie,{router:0})}}function yi(r){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=E("p"),e.textContent=t},l(n){e=C(n,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,s){k(n,e,s)},p:Pe,i:Pe,o:Pe,d(n){n&&f(e)}}}function vi(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g=r[0].id+"",_,m,p,I,H,L,j,N,z,G,S=r[0]instanceof ze&&An(r),w=r[0]instanceof Ke&&Mn(r),A=(r[0]instanceof Ke||r[0]instanceof Ct)&&Fn(r);return j=new mt({props:{text:"Delete Router",callback:r[3]}}),{c(){e=E("div"),t=E("div"),n=E("label"),s=ve(`Label:
          `),i=E("input"),a=T(),o=E("label"),l=ve(`Position:
        `),c=E("input"),u=T(),d=E("input"),h=T(),y=E("p"),b=ve("ID: "),_=ve(g),m=T(),S&&S.c(),p=T(),w&&w.c(),I=T(),A&&A.c(),H=T(),L=E("div"),Q(j.$$.fragment),this.h()},l(R){e=C(R,"DIV",{});var F=M(e);t=C(F,"DIV",{});var fe=M(t);n=C(fe,"LABEL",{});var K=M(n);s=ke(K,`Label:
          `),i=C(K,"INPUT",{type:!0,class:!0}),K.forEach(f),fe.forEach(f),a=P(F),o=C(F,"LABEL",{});var ie=M(o);l=ke(ie,`Position:
        `),c=C(ie,"INPUT",{type:!0,class:!0}),u=P(ie),d=C(ie,"INPUT",{type:!0,class:!0}),ie.forEach(f),h=P(F),y=C(F,"P",{});var be=M(y);b=ke(be,"ID: "),_=ke(be,g),be.forEach(f),F.forEach(f),m=P(R),S&&S.l(R),p=P(R),w&&w.l(R),I=P(R),A&&A.l(R),H=P(R),L=C(R,"DIV",{class:!0});var xe=M(L);ee(j.$$.fragment,xe),xe.forEach(f),this.h()},h(){v(i,"type","text"),v(i,"class","svelte-cihl2i"),v(c,"type","number"),c.disabled=r[2],v(c,"class","svelte-cihl2i"),v(d,"type","number"),d.disabled=r[2],v(d,"class","svelte-cihl2i"),v(L,"class","margin-top svelte-cihl2i")},m(R,F){k(R,e,F),$(e,t),$(t,n),$(n,s),$(n,i),Ne(i,r[0].node.label),$(e,a),$(e,o),$(o,l),$(o,c),Ne(c,r[0].node.x),$(o,u),$(o,d),Ne(d,r[0].node.y),$(e,h),$(e,y),$(y,b),$(y,_),k(R,m,F),S&&S.m(R,F),k(R,p,F),w&&w.m(R,F),k(R,I,F),A&&A.m(R,F),k(R,H,F),k(R,L,F),te(j,L,null),N=!0,z||(G=[he(i,"input",r[4]),he(c,"input",r[5]),he(d,"input",r[6]),he(e,"input",r[7])],z=!0)},p(R,F){F&1&&i.value!==R[0].node.label&&Ne(i,R[0].node.label),(!N||F&4)&&(c.disabled=R[2]),F&1&&et(c.value)!==R[0].node.x&&Ne(c,R[0].node.x),(!N||F&4)&&(d.disabled=R[2]),F&1&&et(d.value)!==R[0].node.y&&Ne(d,R[0].node.y),(!N||F&1)&&g!==(g=R[0].id+"")&&Ye(_,g),R[0]instanceof ze?S?(S.p(R,F),F&1&&D(S,1)):(S=An(R),S.c(),D(S,1),S.m(p.parentNode,p)):S&&(Se(),Z(S,1,1,()=>{S=null}),Be()),R[0]instanceof Ke?w?(w.p(R,F),F&1&&D(w,1)):(w=Mn(R),w.c(),D(w,1),w.m(I.parentNode,I)):w&&(Se(),Z(w,1,1,()=>{w=null}),Be()),R[0]instanceof Ke||R[0]instanceof Ct?A?(A.p(R,F),F&1&&D(A,1)):(A=Fn(R),A.c(),D(A,1),A.m(H.parentNode,H)):A&&(Se(),Z(A,1,1,()=>{A=null}),Be())},i(R){N||(D(S),D(w),D(A),D(j.$$.fragment,R),N=!0)},o(R){Z(S),Z(w),Z(A),Z(j.$$.fragment,R),N=!1},d(R){R&&(f(e),f(m),f(p),f(I),f(H),f(L)),S&&S.d(R),w&&w.d(R),A&&A.d(R),ne(j),z=!1,xt(G)}}}function An(r){let e,t="Address:",n,s,i=r[0].address+"",a,o,l,c,u,d,h,y;function b(_){r[9](_)}let g={};return r[0]!==void 0&&(g.router=r[0]),c=new fi({props:g}),Oe.push(()=>qe(c,"router",b)),{c(){e=E("p"),e.textContent=t,n=T(),s=E("button"),a=ve(i),o=T(),l=E("div"),Q(c.$$.fragment),this.h()},l(_){e=C(_,"P",{"data-svelte-h":!0}),le(e)!=="svelte-18hoeeh"&&(e.textContent=t),n=P(_),s=C(_,"BUTTON",{class:!0});var m=M(s);a=ke(m,i),m.forEach(f),o=P(_),l=C(_,"DIV",{class:!0});var p=M(l);ee(c.$$.fragment,p),p.forEach(f),this.h()},h(){ct(e,"display","inline"),v(s,"class","svelte-cihl2i"),v(l,"class","margin-top svelte-cihl2i")},m(_,m){k(_,e,m),k(_,n,m),k(_,s,m),$(s,a),k(_,o,m),k(_,l,m),te(c,l,null),d=!0,h||(y=he(s,"click",r[8]),h=!0)},p(_,m){(!d||m&1)&&i!==(i=_[0].address+"")&&Ye(a,i);const p={};!u&&m&1&&(u=!0,p.router=_[0],Ue(()=>u=!1)),c.$set(p)},i(_){d||(D(c.$$.fragment,_),d=!0)},o(_){Z(c.$$.fragment,_),d=!1},d(_){_&&(f(e),f(n),f(s),f(o),f(l)),ne(c),h=!1,y()}}}function Mn(r){let e,t,n,s;function i(o){r[10](o)}let a={};return r[0]!==void 0&&(a.router=r[0]),t=new bi({props:a}),Oe.push(()=>qe(t,"router",i)),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(o){e=C(o,"DIV",{class:!0});var l=M(e);ee(t.$$.fragment,l),l.forEach(f),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(o,l){k(o,e,l),te(t,e,null),s=!0},p(o,l){const c={};!n&&l&1&&(n=!0,c.router=o[0],Ue(()=>n=!1)),t.$set(c)},i(o){s||(D(t.$$.fragment,o),s=!0)},o(o){Z(t.$$.fragment,o),s=!1},d(o){o&&f(e),ne(t)}}}function Fn(r){let e,t,n,s;function i(o){r[11](o)}let a={};return r[0]!==void 0&&(a.router=r[0]),t=new mi({props:a}),Oe.push(()=>qe(t,"router",i)),{c(){e=E("div"),Q(t.$$.fragment),this.h()},l(o){e=C(o,"DIV",{class:!0});var l=M(e);ee(t.$$.fragment,l),l.forEach(f),this.h()},h(){v(e,"class","margin-top svelte-cihl2i")},m(o,l){k(o,e,l),te(t,e,null),s=!0},p(o,l){const c={};!n&&l&1&&(n=!0,c.router=o[0],Ue(()=>n=!1)),t.$set(c)},i(o){s||(D(t.$$.fragment,o),s=!0)},o(o){Z(t.$$.fragment,o),s=!1},d(o){o&&f(e),ne(t)}}}function ki(r){let e,t,n,s;const i=[vi,yi],a=[];function o(l,c){return l[0]?0:1}return e=o(r),t=a[e]=i[e](r),{c(){t.c(),n=Re()},l(l){t.l(l),n=Re()},m(l,c){a[e].m(l,c),k(l,n,c),s=!0},p(l,c){let u=e;e=o(l),e===u?a[e].p(l,c):(Se(),Z(a[u],1,1,()=>{a[u]=null}),Be(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),D(t,1),t.m(n.parentNode,n))},i(l){s||(D(t),s=!0)},o(l){Z(t),s=!1},d(l){l&&f(n),a[e].d(l)}}}function xi(r){let e,t,n;function s(a){r[12](a)}let i={$$slots:{default:[ki]},$$scope:{ctx:r}};return r[1]!==void 0&&(i.dialog=r[1]),e=new Jt({props:i}),Oe.push(()=>qe(e,"dialog",s)),e.$on("close",r[13]),{c(){Q(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),n=!0},p(a,[o]){const l={};o&16389&&(l.$$scope={dirty:o,ctx:a}),!t&&o&2&&(t=!0,l.dialog=a[1],Ue(()=>t=!1)),e.$set(l)},i(a){n||(D(e.$$.fragment,a),n=!0)},o(a){Z(e.$$.fragment,a),n=!1},d(a){ne(e,a)}}}function wi(r,e,t){let n;je(r,kt,m=>t(2,n=m));let{router:s}=e,{dialog:i}=e;function a(){if(!n&&s){if(!confirm("Are you sure you want to delete this router?"))return;Y.deleteRouter(s.id),i.close()}else alert("You can't delete a router while the network is locked.")}function o(){s.node.label=this.value,t(0,s)}function l(){s.node.x=et(this.value),t(0,s)}function c(){s.node.y=et(this.value),t(0,s)}const u=()=>{Y.notify()},d=async()=>{s instanceof ze&&await navigator.clipboard.writeText(s.address)};function h(m){s=m,t(0,s)}function y(m){s=m,t(0,s)}function b(m){s=m,t(0,s)}function g(m){i=m,t(1,i)}const _=()=>{if(s instanceof ze)for(const m of s.firstHop.keys())m===""&&s.firstHop.delete(m);Y.notify()};return r.$$set=m=>{"router"in m&&t(0,s=m.router),"dialog"in m&&t(1,i=m.dialog)},[s,i,n,a,o,l,c,u,d,h,y,b,g,_]}class Ei extends $e{constructor(e){super(),Le(this,e,wi,xi,Ie,{router:0,dialog:1})}}function Ci(r){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=E("p"),e.textContent=t},l(n){e=C(n,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,s){k(n,e,s)},p:Pe,i:Pe,o:Pe,d(n){n&&f(e)}}}function Ii(r){let e,t=r[0].distance+"",n,s,i,a,o,l,c,u,d,h,y;return u=new mt({props:{text:"Delete Link",callback:r[3]}}),{c(){e=ve("Distance: "),n=ve(t),s=ve(` km
    `),i=E("label"),a=ve(`Bandwidth:
      `),o=E("input"),l=T(),c=E("div"),Q(u.$$.fragment),this.h()},l(b){e=ke(b,"Distance: "),n=ke(b,t),s=ke(b,` km
    `),i=C(b,"LABEL",{class:!0});var g=M(i);a=ke(g,`Bandwidth:
      `),o=C(g,"INPUT",{type:!0,class:!0}),g.forEach(f),l=P(b),c=C(b,"DIV",{class:!0});var _=M(c);ee(u.$$.fragment,_),_.forEach(f),this.h()},h(){v(o,"type","number"),o.disabled=r[2],v(o,"class","svelte-11gx5jd"),v(i,"class","svelte-11gx5jd"),v(c,"class","svelte-11gx5jd")},m(b,g){k(b,e,g),k(b,n,g),k(b,s,g),k(b,i,g),$(i,a),$(i,o),Ne(o,r[0].bandwidth),k(b,l,g),k(b,c,g),te(u,c,null),d=!0,h||(y=he(o,"input",r[4]),h=!0)},p(b,g){(!d||g&1)&&t!==(t=b[0].distance+"")&&Ye(n,t),(!d||g&4)&&(o.disabled=b[2]),g&1&&et(o.value)!==b[0].bandwidth&&Ne(o,b[0].bandwidth)},i(b){d||(D(u.$$.fragment,b),d=!0)},o(b){Z(u.$$.fragment,b),d=!1},d(b){b&&(f(e),f(n),f(s),f(i),f(l),f(c)),ne(u),h=!1,y()}}}function $i(r){let e,t,n,s;const i=[Ii,Ci],a=[];function o(l,c){return l[0]?0:1}return e=o(r),t=a[e]=i[e](r),{c(){t.c(),n=Re()},l(l){t.l(l),n=Re()},m(l,c){a[e].m(l,c),k(l,n,c),s=!0},p(l,c){let u=e;e=o(l),e===u?a[e].p(l,c):(Se(),Z(a[u],1,1,()=>{a[u]=null}),Be(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),D(t,1),t.m(n.parentNode,n))},i(l){s||(D(t),s=!0)},o(l){Z(t),s=!1},d(l){l&&f(n),a[e].d(l)}}}function Li(r){let e,t,n;function s(a){r[5](a)}let i={$$slots:{default:[$i]},$$scope:{ctx:r}};return r[1]!==void 0&&(i.dialog=r[1]),e=new Jt({props:i}),Oe.push(()=>qe(e,"dialog",s)),e.$on("close",r[6]),{c(){Q(e.$$.fragment)},l(a){ee(e.$$.fragment,a)},m(a,o){te(e,a,o),n=!0},p(a,[o]){const l={};o&133&&(l.$$scope={dirty:o,ctx:a}),!t&&o&2&&(t=!0,l.dialog=a[1],Ue(()=>t=!1)),e.$set(l)},i(a){n||(D(e.$$.fragment,a),n=!0)},o(a){Z(e.$$.fragment,a),n=!1},d(a){ne(e,a)}}}function Ri(r,e,t){let n;je(r,kt,u=>t(2,n=u));let{link:s}=e,{dialog:i}=e;function a(){if(!n&&s){if(!confirm("Are you sure you want to delete this link?"))return;Y.deleteLink(s.id),i.close()}else alert("You can't delete a link while the network is locked.")}function o(){s.bandwidth=et(this.value),t(0,s)}function l(u){i=u,t(1,i)}const c=()=>{Y.notify()};return r.$$set=u=>{"link"in u&&t(0,s=u.link),"dialog"in u&&t(1,i=u.dialog)},[s,i,n,a,o,l,c]}class Ti extends $e{constructor(e){super(),Le(this,e,Ri,Li,Ie,{link:0,dialog:1})}}function zn(r){let e,t="Loading...";return{c(){e=E("p"),e.textContent=t,this.h()},l(n){e=C(n,"P",{style:!0,"data-svelte-h":!0}),le(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){ct(e,"font-size","200px")},m(n,s){k(n,e,s)},d(n){n&&f(e)}}}function Vn(r){let e,t,n,s,i,a;return{c(){e=ot("line"),this.h()},l(o){e=lt(o,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),M(e).forEach(f),this.h()},h(){v(e,"class","preview"),v(e,"x1",t=r[5].node.x),v(e,"y1",n=r[5].node.y),v(e,"x2",s=r[21](r[2].x)),v(e,"y2",i=r[22](r[2].y)),v(e,"stroke",a=r[7]===r[13].CONNECTING?"green":"blue")},m(o,l){k(o,e,l)},p(o,l){l[0]&32&&t!==(t=o[5].node.x)&&v(e,"x1",t),l[0]&32&&n!==(n=o[5].node.y)&&v(e,"y1",n),l[0]&4&&s!==(s=o[21](o[2].x))&&v(e,"x2",s),l[0]&4&&i!==(i=o[22](o[2].y))&&v(e,"y2",i),l[0]&128&&a!==(a=o[7]===o[13].CONNECTING?"green":"blue")&&v(e,"stroke",a)},d(o){o&&f(e)}}}function Un(r){let e,t,n,s,i,a=r[12].placing+"",o,l,c;return{c(){e=ot("image"),i=ot("text"),o=ve(a),this.h()},l(u){e=lt(u,"image",{x:!0,y:!0,width:!0,height:!0,href:!0}),M(e).forEach(f),i=lt(u,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var d=M(i);o=ke(d,a),d.forEach(f),this.h()},h(){v(e,"x",t=r[21](r[3].x)-45/2),v(e,"y",n=r[22](r[3].y)-45/2),v(e,"width","45"),v(e,"height","45"),v(e,"href",s=`Router/${r[12].placing}.svg`),v(i,"x",l=r[21](r[3].x)),v(i,"y",c=r[22](r[3].y)),v(i,"dominant-baseline","central"),v(i,"font-size","smaller"),v(i,"class","svelte-huetud")},m(u,d){k(u,e,d),k(u,i,d),$(i,o)},p(u,d){d[0]&8&&t!==(t=u[21](u[3].x)-45/2)&&v(e,"x",t),d[0]&8&&n!==(n=u[22](u[3].y)-45/2)&&v(e,"y",n),d[0]&4096&&s!==(s=`Router/${u[12].placing}.svg`)&&v(e,"href",s),d[0]&4096&&a!==(a=u[12].placing+"")&&Ye(o,a),d[0]&8&&l!==(l=u[21](u[3].x))&&v(i,"x",l),d[0]&8&&c!==(c=u[22](u[3].y))&&v(i,"y",c)},d(u){u&&(f(e),f(i))}}}function Pi(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g,_=!r[10]&&zn(),m=(!r[0]&&r[7]===r[13].CONNECTING||r[7]===r[13].ADDING_DESTINATION)&&r[5]&&Vn(r);const p=r[25].default,I=hr(p,r,r[24],null);let H=r[7]===r[13].ADDING_ROUTERS&&r[12].placing&&Un(r);function L(w){r[28](w)}function j(w){r[29](w)}let N={};r[5]!==void 0&&(N.router=r[5]),r[8]!==void 0&&(N.dialog=r[8]),a=new Ei({props:N}),Oe.push(()=>qe(a,"router",L)),Oe.push(()=>qe(a,"dialog",j));function z(w){r[30](w)}function G(w){r[31](w)}let S={};return r[6]!==void 0&&(S.link=r[6]),r[9]!==void 0&&(S.dialog=r[9]),u=new Ti({props:S}),Oe.push(()=>qe(u,"link",z)),Oe.push(()=>qe(u,"dialog",G)),{c(){_&&_.c(),e=T(),t=ot("svg"),m&&m.c(),n=Re(),I&&I.c(),H&&H.c(),i=T(),Q(a.$$.fragment),c=T(),Q(u.$$.fragment),this.h()},l(w){_&&_.l(w),e=P(w),t=lt(w,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var A=M(t);m&&m.l(A),n=Re(),I&&I.l(A),H&&H.l(A),A.forEach(f),i=P(w),ee(a.$$.fragment,w),c=P(w),ee(u.$$.fragment,w),this.h()},h(){v(t,"viewBox",s=`${r[1].x} ${r[1].y} ${r[1].width} ${r[1].height}`),v(t,"role","button"),v(t,"tabindex","-1"),v(t,"class","svelte-huetud"),ct(t,"cursor",r[11][r[7]])},m(w,A){_&&_.m(w,A),k(w,e,A),k(w,t,A),m&&m.m(t,null),$(t,n),I&&I.m(t,null),H&&H.m(t,null),r[27](t),k(w,i,A),te(a,w,A),k(w,c,A),te(u,w,A),y=!0,b||(g=[he(window,"keydown",r[15]),he(t,"pointerdown",r[16]),he(t,"pointermove",r[14]),he(t,"pointerup",r[17]),he(t,"wheel",r[18]),he(t,"dblclick",r[19]),he(t,"dragover",Pr(r[26])),he(t,"drop",r[20])],b=!0)},p(w,A){w[10]?_&&(_.d(1),_=null):_||(_=zn(),_.c(),_.m(e.parentNode,e)),(!w[0]&&w[7]===w[13].CONNECTING||w[7]===w[13].ADDING_DESTINATION)&&w[5]?m?m.p(w,A):(m=Vn(w),m.c(),m.m(t,n)):m&&(m.d(1),m=null),I&&I.p&&(!y||A[0]&16777216)&&pr(I,p,w,w[24],y?gr(p,w[24],A,null):mr(w[24]),null),w[7]===w[13].ADDING_ROUTERS&&w[12].placing?H?H.p(w,A):(H=Un(w),H.c(),H.m(t,null)):H&&(H.d(1),H=null),(!y||A[0]&2&&s!==(s=`${w[1].x} ${w[1].y} ${w[1].width} ${w[1].height}`))&&v(t,"viewBox",s),A[0]&2176&&ct(t,"cursor",w[11][w[7]]);const R={};!o&&A[0]&32&&(o=!0,R.router=w[5],Ue(()=>o=!1)),!l&&A[0]&256&&(l=!0,R.dialog=w[8],Ue(()=>l=!1)),a.$set(R);const F={};!d&&A[0]&64&&(d=!0,F.link=w[6],Ue(()=>d=!1)),!h&&A[0]&512&&(h=!0,F.dialog=w[9],Ue(()=>h=!1)),u.$set(F)},i(w){y||(D(I,w),D(a.$$.fragment,w),D(u.$$.fragment,w),y=!0)},o(w){Z(I,w),Z(a.$$.fragment,w),Z(u.$$.fragment,w),y=!1},d(w){w&&(f(e),f(t),f(i),f(c)),_&&_.d(w),m&&m.d(),I&&I.d(w),H&&H.d(),r[27](null),ne(a,w),ne(u,w),b=!1,xt(g)}}}function Ni(r,e,t){let n,s,i,a;je(r,kt,x=>t(0,s=x)),je(r,Je,x=>t(12,i=x)),je(r,Ge,x=>t(33,a=x));let{$$slots:o={},$$scope:l}=e;var c=(x=>(x[x.NONE=0]="NONE",x[x.DRAGGING=1]="DRAGGING",x[x.PANNING=2]="PANNING",x[x.CONNECTING=3]="CONNECTING",x[x.ADDING_DESTINATION=4]="ADDING_DESTINATION",x[x.ADDING_ROUTERS=5]="ADDING_ROUTERS",x))(c||{});const u={x:0,y:0,width:0,height:0,get scale(){return b?this.width/b.getBoundingClientRect().width:1}},d={x:0,y:0},h={x:0,y:0},y={x:0,y:0};let b=null,g=null,_=null,m=0,p,I,H=!1;Je.subscribe(x=>{x.placing&&["CE","LER","LSR"].includes(x.placing)?t(7,m=5):t(7,m=0)}),wn(()=>{if(!b)return;new ResizeObserver(L).observe(b),requestAnimationFrame(()=>{b&&(t(1,u.x=b.getBoundingClientRect().width/-2,u),t(1,u.y=b.getBoundingClientRect().height/-2,u))}),t(10,H=!0)});function L(){if(!b)return;const x=u.scale||1;t(1,u.width=b.getBoundingClientRect().width*x,u),t(1,u.height=b.getBoundingClientRect().height*x,u)}function j(x){t(3,y.x=x.clientX,y),t(3,y.y=x.clientY,y)}function N(x){switch(x.code){case"Escape":We(Je,i.placing=null,i);break;case"Tab":if(p.open||I.open)return;x.preventDefault(),We(kt,s=!s,s),We(Je,i.placing=null,i),Y.clearPackets();break;case"Digit1":We(Je,i.placing="CE",i);break;case"Digit2":We(Je,i.placing="LER",i);break;case"Digit3":We(Je,i.placing="LSR",i);break;case"Space":x.preventDefault(),We(Ge,a.running=!a.running,a)}}function z(x){if(!(x.target instanceof Element))return;if(x.preventDefault(),m===5){switch(i.placing){case"CE":Y.createCE(ie(x.clientX),be(x.clientY));break;case"LER":Y.createLER(ie(x.clientX),be(x.clientY));break;case"LSR":Y.createLSR(ie(x.clientX),be(x.clientY));break}x.shiftKey||We(Je,i.placing=null,i);return}b==null||b.addEventListener("pointermove",S),b==null||b.setPointerCapture(x.pointerId);const oe=x.target.id;if(oe){if(t(5,g=Y.getRouter(parseInt(oe))||null),!g)return;x.shiftKey?t(7,m=3):x.altKey&&g instanceof ze?t(7,m=4):(h.x=g.node.x,h.y=g.node.y,t(7,m=1))}else t(7,m=2);t(2,d.x=x.clientX,d),t(2,d.y=x.clientY,d)}function G(x){if(x.target instanceof Element&&m!==5){x.preventDefault();e:if(g&&m===4){const oe=document.elementFromPoint(x.clientX,x.clientY),ge=(oe==null?void 0:oe.tagName)==="image"?oe.id:null,Te=Y.getRouter(parseInt(ge??""));if(!Te||g===Te)break e;if(!(Te instanceof ze)){alert("Destination must be a CE");break e}const at=Cn(g,Te);if(at.length<=1){alert("No path found");break e}Lr(at,Te.address),Y.notify()}t(7,m=0),t(5,g=null),b==null||b.releasePointerCapture(x.pointerId),b==null||b.removeEventListener("pointermove",S)}}function S(x){x.preventDefault();const oe={x:(x.clientX-d.x)*u.scale,y:(x.clientY-d.y)*u.scale};if(!s&&m===1&&g)t(5,g.node.x=Math.round(h.x+oe.x),g),t(5,g.node.y=Math.round(h.y+oe.y),g),Y.notify();else if(m===2)t(2,d.x=x.clientX,d),t(2,d.y=x.clientY,d),t(1,u.x-=oe.x,u),t(1,u.y-=oe.y,u);else if(m===4)t(2,d.x=x.clientX,d),t(2,d.y=x.clientY,d);else if(!s&&m===3){t(2,d.x=x.clientX,d),t(2,d.y=x.clientY,d);const ge=document.elementFromPoint(x.clientX,x.clientY);if(!ge)return;const Te=Y.getRouter(parseInt(ge.id));ge.tagName==="image"&&Te&&g&&(Y.addLink({source:g,target:Te}),t(5,g=Te))}}function w(x){x.preventDefault(),t(2,d.x=x.clientX,d),t(2,d.y=x.clientY,d);const oe=x.deltaY>0?1.025:.975;A(oe,d)}function A(x,oe){if(!b||u.scale<.1&&x<1||u.scale>5&&x>1)return;const ge=b.getBoundingClientRect(),Te={x:(oe.x-ge.left)/ge.width,y:(oe.y-ge.top)/ge.height};t(1,u.x-=u.width*(x-1)*Te.x,u),t(1,u.y-=u.height*(x-1)*Te.y,u),t(1,u.width*=x,u),t(1,u.height*=x,u)}function R(x){if(!(x.target instanceof Element))return;x.preventDefault();const oe=document.elementFromPoint(x.clientX,x.clientY);oe&&(oe.tagName==="image"?F(oe.id):oe.tagName==="rect"&&fe(oe.id))}function F(x){const oe=Y.getRouter(parseInt(x));oe&&(t(5,g=oe),p.showModal())}function fe(x){const oe=Y.links.find(ge=>x===ge.id);oe&&(t(6,_=oe),I.showModal())}function K(x){var ge;x.preventDefault();const oe=(ge=x.dataTransfer)==null?void 0:ge.getData("text/plain");if(oe)switch(oe){case"CE":Y.createCE(ie(x.clientX),be(x.clientY));break;case"LER":Y.createLER(ie(x.clientX),be(x.clientY));break;case"LSR":Y.createLSR(ie(x.clientX),be(x.clientY));break}}function ie(x){return b?(x-b.getBoundingClientRect().left)*u.scale+u.x:x}function be(x){return b?(x-b.getBoundingClientRect().top)*u.scale+u.y:x}function xe(x){_r.call(this,r,x)}function Ee(x){Oe[x?"unshift":"push"](()=>{b=x,t(4,b)})}function Ze(x){g=x,t(5,g)}function De(x){p=x,t(8,p)}function He(x){_=x,t(6,_)}function V(x){I=x,t(9,I)}return r.$$set=x=>{"$$scope"in x&&t(24,l=x.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&1&&t(11,n={0:"move",1:s?"not-allowed":"grabbing",2:"grabbing",3:s?"not-allowed":"crosshair",4:"crosshair",5:"none"})},[s,u,d,y,b,g,_,m,p,I,H,n,i,c,j,N,z,G,w,R,K,ie,be,A,l,o,xe,Ee,Ze,De,He,V]}class Si extends $e{constructor(e){super(),Le(this,e,Ni,Pi,Ie,{zoom:23},null,[-1,-1])}get zoom(){return this.$$.ctx[23]}}function Bi(r){let e,t,n=r[0].address+"",s,i,a,o="→",l,c,u=r[1].address+"",d,h,y,b,g,_;return y=new Qe({props:{text:"Play",callback:r[2]}}),g=new Qe({props:{text:"Delete",callback:r[3]}}),{c(){e=E("div"),t=E("p"),s=ve(n),i=T(),a=E("p"),a.textContent=o,l=T(),c=E("p"),d=ve(u),h=T(),Q(y.$$.fragment),b=T(),Q(g.$$.fragment),this.h()},l(m){e=C(m,"DIV",{class:!0});var p=M(e);t=C(p,"P",{class:!0});var I=M(t);s=ke(I,n),I.forEach(f),i=P(p),a=C(p,"P",{class:!0,"data-svelte-h":!0}),le(a)!=="svelte-1giyjq6"&&(a.textContent=o),l=P(p),c=C(p,"P",{class:!0});var H=M(c);d=ke(H,u),H.forEach(f),h=P(p),ee(y.$$.fragment,p),b=P(p),ee(g.$$.fragment,p),p.forEach(f),this.h()},h(){v(t,"class","svelte-ikhsiz"),v(a,"class","svelte-ikhsiz"),v(c,"class","svelte-ikhsiz"),v(e,"class","svelte-ikhsiz")},m(m,p){k(m,e,p),$(e,t),$(t,s),$(e,i),$(e,a),$(e,l),$(e,c),$(c,d),$(e,h),te(y,e,null),$(e,b),te(g,e,null),_=!0},p(m,[p]){(!_||p&1)&&n!==(n=m[0].address+"")&&Ye(s,n),(!_||p&2)&&u!==(u=m[1].address+"")&&Ye(d,u)},i(m){_||(D(y.$$.fragment,m),D(g.$$.fragment,m),_=!0)},o(m){Z(y.$$.fragment,m),Z(g.$$.fragment,m),_=!1},d(m){m&&f(e),ne(y),ne(g)}}}function Di(r,e,t){let{source:n}=e,{destination:s}=e;function i(){Y.addPacket(n,s)}function a(){confirm("Are you sure you want to delete this LSP?")&&(n.deleteEntry(s.address),Y.notify())}return r.$$set=o=>{"source"in o&&t(0,n=o.source),"destination"in o&&t(1,s=o.destination)},[n,s,i,a]}class Hi extends $e{constructor(e){super(),Le(this,e,Di,Bi,Ie,{source:0,destination:1})}}function qn(r,e,t){const n=r.slice();return n[2]=e[t],n}function Yn(r,e,t){const n=r.slice();return n[5]=e[t][0],n}function Wn(r){let e,t;return e=new Hi({props:{source:r[2],destination:Y.getSureCERouter(r[5])}}),{c(){Q(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,s){te(e,n,s),t=!0},p(n,s){const i={};s&1&&(i.source=n[2]),s&1&&(i.destination=Y.getSureCERouter(n[5])),e.$set(i)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){Z(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Gn(r){let e,t,n=we([...r[2].firstHop]),s=[];for(let a=0;a<n.length;a+=1)s[a]=Wn(Yn(r,n,a));const i=a=>Z(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Re()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Re()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);k(a,e,o),t=!0},p(a,o){if(o&1){n=we([...a[2].firstHop]);let l;for(l=0;l<n.length;l+=1){const c=Yn(a,n,l);s[l]?(s[l].p(c,o),D(s[l],1)):(s[l]=Wn(c),s[l].c(),D(s[l],1),s[l].m(e.parentNode,e))}for(Se(),l=n.length;l<s.length;l+=1)i(l);Be()}},i(a){if(!t){for(let o=0;o<n.length;o+=1)D(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)Z(s[o]);t=!1},d(a){a&&f(e),ut(s,a)}}}function Oi(r){let e,t,n=we(r[0]),s=[];for(let a=0;a<n.length;a+=1)s[a]=Gn(qn(r,n,a));const i=a=>Z(s[a],1,1,()=>{s[a]=null});return{c(){e=E("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=C(a,"DIV",{class:!0});var o=M(e);for(let l=0;l<s.length;l+=1)s[l].l(o);o.forEach(f),this.h()},h(){v(e,"class","svelte-kwkmok")},m(a,o){k(a,e,o);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(a,[o]){if(o&1){n=we(a[0]);let l;for(l=0;l<n.length;l+=1){const c=qn(a,n,l);s[l]?(s[l].p(c,o),D(s[l],1)):(s[l]=Gn(c),s[l].c(),D(s[l],1),s[l].m(e,null))}for(Se(),l=n.length;l<s.length;l+=1)i(l);Be()}},i(a){if(!t){for(let o=0;o<n.length;o+=1)D(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)Z(s[o]);t=!1},d(a){a&&f(e),ut(s,a)}}}function ji(r,e,t){let n,s;return je(r,Y,i=>t(1,s=i)),r.$$.update=()=>{r.$$.dirty&2&&t(0,n=s.routers.filter(i=>i instanceof ze))},[n,s]}class Zi extends $e{constructor(e){super(),Le(this,e,ji,Oi,Ie,{})}}function Xn(r,e,t){const n=r.slice();return n[15]=e[t],n}function Jn(r){let e,t;const n=[r[15],{style:"padding: 10px 20px"}];let s={};for(let i=0;i<n.length;i+=1)s=Yt(s,n[i]);return e=new Qe({props:s}),{c(){Q(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){const o=a&64?Wt(n,[Gt(i[15]),n[1]]):{};e.$set(o)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){Z(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function Ai(r){let e,t,n,s,i,a,o,l="Packet Controls",c,u,d,h=r[2].packets.length+"",y,b,g,_,m,p,I,H,L=r[1].speedMultiplier.toFixed(1)+"",j,N,z,G,S,w,A,R=r[1].maxPackets+"",F,fe,K,ie,be,xe,Ee,Ze="Fallback to normal IP routing?",De,He,V,x,oe,ge,Te,at,Fe=we(r[6]),ye=[];for(let se=0;se<Fe.length;se+=1)ye[se]=Jn(Xn(r,Fe,se));const Rt=se=>Z(ye[se],1,1,()=>{ye[se]=null});return x=new Zi({}),{c(){e=E("div"),t=E("div"),s=T(),i=E("div"),a=E("div"),o=E("p"),o.textContent=l,c=T(),u=E("p"),d=ve("Count: "),y=ve(h),b=T(),g=E("div");for(let se=0;se<ye.length;se+=1)ye[se].c();_=T(),m=E("div"),p=E("div"),I=E("p"),H=ve("Speed Multiplier: "),j=ve(L),N=T(),z=E("input"),G=T(),S=E("div"),w=E("p"),A=ve("Max Packets: "),F=ve(R),fe=T(),K=E("input"),ie=T(),be=E("div"),xe=E("label"),Ee=E("p"),Ee.textContent=Ze,De=T(),He=E("input"),V=T(),Q(x.$$.fragment),this.h()},l(se){e=C(se,"DIV",{id:!0,style:!0,class:!0});var _e=M(e);t=C(_e,"DIV",{id:!0,class:!0}),M(t).forEach(f),_e.forEach(f),s=P(se),i=C(se,"DIV",{id:!0,style:!0,class:!0});var me=M(i);a=C(me,"DIV",{id:!0,class:!0});var Ae=M(a);o=C(Ae,"P",{id:!0,class:!0,"data-svelte-h":!0}),le(o)!=="svelte-1cfybk8"&&(o.textContent=l),c=P(Ae),u=C(Ae,"P",{id:!0,class:!0});var gt=M(u);d=ke(gt,"Count: "),y=ke(gt,h),gt.forEach(f),b=P(Ae),g=C(Ae,"DIV",{id:!0,class:!0});var wt=M(g);for(let fn=0;fn<ye.length;fn+=1)ye[fn].l(wt);wt.forEach(f),_=P(Ae),m=C(Ae,"DIV",{class:!0});var tt=M(m);p=C(tt,"DIV",{class:!0});var Xe=M(p);I=C(Xe,"P",{class:!0});var Tt=M(I);H=ke(Tt,"Speed Multiplier: "),j=ke(Tt,L),Tt.forEach(f),N=P(Xe),z=C(Xe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Xe.forEach(f),G=P(tt),S=C(tt,"DIV",{class:!0});var B=M(S);w=C(B,"P",{class:!0});var X=M(w);A=ke(X,"Max Packets: "),F=ke(X,R),X.forEach(f),fe=P(B),K=C(B,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),B.forEach(f),ie=P(tt),be=C(tt,"DIV",{class:!0});var In=M(be);xe=C(In,"LABEL",{class:!0});var Kt=M(xe);Ee=C(Kt,"P",{class:!0,"data-svelte-h":!0}),le(Ee)!=="svelte-1re47ui"&&(Ee.textContent=Ze),De=P(Kt),He=C(Kt,"INPUT",{type:!0,class:!0}),Kt.forEach(f),In.forEach(f),tt.forEach(f),V=P(Ae),ee(x.$$.fragment,Ae),Ae.forEach(f),me.forEach(f),this.h()},h(){v(t,"id","resize-bar"),v(t,"class","svelte-1jfhuaz"),v(e,"id","visual-resize-bar"),v(e,"style",n=`width: ${r[0]?1:0}px`),v(e,"class","svelte-1jfhuaz"),v(o,"id","packet-controls-title"),v(o,"class","svelte-1jfhuaz"),v(u,"id","packet-controls-count"),v(u,"class","svelte-1jfhuaz"),v(g,"id","control-panel-buttons"),v(g,"class","svelte-1jfhuaz"),v(I,"class","svelte-1jfhuaz"),v(z,"type","range"),v(z,"min","0.1"),v(z,"max","2"),v(z,"step","0.001"),v(z,"class","svelte-1jfhuaz"),v(p,"class","input-box svelte-1jfhuaz"),v(w,"class","svelte-1jfhuaz"),v(K,"type","range"),v(K,"min","1"),v(K,"max","500"),v(K,"step","1"),v(K,"class","svelte-1jfhuaz"),v(S,"class","input-box svelte-1jfhuaz"),v(Ee,"class","svelte-1jfhuaz"),v(He,"type","checkbox"),v(He,"class","svelte-1jfhuaz"),v(xe,"class","svelte-1jfhuaz"),v(be,"class","input-box svelte-1jfhuaz"),v(m,"class","inputs svelte-1jfhuaz"),v(a,"id","control-panel-content"),v(a,"class","svelte-1jfhuaz"),v(i,"id","control-panel"),v(i,"style",oe=`width: ${r[5]}px; transition: ${r[4]};`),v(i,"class","svelte-1jfhuaz")},m(se,_e){k(se,e,_e),$(e,t),r[9](t),k(se,s,_e),k(se,i,_e),$(i,a),$(a,o),$(a,c),$(a,u),$(u,d),$(u,y),$(a,b),$(a,g);for(let me=0;me<ye.length;me+=1)ye[me]&&ye[me].m(g,null);$(a,_),$(a,m),$(m,p),$(p,I),$(I,H),$(I,j),$(p,N),$(p,z),Ne(z,r[1].speedMultiplier),$(m,G),$(m,S),$(S,w),$(w,A),$(w,F),$(S,fe),$(S,K),Ne(K,r[1].maxPackets),$(m,ie),$(m,be),$(be,xe),$(xe,Ee),$(xe,De),$(xe,He),He.checked=r[1].enableFallback,$(a,V),te(x,a,null),ge=!0,Te||(at=[he(t,"pointerdown",r[7]),he(z,"change",r[10]),he(z,"input",r[10]),he(K,"change",r[11]),he(K,"input",r[11]),he(He,"change",r[12])],Te=!0)},p(se,[_e]){if((!ge||_e&1&&n!==(n=`width: ${se[0]?1:0}px`))&&v(e,"style",n),(!ge||_e&4)&&h!==(h=se[2].packets.length+"")&&Ye(y,h),_e&64){Fe=we(se[6]);let me;for(me=0;me<Fe.length;me+=1){const Ae=Xn(se,Fe,me);ye[me]?(ye[me].p(Ae,_e),D(ye[me],1)):(ye[me]=Jn(Ae),ye[me].c(),D(ye[me],1),ye[me].m(g,null))}for(Se(),me=Fe.length;me<ye.length;me+=1)Rt(me);Be()}(!ge||_e&2)&&L!==(L=se[1].speedMultiplier.toFixed(1)+"")&&Ye(j,L),_e&2&&Ne(z,se[1].speedMultiplier),(!ge||_e&2)&&R!==(R=se[1].maxPackets+"")&&Ye(F,R),_e&2&&Ne(K,se[1].maxPackets),_e&2&&(He.checked=se[1].enableFallback),(!ge||_e&48&&oe!==(oe=`width: ${se[5]}px; transition: ${se[4]};`))&&v(i,"style",oe)},i(se){if(!ge){for(let _e=0;_e<Fe.length;_e+=1)D(ye[_e]);D(x.$$.fragment,se),ge=!0}},o(se){ye=ye.filter(Boolean);for(let _e=0;_e<ye.length;_e+=1)Z(ye[_e]);Z(x.$$.fragment,se),ge=!1},d(se){se&&(f(e),f(s),f(i)),r[9](null),ut(ye,se),ne(x),Te=!1,xt(at)}}}function Mi(r,e,t){let n,s,i,a,o,l;je(r,kt,p=>t(0,a=p)),je(r,Ge,p=>t(1,o=p)),je(r,Y,p=>t(2,l=p));let c,u="width 200ms";function d(p){a&&(t(4,u="none"),c.setPointerCapture(p.pointerId),c.addEventListener("pointermove",h),c.addEventListener("pointerup",y))}function h(p){t(5,i=window.innerWidth-p.clientX),i<=20&&t(5,i=0),i>=window.innerWidth-350&&t(5,i=window.innerWidth-350)}function y(p){c.removeEventListener("pointermove",h),c.removeEventListener("pointerup",y),c.releasePointerCapture(p.pointerId),t(4,u="width 200ms")}function b(p){Oe[p?"unshift":"push"](()=>{c=p,t(3,c)})}function g(){o.speedMultiplier=et(this.value),Ge.set(o)}function _(){o.maxPackets=et(this.value),Ge.set(o)}function m(){o.enableFallback=this.checked,Ge.set(o)}return r.$$.update=()=>{r.$$.dirty&4&&t(8,n=l.routers.filter(p=>p instanceof ze)),r.$$.dirty&258&&t(6,s=[{text:o.running?"⏸ Pause":"⏵ Play",callback:()=>{We(Ge,o.running=!o.running,o)}},{text:"Reset",callback:()=>{Y.clearPackets()}},{text:"Play All",callback:()=>{for(const p of n)for(const[I]of p.firstHop)Y.addPacket(p,Y.getSureCERouter(I))}}]),r.$$.dirty&1&&t(5,i=a?350:0)},[a,o,l,c,u,i,s,d,n,b,g,_,m]}class Fi extends $e{constructor(e){super(),Le(this,e,Mi,Ai,Ie,{})}}function zi(r){let e;return{c(){e=ot("circle"),this.h()},l(t){e=lt(t,"circle",{r:!0,class:!0}),M(e).forEach(f),this.h()},h(){v(e,"r","5"),v(e,"class","svelte-rvo2j9"),$n(e,"labeled",r[0].label!==-1)},m(t,n){k(t,e,n),r[4](e)},p(t,[n]){n&1&&$n(e,"labeled",t[0].label!==-1)},i:Pe,o:Pe,d(t){t&&f(e),r[4](null)}}}function Vi(r,e,t){let n;je(r,Ge,h=>t(3,n=h));let{packet:s}=e,i,a,o;function l(){const h=Math.sqrt((s.node.x-s.nextHop.node.x)**2+(s.node.y-s.nextHop.node.y)**2);i=Math.round(h/250*1e3)}function c(){if(l(),!o)return;const h=s.node,y=s.nextHop.node;t(2,a=o.animate({transform:[`translate(${h.x}px, ${h.y}px)`,`translate(${y.x}px, ${y.y}px)`]},{duration:i,easing:"linear"})),t(2,a.onfinish=u,a)}function u(){t(0,s.node=s.nextHop.node,s);const h=s.nextHop;if(h.receivePacket(s),h!==s.nextHop){if(!s.validateNextHop(h))return s.drop("Invalid next hop");c()}}requestAnimationFrame(c);function d(h){Oe[h?"unshift":"push"](()=>{o=h,t(1,o)})}return r.$$set=h=>{"packet"in h&&t(0,s=h.packet)},r.$$.update=()=>{r.$$.dirty&12&&a&&t(2,a.playbackRate=n.speedMultiplier,a),r.$$.dirty&12&&a&&requestAnimationFrame(()=>{n.running?a.play():a.pause()})},[s,o,a,n,d]}class Ui extends $e{constructor(e){super(),Le(this,e,Vi,zi,Ie,{packet:0})}}function qi(r){let e,t,n,s,i,a,o,l,c=r[0].distance+"",u,d,h,y;return{c(){e=ot("line"),t=T(),n=ot("rect"),o=T(),l=ot("text"),u=ve(c),d=ve(" km"),this.h()},l(b){e=lt(b,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),M(e).forEach(f),t=P(b),n=lt(b,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),M(n).forEach(f),o=P(b),l=lt(b,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var g=M(l);u=ke(g,c),d=ke(g," km"),g.forEach(f),this.h()},h(){v(e,"x1",r[4]),v(e,"y1",r[2]),v(e,"x2",r[3]),v(e,"y2",r[1]),v(n,"id",s=r[0].id),v(n,"x",i=r[5].x-_n/2),v(n,"y",a=r[5].y-bn/2),v(n,"width",_n),v(n,"height",bn),v(n,"class","svelte-zjn2k6"),v(l,"x",h=r[5].x),v(l,"y",y=r[5].y),v(l,"dominant-baseline","central"),v(l,"class","svelte-zjn2k6")},m(b,g){k(b,e,g),k(b,t,g),k(b,n,g),k(b,o,g),k(b,l,g),$(l,u),$(l,d)},p(b,[g]){g&16&&v(e,"x1",b[4]),g&4&&v(e,"y1",b[2]),g&8&&v(e,"x2",b[3]),g&2&&v(e,"y2",b[1]),g&1&&s!==(s=b[0].id)&&v(n,"id",s),g&32&&i!==(i=b[5].x-_n/2)&&v(n,"x",i),g&32&&a!==(a=b[5].y-bn/2)&&v(n,"y",a),g&1&&c!==(c=b[0].distance+"")&&Ye(u,c),g&32&&h!==(h=b[5].x)&&v(l,"x",h),g&32&&y!==(y=b[5].y)&&v(l,"y",y)},i:Pe,o:Pe,d(b){b&&(f(e),f(t),f(n),f(o),f(l))}}}const _n=50,bn=20;function Kn(r,e){return(r+e)/2}function Yi(r,e,t){let n,s,i,a,o,{link:l}=e;return r.$$set=c=>{"link"in c&&t(0,l=c.link)},r.$$.update=()=>{r.$$.dirty&1&&t(4,n=l.source.node.x),r.$$.dirty&1&&t(3,s=l.target.node.x),r.$$.dirty&1&&t(2,i=l.source.node.y),r.$$.dirty&1&&t(1,a=l.target.node.y),r.$$.dirty&30&&t(5,o={x:Kn(n,s),y:Kn(i,a)})},[l,a,i,s,n,o]}class Wi extends $e{constructor(e){super(),Le(this,e,Yi,qi,Ie,{link:0})}}function Gi(r){let e,t,n,s,i,a,o,l=r[0].node.label+"",c,u,d;return{c(){e=ot("image"),a=T(),o=ot("text"),c=ve(l),this.h()},l(h){e=lt(h,"image",{id:!0,x:!0,y:!0,width:!0,height:!0,href:!0,class:!0}),M(e).forEach(f),a=P(h),o=lt(h,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var y=M(o);c=ke(y,l),y.forEach(f),this.h()},h(){v(e,"id",t=r[0].id.toString()),v(e,"x",n=r[0].node.x-45/2),v(e,"y",s=r[0].node.y-45/2),v(e,"width","45"),v(e,"height","45"),v(e,"href",i=`Router/${r[0].type}.svg`),v(e,"class","svelte-1eo9fnr"),v(o,"x",u=r[0].node.x),v(o,"y",d=r[0].node.y+10),v(o,"dominant-baseline","central"),v(o,"font-size","smaller"),v(o,"class","svelte-1eo9fnr")},m(h,y){k(h,e,y),k(h,a,y),k(h,o,y),$(o,c)},p(h,[y]){y&1&&t!==(t=h[0].id.toString())&&v(e,"id",t),y&1&&n!==(n=h[0].node.x-45/2)&&v(e,"x",n),y&1&&s!==(s=h[0].node.y-45/2)&&v(e,"y",s),y&1&&i!==(i=`Router/${h[0].type}.svg`)&&v(e,"href",i),y&1&&l!==(l=h[0].node.label+"")&&Ye(c,l),y&1&&u!==(u=h[0].node.x)&&v(o,"x",u),y&1&&d!==(d=h[0].node.y+10)&&v(o,"y",d)},i:Pe,o:Pe,d(h){h&&(f(e),f(a),f(o))}}}function Xi(r,e,t){let{router:n}=e;return r.$$set=s=>{"router"in s&&t(0,n=s.router)},[n]}class Ji extends $e{constructor(e){super(),Le(this,e,Xi,Gi,Ie,{router:0})}}function Ki(r){let e,t,n,s;return{c(){e=E("div"),t=ve(r[0]),this.h()},l(i){e=C(i,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var a=M(e);t=ke(a,r[0]),a.forEach(f),this.h()},h(){v(e,"draggable","true"),v(e,"role","button"),v(e,"tabindex","-1"),ct(e,"background-color",r[1]),v(e,"class","svelte-dfkep2")},m(i,a){k(i,e,a),$(e,t),n||(s=[he(e,"dragstart",r[2]),he(e,"click",r[3])],n=!0)},p(i,[a]){a&1&&Ye(t,i[0]),a&2&&ct(e,"background-color",i[1])},i:Pe,o:Pe,d(i){i&&f(e),n=!1,xt(s)}}}function Qi(r,e,t){let n,s;je(r,Je,u=>t(5,n=u)),je(r,kt,u=>t(6,s=u));let{text:i}=e,{type:a}=e,{color:o}=e;function l(u){var d;if(s){alert("Network is locked.");return}(d=u.dataTransfer)==null||d.setData("text/plain",a)}function c(){We(Je,n.placing=a,n)}return r.$$set=u=>{"text"in u&&t(0,i=u.text),"type"in u&&t(4,a=u.type),"color"in u&&t(1,o=u.color)},[i,o,l,c,a]}class ea extends $e{constructor(e){super(),Le(this,e,Qi,Ki,Ie,{text:0,type:4,color:1})}}function Qn(r,e,t){const n=r.slice();return n[7]=e[t],n}function er(r,e,t){const n=r.slice();return n[7]=e[t],n}function tr(r,e,t){const n=r.slice();return n[10]=e[t],n}function ta(r){let e,t,n=we(r[0]),s=[];for(let a=0;a<n.length;a+=1)s[a]=nr(Qn(r,n,a));const i=a=>Z(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=Re()},l(a){for(let o=0;o<s.length;o+=1)s[o].l(a);e=Re()},m(a,o){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(a,o);k(a,e,o),t=!0},p(a,o){if(o&1){n=we(a[0]);let l;for(l=0;l<n.length;l+=1){const c=Qn(a,n,l);s[l]?(s[l].p(c,o),D(s[l],1)):(s[l]=nr(c),s[l].c(),D(s[l],1),s[l].m(e.parentNode,e))}for(Se(),l=n.length;l<s.length;l+=1)i(l);Be()}},i(a){if(!t){for(let o=0;o<n.length;o+=1)D(s[o]);t=!0}},o(a){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)Z(s[o]);t=!1},d(a){a&&f(e),ut(s,a)}}}function na(r){let e,t,n,s=we(r[4]),i=[];for(let u=0;u<s.length;u+=1)i[u]=rr(tr(r,s,u));const a=u=>Z(i[u],1,1,()=>{i[u]=null});let o=we(r[1]),l=[];for(let u=0;u<o.length;u+=1)l[u]=sr(er(r,o,u));const c=u=>Z(l[u],1,1,()=>{l[u]=null});return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=T();for(let u=0;u<l.length;u+=1)l[u].c();t=Re()},l(u){for(let d=0;d<i.length;d+=1)i[d].l(u);e=P(u);for(let d=0;d<l.length;d+=1)l[d].l(u);t=Re()},m(u,d){for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(u,d);k(u,e,d);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(u,d);k(u,t,d),n=!0},p(u,d){if(d&16){s=we(u[4]);let h;for(h=0;h<s.length;h+=1){const y=tr(u,s,h);i[h]?(i[h].p(y,d),D(i[h],1)):(i[h]=rr(y),i[h].c(),D(i[h],1),i[h].m(e.parentNode,e))}for(Se(),h=s.length;h<i.length;h+=1)a(h);Be()}if(d&2){o=we(u[1]);let h;for(h=0;h<o.length;h+=1){const y=er(u,o,h);l[h]?(l[h].p(y,d),D(l[h],1)):(l[h]=sr(y),l[h].c(),D(l[h],1),l[h].m(t.parentNode,t))}for(Se(),h=o.length;h<l.length;h+=1)c(h);Be()}},i(u){if(!n){for(let d=0;d<s.length;d+=1)D(i[d]);for(let d=0;d<o.length;d+=1)D(l[d]);n=!0}},o(u){i=i.filter(Boolean);for(let d=0;d<i.length;d+=1)Z(i[d]);l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)Z(l[d]);n=!1},d(u){u&&(f(e),f(t)),ut(i,u),ut(l,u)}}}function nr(r){let e,t;const n=[r[7]];let s={};for(let i=0;i<n.length;i+=1)s=Yt(s,n[i]);return e=new Qe({props:s}),{c(){Q(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){const o=a&1?Wt(n,[Gt(i[7])]):{};e.$set(o)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){Z(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function rr(r){let e,t;const n=[r[10]];let s={};for(let i=0;i<n.length;i+=1)s=Yt(s,n[i]);return e=new ea({props:s}),{c(){Q(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){const o=a&16?Wt(n,[Gt(i[10])]):{};e.$set(o)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){Z(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function sr(r){let e,t;const n=[r[7]];let s={};for(let i=0;i<n.length;i+=1)s=Yt(s,n[i]);return e=new Qe({props:s}),{c(){Q(e.$$.fragment)},l(i){ee(e.$$.fragment,i)},m(i,a){te(e,i,a),t=!0},p(i,a){const o=a&2?Wt(n,[Gt(i[7])]):{};e.$set(o)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){Z(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function ra(r){let e,t,n,s,i,a;e=new Qe({props:{text:r[2]?"Edit":"Simulation",callback:r[6],style:`width: 100px; background-color: ${r[2]?"#3CB371":"#6495ED"};`}});const o=[na,ta],l=[];function c(u,d){return u[2]?1:0}return n=c(r),s=l[n]=o[n](r),{c(){Q(e.$$.fragment),t=T(),s.c(),i=Re()},l(u){ee(e.$$.fragment,u),t=P(u),s.l(u),i=Re()},m(u,d){te(e,u,d),k(u,t,d),l[n].m(u,d),k(u,i,d),a=!0},p(u,[d]){const h={};d&4&&(h.text=u[2]?"Edit":"Simulation"),d&12&&(h.callback=u[6]),d&4&&(h.style=`width: 100px; background-color: ${u[2]?"#3CB371":"#6495ED"};`),e.$set(h);let y=n;n=c(u),n===y?l[n].p(u,d):(Se(),Z(l[y],1,1,()=>{l[y]=null}),Be(),s=l[n],s?s.p(u,d):(s=l[n]=o[n](u),s.c()),D(s,1),s.m(i.parentNode,i))},i(u){a||(D(e.$$.fragment,u),D(s),a=!0)},o(u){Z(e.$$.fragment,u),Z(s),a=!1},d(u){u&&(f(t),f(i)),ne(e,u),l[n].d(u)}}}function sa(r,e,t){let n,s,i,a,o;je(r,Y,u=>t(5,i=u)),je(r,kt,u=>t(2,a=u)),je(r,Je,u=>t(3,o=u));const l=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],c=()=>{We(kt,a=!a,a),We(Je,o.placing=null,o),Y.clearPackets()};return r.$$.update=()=>{r.$$.dirty&32&&t(0,s=[{text:"Clear Tables",callback:()=>{confirm("Are you sure you want to clear the routing tables?")&&Y.clearTables()}},{text:"Export",callback:()=>{const u={routers:i.routers.map(g=>{if(g instanceof ze)return{...g,type:g.type,firstHop:Object.fromEntries(g.firstHop)};if(g instanceof Ke)return{...g,type:g.type,FIB:Object.fromEntries(g.FIB.map),LFIB:Object.fromEntries(g.LFIB.map)};if(g instanceof Ct)return{...g,type:g.type,LFIB:Object.fromEntries(g.LFIB.map)}}),links:i.links.map(g=>({...g,source:g.source.id,target:g.target.id}))},d=JSON.stringify(u,null,2),h=new Blob([d],{type:"application/json"}),y=window.URL.createObjectURL(h),b=document.createElement("a");b.href=y,b.download="network.json",b.click(),window.URL.revokeObjectURL(y)}}]),r.$$.dirty&1&&t(1,n=[{text:"Clear Network",callback:()=>{confirm("Are you sure you want to clear the network?")&&Y.clear()}},{text:"Clear Links",callback:()=>{confirm("Are you sure you want to clear the links?")&&Y.clearLinks()}},...s])},[s,n,a,o,l,i,c]}class ia extends $e{constructor(e){super(),Le(this,e,sa,ra,Ie,{})}}function aa(r){let e,t="Drag and drop routers to add them to the network.",n,s,i,a,o=`Instead of drag and drop, you can also click and hold shift while continuously clicking to add
    many routers.`,l,c,u,d,h=`Pressing 1, 2 or 3 will respectively select CE, LER or LSR, this works with the holding of shift
    to insert routers.`,y,b,g,_,m="Pressing Space will pause/resume the packet animations.",p,I,H,L,j="Pressing Tab will open the packet control panel.",N,z,G,S,w="Hold Shift and drag routers to make links.",A,R,F,fe,K="Hold Ctrl and drag CE's to add destinations.",ie,be,xe,Ee,Ze="Double click a router or link to configure it.",De,He,V,x,oe="The clear button will delete the entire network.",ge,Te,at,Fe,ye="The export button will download your network as a .json file",Rt,se,_e,me,Ae="If you are experiencing packets going offroad, please lower the max packets count.",gt,wt,tt,Xe,Tt="Press Esc to close this popup.";return{c(){e=E("p"),e.textContent=t,n=T(),s=E("br"),i=T(),a=E("p"),a.textContent=o,l=T(),c=E("br"),u=T(),d=E("p"),d.textContent=h,y=T(),b=E("br"),g=T(),_=E("p"),_.textContent=m,p=T(),I=E("br"),H=T(),L=E("p"),L.textContent=j,N=T(),z=E("br"),G=T(),S=E("p"),S.textContent=w,A=T(),R=E("br"),F=T(),fe=E("p"),fe.textContent=K,ie=T(),be=E("br"),xe=T(),Ee=E("p"),Ee.textContent=Ze,De=T(),He=E("br"),V=T(),x=E("p"),x.textContent=oe,ge=T(),Te=E("br"),at=T(),Fe=E("p"),Fe.textContent=ye,Rt=T(),se=E("br"),_e=T(),me=E("p"),me.textContent=Ae,gt=T(),wt=E("br"),tt=T(),Xe=E("p"),Xe.textContent=Tt},l(B){e=C(B,"P",{"data-svelte-h":!0}),le(e)!=="svelte-bhocp0"&&(e.textContent=t),n=P(B),s=C(B,"BR",{}),i=P(B),a=C(B,"P",{"data-svelte-h":!0}),le(a)!=="svelte-12tzi3f"&&(a.textContent=o),l=P(B),c=C(B,"BR",{}),u=P(B),d=C(B,"P",{"data-svelte-h":!0}),le(d)!=="svelte-1gxe9lx"&&(d.textContent=h),y=P(B),b=C(B,"BR",{}),g=P(B),_=C(B,"P",{"data-svelte-h":!0}),le(_)!=="svelte-19sx7cb"&&(_.textContent=m),p=P(B),I=C(B,"BR",{}),H=P(B),L=C(B,"P",{"data-svelte-h":!0}),le(L)!=="svelte-1mdsx76"&&(L.textContent=j),N=P(B),z=C(B,"BR",{}),G=P(B),S=C(B,"P",{"data-svelte-h":!0}),le(S)!=="svelte-1dtxzou"&&(S.textContent=w),A=P(B),R=C(B,"BR",{}),F=P(B),fe=C(B,"P",{"data-svelte-h":!0}),le(fe)!=="svelte-7xq26y"&&(fe.textContent=K),ie=P(B),be=C(B,"BR",{}),xe=P(B),Ee=C(B,"P",{"data-svelte-h":!0}),le(Ee)!=="svelte-qvtprs"&&(Ee.textContent=Ze),De=P(B),He=C(B,"BR",{}),V=P(B),x=C(B,"P",{"data-svelte-h":!0}),le(x)!=="svelte-vcl8s3"&&(x.textContent=oe),ge=P(B),Te=C(B,"BR",{}),at=P(B),Fe=C(B,"P",{"data-svelte-h":!0}),le(Fe)!=="svelte-1ww5ij7"&&(Fe.textContent=ye),Rt=P(B),se=C(B,"BR",{}),_e=P(B),me=C(B,"P",{"data-svelte-h":!0}),le(me)!=="svelte-15en2mv"&&(me.textContent=Ae),gt=P(B),wt=C(B,"BR",{}),tt=P(B),Xe=C(B,"P",{"data-svelte-h":!0}),le(Xe)!=="svelte-1dvt5v1"&&(Xe.textContent=Tt)},m(B,X){k(B,e,X),k(B,n,X),k(B,s,X),k(B,i,X),k(B,a,X),k(B,l,X),k(B,c,X),k(B,u,X),k(B,d,X),k(B,y,X),k(B,b,X),k(B,g,X),k(B,_,X),k(B,p,X),k(B,I,X),k(B,H,X),k(B,L,X),k(B,N,X),k(B,z,X),k(B,G,X),k(B,S,X),k(B,A,X),k(B,R,X),k(B,F,X),k(B,fe,X),k(B,ie,X),k(B,be,X),k(B,xe,X),k(B,Ee,X),k(B,De,X),k(B,He,X),k(B,V,X),k(B,x,X),k(B,ge,X),k(B,Te,X),k(B,at,X),k(B,Fe,X),k(B,Rt,X),k(B,se,X),k(B,_e,X),k(B,me,X),k(B,gt,X),k(B,wt,X),k(B,tt,X),k(B,Xe,X)},p:Pe,d(B){B&&(f(e),f(n),f(s),f(i),f(a),f(l),f(c),f(u),f(d),f(y),f(b),f(g),f(_),f(p),f(I),f(H),f(L),f(N),f(z),f(G),f(S),f(A),f(R),f(F),f(fe),f(ie),f(be),f(xe),f(Ee),f(De),f(He),f(V),f(x),f(ge),f(Te),f(at),f(Fe),f(Rt),f(se),f(_e),f(me),f(gt),f(wt),f(tt),f(Xe))}}}function oa(r){let e,t,n,s,i,a;t=new Qe({props:{text:"Help",callback:r[1]}});function o(c){r[2](c)}let l={$$slots:{default:[aa]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.dialog=r[0]),s=new Jt({props:l}),Oe.push(()=>qe(s,"dialog",o)),{c(){e=E("div"),Q(t.$$.fragment),n=T(),Q(s.$$.fragment)},l(c){e=C(c,"DIV",{});var u=M(e);ee(t.$$.fragment,u),u.forEach(f),n=P(c),ee(s.$$.fragment,c)},m(c,u){k(c,e,u),te(t,e,null),k(c,n,u),te(s,c,u),a=!0},p(c,[u]){const d={};u&1&&(d.callback=c[1]),t.$set(d);const h={};u&8&&(h.$$scope={dirty:u,ctx:c}),!i&&u&1&&(i=!0,h.dialog=c[0],Ue(()=>i=!1)),s.$set(h)},i(c){a||(D(t.$$.fragment,c),D(s.$$.fragment,c),a=!0)},o(c){Z(t.$$.fragment,c),Z(s.$$.fragment,c),a=!1},d(c){c&&(f(e),f(n)),ne(t),ne(s,c)}}}function la(r,e,t){let n;const s=()=>{n.showModal()};function i(a){n=a,t(0,n)}return[n,s,i]}class ua extends $e{constructor(e){super(),Le(this,e,la,oa,Ie,{})}}function ca(r){let e,t,n,s,i,a;return e=new Qe({props:{text:" - ",callback:r[1]}}),n=new Qe({props:{text:"Fullscreen",callback:r[2]}}),i=new Qe({props:{text:" + ",callback:r[3]}}),{c(){Q(e.$$.fragment),t=T(),Q(n.$$.fragment),s=T(),Q(i.$$.fragment)},l(o){ee(e.$$.fragment,o),t=P(o),ee(n.$$.fragment,o),s=P(o),ee(i.$$.fragment,o)},m(o,l){te(e,o,l),k(o,t,l),te(n,o,l),k(o,s,l),te(i,o,l),a=!0},p(o,[l]){const c={};l&1&&(c.callback=o[1]),e.$set(c);const u={};l&1&&(u.callback=o[3]),i.$set(u)},i(o){a||(D(e.$$.fragment,o),D(n.$$.fragment,o),D(i.$$.fragment,o),a=!0)},o(o){Z(e.$$.fragment,o),Z(n.$$.fragment,o),Z(i.$$.fragment,o),a=!1},d(o){o&&(f(t),f(s)),ne(e,o),ne(n,o),ne(i,o)}}}function da(r,e,t){let{zoom:n}=e;const s=()=>{const o={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,o)},i=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},a=()=>{const o={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,o)};return r.$$set=o=>{"zoom"in o&&t(0,n=o.zoom)},[n,s,i,a]}class fa extends $e{constructor(e){super(),Le(this,e,da,ca,Ie,{zoom:0})}}function ha(r){let e,t="Attribution: The following Icon has been used",n,s,i,a,o="https://commons.wikimedia.org/wiki/File:Router.svg#",l,c,u,d,h="Share Alike: We hereby grant permission to",y,b,g=`Copy, distribute and/or modify this document under the terms of the GNU Free Documentation
    License.`,_,m,p="Version 1.2 or any later version published by the Free Software Foundation;",I,H,L="with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.",j,N,z="A copy of the license is included in the section entitled GNU Free Documentation License.",G,S,w,A,R="The Icon used for CE routers is almost identical to the one on Wikimedia (aspect ratio changed)",F,fe,K,ie,be=`The Icon used for LSR/LER routers is almost identical, except with different colors. (aspect
    ratio changed)`,xe,Ee,Ze,De,He="Press Esc to close this popup";return{c(){e=E("p"),e.textContent=t,n=T(),s=E("br"),i=T(),a=E("p"),a.textContent=o,l=T(),c=E("br"),u=T(),d=E("p"),d.textContent=h,y=T(),b=E("p"),b.textContent=g,_=T(),m=E("p"),m.textContent=p,I=T(),H=E("p"),H.textContent=L,j=T(),N=E("p"),N.textContent=z,G=T(),S=E("br"),w=T(),A=E("p"),A.textContent=R,F=T(),fe=E("br"),K=T(),ie=E("p"),ie.textContent=be,xe=T(),Ee=E("br"),Ze=T(),De=E("p"),De.textContent=He},l(V){e=C(V,"P",{"data-svelte-h":!0}),le(e)!=="svelte-t8z8ph"&&(e.textContent=t),n=P(V),s=C(V,"BR",{}),i=P(V),a=C(V,"P",{"data-svelte-h":!0}),le(a)!=="svelte-dbjryl"&&(a.textContent=o),l=P(V),c=C(V,"BR",{}),u=P(V),d=C(V,"P",{"data-svelte-h":!0}),le(d)!=="svelte-1y4tl2"&&(d.textContent=h),y=P(V),b=C(V,"P",{"data-svelte-h":!0}),le(b)!=="svelte-17660lf"&&(b.textContent=g),_=P(V),m=C(V,"P",{"data-svelte-h":!0}),le(m)!=="svelte-vqht9l"&&(m.textContent=p),I=P(V),H=C(V,"P",{"data-svelte-h":!0}),le(H)!=="svelte-1x9q3li"&&(H.textContent=L),j=P(V),N=C(V,"P",{"data-svelte-h":!0}),le(N)!=="svelte-hnn81q"&&(N.textContent=z),G=P(V),S=C(V,"BR",{}),w=P(V),A=C(V,"P",{"data-svelte-h":!0}),le(A)!=="svelte-q0q94c"&&(A.textContent=R),F=P(V),fe=C(V,"BR",{}),K=P(V),ie=C(V,"P",{"data-svelte-h":!0}),le(ie)!=="svelte-vmr7sg"&&(ie.textContent=be),xe=P(V),Ee=C(V,"BR",{}),Ze=P(V),De=C(V,"P",{"data-svelte-h":!0}),le(De)!=="svelte-mgckcf"&&(De.textContent=He)},m(V,x){k(V,e,x),k(V,n,x),k(V,s,x),k(V,i,x),k(V,a,x),k(V,l,x),k(V,c,x),k(V,u,x),k(V,d,x),k(V,y,x),k(V,b,x),k(V,_,x),k(V,m,x),k(V,I,x),k(V,H,x),k(V,j,x),k(V,N,x),k(V,G,x),k(V,S,x),k(V,w,x),k(V,A,x),k(V,F,x),k(V,fe,x),k(V,K,x),k(V,ie,x),k(V,xe,x),k(V,Ee,x),k(V,Ze,x),k(V,De,x)},p:Pe,d(V){V&&(f(e),f(n),f(s),f(i),f(a),f(l),f(c),f(u),f(d),f(y),f(b),f(_),f(m),f(I),f(H),f(j),f(N),f(G),f(S),f(w),f(A),f(F),f(fe),f(K),f(ie),f(xe),f(Ee),f(Ze),f(De))}}}function pa(r){let e,t,n,s,i,a;t=new Qe({props:{text:"Credits",callback:r[1]}});function o(c){r[2](c)}let l={$$slots:{default:[ha]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.dialog=r[0]),s=new Jt({props:l}),Oe.push(()=>qe(s,"dialog",o)),{c(){e=E("div"),Q(t.$$.fragment),n=T(),Q(s.$$.fragment)},l(c){e=C(c,"DIV",{});var u=M(e);ee(t.$$.fragment,u),u.forEach(f),n=P(c),ee(s.$$.fragment,c)},m(c,u){k(c,e,u),te(t,e,null),k(c,n,u),te(s,c,u),a=!0},p(c,[u]){const d={};u&1&&(d.callback=c[1]),t.$set(d);const h={};u&8&&(h.$$scope={dirty:u,ctx:c}),!i&&u&1&&(i=!0,h.dialog=c[0],Ue(()=>i=!1)),s.$set(h)},i(c){a||(D(t.$$.fragment,c),D(s.$$.fragment,c),a=!0)},o(c){Z(t.$$.fragment,c),Z(s.$$.fragment,c),a=!1},d(c){c&&(f(e),f(n)),ne(t),ne(s,c)}}}function ma(r,e,t){let n;const s=()=>{n.showModal()};function i(a){n=a,t(0,n)}return[n,s,i]}class ga extends $e{constructor(e){super(),Le(this,e,ma,pa,Ie,{})}}function ir(r,e,t){const n=r.slice();return n[5]=e[t],n}function ar(r,e,t){const n=r.slice();return n[8]=e[t],n}function or(r,e,t){const n=r.slice();return n[11]=e[t],n}function lr(r,e){let t,n,s;return n=new Wi({props:{link:e[11]}}),{key:r,first:null,c(){t=Re(),Q(n.$$.fragment),this.h()},l(i){t=Re(),ee(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){k(i,t,a),te(n,i,a),s=!0},p(i,a){e=i;const o={};a&2&&(o.link=e[11]),n.$set(o)},i(i){s||(D(n.$$.fragment,i),s=!0)},o(i){Z(n.$$.fragment,i),s=!1},d(i){i&&f(t),ne(n,i)}}}function ur(r,e){let t,n,s;return n=new Ji({props:{router:e[8]}}),{key:r,first:null,c(){t=Re(),Q(n.$$.fragment),this.h()},l(i){t=Re(),ee(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){k(i,t,a),te(n,i,a),s=!0},p(i,a){e=i;const o={};a&2&&(o.router=e[8]),n.$set(o)},i(i){s||(D(n.$$.fragment,i),s=!0)},o(i){Z(n.$$.fragment,i),s=!1},d(i){i&&f(t),ne(n,i)}}}function cr(r,e){let t,n,s;return n=new Ui({props:{packet:e[5]}}),{key:r,first:null,c(){t=Re(),Q(n.$$.fragment),this.h()},l(i){t=Re(),ee(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){k(i,t,a),te(n,i,a),s=!0},p(i,a){e=i;const o={};a&2&&(o.packet=e[5]),n.$set(o)},i(i){s||(D(n.$$.fragment,i),s=!0)},o(i){Z(n.$$.fragment,i),s=!1},d(i){i&&f(t),ne(n,i)}}}function _a(r){let e=[],t=new Map,n,s=[],i=new Map,a,o=[],l=new Map,c,u,d=we(r[1].links);const h=m=>m[11].id;for(let m=0;m<d.length;m+=1){let p=or(r,d,m),I=h(p);t.set(I,e[m]=lr(I,p))}let y=we(r[1].routers);const b=m=>m[8].id;for(let m=0;m<y.length;m+=1){let p=ar(r,y,m),I=b(p);i.set(I,s[m]=ur(I,p))}let g=we(r[1].packets);const _=m=>m[5].id;for(let m=0;m<g.length;m+=1){let p=ir(r,g,m),I=_(p);l.set(I,o[m]=cr(I,p))}return{c(){for(let m=0;m<e.length;m+=1)e[m].c();n=T();for(let m=0;m<s.length;m+=1)s[m].c();a=T();for(let m=0;m<o.length;m+=1)o[m].c();c=Re()},l(m){for(let p=0;p<e.length;p+=1)e[p].l(m);n=P(m);for(let p=0;p<s.length;p+=1)s[p].l(m);a=P(m);for(let p=0;p<o.length;p+=1)o[p].l(m);c=Re()},m(m,p){for(let I=0;I<e.length;I+=1)e[I]&&e[I].m(m,p);k(m,n,p);for(let I=0;I<s.length;I+=1)s[I]&&s[I].m(m,p);k(m,a,p);for(let I=0;I<o.length;I+=1)o[I]&&o[I].m(m,p);k(m,c,p),u=!0},p(m,p){p&2&&(d=we(m[1].links),Se(),e=pn(e,p,h,1,m,d,t,n.parentNode,hn,lr,n,or),Be()),p&2&&(y=we(m[1].routers),Se(),s=pn(s,p,b,1,m,y,i,a.parentNode,hn,ur,a,ar),Be()),p&2&&(g=we(m[1].packets),Se(),o=pn(o,p,_,1,m,g,l,c.parentNode,hn,cr,c,ir),Be())},i(m){if(!u){for(let p=0;p<d.length;p+=1)D(e[p]);for(let p=0;p<y.length;p+=1)D(s[p]);for(let p=0;p<g.length;p+=1)D(o[p]);u=!0}},o(m){for(let p=0;p<e.length;p+=1)Z(e[p]);for(let p=0;p<s.length;p+=1)Z(s[p]);for(let p=0;p<o.length;p+=1)Z(o[p]);u=!1},d(m){m&&(f(n),f(a),f(c));for(let p=0;p<e.length;p+=1)e[p].d(m);for(let p=0;p<s.length;p+=1)s[p].d(m);for(let p=0;p<o.length;p+=1)o[p].d(m)}}}function ba(r){let e,t,n,s,i,a,o,l,c,u,d,h,y,b,g,_,m,p,I,H,L;t=new si({});function j(S){r[2](S)}let N={$$slots:{default:[_a]},$$scope:{ctx:r}};r[0]!==void 0&&(N.zoom=r[0]),i=new Si({props:N}),Oe.push(()=>qe(i,"zoom",j)),c=new ia({}),h=new ua({}),b=new ga({});function z(S){r[3](S)}let G={};return r[0]!==void 0&&(G.zoom=r[0]),m=new fa({props:G}),Oe.push(()=>qe(m,"zoom",z)),H=new Fi({}),{c(){e=E("div"),Q(t.$$.fragment),n=T(),s=E("div"),Q(i.$$.fragment),o=T(),l=E("div"),Q(c.$$.fragment),u=T(),d=E("div"),Q(h.$$.fragment),y=T(),Q(b.$$.fragment),g=T(),_=E("div"),Q(m.$$.fragment),I=T(),Q(H.$$.fragment),this.h()},l(S){e=C(S,"DIV",{id:!0,class:!0});var w=M(e);ee(t.$$.fragment,w),n=P(w),s=C(w,"DIV",{id:!0,class:!0});var A=M(s);ee(i.$$.fragment,A),o=P(A),l=C(A,"DIV",{id:!0,class:!0});var R=M(l);ee(c.$$.fragment,R),R.forEach(f),u=P(A),d=C(A,"DIV",{id:!0,class:!0});var F=M(d);ee(h.$$.fragment,F),y=P(F),ee(b.$$.fragment,F),F.forEach(f),g=P(A),_=C(A,"DIV",{id:!0,class:!0});var fe=M(_);ee(m.$$.fragment,fe),fe.forEach(f),A.forEach(f),I=P(w),ee(H.$$.fragment,w),w.forEach(f),this.h()},h(){v(l,"id","top-left-bar"),v(l,"class","absolute-flex svelte-1kpnzxr"),v(d,"id","bottom-left-bar"),v(d,"class","absolute-flex svelte-1kpnzxr"),v(_,"id","bottom-right-bar"),v(_,"class","absolute-flex svelte-1kpnzxr"),v(s,"id","network"),v(s,"class","svelte-1kpnzxr"),v(e,"id","mpls"),v(e,"class","svelte-1kpnzxr")},m(S,w){k(S,e,w),te(t,e,null),$(e,n),$(e,s),te(i,s,null),$(s,o),$(s,l),te(c,l,null),$(s,u),$(s,d),te(h,d,null),$(d,y),te(b,d,null),$(s,g),$(s,_),te(m,_,null),$(e,I),te(H,e,null),L=!0},p(S,[w]){const A={};w&16386&&(A.$$scope={dirty:w,ctx:S}),!a&&w&1&&(a=!0,A.zoom=S[0],Ue(()=>a=!1)),i.$set(A);const R={};!p&&w&1&&(p=!0,R.zoom=S[0],Ue(()=>p=!1)),m.$set(R)},i(S){L||(D(t.$$.fragment,S),D(i.$$.fragment,S),D(c.$$.fragment,S),D(h.$$.fragment,S),D(b.$$.fragment,S),D(m.$$.fragment,S),D(H.$$.fragment,S),L=!0)},o(S){Z(t.$$.fragment,S),Z(i.$$.fragment,S),Z(c.$$.fragment,S),Z(h.$$.fragment,S),Z(b.$$.fragment,S),Z(m.$$.fragment,S),Z(H.$$.fragment,S),L=!1},d(S){S&&f(e),ne(t),ne(i),ne(c),ne(h),ne(b),ne(m),ne(H)}}}function ya(r,e,t){let n,s;je(r,Ge,l=>t(4,n=l)),je(r,Y,l=>t(1,s=l));let i;wn(()=>{window.addEventListener("visibilitychanged",()=>{We(Ge,n.running=!document.hidden,n)})});function a(l){i=l,t(0,i)}function o(l){i=l,t(0,i)}return[i,s,a,o]}class va extends $e{constructor(e){super(),Le(this,e,ya,ba,Ie,{})}}function ka(r){let e,t;return e=new va({}),{c(){Q(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,s){te(e,n,s),t=!0},p:Pe,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){Z(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}class Pa extends $e{constructor(e){super(),Le(this,e,null,ka,Ie,{})}}export{Pa as component};
