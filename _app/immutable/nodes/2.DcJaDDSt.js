var Mt=Object.defineProperty;var xt=(l,e,t)=>e in l?Mt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var U=(l,e,t)=>(xt(l,typeof e!="symbol"?e+"":e,t),t);import{r as $e,s as re,a as Ct,u as $t,g as Lt,b as It,x as Nt,e as ce,i as De,n as ne,y as he,c as me,o as Rt,z as Oe,A as ze}from"../chunks/scheduler.C5v8YK5g.js";import{n as A,m as T,S as se,i as ue,e as I,c as N,a as O,d as g,l as k,g as C,z as q,s as D,A as ee,f as H,h as $,B as Ce,C as ae,D as ke,E as pe,v as W,w as K,x as J,y as Q,o as le,r as _e,p as ge,t as ie,b as oe,j as ye,F as ve,G as we,q as Pe,H as St,I as Ye}from"../chunks/index.ChYF1Lys.js";import{w as He}from"../chunks/index.CD1dNpfE.js";function te(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Me(l,e){A(l,1,1,()=>{e.delete(l.key)})}function xe(l,e,t,n,o,r,i,s,u,d,a,c){let f=l.length,p=r.length,h=f;const b={};for(;h--;)b[l[h].key]=h;const y=[],_=new Map,m=new Map,L=[];for(h=p;h--;){const v=c(o,r,h),B=t(v);let M=i.get(B);M?n&&L.push(()=>M.p(v,e)):(M=d(B,v),M.c()),_.set(B,y[h]=M),B in b&&m.set(B,Math.abs(h-b[B]))}const x=new Set,P=new Set;function S(v){T(v,1),v.m(s,a),i.set(v.key,v),a=v.first,p--}for(;f&&p;){const v=y[p-1],B=l[f-1],M=v.key,z=B.key;v===B?(a=v.first,f--,p--):_.has(z)?!i.has(M)||x.has(M)?S(v):P.has(z)?f--:m.get(M)>m.get(z)?(P.add(M),S(v)):(x.add(z),f--):(u(B,i),f--)}for(;f--;){const v=l[f];_.has(v.key)||u(v,i)}for(;p;)S(y[p-1]);return $e(L),y}function Fe(l,e){const t={},n={},o={$$scope:1};let r=l.length;for(;r--;){const i=l[r],s=e[r];if(s){for(const u in i)u in s||(n[u]=1);for(const u in s)o[u]||(t[u]=s[u],o[u]=1);l[r]=s}else for(const u in i)o[u]=1}for(const i in n)i in t||(t[i]=void 0);return t}function Ue(l){return typeof l=="object"&&l!==null?l:{}}let At=class{constructor(e,t,n){U(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},Ot=class{constructor(e,t,n,o){U(this,"ttl",32);U(this,"label",-1);U(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=o;const r=t.firstHop.get(n.address);if(!r)return;const i=j.getRouter(r);i&&(this.nextHop=i)}decrementTTL(){--this.ttl<=0&&this.drop()}drop(){j.deletePacket(this.id)}},je=class{constructor(e,t){this.id=e,this.node=t}};class be extends je{constructor(){super(...arguments);U(this,"address",`CE-IP-${this.id}`);U(this,"firstHop",new Map);U(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});U(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});U(this,"updateAddress",(t,n)=>{const o=this.firstHop.get(t);if(!o){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,o),this.firstHop.delete(t)});U(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop()}get type(){return"CE"}}let Tt=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});U(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}},zt=class{constructor(){U(this,"map",new Map);U(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});U(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});U(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});U(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class Ne extends je{constructor(){super(...arguments);U(this,"FIB",new zt);U(this,"LIB",new Tt)}receivePacket(t){var o,r,i,s;const n=t.destination;if(t.label===-1){const u=(o=this.FIB.get(n.address))==null?void 0:o.nextHop;if(!u)return;const d=(r=this.FIB.get(n.address))==null?void 0:r.label;if(!d)return;t.label=d;const a=j.getRouter(parseInt(u));if(!a)return;t.nextHop=a}else{const u=(i=this.LIB.get(t.label))==null?void 0:i.nextHop;if(!u)return;const d=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!d)return;t.label=d;const a=j.routers.find(c=>c instanceof be&&c.address===u);if(!a)return;t.nextHop=a}t.decrementTTL()}get type(){return"LER"}}class Be extends je{constructor(){super(...arguments);U(this,"LIB",new Tt)}receivePacket(t){var i,s;const n=(i=this.LIB.get(t.label))==null?void 0:i.nextHop;if(!n)return;const o=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!o)return;t.label=o;const r=j.getRouter(parseInt(n));r&&(t.nextHop=r,t.decrementTTL())}get type(){return"LSR"}}const Ft={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class Ut{constructor(){U(this,"store",He({routers:[],links:[],packets:[]}));U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_routers",[]);U(this,"_links",[]);U(this,"_packets",[]);U(this,"routerMap",new Map);U(this,"CEMap",new Map);U(this,"routerCounter",0);U(this,"packetCounter",0)}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!Ft[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new At(`${e.source.id}-${e.target.id}`,e.source,e.target);this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,o=new be(n,{label:`CE ${n}`,x:e,y:t});this.addRouter(o)}createLER(e,t){const n=this.routerCounter++,o=new Ne(n,{label:`LER ${n}`,x:e,y:t});this.addRouter(o)}createLSR(e,t){const n=this.routerCounter++,o=new Be(n,{label:`LSR ${n}`,x:e,y:t});this.addRouter(o)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof be&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof be&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){const n=new Ot(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=0,this.packetCounter=0,this.notify()}notify(){this.store.set(this.networkState)}}const jt=new Ut,j=jt,Ie=He({running:!0,speedMultiplier:1});class Gt{constructor(){U(this,"store",He());U(this,"set",this.store.set);U(this,"update",this.store.update);U(this,"subscribe",this.store.subscribe);U(this,"_map",new Map)}getPath(e,t){const n=this._map.get(e);if(n)return n.get(t)}findShortestPath(e,t){return Xe(e,t)}findShortestPaths(){const e=new Map,t=j.routers.filter(n=>n.type==="CE");for(const n of t){const o=new Map;for(const r of t){if(n===r)continue;const i=Xe(n,r);o.set(r.id,i)}e.set(n.id,o)}this._map=e}notify(){this.store.set(this._map)}}function Xe(l,e){const t=j.routers,n=t.length,o=new Array(n).fill(1/0),r=new Array(n).fill(!1),i=new Array(n).fill(null);o[t.indexOf(l)]=0;let s=!1;for(;!s;){let a=null,c=1/0;for(let f=0;f<n;f++)!r[f]&&o[f]<c&&(a=t[f],c=o[f]);if(!a||a.id===e.id){s=!0;continue}r[t.indexOf(a)]=!0;for(const f of j.links){let p;if(f.source===a)p=f.target;else if(f.target===a)p=f.source;else continue;const h=t.indexOf(p),b=c+f.distance;b<o[h]&&(o[h]=b,i[h]=a)}}const u=[];let d=e;for(;d;){u.unshift(d);const a=t.indexOf(d);d=i[a]}return u}const Yt=new Gt,Pt=Yt,Le=He(!1);function Xt(l){let e,t,n,o;const r=l[2].default,i=Ct(r,l,l[1],null);return{c(){e=I("dialog"),i&&i.c(),this.h()},l(s){e=N(s,"DIALOG",{class:!0});var u=O(e);i&&i.l(u),u.forEach(g),this.h()},h(){k(e,"class","svelte-414ocx")},m(s,u){C(s,e,u),i&&i.m(e,null),l[4](e),t=!0,n||(o=q(e,"close",l[3]),n=!0)},p(s,[u]){i&&i.p&&(!t||u&2)&&$t(i,r,s,s[1],t?It(r,s[1],u,null):Lt(s[1]),null)},i(s){t||(T(i,s),t=!0)},o(s){A(i,s),t=!1},d(s){s&&g(e),i&&i.d(s),l[4](null),n=!1,o()}}}function qt(l,e,t){let{$$slots:n={},$$scope:o}=e,{dialog:r}=e;function i(u){Nt.call(this,l,u)}function s(u){ce[u?"unshift":"push"](()=>{r=u,t(0,r)})}return l.$$set=u=>{"dialog"in u&&t(0,r=u.dialog),"$$scope"in u&&t(1,o=u.$$scope)},[r,o,n,i,s]}class Ge extends se{constructor(e){super(),ue(this,e,qt,Xt,re,{dialog:0})}}const qe=16,Vt=2**20-1;function Bt(l,e){const t=l[0];if(!(t instanceof be)){alert("The path does not start with a CE");return}if(t.firstHop.has(e)){alert("The destination is already in the CE's first hop");return}const n=l.length-2,o=l[n];if(!(o instanceof Ne)){alert("Destination CE is not connected directly to a LER");return}let r=Ve(l[n]);o.LIB.receiveEntry(r,-1,e);for(let i=l.length-2;i>0;i--){const s=l[i],u=l[i-1],d=r;r=Ve(s),u instanceof Ne?u.FIB.receiveEntry(e,d,s.id.toString()):u instanceof Be&&u.LIB.receiveEntry(r,d,s.id.toString())}t.firstHop.set(e,l[1].id)}function Wt(l,e){return l instanceof Be||l instanceof Ne?l.LIB.map.has(e):!1}function Ve(l){let e;do e=Math.floor(Math.random()*(Vt-qe+1)+qe);while(Wt(l,e));return e}function We(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n}function Ke(l){let e,t,n,o,r,i,s,u,d,a,c="-",f,p,h;function b(...m){return l[4](l[7],...m)}function y(...m){return l[5](l[7],...m)}function _(){return l[6](l[7])}return{c(){e=I("tr"),t=I("td"),n=I("input"),r=D(),i=I("td"),s=I("input"),d=D(),a=I("button"),a.textContent=c,f=D(),this.h()},l(m){e=N(m,"TR",{});var L=O(e);t=N(L,"TD",{});var x=O(t);n=N(x,"INPUT",{type:!0,placeholder:!0}),x.forEach(g),r=H(L),i=N(L,"TD",{});var P=O(i);s=N(P,"INPUT",{type:!0,placeholder:!0}),P.forEach(g),d=H(L),a=N(L,"BUTTON",{"data-svelte-h":!0}),ee(a)!=="svelte-696gh"&&(a.textContent=c),f=H(L),L.forEach(g),this.h()},h(){k(n,"type","text"),n.value=o=l[7],k(n,"placeholder","Address"),k(s,"type","text"),s.value=u=l[8],k(s,"placeholder","Link")},m(m,L){C(m,e,L),$(e,t),$(t,n),$(e,r),$(e,i),$(i,s),$(e,d),$(e,a),$(e,f),p||(h=[q(n,"change",b),q(s,"change",y),q(a,"click",_)],p=!0)},p(m,L){l=m,L&1&&o!==(o=l[7])&&n.value!==o&&(n.value=o),L&1&&u!==(u=l[8])&&s.value!==u&&(s.value=u)},d(m){m&&g(e),p=!1,$e(h)}}}function Kt(l){let e,t="Destinations:",n,o,r,i="<th>Destination</th> <th>First hop</th>",s,u,d,a="+",c,f,p=te([...l[0].firstHop]),h=[];for(let b=0;b<p.length;b+=1)h[b]=Ke(We(l,p,b));return{c(){e=I("p"),e.textContent=t,n=D(),o=I("table"),r=I("tr"),r.innerHTML=i,s=D();for(let b=0;b<h.length;b+=1)h[b].c();u=D(),d=I("button"),d.textContent=a},l(b){e=N(b,"P",{"data-svelte-h":!0}),ee(e)!=="svelte-1ixmdgd"&&(e.textContent=t),n=H(b),o=N(b,"TABLE",{});var y=O(o);r=N(y,"TR",{"data-svelte-h":!0}),ee(r)!=="svelte-cu9tpt"&&(r.innerHTML=i),s=H(y);for(let _=0;_<h.length;_+=1)h[_].l(y);y.forEach(g),u=H(b),d=N(b,"BUTTON",{"data-svelte-h":!0}),ee(d)!=="svelte-1nn20mc"&&(d.textContent=a)},m(b,y){C(b,e,y),C(b,n,y),C(b,o,y),$(o,r),$(o,s);for(let _=0;_<h.length;_+=1)h[_]&&h[_].m(o,null);C(b,u,y),C(b,d,y),c||(f=q(d,"click",function(){De(l[1](l[0].addEmptyEntry))&&l[1](l[0].addEmptyEntry).apply(this,arguments)}),c=!0)},p(b,[y]){if(l=b,y&13){p=te([...l[0].firstHop]);let _;for(_=0;_<p.length;_+=1){const m=We(l,p,_);h[_]?h[_].p(m,y):(h[_]=Ke(m),h[_].c(),h[_].m(o,null))}for(;_<h.length;_+=1)h[_].d(1);h.length=p.length}},i:ne,o:ne,d(b){b&&(g(e),g(n),g(o),g(u),g(d)),Ce(h,b),c=!1,f()}}}function Jt(l,e,t){let{router:n}=e;function o(a){return()=>{a(),t(0,n)}}function r(a,c){if(!(a.target instanceof HTMLInputElement))return;const f=a.target.value.toUpperCase();n.updateAddress(c,f);const p=j.getCERouter(f);if(!p){alert("Destination router not found.");return}const h=Pt.findShortestPath(n,p);Bt(h,f),t(0,n)}function i(a,c){if(!(a.target instanceof HTMLInputElement))return;const f=parseInt(a.target.value);n.firstHop.set(c,f)}const s=(a,c)=>{r(c,a)},u=(a,c)=>{i(c,a)},d=a=>{n.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,o,r,i,s,u,d]}class Qt extends se{constructor(e){super(),ue(this,e,Jt,Kt,re,{router:0})}}function Je(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Qe(l){let e,t,n,o,r,i,s,u,d,a,c,f,p="-",h,b;function y(...x){return l[3](l[7],...x)}function _(){l[4].call(s,l[9],l[10])}function m(){l[5].call(a,l[9],l[10])}function L(){return l[6](l[7])}return{c(){e=I("tr"),t=I("td"),n=I("input"),r=D(),i=I("td"),s=I("input"),u=D(),d=I("td"),a=I("input"),c=D(),f=I("button"),f.textContent=p,this.h()},l(x){e=N(x,"TR",{});var P=O(e);t=N(P,"TD",{});var S=O(t);n=N(S,"INPUT",{type:!0}),S.forEach(g),r=H(P),i=N(P,"TD",{});var v=O(i);s=N(v,"INPUT",{type:!0}),v.forEach(g),u=H(P),d=N(P,"TD",{});var B=O(d);a=N(B,"INPUT",{type:!0}),B.forEach(g),c=H(P),f=N(P,"BUTTON",{"data-svelte-h":!0}),ee(f)!=="svelte-wfbfbi"&&(f.textContent=p),P.forEach(g),this.h()},h(){k(n,"type","number"),n.value=o=l[7],k(s,"type","number"),k(a,"type","text")},m(x,P){C(x,e,P),$(e,t),$(t,n),$(e,r),$(e,i),$(i,s),ae(s,l[8].outgoingLabel),$(e,u),$(e,d),$(d,a),ae(a,l[8].nextHop),$(e,c),$(e,f),h||(b=[q(n,"change",y),q(s,"input",_),q(a,"input",m),q(f,"click",L)],h=!0)},p(x,P){l=x,P&1&&o!==(o=l[7])&&n.value!==o&&(n.value=o),P&1&&ke(s.value)!==l[8].outgoingLabel&&ae(s,l[8].outgoingLabel),P&1&&a.value!==l[8].nextHop&&ae(a,l[8].nextHop)},d(x){x&&g(e),h=!1,$e(b)}}}function Zt(l){let e,t,n="<th>Incoming</th> <th>Outgoing</th> <th>Next hop</th>",o,r,i,s="+",u,d,a=te([...l[0].LIB.map]),c=[];for(let f=0;f<a.length;f+=1)c[f]=Qe(Je(l,a,f));return{c(){e=I("table"),t=I("tr"),t.innerHTML=n,o=D();for(let f=0;f<c.length;f+=1)c[f].c();r=D(),i=I("button"),i.textContent=s},l(f){e=N(f,"TABLE",{});var p=O(e);t=N(p,"TR",{"data-svelte-h":!0}),ee(t)!=="svelte-4lulgl"&&(t.innerHTML=n),o=H(p);for(let h=0;h<c.length;h+=1)c[h].l(p);r=H(p),i=N(p,"BUTTON",{"data-svelte-h":!0}),ee(i)!=="svelte-1qyq3ir"&&(i.textContent=s),p.forEach(g)},m(f,p){C(f,e,p),$(e,t),$(e,o);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(e,null);$(e,r),$(e,i),u||(d=q(i,"click",function(){De(l[1](l[0].LIB.addEmptyEntry))&&l[1](l[0].LIB.addEmptyEntry).apply(this,arguments)}),u=!0)},p(f,[p]){if(l=f,p&5){a=te([...l[0].LIB.map]);let h;for(h=0;h<a.length;h+=1){const b=Je(l,a,h);c[h]?c[h].p(b,p):(c[h]=Qe(b),c[h].c(),c[h].m(e,r))}for(;h<c.length;h+=1)c[h].d(1);c.length=a.length}},i:ne,o:ne,d(f){f&&g(e),Ce(c,f),u=!1,d()}}}function en(l,e,t){let{router:n}=e;function o(a){return()=>{a(),t(0,n)}}function r(a,c){if(!(a.target instanceof HTMLInputElement))return;const f=parseInt(a.target.value);n.LIB.updateLabel(c,f)}const i=(a,c)=>{r(c,a)};function s(a,c){a[c][1].outgoingLabel=ke(this.value),t(0,n)}function u(a,c){a[c][1].nextHop=this.value,t(0,n)}const d=a=>{n.LIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,o,r,i,s,u,d]}class Dt extends se{constructor(e){super(),ue(this,e,en,Zt,re,{router:0})}}function Ze(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function et(l){let e,t,n,o,r,i,s,u,d,a,c,f,p="-",h,b;function y(...x){return l[3](l[7],...x)}function _(){l[4].call(s,l[9],l[10])}function m(){l[5].call(a,l[9],l[10])}function L(){return l[6](l[7])}return{c(){e=I("tr"),t=I("td"),n=I("input"),r=D(),i=I("td"),s=I("input"),u=D(),d=I("td"),a=I("input"),c=D(),f=I("button"),f.textContent=p,this.h()},l(x){e=N(x,"TR",{});var P=O(e);t=N(P,"TD",{});var S=O(t);n=N(S,"INPUT",{type:!0}),S.forEach(g),r=H(P),i=N(P,"TD",{});var v=O(i);s=N(v,"INPUT",{type:!0}),v.forEach(g),u=H(P),d=N(P,"TD",{});var B=O(d);a=N(B,"INPUT",{type:!0}),B.forEach(g),c=H(P),f=N(P,"BUTTON",{"data-svelte-h":!0}),ee(f)!=="svelte-liojo2"&&(f.textContent=p),P.forEach(g),this.h()},h(){k(n,"type","text"),n.value=o=l[7],k(s,"type","number"),k(a,"type","text")},m(x,P){C(x,e,P),$(e,t),$(t,n),$(e,r),$(e,i),$(i,s),ae(s,l[8].label),$(e,u),$(e,d),$(d,a),ae(a,l[8].nextHop),$(e,c),$(e,f),h||(b=[q(n,"change",y),q(s,"input",_),q(a,"input",m),q(f,"click",L)],h=!0)},p(x,P){l=x,P&1&&o!==(o=l[7])&&n.value!==o&&(n.value=o),P&1&&ke(s.value)!==l[8].label&&ae(s,l[8].label),P&1&&a.value!==l[8].nextHop&&ae(a,l[8].nextHop)},d(x){x&&g(e),h=!1,$e(b)}}}function tn(l){let e,t,n="<th>Address</th> <th>Label</th> <th>Next hop</th>",o,r,i,s="+",u,d,a=te([...l[0].FIB.map]),c=[];for(let f=0;f<a.length;f+=1)c[f]=et(Ze(l,a,f));return{c(){e=I("table"),t=I("tr"),t.innerHTML=n,o=D();for(let f=0;f<c.length;f+=1)c[f].c();r=D(),i=I("button"),i.textContent=s},l(f){e=N(f,"TABLE",{});var p=O(e);t=N(p,"TR",{"data-svelte-h":!0}),ee(t)!=="svelte-1ntom3r"&&(t.innerHTML=n),o=H(p);for(let h=0;h<c.length;h+=1)c[h].l(p);r=H(p),i=N(p,"BUTTON",{"data-svelte-h":!0}),ee(i)!=="svelte-hxdqrl"&&(i.textContent=s),p.forEach(g)},m(f,p){C(f,e,p),$(e,t),$(e,o);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(e,null);$(e,r),$(e,i),u||(d=q(i,"click",function(){De(l[1](l[0].FIB.addEmptyEntry))&&l[1](l[0].FIB.addEmptyEntry).apply(this,arguments)}),u=!0)},p(f,[p]){if(l=f,p&5){a=te([...l[0].FIB.map]);let h;for(h=0;h<a.length;h+=1){const b=Ze(l,a,h);c[h]?c[h].p(b,p):(c[h]=et(b),c[h].c(),c[h].m(e,r))}for(;h<c.length;h+=1)c[h].d(1);c.length=a.length}},i:ne,o:ne,d(f){f&&g(e),Ce(c,f),u=!1,d()}}}function nn(l,e,t){let{router:n}=e;function o(a){return()=>{a(),t(0,n)}}function r(a,c){if(!(a.target instanceof HTMLInputElement))return;const f=a.target.value;n.FIB.updateAddress(c,f)}const i=(a,c)=>{r(c,a)};function s(a,c){a[c][1].label=ke(this.value),t(0,n)}function u(a,c){a[c][1].nextHop=this.value,t(0,n)}const d=a=>{n.FIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,o,r,i,s,u,d]}class ln extends se{constructor(e){super(),ue(this,e,nn,tn,re,{router:0})}}function on(l){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=I("p"),e.textContent=t},l(n){e=N(n,"P",{"data-svelte-h":!0}),ee(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,o){C(n,e,o)},p:ne,i:ne,o:ne,d(n){n&&g(e)}}}function rn(l){let e,t,n,o,r,i,s=l[0].id+"",u,d,a,c,f=l[0].type+"",p,h,b,y,_,m,L,x,P,S,v,B,M="Delete Router",z,E,F,X=l[0]instanceof be&&tt(l),V=l[0]instanceof Ne&&nt(l),Z=l[0]instanceof Be&&lt(l);return{c(){e=I("label"),t=ie(`Label:
      `),n=I("input"),o=D(),r=I("p"),i=ie("ID: "),u=ie(s),d=D(),a=I("p"),c=ie("Type: "),p=ie(f),h=D(),b=I("label"),y=ie(`Position:
      `),_=I("input"),m=D(),L=I("input"),x=D(),X&&X.c(),P=D(),V&&V.c(),S=D(),Z&&Z.c(),v=D(),B=I("button"),B.textContent=M,this.h()},l(R){e=N(R,"LABEL",{});var G=O(e);t=oe(G,`Label:
      `),n=N(G,"INPUT",{type:!0}),G.forEach(g),o=H(R),r=N(R,"P",{});var Re=O(r);i=oe(Re,"ID: "),u=oe(Re,s),Re.forEach(g),d=H(R),a=N(R,"P",{});var Te=O(a);c=oe(Te,"Type: "),p=oe(Te,f),Te.forEach(g),h=H(R),b=N(R,"LABEL",{});var w=O(b);y=oe(w,`Position:
      `),_=N(w,"INPUT",{type:!0}),m=H(w),L=N(w,"INPUT",{type:!0}),w.forEach(g),x=H(R),X&&X.l(R),P=H(R),V&&V.l(R),S=H(R),Z&&Z.l(R),v=H(R),B=N(R,"BUTTON",{"data-svelte-h":!0}),ee(B)!=="svelte-1kc1129"&&(B.textContent=M),this.h()},h(){k(n,"type","text"),k(_,"type","number"),_.disabled=l[2],k(L,"type","number"),L.disabled=l[2]},m(R,G){C(R,e,G),$(e,t),$(e,n),ae(n,l[0].node.label),C(R,o,G),C(R,r,G),$(r,i),$(r,u),C(R,d,G),C(R,a,G),$(a,c),$(a,p),C(R,h,G),C(R,b,G),$(b,y),$(b,_),ae(_,l[0].node.x),$(b,m),$(b,L),ae(L,l[0].node.y),C(R,x,G),X&&X.m(R,G),C(R,P,G),V&&V.m(R,G),C(R,S,G),Z&&Z.m(R,G),C(R,v,G),C(R,B,G),z=!0,E||(F=[q(n,"input",l[4]),q(_,"input",l[5]),q(L,"input",l[6]),q(B,"click",l[3])],E=!0)},p(R,G){G&1&&n.value!==R[0].node.label&&ae(n,R[0].node.label),(!z||G&1)&&s!==(s=R[0].id+"")&&ye(u,s),(!z||G&1)&&f!==(f=R[0].type+"")&&ye(p,f),(!z||G&4)&&(_.disabled=R[2]),G&1&&ke(_.value)!==R[0].node.x&&ae(_,R[0].node.x),(!z||G&4)&&(L.disabled=R[2]),G&1&&ke(L.value)!==R[0].node.y&&ae(L,R[0].node.y),R[0]instanceof be?X?(X.p(R,G),G&1&&T(X,1)):(X=tt(R),X.c(),T(X,1),X.m(P.parentNode,P)):X&&(_e(),A(X,1,1,()=>{X=null}),ge()),R[0]instanceof Ne?V?(V.p(R,G),G&1&&T(V,1)):(V=nt(R),V.c(),T(V,1),V.m(S.parentNode,S)):V&&(_e(),A(V,1,1,()=>{V=null}),ge()),R[0]instanceof Be?Z?(Z.p(R,G),G&1&&T(Z,1)):(Z=lt(R),Z.c(),T(Z,1),Z.m(v.parentNode,v)):Z&&(_e(),A(Z,1,1,()=>{Z=null}),ge())},i(R){z||(T(X),T(V),T(Z),z=!0)},o(R){A(X),A(V),A(Z),z=!1},d(R){R&&(g(e),g(o),g(r),g(d),g(a),g(h),g(b),g(x),g(P),g(S),g(v),g(B)),X&&X.d(R),V&&V.d(R),Z&&Z.d(R),E=!1,$e(F)}}}function tt(l){let e,t,n=l[0].address+"",o,r,i,s,u;function d(c){l[7](c)}let a={};return l[0]!==void 0&&(a.router=l[0]),i=new Qt({props:a}),ce.push(()=>pe(i,"router",d)),{c(){e=I("p"),t=ie("Address: "),o=ie(n),r=D(),W(i.$$.fragment)},l(c){e=N(c,"P",{});var f=O(e);t=oe(f,"Address: "),o=oe(f,n),f.forEach(g),r=H(c),K(i.$$.fragment,c)},m(c,f){C(c,e,f),$(e,t),$(e,o),C(c,r,f),J(i,c,f),u=!0},p(c,f){(!u||f&1)&&n!==(n=c[0].address+"")&&ye(o,n);const p={};!s&&f&1&&(s=!0,p.router=c[0],he(()=>s=!1)),i.$set(p)},i(c){u||(T(i.$$.fragment,c),u=!0)},o(c){A(i.$$.fragment,c),u=!1},d(c){c&&(g(e),g(r)),Q(i,c)}}}function nt(l){let e,t,n,o,r,i;function s(c){l[8](c)}let u={};l[0]!==void 0&&(u.router=l[0]),e=new Dt({props:u}),ce.push(()=>pe(e,"router",s));function d(c){l[9](c)}let a={};return l[0]!==void 0&&(a.router=l[0]),o=new ln({props:a}),ce.push(()=>pe(o,"router",d)),{c(){W(e.$$.fragment),n=D(),W(o.$$.fragment)},l(c){K(e.$$.fragment,c),n=H(c),K(o.$$.fragment,c)},m(c,f){J(e,c,f),C(c,n,f),J(o,c,f),i=!0},p(c,f){const p={};!t&&f&1&&(t=!0,p.router=c[0],he(()=>t=!1)),e.$set(p);const h={};!r&&f&1&&(r=!0,h.router=c[0],he(()=>r=!1)),o.$set(h)},i(c){i||(T(e.$$.fragment,c),T(o.$$.fragment,c),i=!0)},o(c){A(e.$$.fragment,c),A(o.$$.fragment,c),i=!1},d(c){c&&g(n),Q(e,c),Q(o,c)}}}function lt(l){let e,t,n;function o(i){l[10](i)}let r={};return l[0]!==void 0&&(r.router=l[0]),e=new Dt({props:r}),ce.push(()=>pe(e,"router",o)),{c(){W(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,s){J(e,i,s),n=!0},p(i,s){const u={};!t&&s&1&&(t=!0,u.router=i[0],he(()=>t=!1)),e.$set(u)},i(i){n||(T(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){Q(e,i)}}}function sn(l){let e,t,n,o;const r=[rn,on],i=[];function s(u,d){return u[0]?0:1}return e=s(l),t=i[e]=r[e](l),{c(){t.c(),n=le()},l(u){t.l(u),n=le()},m(u,d){i[e].m(u,d),C(u,n,d),o=!0},p(u,d){let a=e;e=s(u),e===a?i[e].p(u,d):(_e(),A(i[a],1,1,()=>{i[a]=null}),ge(),t=i[e],t?t.p(u,d):(t=i[e]=r[e](u),t.c()),T(t,1),t.m(n.parentNode,n))},i(u){o||(T(t),o=!0)},o(u){A(t),o=!1},d(u){u&&g(n),i[e].d(u)}}}function un(l){let e,t,n;function o(i){l[11](i)}let r={$$slots:{default:[sn]},$$scope:{ctx:l}};return l[1]!==void 0&&(r.dialog=l[1]),e=new Ge({props:r}),ce.push(()=>pe(e,"dialog",o)),e.$on("close",l[12]),{c(){W(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,s){J(e,i,s),n=!0},p(i,[s]){const u={};s&8197&&(u.$$scope={dirty:s,ctx:i}),!t&&s&2&&(t=!0,u.dialog=i[1],he(()=>t=!1)),e.$set(u)},i(i){n||(T(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){Q(e,i)}}}function an(l,e,t){let n;me(l,Le,y=>t(2,n=y));let{router:o}=e,{dialog:r}=e;function i(){!n&&o?confirm("Are you sure you want to delete this router?")&&(j.deleteRouter(o.id),r.close()):alert("You can't delete a router while the network is locked.")}function s(){o.node.label=this.value,t(0,o)}function u(){o.node.x=ke(this.value),t(0,o)}function d(){o.node.y=ke(this.value),t(0,o)}function a(y){o=y,t(0,o)}function c(y){o=y,t(0,o)}function f(y){o=y,t(0,o)}function p(y){o=y,t(0,o)}function h(y){r=y,t(1,r)}const b=()=>{j.notify()};return l.$$set=y=>{"router"in y&&t(0,o=y.router),"dialog"in y&&t(1,r=y.dialog)},[o,r,n,i,s,u,d,a,c,f,p,h,b]}class fn extends se{constructor(e){super(),ue(this,e,an,un,re,{router:0,dialog:1})}}function cn(l){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=I("p"),e.textContent=t},l(n){e=N(n,"P",{"data-svelte-h":!0}),ee(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,o){C(n,e,o)},p:ne,d(n){n&&g(e)}}}function dn(l){let e,t=l[0].distance+"",n,o,r,i,s,u,d,a="Delete Link",c,f;return{c(){e=ie("Distance: "),n=ie(t),o=D(),r=I("label"),i=ie(`Bandwidth:
      `),s=I("input"),u=D(),d=I("button"),d.textContent=a,this.h()},l(p){e=oe(p,"Distance: "),n=oe(p,t),o=H(p),r=N(p,"LABEL",{class:!0});var h=O(r);i=oe(h,`Bandwidth:
      `),s=N(h,"INPUT",{type:!0,class:!0}),h.forEach(g),u=H(p),d=N(p,"BUTTON",{"data-svelte-h":!0}),ee(d)!=="svelte-rk1ni8"&&(d.textContent=a),this.h()},h(){k(s,"type","number"),s.disabled=l[2],k(s,"class","svelte-mdz6ho"),k(r,"class","svelte-mdz6ho")},m(p,h){C(p,e,h),C(p,n,h),C(p,o,h),C(p,r,h),$(r,i),$(r,s),ae(s,l[0].bandwidth),C(p,u,h),C(p,d,h),c||(f=[q(s,"input",l[4]),q(d,"click",l[3])],c=!0)},p(p,h){h&1&&t!==(t=p[0].distance+"")&&ye(n,t),h&4&&(s.disabled=p[2]),h&1&&ke(s.value)!==p[0].bandwidth&&ae(s,p[0].bandwidth)},d(p){p&&(g(e),g(n),g(o),g(r),g(u),g(d)),c=!1,$e(f)}}}function hn(l){let e;function t(r,i){return r[0]?dn:cn}let n=t(l),o=n(l);return{c(){o.c(),e=le()},l(r){o.l(r),e=le()},m(r,i){o.m(r,i),C(r,e,i)},p(r,i){n===(n=t(r))&&o?o.p(r,i):(o.d(1),o=n(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){r&&g(e),o.d(r)}}}function pn(l){let e,t,n;function o(i){l[5](i)}let r={$$slots:{default:[hn]},$$scope:{ctx:l}};return l[1]!==void 0&&(r.dialog=l[1]),e=new Ge({props:r}),ce.push(()=>pe(e,"dialog",o)),e.$on("close",l[6]),{c(){W(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,s){J(e,i,s),n=!0},p(i,[s]){const u={};s&133&&(u.$$scope={dirty:s,ctx:i}),!t&&s&2&&(t=!0,u.dialog=i[1],he(()=>t=!1)),e.$set(u)},i(i){n||(T(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){Q(e,i)}}}function _n(l,e,t){let n;me(l,Le,a=>t(2,n=a));let{link:o}=e,{dialog:r}=e;function i(){!n&&o&&confirm("Are you sure you want to delete this link?")&&(j.deleteLink(o.id),r.close())}function s(){o.bandwidth=ke(this.value),t(0,o)}function u(a){r=a,t(1,r)}const d=()=>{j.notify()};return l.$$set=a=>{"link"in a&&t(0,o=a.link),"dialog"in a&&t(1,r=a.dialog)},[o,r,n,i,s,u,d]}class gn extends se{constructor(e){super(),ue(this,e,_n,pn,re,{link:0,dialog:1})}}function it(l){let e,t="Loading...";return{c(){e=I("p"),e.textContent=t,this.h()},l(n){e=N(n,"P",{style:!0,"data-svelte-h":!0}),ee(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){Pe(e,"font-size","200px")},m(n,o){C(n,e,o)},d(n){n&&g(e)}}}function ot(l){let e,t,n,o,r,i;return{c(){e=ve("line"),this.h()},l(s){e=we(s,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),O(e).forEach(g),this.h()},h(){k(e,"class","preview"),k(e,"x1",t=l[4].node.x),k(e,"y1",n=l[4].node.y),k(e,"x2",o=l[17](l[2].x)),k(e,"y2",r=l[18](l[2].y)),k(e,"stroke",i=[l[11].CONNECTING,l[11].MASS_CONNECTING].includes(l[6])?"green":"blue")},m(s,u){C(s,e,u)},p(s,u){u[0]&16&&t!==(t=s[4].node.x)&&k(e,"x1",t),u[0]&16&&n!==(n=s[4].node.y)&&k(e,"y1",n),u[0]&4&&o!==(o=s[17](s[2].x))&&k(e,"x2",o),u[0]&4&&r!==(r=s[18](s[2].y))&&k(e,"y2",r),u[0]&64&&i!==(i=[s[11].CONNECTING,s[11].MASS_CONNECTING].includes(s[6])?"green":"blue")&&k(e,"stroke",i)},d(s){s&&g(e)}}}function mn(l){let e,t,n=(!l[0]&&l[6]===l[11].CONNECTING||[l[11].MASS_CONNECTING,l[11].ADDING_DESTINATION].includes(l[6]))&&l[4],o,r,i,s,u,d,a,c,f,p,h,b,y,_=!l[9]&&it(),m=n&&ot(l);const L=l[21].default,x=Ct(L,l,l[20],null);function P(E){l[24](E)}function S(E){l[25](E)}let v={};l[4]!==void 0&&(v.router=l[4]),l[7]!==void 0&&(v.dialog=l[7]),s=new fn({props:v}),ce.push(()=>pe(s,"router",P)),ce.push(()=>pe(s,"dialog",S));function B(E){l[26](E)}function M(E){l[27](E)}let z={};return l[5]!==void 0&&(z.link=l[5]),l[8]!==void 0&&(z.dialog=l[8]),c=new gn({props:z}),ce.push(()=>pe(c,"link",B)),ce.push(()=>pe(c,"dialog",M)),{c(){_&&_.c(),e=D(),t=ve("svg"),m&&m.c(),o=le(),x&&x.c(),i=D(),W(s.$$.fragment),a=D(),W(c.$$.fragment),this.h()},l(E){_&&_.l(E),e=H(E),t=we(E,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var F=O(t);m&&m.l(F),o=le(),x&&x.l(F),F.forEach(g),i=H(E),K(s.$$.fragment,E),a=H(E),K(c.$$.fragment,E),this.h()},h(){k(t,"viewBox",r=`${l[1].x} ${l[1].y} ${l[1].width} ${l[1].height}`),k(t,"role","button"),k(t,"tabindex","-1"),k(t,"class","svelte-1cmb9l6"),Pe(t,"cursor",l[10][l[6]])},m(E,F){_&&_.m(E,F),C(E,e,F),C(E,t,F),m&&m.m(t,null),$(t,o),x&&x.m(t,null),l[23](t),C(E,i,F),J(s,E,F),C(E,a,F),J(c,E,F),h=!0,b||(y=[q(t,"pointerdown",l[12]),q(t,"pointerup",l[13]),q(t,"wheel",l[14]),q(t,"dblclick",l[15]),q(t,"dragover",St(l[22])),q(t,"drop",l[16])],b=!0)},p(E,F){E[9]?_&&(_.d(1),_=null):_||(_=it(),_.c(),_.m(e.parentNode,e)),F[0]&81&&(n=(!E[0]&&E[6]===E[11].CONNECTING||[E[11].MASS_CONNECTING,E[11].ADDING_DESTINATION].includes(E[6]))&&E[4]),n?m?m.p(E,F):(m=ot(E),m.c(),m.m(t,o)):m&&(m.d(1),m=null),x&&x.p&&(!h||F[0]&1048576)&&$t(x,L,E,E[20],h?It(L,E[20],F,null):Lt(E[20]),null),(!h||F[0]&2&&r!==(r=`${E[1].x} ${E[1].y} ${E[1].width} ${E[1].height}`))&&k(t,"viewBox",r),F[0]&1088&&Pe(t,"cursor",E[10][E[6]]);const X={};!u&&F[0]&16&&(u=!0,X.router=E[4],he(()=>u=!1)),!d&&F[0]&128&&(d=!0,X.dialog=E[7],he(()=>d=!1)),s.$set(X);const V={};!f&&F[0]&32&&(f=!0,V.link=E[5],he(()=>f=!1)),!p&&F[0]&256&&(p=!0,V.dialog=E[8],he(()=>p=!1)),c.$set(V)},i(E){h||(T(x,E),T(s.$$.fragment,E),T(c.$$.fragment,E),h=!0)},o(E){A(x,E),A(s.$$.fragment,E),A(c.$$.fragment,E),h=!1},d(E){E&&(g(e),g(t),g(i),g(a)),_&&_.d(E),m&&m.d(),x&&x.d(E),l[23](null),Q(s,E),Q(c,E),b=!1,$e(y)}}}function bn(l,e,t){let n,o;me(l,Le,w=>t(0,o=w));let{$$slots:r={},$$scope:i}=e;var s=(w=>(w[w.NONE=0]="NONE",w[w.DRAGGING=1]="DRAGGING",w[w.PANNING=2]="PANNING",w[w.CONNECTING=3]="CONNECTING",w[w.MASS_CONNECTING=4]="MASS_CONNECTING",w[w.ADDING_DESTINATION=5]="ADDING_DESTINATION",w))(s||{});const u={x:0,y:0,width:0,height:0,get scale(){return c?this.width/c.getBoundingClientRect().width:1}},d={x:0,y:0},a={x:0,y:0};let c=null,f=null,p=null,h=0,b,y,_=!1;Rt(()=>{if(!c)return;new ResizeObserver(m).observe(c),requestAnimationFrame(()=>{c&&(t(1,u.x=c.getBoundingClientRect().width/-2,u),t(1,u.y=c.getBoundingClientRect().height/-2,u))}),t(9,_=!0)});function m(){if(!c)return;const w=u.scale||1;t(1,u.width=c.getBoundingClientRect().width*w,u),t(1,u.height=c.getBoundingClientRect().height*w,u)}function L(w){if(!(w.target instanceof Element))return;w.preventDefault(),c==null||c.addEventListener("pointermove",P),c==null||c.setPointerCapture(w.pointerId);const Y=w.target.id;if(Y){if(t(4,f=j.getRouter(parseInt(Y))||null),!f)return;w.shiftKey?t(6,h=3):w.altKey?t(6,h=4):w.ctrlKey&&f instanceof be?t(6,h=5):(a.x=f.node.x,a.y=f.node.y,t(6,h=1))}else t(6,h=2);t(2,d.x=w.clientX,d),t(2,d.y=w.clientY,d)}function x(w){if(w.target instanceof Element){if(w.preventDefault(),f){if(!o&&h===3){const Y=document.elementFromPoint(w.clientX,w.clientY),fe=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,de=j.getRouter(parseInt(fe??""));de&&j.addLink({source:f,target:de})}else if(h===5){const Y=document.elementFromPoint(w.clientX,w.clientY),fe=(Y==null?void 0:Y.tagName)==="circle"?Y.id:null,de=j.getRouter(parseInt(fe??""));if(de instanceof be){const Ht=Pt.findShortestPath(f,de);Bt(Ht,de.address.toUpperCase()),j.notify()}else alert("Destination must be a CE")}}t(6,h=0),t(4,f=null),c==null||c.releasePointerCapture(w.pointerId),c==null||c.removeEventListener("pointermove",P)}}function P(w){w.preventDefault();const Y={x:(w.clientX-d.x)*u.scale,y:(w.clientY-d.y)*u.scale};if(!o&&h===1&&f)t(4,f.node.x=a.x+Y.x,f),t(4,f.node.y=a.y+Y.y,f),j.notify();else if(h===2)t(2,d.x=w.clientX,d),t(2,d.y=w.clientY,d),t(1,u.x-=Y.x,u),t(1,u.y-=Y.y,u);else if(!o&&h===3||h===5)t(2,d.x=w.clientX,d),t(2,d.y=w.clientY,d);else if(!o&&h===4){t(2,d.x=w.clientX,d),t(2,d.y=w.clientY,d);const fe=document.elementFromPoint(w.clientX,w.clientY);if(!fe)return;const de=j.getRouter(parseInt(fe.id));fe.tagName==="circle"&&de&&f&&(j.addLink({source:f,target:de}),t(4,f=de))}}function S(w){w.preventDefault(),t(2,d.x=w.clientX,d),t(2,d.y=w.clientY,d);const Y=w.deltaY>0?1.025:.975;v(Y,d)}function v(w,Y){if(!c||u.scale<.1&&w<1||u.scale>5&&w>1)return;const fe=c.getBoundingClientRect(),de={x:(Y.x-fe.left)/fe.width,y:(Y.y-fe.top)/fe.height};t(1,u.x-=u.width*(w-1)*de.x,u),t(1,u.y-=u.height*(w-1)*de.y,u),t(1,u.width*=w,u),t(1,u.height*=w,u)}function B(w){if(!(w.target instanceof Element))return;w.preventDefault();const Y=document.elementFromPoint(w.clientX,w.clientY);Y&&(Y.tagName==="circle"?M(Y.id):Y.tagName==="rect"&&z(Y.id))}function M(w){const Y=j.getRouter(parseInt(w));Y&&(t(4,f=Y),b.showModal())}function z(w){const Y=j.links.find(fe=>w===fe.id);Y&&(t(5,p=Y),y.showModal())}function E(w){var fe;switch(w.preventDefault(),(fe=w.dataTransfer)==null?void 0:fe.getData("text/plain")){case"CE":j.createCE(F(w.clientX),X(w.clientY));break;case"LER":j.createLER(F(w.clientX),X(w.clientY));break;case"LSR":j.createLSR(F(w.clientX),X(w.clientY));break}}function F(w){return c?(w-c.getBoundingClientRect().left)*u.scale+u.x:w}function X(w){return c?(w-c.getBoundingClientRect().top)*u.scale+u.y:w}function V(w){Nt.call(this,l,w)}function Z(w){ce[w?"unshift":"push"](()=>{c=w,t(3,c)})}function R(w){f=w,t(4,f)}function G(w){b=w,t(7,b)}function Re(w){p=w,t(5,p)}function Te(w){y=w,t(8,y)}return l.$$set=w=>{"$$scope"in w&&t(20,i=w.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1&&t(10,n={0:"move",1:o?"not-allowed":"grabbing",2:"grabbing",3:o?"not-allowed":"crosshair",4:o?"not-allowed":"crosshair",5:"crosshair"})},[o,u,d,c,f,p,h,b,y,_,n,s,L,x,S,B,E,F,X,v,i,r,V,Z,R,G,Re,Te]}class kn extends se{constructor(e){super(),ue(this,e,bn,mn,re,{zoom:19},null,[-1,-1])}get zoom(){return this.$$.ctx[19]}}function yn(l){let e,t,n,o;return{c(){e=I("button"),t=ie(l[0]),this.h()},l(r){e=N(r,"BUTTON",{style:!0,class:!0});var i=O(e);t=oe(i,l[0]),i.forEach(g),this.h()},h(){k(e,"style",l[2]),k(e,"class","svelte-1aag39e")},m(r,i){C(r,e,i),$(e,t),n||(o=q(e,"click",function(){De(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(r,[i]){l=r,i&1&&ye(t,l[0]),i&4&&k(e,"style",l[2])},i:ne,o:ne,d(r){r&&g(e),n=!1,o()}}}function vn(l,e,t){let{text:n}=e,{callback:o=()=>{}}=e,{style:r=void 0}=e;return l.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,o=i.callback),"style"in i&&t(2,r=i.style)},[n,o,r]}class Ee extends se{constructor(e){super(),ue(this,e,vn,yn,re,{text:0,callback:1,style:2})}}function wn(l){let e,t,n=l[0].address+"",o,r,i,s="â†’",u,d,a=l[1].address+"",c,f,p,h;return p=new Ee({props:{text:"Play",callback:l[2]}}),{c(){e=I("div"),t=I("p"),o=ie(n),r=D(),i=I("p"),i.textContent=s,u=D(),d=I("p"),c=ie(a),f=D(),W(p.$$.fragment),this.h()},l(b){e=N(b,"DIV",{class:!0});var y=O(e);t=N(y,"P",{});var _=O(t);o=oe(_,n),_.forEach(g),r=H(y),i=N(y,"P",{"data-svelte-h":!0}),ee(i)!=="svelte-1giyjq6"&&(i.textContent=s),u=H(y),d=N(y,"P",{});var m=O(d);c=oe(m,a),m.forEach(g),f=H(y),K(p.$$.fragment,y),y.forEach(g),this.h()},h(){k(e,"class","svelte-phufxh")},m(b,y){C(b,e,y),$(e,t),$(t,o),$(e,r),$(e,i),$(e,u),$(e,d),$(d,c),$(e,f),J(p,e,null),h=!0},p(b,[y]){(!h||y&1)&&n!==(n=b[0].address+"")&&ye(o,n),(!h||y&2)&&a!==(a=b[1].address+"")&&ye(c,a)},i(b){h||(T(p.$$.fragment,b),h=!0)},o(b){A(p.$$.fragment,b),h=!1},d(b){b&&g(e),Q(p)}}}function En(l,e,t){let{source:n}=e,{destination:o}=e;function r(){j.addPacket(n,o)}return l.$$set=i=>{"source"in i&&t(0,n=i.source),"destination"in i&&t(1,o=i.destination)},[n,o,r]}class Cn extends se{constructor(e){super(),ue(this,e,En,wn,re,{source:0,destination:1})}}function rt(l,e,t){const n=l.slice();return n[2]=e[t],n}function st(l,e,t){const n=l.slice();return n[5]=e[t][0],n}function ut(l){let e,t;return e=new Cn({props:{source:l[2],destination:j.getSureCERouter(l[5])}}),{c(){W(e.$$.fragment)},l(n){K(e.$$.fragment,n)},m(n,o){J(e,n,o),t=!0},p(n,o){const r={};o&1&&(r.source=n[2]),o&1&&(r.destination=j.getSureCERouter(n[5])),e.$set(r)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}function at(l){let e,t,n=te([...l[2].firstHop]),o=[];for(let i=0;i<n.length;i+=1)o[i]=ut(st(l,n,i));const r=i=>A(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=le()},l(i){for(let s=0;s<o.length;s+=1)o[s].l(i);e=le()},m(i,s){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(i,s);C(i,e,s),t=!0},p(i,s){if(s&1){n=te([...i[2].firstHop]);let u;for(u=0;u<n.length;u+=1){const d=st(i,n,u);o[u]?(o[u].p(d,s),T(o[u],1)):(o[u]=ut(d),o[u].c(),T(o[u],1),o[u].m(e.parentNode,e))}for(_e(),u=n.length;u<o.length;u+=1)r(u);ge()}},i(i){if(!t){for(let s=0;s<n.length;s+=1)T(o[s]);t=!0}},o(i){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)A(o[s]);t=!1},d(i){i&&g(e),Ce(o,i)}}}function $n(l){let e,t,n=te(l[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=at(rt(l,n,i));const r=i=>A(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=le()},l(i){for(let s=0;s<o.length;s+=1)o[s].l(i);e=le()},m(i,s){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(i,s);C(i,e,s),t=!0},p(i,[s]){if(s&1){n=te(i[0]);let u;for(u=0;u<n.length;u+=1){const d=rt(i,n,u);o[u]?(o[u].p(d,s),T(o[u],1)):(o[u]=at(d),o[u].c(),T(o[u],1),o[u].m(e.parentNode,e))}for(_e(),u=n.length;u<o.length;u+=1)r(u);ge()}},i(i){if(!t){for(let s=0;s<n.length;s+=1)T(o[s]);t=!0}},o(i){o=o.filter(Boolean);for(let s=0;s<o.length;s+=1)A(o[s]);t=!1},d(i){i&&g(e),Ce(o,i)}}}function Ln(l,e,t){let n,o;return me(l,j,r=>t(1,o=r)),l.$$.update=()=>{l.$$.dirty&2&&t(0,n=o.routers.filter(r=>r instanceof be))},[n,o]}class In extends se{constructor(e){super(),ue(this,e,Ln,$n,re,{})}}function ft(l,e,t){const n=l.slice();return n[13]=e[t],n}function ct(l){let e,t;const n=[l[13],{style:"padding: 10px 20px"}];let o={};for(let r=0;r<n.length;r+=1)o=ze(o,n[r]);return e=new Ee({props:o}),{c(){W(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,i){J(e,r,i),t=!0},p(r,i){const s=i&32?Fe(n,[Ue(r[13]),n[1]]):{};e.$set(s)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){Q(e,r)}}}function Nn(l){let e,t,n,o,r,i,s,u,d,a,c,f=l[1].speedMultiplier+"",p,h,b,y,_,m,L,x,P,S=te(l[5]),v=[];for(let M=0;M<S.length;M+=1)v[M]=ct(ft(l,S,M));const B=M=>A(v[M],1,1,()=>{v[M]=null});return _=new In({}),{c(){e=I("div"),t=I("div"),o=D(),r=I("div"),i=I("div"),s=I("div");for(let M=0;M<v.length;M+=1)v[M].c();u=D(),d=I("div"),a=I("p"),c=ie("Speed Multiplier: "),p=ie(f),h=D(),b=I("input"),y=D(),W(_.$$.fragment),this.h()},l(M){e=N(M,"DIV",{id:!0,style:!0,class:!0});var z=O(e);t=N(z,"DIV",{id:!0,class:!0}),O(t).forEach(g),z.forEach(g),o=H(M),r=N(M,"DIV",{id:!0,style:!0,class:!0});var E=O(r);i=N(E,"DIV",{id:!0,class:!0});var F=O(i);s=N(F,"DIV",{id:!0,class:!0});var X=O(s);for(let R=0;R<v.length;R+=1)v[R].l(X);X.forEach(g),u=H(F),d=N(F,"DIV",{id:!0,class:!0});var V=O(d);a=N(V,"P",{});var Z=O(a);c=oe(Z,"Speed Multiplier: "),p=oe(Z,f),Z.forEach(g),h=H(V),b=N(V,"INPUT",{type:!0,min:!0,max:!0,step:!0}),V.forEach(g),y=H(F),K(_.$$.fragment,F),F.forEach(g),E.forEach(g),this.h()},h(){k(t,"id","resize-bar"),k(t,"class","svelte-1jmh3n8"),k(e,"id","visual-resize-bar"),k(e,"style",n=`width: ${l[0]?1:0}px`),k(e,"class","svelte-1jmh3n8"),k(s,"id","control-panel-buttons"),k(s,"class","svelte-1jmh3n8"),k(b,"type","range"),k(b,"min","0.1"),k(b,"max","2"),k(b,"step","0.1"),k(d,"id","slider"),k(d,"class","svelte-1jmh3n8"),k(i,"id","control-panel-content"),k(i,"class","svelte-1jmh3n8"),k(r,"id","control-panel"),k(r,"style",m=`width: ${l[4]}px; transition: ${l[3]};`),k(r,"class","svelte-1jmh3n8")},m(M,z){C(M,e,z),$(e,t),l[9](t),C(M,o,z),C(M,r,z),$(r,i),$(i,s);for(let E=0;E<v.length;E+=1)v[E]&&v[E].m(s,null);$(i,u),$(i,d),$(d,a),$(a,c),$(a,p),$(d,h),$(d,b),ae(b,l[1].speedMultiplier),$(i,y),J(_,i,null),L=!0,x||(P=[q(t,"pointerdown",l[6]),q(b,"change",l[10]),q(b,"input",l[10])],x=!0)},p(M,[z]){if((!L||z&1&&n!==(n=`width: ${M[0]?1:0}px`))&&k(e,"style",n),z&32){S=te(M[5]);let E;for(E=0;E<S.length;E+=1){const F=ft(M,S,E);v[E]?(v[E].p(F,z),T(v[E],1)):(v[E]=ct(F),v[E].c(),T(v[E],1),v[E].m(s,null))}for(_e(),E=S.length;E<v.length;E+=1)B(E);ge()}(!L||z&2)&&f!==(f=M[1].speedMultiplier+"")&&ye(p,f),z&2&&ae(b,M[1].speedMultiplier),(!L||z&24&&m!==(m=`width: ${M[4]}px; transition: ${M[3]};`))&&k(r,"style",m)},i(M){if(!L){for(let z=0;z<S.length;z+=1)T(v[z]);T(_.$$.fragment,M),L=!0}},o(M){v=v.filter(Boolean);for(let z=0;z<v.length;z+=1)A(v[z]);A(_.$$.fragment,M),L=!1},d(M){M&&(g(e),g(o),g(r)),l[9](null),Ce(v,M),Q(_),x=!1,$e(P)}}}function Rn(l,e,t){let n,o,r,i,s,u;me(l,Le,y=>t(0,i=y)),me(l,Ie,y=>t(1,s=y)),me(l,j,y=>t(8,u=y));let d,a="width 250ms";function c(y){i&&(t(3,a="none"),d.setPointerCapture(y.pointerId),d.addEventListener("pointermove",f),d.addEventListener("pointerup",p))}function f(y){t(4,r=window.innerWidth-y.clientX),r<=20&&t(4,r=0),r>=window.innerWidth-20&&t(4,r=window.innerWidth-20)}function p(y){d.removeEventListener("pointermove",f),d.removeEventListener("pointerup",p),d.releasePointerCapture(y.pointerId),t(3,a="width 250ms")}function h(y){ce[y?"unshift":"push"](()=>{d=y,t(2,d)})}function b(){s.speedMultiplier=ke(this.value),Ie.set(s)}return l.$$.update=()=>{l.$$.dirty&256&&t(7,n=u.routers.filter(y=>y instanceof be)),l.$$.dirty&130&&t(5,o=[{text:s.running?"Pause":"Resume",callback:()=>{Oe(Ie,s.running=!s.running,s)}},{text:"Reset",callback:()=>{j.clearPackets()}},{text:"Play All",callback:()=>{for(const y of n)for(const[_]of y.firstHop)j.addPacket(y,j.getSureCERouter(_))}}]),l.$$.dirty&1&&t(4,r=i?300:0)},[i,s,d,a,r,o,c,n,u,h,b]}class Tn extends se{constructor(e){super(),ue(this,e,Rn,Nn,re,{})}}function Pn(l){let e;return{c(){e=ve("circle"),this.h()},l(t){e=we(t,"circle",{r:!0,class:!0}),O(e).forEach(g),this.h()},h(){k(e,"r","5"),k(e,"class","svelte-rvo2j9"),Ye(e,"labeled",l[0].label!==-1)},m(t,n){C(t,e,n),l[4](e)},p(t,[n]){n&1&&Ye(e,"labeled",t[0].label!==-1)},i:ne,o:ne,d(t){t&&g(e),l[4](null)}}}function Bn(l,e,t){let n;me(l,Ie,f=>t(3,n=f));let{packet:o}=e,r,i,s;function u(){if(!o.nextHop){o.drop(),alert("Packet has no next hop.");return}const f=Math.sqrt((o.node.x-o.nextHop.node.x)**2+(o.node.y-o.nextHop.node.y)**2);r=Math.round(f/250*1e3)}function d(){if(!o.nextHop){o.drop(),alert("Packet has no next hop.");return}u(),s&&(t(2,i=s.animate([{transform:`translate(${o.node.x}px, ${o.node.y}px)`},{transform:`translate(${o.nextHop.node.x}px, ${o.nextHop.node.y}px)`}],{duration:r,easing:"linear"})),t(2,i.onfinish=a,i))}function a(){if(!o.nextHop){o.drop(),alert("Packet has no next hop.");return}t(0,o.node=o.nextHop.node,o),o.nextHop.receivePacket(o),d()}requestAnimationFrame(d);function c(f){ce[f?"unshift":"push"](()=>{s=f,t(1,s)})}return l.$$set=f=>{"packet"in f&&t(0,o=f.packet)},l.$$.update=()=>{l.$$.dirty&12&&i&&t(2,i.playbackRate=n.speedMultiplier,i),l.$$.dirty&12&&i&&(n.running?i.play():i.pause())},[o,s,i,n,c]}class Dn extends se{constructor(e){super(),ue(this,e,Bn,Pn,re,{packet:0})}}function Hn(l){let e,t,n,o,r,i,s,u,d=l[0].distance+"",a,c,f,p;return{c(){e=ve("line"),t=D(),n=ve("rect"),s=D(),u=ve("text"),a=ie(d),c=ie(" km"),this.h()},l(h){e=we(h,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),O(e).forEach(g),t=H(h),n=we(h,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),O(n).forEach(g),s=H(h),u=we(h,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var b=O(u);a=oe(b,d),c=oe(b," km"),b.forEach(g),this.h()},h(){k(e,"x1",l[4]),k(e,"y1",l[2]),k(e,"x2",l[3]),k(e,"y2",l[1]),k(n,"id",o=l[0].id),k(n,"x",r=l[5].x-Se/2),k(n,"y",i=l[5].y-Ae/2),k(n,"width",Se),k(n,"height",Ae),k(n,"class","svelte-zjn2k6"),k(u,"x",f=l[5].x),k(u,"y",p=l[5].y),k(u,"dominant-baseline","central"),k(u,"class","svelte-zjn2k6")},m(h,b){C(h,e,b),C(h,t,b),C(h,n,b),C(h,s,b),C(h,u,b),$(u,a),$(u,c)},p(h,[b]){b&16&&k(e,"x1",h[4]),b&4&&k(e,"y1",h[2]),b&8&&k(e,"x2",h[3]),b&2&&k(e,"y2",h[1]),b&1&&o!==(o=h[0].id)&&k(n,"id",o),b&32&&r!==(r=h[5].x-Se/2)&&k(n,"x",r),b&32&&i!==(i=h[5].y-Ae/2)&&k(n,"y",i),b&1&&d!==(d=h[0].distance+"")&&ye(a,d),b&32&&f!==(f=h[5].x)&&k(u,"x",f),b&32&&p!==(p=h[5].y)&&k(u,"y",p)},i:ne,o:ne,d(h){h&&(g(e),g(t),g(n),g(s),g(u))}}}const Se=50,Ae=20;function dt(l,e){return(l+e)/2}function Mn(l,e,t){let n,o,r,i,s,{link:u}=e;return l.$$set=d=>{"link"in d&&t(0,u=d.link)},l.$$.update=()=>{l.$$.dirty&1&&t(4,n=u.source.node.x),l.$$.dirty&1&&t(3,o=u.target.node.x),l.$$.dirty&1&&t(2,r=u.source.node.y),l.$$.dirty&1&&t(1,i=u.target.node.y),l.$$.dirty&30&&t(5,s={x:dt(n,o),y:dt(r,i)})},[u,i,r,o,n,s]}class xn extends se{constructor(e){super(),ue(this,e,Mn,Hn,re,{link:0})}}function Sn(l){let e,t,n,o,r,i,s,u=l[0].node.label+"",d,a,c;return{c(){e=ve("circle"),i=D(),s=ve("text"),d=ie(u),this.h()},l(f){e=we(f,"circle",{id:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),O(e).forEach(g),i=H(f),s=we(f,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var p=O(s);d=oe(p,u),p.forEach(g),this.h()},h(){k(e,"id",t=l[0].id.toString()),k(e,"cx",n=l[0].node.x),k(e,"cy",o=l[0].node.y),k(e,"r","20"),k(e,"fill",r=l[1][l[0].type]),k(e,"class","svelte-17jcsko"),k(s,"x",a=l[0].node.x),k(s,"y",c=l[0].node.y),k(s,"dominant-baseline","central"),k(s,"class","svelte-17jcsko")},m(f,p){C(f,e,p),C(f,i,p),C(f,s,p),$(s,d)},p(f,[p]){p&1&&t!==(t=f[0].id.toString())&&k(e,"id",t),p&1&&n!==(n=f[0].node.x)&&k(e,"cx",n),p&1&&o!==(o=f[0].node.y)&&k(e,"cy",o),p&1&&r!==(r=f[1][f[0].type])&&k(e,"fill",r),p&1&&u!==(u=f[0].node.label+"")&&ye(d,u),p&1&&a!==(a=f[0].node.x)&&k(s,"x",a),p&1&&c!==(c=f[0].node.y)&&k(s,"y",c)},i:ne,o:ne,d(f){f&&(g(e),g(i),g(s))}}}function An(l,e,t){let{router:n}=e;const o={CE:"#7FC8F8",LER:"#FFE45E",LSR:"#FF6392"};return l.$$set=r=>{"router"in r&&t(0,n=r.router)},[n,o]}class On extends se{constructor(e){super(),ue(this,e,An,Sn,re,{router:0})}}function zn(l){let e,t,n,o;return{c(){e=I("div"),t=ie(l[0]),this.h()},l(r){e=N(r,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var i=O(e);t=oe(i,l[0]),i.forEach(g),this.h()},h(){k(e,"draggable","true"),k(e,"role","button"),k(e,"tabindex","-1"),Pe(e,"background-color",l[1]),k(e,"class","svelte-blffat")},m(r,i){C(r,e,i),$(e,t),n||(o=q(e,"dragstart",l[2]),n=!0)},p(r,[i]){i&1&&ye(t,r[0]),i&2&&Pe(e,"background-color",r[1])},i:ne,o:ne,d(r){r&&g(e),n=!1,o()}}}function Fn(l,e,t){let n;me(l,Le,u=>t(4,n=u));let{text:o}=e,{type:r}=e,{color:i}=e;function s(u){var d;if(n){alert("Network is locked.");return}(d=u.dataTransfer)==null||d.setData("text/plain",r)}return l.$$set=u=>{"text"in u&&t(0,o=u.text),"type"in u&&t(3,r=u.type),"color"in u&&t(1,i=u.color)},[o,i,s,r]}class Un extends se{constructor(e){super(),ue(this,e,Fn,zn,re,{text:0,type:3,color:1})}}function ht(l,e,t){const n=l.slice();return n[4]=e[t],n}function pt(l,e,t){const n=l.slice();return n[7]=e[t],n}function _t(l){let e,t,n,o=te(l[2]),r=[];for(let a=0;a<o.length;a+=1)r[a]=gt(pt(l,o,a));const i=a=>A(r[a],1,1,()=>{r[a]=null});let s=te(l[1]),u=[];for(let a=0;a<s.length;a+=1)u[a]=mt(ht(l,s,a));const d=a=>A(u[a],1,1,()=>{u[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=D();for(let a=0;a<u.length;a+=1)u[a].c();t=le()},l(a){for(let c=0;c<r.length;c+=1)r[c].l(a);e=H(a);for(let c=0;c<u.length;c+=1)u[c].l(a);t=le()},m(a,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(a,c);C(a,e,c);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(a,c);C(a,t,c),n=!0},p(a,c){if(c&4){o=te(a[2]);let f;for(f=0;f<o.length;f+=1){const p=pt(a,o,f);r[f]?(r[f].p(p,c),T(r[f],1)):(r[f]=gt(p),r[f].c(),T(r[f],1),r[f].m(e.parentNode,e))}for(_e(),f=o.length;f<r.length;f+=1)i(f);ge()}if(c&2){s=te(a[1]);let f;for(f=0;f<s.length;f+=1){const p=ht(a,s,f);u[f]?(u[f].p(p,c),T(u[f],1)):(u[f]=mt(p),u[f].c(),T(u[f],1),u[f].m(t.parentNode,t))}for(_e(),f=s.length;f<u.length;f+=1)d(f);ge()}},i(a){if(!n){for(let c=0;c<o.length;c+=1)T(r[c]);for(let c=0;c<s.length;c+=1)T(u[c]);n=!0}},o(a){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)A(r[c]);u=u.filter(Boolean);for(let c=0;c<u.length;c+=1)A(u[c]);n=!1},d(a){a&&(g(e),g(t)),Ce(r,a),Ce(u,a)}}}function gt(l){let e,t;const n=[l[7]];let o={};for(let r=0;r<n.length;r+=1)o=ze(o,n[r]);return e=new Un({props:o}),{c(){W(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,i){J(e,r,i),t=!0},p(r,i){const s=i&4?Fe(n,[Ue(r[7])]):{};e.$set(s)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){Q(e,r)}}}function mt(l){let e,t;const n=[l[4]];let o={};for(let r=0;r<n.length;r+=1)o=ze(o,n[r]);return e=new Ee({props:o}),{c(){W(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,i){J(e,r,i),t=!0},p(r,i){const s=i&2?Fe(n,[Ue(r[4])]):{};e.$set(s)},i(r){t||(T(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){Q(e,r)}}}function jn(l){let e,t,n,o;e=new Ee({props:{text:l[0]?"Edit":"Simulation",callback:l[3],style:`width: 100px; background-color: ${l[0]?"#3CB371":"#6495ED"};`}});let r=!l[0]&&_t(l);return{c(){W(e.$$.fragment),t=D(),r&&r.c(),n=le()},l(i){K(e.$$.fragment,i),t=H(i),r&&r.l(i),n=le()},m(i,s){J(e,i,s),C(i,t,s),r&&r.m(i,s),C(i,n,s),o=!0},p(i,[s]){const u={};s&1&&(u.text=i[0]?"Edit":"Simulation"),s&1&&(u.callback=i[3]),s&1&&(u.style=`width: 100px; background-color: ${i[0]?"#3CB371":"#6495ED"};`),e.$set(u),i[0]?r&&(_e(),A(r,1,1,()=>{r=null}),ge()):r?(r.p(i,s),s&1&&T(r,1)):(r=_t(i),r.c(),T(r,1),r.m(n.parentNode,n))},i(i){o||(T(e.$$.fragment,i),T(r),o=!0)},o(i){A(e.$$.fragment,i),A(r),o=!1},d(i){i&&(g(t),g(n)),Q(e,i),r&&r.d(i)}}}function Gn(l,e,t){let n,o;me(l,Le,s=>t(0,o=s));const r=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],i=()=>{Oe(Le,o=!o,o),j.clearPackets()};return l.$$.update=()=>{l.$$.dirty&1&&t(1,n=[{text:"Clear",callback:()=>{if(o){alert("Network is locked.");return}confirm("Are you sure you want to clear the network?")&&j.clear()}}])},[o,n,r,i]}class Yn extends se{constructor(e){super(),ue(this,e,Gn,jn,re,{})}}function Xn(l){let e,t="Drag and drop routers to add them to the network.",n,o,r="Hold the shift key and drag routers to make a singular link.",i,s,u="Hold the alt key and drag routers to make continous links.",d,a,c="Hold the ctrl key and drag CE's to add destinations.",f,p,h="Double click a router to configure it.",b,y,_="The clear button will delete the entire network.",m,L,x,P,S="Press Esc to close this popup.";return{c(){e=I("p"),e.textContent=t,n=D(),o=I("p"),o.textContent=r,i=D(),s=I("p"),s.textContent=u,d=D(),a=I("p"),a.textContent=c,f=D(),p=I("p"),p.textContent=h,b=D(),y=I("p"),y.textContent=_,m=D(),L=I("br"),x=D(),P=I("p"),P.textContent=S},l(v){e=N(v,"P",{"data-svelte-h":!0}),ee(e)!=="svelte-bhocp0"&&(e.textContent=t),n=H(v),o=N(v,"P",{"data-svelte-h":!0}),ee(o)!=="svelte-11o7jqf"&&(o.textContent=r),i=H(v),s=N(v,"P",{"data-svelte-h":!0}),ee(s)!=="svelte-g9ilhz"&&(s.textContent=u),d=H(v),a=N(v,"P",{"data-svelte-h":!0}),ee(a)!=="svelte-33j76o"&&(a.textContent=c),f=H(v),p=N(v,"P",{"data-svelte-h":!0}),ee(p)!=="svelte-11scjjz"&&(p.textContent=h),b=H(v),y=N(v,"P",{"data-svelte-h":!0}),ee(y)!=="svelte-vcl8s3"&&(y.textContent=_),m=H(v),L=N(v,"BR",{}),x=H(v),P=N(v,"P",{"data-svelte-h":!0}),ee(P)!=="svelte-1dvt5v1"&&(P.textContent=S)},m(v,B){C(v,e,B),C(v,n,B),C(v,o,B),C(v,i,B),C(v,s,B),C(v,d,B),C(v,a,B),C(v,f,B),C(v,p,B),C(v,b,B),C(v,y,B),C(v,m,B),C(v,L,B),C(v,x,B),C(v,P,B)},p:ne,d(v){v&&(g(e),g(n),g(o),g(i),g(s),g(d),g(a),g(f),g(p),g(b),g(y),g(m),g(L),g(x),g(P))}}}function qn(l){let e,t,n,o,r,i;t=new Ee({props:{text:"Help",callback:l[1]}});function s(d){l[2](d)}let u={$$slots:{default:[Xn]},$$scope:{ctx:l}};return l[0]!==void 0&&(u.dialog=l[0]),o=new Ge({props:u}),ce.push(()=>pe(o,"dialog",s)),{c(){e=I("div"),W(t.$$.fragment),n=D(),W(o.$$.fragment)},l(d){e=N(d,"DIV",{});var a=O(e);K(t.$$.fragment,a),a.forEach(g),n=H(d),K(o.$$.fragment,d)},m(d,a){C(d,e,a),J(t,e,null),C(d,n,a),J(o,d,a),i=!0},p(d,[a]){const c={};a&1&&(c.callback=d[1]),t.$set(c);const f={};a&8&&(f.$$scope={dirty:a,ctx:d}),!r&&a&1&&(r=!0,f.dialog=d[0],he(()=>r=!1)),o.$set(f)},i(d){i||(T(t.$$.fragment,d),T(o.$$.fragment,d),i=!0)},o(d){A(t.$$.fragment,d),A(o.$$.fragment,d),i=!1},d(d){d&&(g(e),g(n)),Q(t),Q(o,d)}}}function Vn(l,e,t){let n;const o=()=>{n.showModal()};function r(i){n=i,t(0,n)}return[n,o,r]}class Wn extends se{constructor(e){super(),ue(this,e,Vn,qn,re,{})}}function Kn(l){let e,t,n,o,r,i;return e=new Ee({props:{text:" - ",callback:l[1]}}),n=new Ee({props:{text:"Fullscreen",callback:l[2]}}),r=new Ee({props:{text:" + ",callback:l[3]}}),{c(){W(e.$$.fragment),t=D(),W(n.$$.fragment),o=D(),W(r.$$.fragment)},l(s){K(e.$$.fragment,s),t=H(s),K(n.$$.fragment,s),o=H(s),K(r.$$.fragment,s)},m(s,u){J(e,s,u),C(s,t,u),J(n,s,u),C(s,o,u),J(r,s,u),i=!0},p(s,[u]){const d={};u&1&&(d.callback=s[1]),e.$set(d);const a={};u&1&&(a.callback=s[3]),r.$set(a)},i(s){i||(T(e.$$.fragment,s),T(n.$$.fragment,s),T(r.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),A(n.$$.fragment,s),A(r.$$.fragment,s),i=!1},d(s){s&&(g(t),g(o)),Q(e,s),Q(n,s),Q(r,s)}}}function Jn(l,e,t){let{zoom:n}=e;const o=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,s)},r=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},i=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,s)};return l.$$set=s=>{"zoom"in s&&t(0,n=s.zoom)},[n,o,r,i]}class Qn extends se{constructor(e){super(),ue(this,e,Jn,Kn,re,{zoom:0})}}function bt(l,e,t){const n=l.slice();return n[5]=e[t],n}function kt(l,e,t){const n=l.slice();return n[8]=e[t],n}function yt(l,e,t){const n=l.slice();return n[11]=e[t],n}function vt(l,e){let t,n,o;return n=new xn({props:{link:e[11]}}),{key:l,first:null,c(){t=le(),W(n.$$.fragment),this.h()},l(r){t=le(),K(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,i){C(r,t,i),J(n,r,i),o=!0},p(r,i){e=r;const s={};i&2&&(s.link=e[11]),n.$set(s)},i(r){o||(T(n.$$.fragment,r),o=!0)},o(r){A(n.$$.fragment,r),o=!1},d(r){r&&g(t),Q(n,r)}}}function wt(l,e){let t,n,o;return n=new On({props:{router:e[8]}}),{key:l,first:null,c(){t=le(),W(n.$$.fragment),this.h()},l(r){t=le(),K(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,i){C(r,t,i),J(n,r,i),o=!0},p(r,i){e=r;const s={};i&2&&(s.router=e[8]),n.$set(s)},i(r){o||(T(n.$$.fragment,r),o=!0)},o(r){A(n.$$.fragment,r),o=!1},d(r){r&&g(t),Q(n,r)}}}function Et(l,e){let t,n,o;return n=new Dn({props:{packet:e[5]}}),{key:l,first:null,c(){t=le(),W(n.$$.fragment),this.h()},l(r){t=le(),K(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,i){C(r,t,i),J(n,r,i),o=!0},p(r,i){e=r;const s={};i&2&&(s.packet=e[5]),n.$set(s)},i(r){o||(T(n.$$.fragment,r),o=!0)},o(r){A(n.$$.fragment,r),o=!1},d(r){r&&g(t),Q(n,r)}}}function Zn(l){let e=[],t=new Map,n,o=[],r=new Map,i,s=[],u=new Map,d,a,c=te(l[1].links);const f=_=>_[11].id;for(let _=0;_<c.length;_+=1){let m=yt(l,c,_),L=f(m);t.set(L,e[_]=vt(L,m))}let p=te(l[1].routers);const h=_=>_[8].id;for(let _=0;_<p.length;_+=1){let m=kt(l,p,_),L=h(m);r.set(L,o[_]=wt(L,m))}let b=te(l[1].packets);const y=_=>_[5].id;for(let _=0;_<b.length;_+=1){let m=bt(l,b,_),L=y(m);u.set(L,s[_]=Et(L,m))}return{c(){for(let _=0;_<e.length;_+=1)e[_].c();n=D();for(let _=0;_<o.length;_+=1)o[_].c();i=D();for(let _=0;_<s.length;_+=1)s[_].c();d=le()},l(_){for(let m=0;m<e.length;m+=1)e[m].l(_);n=H(_);for(let m=0;m<o.length;m+=1)o[m].l(_);i=H(_);for(let m=0;m<s.length;m+=1)s[m].l(_);d=le()},m(_,m){for(let L=0;L<e.length;L+=1)e[L]&&e[L].m(_,m);C(_,n,m);for(let L=0;L<o.length;L+=1)o[L]&&o[L].m(_,m);C(_,i,m);for(let L=0;L<s.length;L+=1)s[L]&&s[L].m(_,m);C(_,d,m),a=!0},p(_,m){m&2&&(c=te(_[1].links),_e(),e=xe(e,m,f,1,_,c,t,n.parentNode,Me,vt,n,yt),ge()),m&2&&(p=te(_[1].routers),_e(),o=xe(o,m,h,1,_,p,r,i.parentNode,Me,wt,i,kt),ge()),m&2&&(b=te(_[1].packets),_e(),s=xe(s,m,y,1,_,b,u,d.parentNode,Me,Et,d,bt),ge())},i(_){if(!a){for(let m=0;m<c.length;m+=1)T(e[m]);for(let m=0;m<p.length;m+=1)T(o[m]);for(let m=0;m<b.length;m+=1)T(s[m]);a=!0}},o(_){for(let m=0;m<e.length;m+=1)A(e[m]);for(let m=0;m<o.length;m+=1)A(o[m]);for(let m=0;m<s.length;m+=1)A(s[m]);a=!1},d(_){_&&(g(n),g(i),g(d));for(let m=0;m<e.length;m+=1)e[m].d(_);for(let m=0;m<o.length;m+=1)o[m].d(_);for(let m=0;m<s.length;m+=1)s[m].d(_)}}}function el(l){let e,t,n,o,r,i,s,u,d,a,c,f,p,h,b,y,_;function m(S){l[2](S)}let L={$$slots:{default:[Zn]},$$scope:{ctx:l}};l[0]!==void 0&&(L.zoom=l[0]),n=new kn({props:L}),ce.push(()=>pe(n,"zoom",m)),s=new Yn({}),a=new Wn({});function x(S){l[3](S)}let P={};return l[0]!==void 0&&(P.zoom=l[0]),p=new Qn({props:P}),ce.push(()=>pe(p,"zoom",x)),y=new Tn({}),{c(){e=I("div"),t=I("div"),W(n.$$.fragment),r=D(),i=I("div"),W(s.$$.fragment),u=D(),d=I("div"),W(a.$$.fragment),c=D(),f=I("div"),W(p.$$.fragment),b=D(),W(y.$$.fragment),this.h()},l(S){e=N(S,"DIV",{id:!0,class:!0});var v=O(e);t=N(v,"DIV",{id:!0,class:!0});var B=O(t);K(n.$$.fragment,B),r=H(B),i=N(B,"DIV",{id:!0,class:!0});var M=O(i);K(s.$$.fragment,M),M.forEach(g),u=H(B),d=N(B,"DIV",{id:!0,class:!0});var z=O(d);K(a.$$.fragment,z),z.forEach(g),c=H(B),f=N(B,"DIV",{id:!0,class:!0});var E=O(f);K(p.$$.fragment,E),E.forEach(g),B.forEach(g),b=H(v),K(y.$$.fragment,v),v.forEach(g),this.h()},h(){k(i,"id","top-left-bar"),k(i,"class","absolute-flex svelte-1kpnzxr"),k(d,"id","bottom-left-bar"),k(d,"class","absolute-flex svelte-1kpnzxr"),k(f,"id","bottom-right-bar"),k(f,"class","absolute-flex svelte-1kpnzxr"),k(t,"id","network"),k(t,"class","svelte-1kpnzxr"),k(e,"id","mpls"),k(e,"class","svelte-1kpnzxr")},m(S,v){C(S,e,v),$(e,t),J(n,t,null),$(t,r),$(t,i),J(s,i,null),$(t,u),$(t,d),J(a,d,null),$(t,c),$(t,f),J(p,f,null),$(e,b),J(y,e,null),_=!0},p(S,[v]){const B={};v&16386&&(B.$$scope={dirty:v,ctx:S}),!o&&v&1&&(o=!0,B.zoom=S[0],he(()=>o=!1)),n.$set(B);const M={};!h&&v&1&&(h=!0,M.zoom=S[0],he(()=>h=!1)),p.$set(M)},i(S){_||(T(n.$$.fragment,S),T(s.$$.fragment,S),T(a.$$.fragment,S),T(p.$$.fragment,S),T(y.$$.fragment,S),_=!0)},o(S){A(n.$$.fragment,S),A(s.$$.fragment,S),A(a.$$.fragment,S),A(p.$$.fragment,S),A(y.$$.fragment,S),_=!1},d(S){S&&g(e),Q(n),Q(s),Q(a),Q(p),Q(y)}}}function tl(l,e,t){let n,o;me(l,Ie,u=>t(4,n=u)),me(l,j,u=>t(1,o=u));let r;Rt(()=>{window.addEventListener("visibilitychanged",()=>{Oe(Ie,n.running=!document.hidden,n)})});function i(u){r=u,t(0,r)}function s(u){r=u,t(0,r)}return[r,o,i,s]}class nl extends se{constructor(e){super(),ue(this,e,tl,el,re,{})}}function ll(l){let e,t;return e=new nl({}),{c(){W(e.$$.fragment)},l(n){K(e.$$.fragment,n)},m(n,o){J(e,n,o),t=!0},p:ne,i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){Q(e,n)}}}class hl extends se{constructor(e){super(),ue(this,e,null,ll,re,{})}}export{hl as component};
