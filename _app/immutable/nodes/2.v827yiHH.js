var xt=Object.defineProperty;var Mt=(l,e,t)=>e in l?xt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var V=(l,e,t)=>(Mt(l,typeof e!="symbol"?e+"":e,t),t);import{r as Be,s as Z,a as Et,u as Ct,g as Lt,b as It,x as Rt,e as fe,i as Dt,n as ne,y as _e,c as he,o as Bt,z as Fe,A as Se}from"../chunks/scheduler.C5v8YK5g.js";import{n as N,m as B,S as ee,i as te,e as R,c as D,a as A,d as b,l as k,g as C,z as K,t as re,b as ie,h as L,j as me,s as x,v as Y,A as le,f as M,w as q,x as X,r as se,p as ue,B as Re,y as G,C as oe,D as be,E as ge,o as Q,q as Pe,F as Le,G as Ie,H as zt,I as Ye}from"../chunks/index.ChYF1Lys.js";import{w as He}from"../chunks/index.CD1dNpfE.js";function J(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function xe(l,e){N(l,1,1,()=>{e.delete(l.key)})}function Me(l,e,t,n,r,i,o,s,u,c,a,_){let f=l.length,g=i.length,p=f;const w={};for(;p--;)w[l[p].key]=p;const d=[],h=new Map,m=new Map,v=[];for(p=g;p--;){const y=_(r,i,p),P=t(y);let j=o.get(P);j?n&&v.push(()=>j.p(y,e)):(j=c(P,y),j.c()),h.set(P,d[p]=j),P in w&&m.set(P,Math.abs(p-w[P]))}const F=new Set,z=new Set;function I(y){B(y,1),y.m(s,a),o.set(y.key,y),a=y.first,g--}for(;f&&g;){const y=d[g-1],P=l[f-1],j=y.key,$=P.key;y===P?(a=y.first,f--,g--):h.has($)?!o.has(j)||F.has(j)?I(y):z.has($)?f--:m.get(j)>m.get($)?(z.add(j),I(y)):(F.add($),f--):(u(P,o),f--)}for(;f--;){const y=l[f];h.has(y.key)||u(y,o)}for(;g;)I(d[g-1]);return Be(v),d}function Oe(l,e){const t={},n={},r={$$scope:1};let i=l.length;for(;i--;){const o=l[i],s=e[i];if(s){for(const u in o)u in s||(n[u]=1);for(const u in s)r[u]||(t[u]=s[u],r[u]=1);l[i]=s}else for(const u in o)r[u]=1}for(const o in n)o in t||(t[o]=void 0);return t}function je(l){return typeof l=="object"&&l!==null?l:{}}let At=class{constructor(e,t,n){V(this,"bandwidth",0);this.id=e,this.source=t,this.target=n}get distance(){return Math.round(Math.sqrt((this.source.node.x-this.target.node.x)**2+(this.source.node.y-this.target.node.y)**2))}},Ft=class{constructor(e,t,n,r){V(this,"ttl",32);V(this,"label",-1);V(this,"nextHop");this.id=e,this.source=t,this.destination=n,this.node=r;const i=t.firstHop.get(n.address);if(!i)return;const o=U.getRouter(i);o&&(this.nextHop=o)}decrementTTL(){--this.ttl<=0&&this.drop()}drop(){U.deletePacket(this.id)}},Ue=class{constructor(e,t){this.id=e,this.node=t}};class de extends Ue{constructor(){super(...arguments);V(this,"address",`CE-IP-${this.id}`);V(this,"firstHop",new Map);V(this,"addEmptyEntry",()=>{this.firstHop.set("",0)});V(this,"receiveEntry",(t,n)=>{this.firstHop.set(t,n)});V(this,"updateAddress",(t,n)=>{const r=this.firstHop.get(t);if(r===void 0){alert(`Unable to update old first hop Address '${t}' to '${n}'.`);return}this.firstHop.set(n,r),this.firstHop.delete(t)});V(this,"deleteEntry",t=>{this.firstHop.delete(t)})}receivePacket(t){t.drop()}clearTables(){this.firstHop.clear()}get type(){return"CE"}}let Tt=class{constructor(){V(this,"map",new Map);V(this,"addEmptyEntry",()=>{this.map.set(0,{outgoingLabel:0,nextHop:"0"})});V(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{outgoingLabel:t,nextHop:n})});V(this,"updateLabel",(e,t)=>{const n=this.map.get(e);if(!n){alert(`Unable to update old LIB label '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Label entry '${t}' already exists.`);return}this.map.set(t,n),this.map.delete(e)});V(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}},St=class{constructor(){V(this,"map",new Map);V(this,"addEmptyEntry",()=>{this.map.set("0",{label:0,nextHop:"0"})});V(this,"receiveEntry",(e,t,n)=>{this.map.set(e,{label:t,nextHop:n})});V(this,"updateAddress",(e,t)=>{const n=this.map.get(e);if(n===void 0){alert(`Unable to update old FIB address '${e}' to '${t}'.`);return}if(this.map.get(t)){alert(`Address '${t}' already exists in FIB.`);return}this.map.set(t,n),this.map.delete(e)});V(this,"deleteEntry",e=>{this.map.delete(e)})}get(e){return this.map.get(e)}};class ve extends Ue{constructor(){super(...arguments);V(this,"FIB",new St);V(this,"LIB",new Tt)}receivePacket(t){var r,i,o,s;const n=t.destination;if(t.label===-1){const u=(r=this.FIB.get(n.address))==null?void 0:r.nextHop;if(!u)return;const c=(i=this.FIB.get(n.address))==null?void 0:i.label;if(!c)return;t.label=c;const a=U.getRouter(parseInt(u));if(!a)return;t.nextHop=a}else{const u=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!u)return;const c=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!c)return;t.label=c;const a=U.routers.find(_=>_ instanceof de&&_.address===u);if(!a)return;t.nextHop=a}t.decrementTTL()}clearTables(){this.FIB.map.clear(),this.LIB.map.clear()}get type(){return"LER"}}class Ne extends Ue{constructor(){super(...arguments);V(this,"LIB",new Tt)}receivePacket(t){var o,s;const n=(o=this.LIB.get(t.label))==null?void 0:o.nextHop;if(!n)return;const r=(s=this.LIB.get(t.label))==null?void 0:s.outgoingLabel;if(!r)return;t.label=r;const i=U.getRouter(parseInt(n));i&&(t.nextHop=i,t.decrementTTL())}clearTables(){this.LIB.map.clear()}get type(){return"LSR"}}const Ot={CE:["LER"],LER:["CE","LSR"],LSR:["LER","LSR"]};class jt{constructor(){V(this,"store",He({routers:[],links:[],packets:[]}));V(this,"set",this.store.set);V(this,"update",this.store.update);V(this,"subscribe",this.store.subscribe);V(this,"_routers",[]);V(this,"_links",[]);V(this,"_packets",[]);V(this,"routerMap",new Map);V(this,"CEMap",new Map);V(this,"routerCounter",1);V(this,"packetCounter",1)}get routers(){return this._routers}get links(){return this._links}get packets(){return this._packets}get networkState(){return{routers:this.routers,links:this.links,packets:this.packets}}addLink(e){if(e.source===e.target||!Ot[e.source.type].includes(e.target.type)||this.doesLinkExist(e)||this.doesLinkExist({source:e.target,target:e.source}))return;const t=new At(`${e.source.id}-${e.target.id}`,e.source,e.target);this._links.push(t),this.notify()}deleteLink(e){this._links=this._links.filter(t=>t.id!==e),this.notify()}doesLinkExist(e){return this._links.some(t=>t.source===e.source&&t.target===e.target)}createCE(e,t){const n=this.routerCounter++,r=new de(n,{label:`CE ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(r)}createLER(e,t){const n=this.routerCounter++,r=new ve(n,{label:`LER ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(r)}createLSR(e,t){const n=this.routerCounter++,r=new Ne(n,{label:`LSR ${n}`,x:Math.round(e),y:Math.round(t)});this.addRouter(r)}addRouter(e){this._routers.push(e),this.routerMap.set(e.id,e),e instanceof de&&this.CEMap.set(e.address,e),this.notify()}deleteRouter(e){const t=this.getRouter(e);t&&(this._routers=this._routers.filter(n=>n.id!==e),this._links=this._links.filter(n=>n.source.id!==e&&n.target.id!==e),this.routerMap.delete(e),t instanceof de&&this.CEMap.delete(t.address),this.notify())}getRouter(e){return this.routerMap.get(e)}getSureRouter(e){const t=this.getRouter(e);if(!t)throw new Error(`Router with id ${e} not found`);return t}getCERouter(e){return this.CEMap.get(e)}getSureCERouter(e){const t=this.getCERouter(e);if(!t)throw new Error(`Router with address ${e} not found`);return t}addPacket(e,t){const n=new Ft(this.packetCounter++,e,t,{x:e.node.x,y:e.node.y});this._packets.push(n),this.notify()}deletePacket(e){this._packets=this._packets.filter(t=>t.id!==e),this.notify()}clearTables(){for(const e of this._routers)e.clearTables();this.notify()}clearLinks(){this._links=[],this.notify()}clearPackets(){this._packets=[],this.packetCounter=0,this.notify()}clear(){this._routers=[],this._links=[],this._packets=[],this.routerMap.clear(),this.CEMap.clear(),this.routerCounter=1,this.packetCounter=1,this.notify()}notify(){this.store.set(this.networkState)}}const Ut=new jt,U=Ut,Te=He({running:!0,speedMultiplier:1});class Vt{constructor(){V(this,"store",He());V(this,"set",this.store.set);V(this,"update",this.store.update);V(this,"subscribe",this.store.subscribe);V(this,"_map",new Map)}getPath(e,t){const n=this._map.get(e);if(n)return n.get(t)}findShortestPath(e,t){return qe(e,t)}findShortestPaths(){const e=new Map,t=U.routers.filter(n=>n.type==="CE");for(const n of t){const r=new Map;for(const i of t){if(n===i)continue;const o=qe(n,i);r.set(i.id,o)}e.set(n.id,r)}this._map=e}notify(){this.store.set(this._map)}}function qe(l,e){const t=U.routers,n=t.length,r=new Array(n).fill(1/0),i=new Array(n).fill(!1),o=new Array(n).fill(null);r[t.indexOf(l)]=0;let s=!1;for(;!s;){let a=null,_=1/0;for(let f=0;f<n;f++)!i[f]&&r[f]<_&&(a=t[f],_=r[f]);if(!a||a.id===e.id){s=!0;continue}i[t.indexOf(a)]=!0;for(const f of U.links){let g;if(f.source===a)g=f.target;else if(f.target===a)g=f.source;else continue;const p=t.indexOf(g),w=_+f.distance;w<r[p]&&(r[p]=w,o[p]=a)}}const u=[];let c=e;for(;c;){u.unshift(c);const a=t.indexOf(c);c=o[a]}return u}const Yt=new Vt,Pt=Yt,De=He(!1);function qt(l){let e,t,n,r;const i=l[2].default,o=Et(i,l,l[1],null);return{c(){e=R("dialog"),o&&o.c(),this.h()},l(s){e=D(s,"DIALOG",{class:!0});var u=A(e);o&&o.l(u),u.forEach(b),this.h()},h(){k(e,"class","svelte-p5wejv")},m(s,u){C(s,e,u),o&&o.m(e,null),l[4](e),t=!0,n||(r=K(e,"close",l[3]),n=!0)},p(s,[u]){o&&o.p&&(!t||u&2)&&Ct(o,i,s,s[1],t?It(i,s[1],u,null):Lt(s[1]),null)},i(s){t||(B(o,s),t=!0)},o(s){N(o,s),t=!1},d(s){s&&b(e),o&&o.d(s),l[4](null),n=!1,r()}}}function Xt(l,e,t){let{$$slots:n={},$$scope:r}=e,{dialog:i}=e;function o(u){Rt.call(this,l,u)}function s(u){fe[u?"unshift":"push"](()=>{i=u,t(0,i)})}return l.$$set=u=>{"dialog"in u&&t(0,i=u.dialog),"$$scope"in u&&t(1,r=u.$$scope)},[i,r,n,o,s]}class Ve extends ee{constructor(e){super(),te(this,e,Xt,qt,Z,{dialog:0})}}const Xe=16,Gt=2**20-1;function Nt(l,e){const t=l[0];if(!(t instanceof de)){alert("The path does not start with a CE");return}const n=l[1];if(!(n instanceof ve)){alert("The source CE is not directly connected to LER");return}if(t.firstHop.set(e,n.id),n.FIB.get(e))return;const r=l.length-2,i=l[r];if(!(i instanceof ve)){alert("Destination CE is not connected directly to a LER");return}let o=Ge(l[r]);i.LIB.receiveEntry(o,-1,e);for(let s=l.length-2;s>0;s--){const u=l[s],c=l[s-1],a=o;o=Ge(u),c instanceof ve?c.FIB.receiveEntry(e,a,u.id.toString()):c instanceof Ne&&c.LIB.receiveEntry(o,a,u.id.toString())}}function Wt(l,e){return l instanceof Ne||l instanceof ve?l.LIB.map.has(e):!1}function Ge(l){let e;do e=Math.floor(Math.random()*(Gt-Xe+1)+Xe);while(Wt(l,e));return e}function Kt(l){let e,t,n,r;return{c(){e=R("button"),t=re(l[0]),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var o=A(e);t=ie(o,l[0]),o.forEach(b),this.h()},h(){k(e,"class","svelte-17itt71")},m(i,o){C(i,e,o),L(e,t),n||(r=K(e,"click",function(){Dt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&me(t,l[0])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function Jt(l,e,t){let{text:n}=e,{callback:r}=e;return l.$$set=i=>{"text"in i&&t(0,n=i.text),"callback"in i&&t(1,r=i.callback)},[n,r]}class ye extends ee{constructor(e){super(),te(this,e,Jt,Kt,Z,{text:0,callback:1})}}function We(l,e,t){const n=l.slice();return n[9]=e[t][0],n[10]=e[t][1],n}function Ke(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w,d,h,m;function v(...y){return l[5](l[9],...y)}function F(...y){return l[6](l[9],...y)}function z(){return l[7](l[9])}_=new ye({props:{text:"LDP",callback:z}});function I(){return l[8](l[9])}return p=new ye({props:{text:"-",callback:I}}),{c(){e=R("tr"),t=R("td"),n=R("input"),i=x(),o=R("td"),s=R("input"),c=x(),a=R("td"),Y(_.$$.fragment),f=x(),g=R("td"),Y(p.$$.fragment),w=x(),this.h()},l(y){e=D(y,"TR",{});var P=A(e);t=D(P,"TD",{});var j=A(t);n=D(j,"INPUT",{type:!0,placeholder:!0}),j.forEach(b),i=M(P),o=D(P,"TD",{});var $=A(o);s=D($,"INPUT",{type:!0,placeholder:!0}),$.forEach(b),c=M(P),a=D(P,"TD",{});var O=A(a);q(_.$$.fragment,O),O.forEach(b),f=M(P),g=D(P,"TD",{});var H=A(g);q(p.$$.fragment,H),H.forEach(b),w=M(P),P.forEach(b),this.h()},h(){k(n,"type","text"),n.value=r=l[9],k(n,"placeholder","Address"),k(s,"type","text"),s.value=u=l[10],k(s,"placeholder","Link")},m(y,P){C(y,e,P),L(e,t),L(t,n),L(e,i),L(e,o),L(o,s),L(e,c),L(e,a),X(_,a,null),L(e,f),L(e,g),X(p,g,null),L(e,w),d=!0,h||(m=[K(n,"change",v),K(s,"change",F)],h=!0)},p(y,P){l=y,(!d||P&1&&r!==(r=l[9])&&n.value!==r)&&(n.value=r),(!d||P&1&&u!==(u=l[10])&&s.value!==u)&&(s.value=u);const j={};P&1&&(j.callback=z),_.$set(j);const $={};P&1&&($.callback=I),p.$set($)},i(y){d||(B(_.$$.fragment,y),B(p.$$.fragment,y),d=!0)},o(y){N(_.$$.fragment,y),N(p.$$.fragment,y),d=!1},d(y){y&&b(e),G(_),G(p),h=!1,Be(m)}}}function Qt(l){let e,t="Destinations:",n,r,i,o='<tr><th class="svelte-1d4gizi">Destination</th> <th class="svelte-1d4gizi">First hop</th> <th class="svelte-1d4gizi"></th> <th class="svelte-1d4gizi"></th></tr>',s,u,c,a,_,f,g=J([...l[0].firstHop]),p=[];for(let d=0;d<g.length;d+=1)p[d]=Ke(We(l,g,d));const w=d=>N(p[d],1,1,()=>{p[d]=null});return _=new ye({props:{text:"+",callback:l[1](l[0].addEmptyEntry)}}),{c(){e=R("p"),e.textContent=t,n=x(),r=R("table"),i=R("thead"),i.innerHTML=o,s=x(),u=R("tbody");for(let d=0;d<p.length;d+=1)p[d].c();c=x(),a=R("div"),Y(_.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1ixmdgd"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var h=A(r);i=D(h,"THEAD",{"data-svelte-h":!0}),le(i)!=="svelte-1jq34m8"&&(i.innerHTML=o),s=M(h),u=D(h,"TBODY",{});var m=A(u);for(let F=0;F<p.length;F+=1)p[F].l(m);m.forEach(b),h.forEach(b),c=M(d),a=D(d,"DIV",{class:!0});var v=A(a);q(_.$$.fragment,v),v.forEach(b),this.h()},h(){k(a,"class","svelte-1d4gizi")},m(d,h){C(d,e,h),C(d,n,h),C(d,r,h),L(r,i),L(r,s),L(r,u);for(let m=0;m<p.length;m+=1)p[m]&&p[m].m(u,null);C(d,c,h),C(d,a,h),X(_,a,null),f=!0},p(d,[h]){if(h&29){g=J([...d[0].firstHop]);let v;for(v=0;v<g.length;v+=1){const F=We(d,g,v);p[v]?(p[v].p(F,h),B(p[v],1)):(p[v]=Ke(F),p[v].c(),B(p[v],1),p[v].m(u,null))}for(se(),v=g.length;v<p.length;v+=1)w(v);ue()}const m={};h&1&&(m.callback=d[1](d[0].addEmptyEntry)),_.$set(m)},i(d){if(!f){for(let h=0;h<g.length;h+=1)B(p[h]);B(_.$$.fragment,d),f=!0}},o(d){p=p.filter(Boolean);for(let h=0;h<p.length;h+=1)N(p[h]);N(_.$$.fragment,d),f=!1},d(d){d&&(b(e),b(n),b(r),b(c),b(a)),Re(p,d),G(_)}}}function Zt(l,e,t){let{router:n}=e;function r(f){return()=>{f(),t(0,n)}}function i(f,g){if(!(f.target instanceof HTMLInputElement))return;const p=f.target.value.toUpperCase();if(!U.getCERouter(p)){alert("Destination router not found.");return}n.updateAddress(g,p),t(0,n)}function o(f){const g=U.getCERouter(f);if(!g){alert("Destination router not found.");return}const p=Pt.findShortestPath(n,g);Nt(p,f),t(0,n)}function s(f,g){if(!(f.target instanceof HTMLInputElement))return;const p=parseInt(f.target.value);n.firstHop.set(g,p)}const u=(f,g)=>{i(g,f)},c=(f,g)=>{s(g,f)},a=f=>{o(f)},_=f=>{n.firstHop.delete(f),t(0,n)};return l.$$set=f=>{"router"in f&&t(0,n=f.router)},[n,r,i,o,s,u,c,a,_]}class en extends ee{constructor(e){super(),te(this,e,Zt,Qt,Z,{router:0})}}function Je(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function Qe(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w,d;function h(...z){return l[3](l[7],...z)}function m(){l[4].call(s,l[9],l[10])}function v(){l[5].call(a,l[9],l[10])}function F(){return l[6](l[7])}return f=new ye({props:{text:"-",callback:F}}),{c(){e=R("tr"),t=R("td"),n=R("input"),i=x(),o=R("td"),s=R("input"),u=x(),c=R("td"),a=R("input"),_=x(),Y(f.$$.fragment),g=x(),this.h()},l(z){e=D(z,"TR",{});var I=A(e);t=D(I,"TD",{});var y=A(t);n=D(y,"INPUT",{type:!0}),y.forEach(b),i=M(I),o=D(I,"TD",{});var P=A(o);s=D(P,"INPUT",{type:!0}),P.forEach(b),u=M(I),c=D(I,"TD",{});var j=A(c);a=D(j,"INPUT",{type:!0}),j.forEach(b),_=M(I),q(f.$$.fragment,I),g=M(I),I.forEach(b),this.h()},h(){k(n,"type","number"),n.value=r=l[7],k(s,"type","number"),k(a,"type","text")},m(z,I){C(z,e,I),L(e,t),L(t,n),L(e,i),L(e,o),L(o,s),oe(s,l[8].outgoingLabel),L(e,u),L(e,c),L(c,a),oe(a,l[8].nextHop),L(e,_),X(f,e,null),L(e,g),p=!0,w||(d=[K(n,"change",h),K(s,"input",m),K(a,"input",v)],w=!0)},p(z,I){l=z,(!p||I&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),I&1&&be(s.value)!==l[8].outgoingLabel&&oe(s,l[8].outgoingLabel),I&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const y={};I&1&&(y.callback=F),f.$set(y)},i(z){p||(B(f.$$.fragment,z),p=!0)},o(z){N(f.$$.fragment,z),p=!1},d(z){z&&b(e),G(f),w=!1,Be(d)}}}function tn(l){let e,t="LIB:",n,r,i,o="<tr><th>Incoming</th> <th>Outgoing</th> <th>Next hop</th> <th></th></tr>",s,u,c,a,_,f,g=J([...l[0].LIB.map]),p=[];for(let d=0;d<g.length;d+=1)p[d]=Qe(Je(l,g,d));const w=d=>N(p[d],1,1,()=>{p[d]=null});return _=new ye({props:{text:"+",callback:l[1](l[0].LIB.addEmptyEntry)}}),{c(){e=R("p"),e.textContent=t,n=x(),r=R("table"),i=R("thead"),i.innerHTML=o,s=x(),u=R("tbody");for(let d=0;d<p.length;d+=1)p[d].c();c=x(),a=R("div"),Y(_.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1j64kst"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var h=A(r);i=D(h,"THEAD",{"data-svelte-h":!0}),le(i)!=="svelte-1fy2y89"&&(i.innerHTML=o),s=M(h),u=D(h,"TBODY",{});var m=A(u);for(let F=0;F<p.length;F+=1)p[F].l(m);m.forEach(b),h.forEach(b),c=M(d),a=D(d,"DIV",{class:!0});var v=A(a);q(_.$$.fragment,v),v.forEach(b),this.h()},h(){k(a,"class","svelte-f8qi58")},m(d,h){C(d,e,h),C(d,n,h),C(d,r,h),L(r,i),L(r,s),L(r,u);for(let m=0;m<p.length;m+=1)p[m]&&p[m].m(u,null);C(d,c,h),C(d,a,h),X(_,a,null),f=!0},p(d,[h]){if(h&5){g=J([...d[0].LIB.map]);let v;for(v=0;v<g.length;v+=1){const F=Je(d,g,v);p[v]?(p[v].p(F,h),B(p[v],1)):(p[v]=Qe(F),p[v].c(),B(p[v],1),p[v].m(u,null))}for(se(),v=g.length;v<p.length;v+=1)w(v);ue()}const m={};h&1&&(m.callback=d[1](d[0].LIB.addEmptyEntry)),_.$set(m)},i(d){if(!f){for(let h=0;h<g.length;h+=1)B(p[h]);B(_.$$.fragment,d),f=!0}},o(d){p=p.filter(Boolean);for(let h=0;h<p.length;h+=1)N(p[h]);N(_.$$.fragment,d),f=!1},d(d){d&&(b(e),b(n),b(r),b(c),b(a)),Re(p,d),G(_)}}}function nn(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,_){if(!(a.target instanceof HTMLInputElement))return;const f=parseInt(a.target.value);n.LIB.updateLabel(_,f)}const o=(a,_)=>{i(_,a)};function s(a,_){a[_][1].outgoingLabel=be(this.value),t(0,n)}function u(a,_){a[_][1].nextHop=this.value,t(0,n)}const c=a=>{n.LIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,c]}class ln extends ee{constructor(e){super(),te(this,e,nn,tn,Z,{router:0})}}function Ze(l,e,t){const n=l.slice();return n[7]=e[t][0],n[8]=e[t][1],n[9]=e,n[10]=t,n}function et(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w,d;function h(...z){return l[3](l[7],...z)}function m(){l[4].call(s,l[9],l[10])}function v(){l[5].call(a,l[9],l[10])}function F(){return l[6](l[7])}return f=new ye({props:{text:"-",callback:F}}),{c(){e=R("tr"),t=R("td"),n=R("input"),i=x(),o=R("td"),s=R("input"),u=x(),c=R("td"),a=R("input"),_=x(),Y(f.$$.fragment),g=x(),this.h()},l(z){e=D(z,"TR",{});var I=A(e);t=D(I,"TD",{});var y=A(t);n=D(y,"INPUT",{type:!0}),y.forEach(b),i=M(I),o=D(I,"TD",{});var P=A(o);s=D(P,"INPUT",{type:!0}),P.forEach(b),u=M(I),c=D(I,"TD",{});var j=A(c);a=D(j,"INPUT",{type:!0}),j.forEach(b),_=M(I),q(f.$$.fragment,I),g=M(I),I.forEach(b),this.h()},h(){k(n,"type","text"),n.value=r=l[7],k(s,"type","number"),k(a,"type","text")},m(z,I){C(z,e,I),L(e,t),L(t,n),L(e,i),L(e,o),L(o,s),oe(s,l[8].label),L(e,u),L(e,c),L(c,a),oe(a,l[8].nextHop),L(e,_),X(f,e,null),L(e,g),p=!0,w||(d=[K(n,"change",h),K(s,"input",m),K(a,"input",v)],w=!0)},p(z,I){l=z,(!p||I&1&&r!==(r=l[7])&&n.value!==r)&&(n.value=r),I&1&&be(s.value)!==l[8].label&&oe(s,l[8].label),I&1&&a.value!==l[8].nextHop&&oe(a,l[8].nextHop);const y={};I&1&&(y.callback=F),f.$set(y)},i(z){p||(B(f.$$.fragment,z),p=!0)},o(z){N(f.$$.fragment,z),p=!1},d(z){z&&b(e),G(f),w=!1,Be(d)}}}function rn(l){let e,t="FIB:",n,r,i,o="<tr><th>Address</th> <th>Label</th> <th>Next hop</th> <th></th></tr>",s,u,c,a,_,f,g=J([...l[0].FIB.map]),p=[];for(let d=0;d<g.length;d+=1)p[d]=et(Ze(l,g,d));const w=d=>N(p[d],1,1,()=>{p[d]=null});return _=new ye({props:{text:"+",callback:l[1](l[0].FIB.addEmptyEntry)}}),{c(){e=R("p"),e.textContent=t,n=x(),r=R("table"),i=R("thead"),i.innerHTML=o,s=x(),u=R("tbody");for(let d=0;d<p.length;d+=1)p[d].c();c=x(),a=R("div"),Y(_.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1j6bdhj"&&(e.textContent=t),n=M(d),r=D(d,"TABLE",{});var h=A(r);i=D(h,"THEAD",{"data-svelte-h":!0}),le(i)!=="svelte-1qhs6t7"&&(i.innerHTML=o),s=M(h),u=D(h,"TBODY",{});var m=A(u);for(let F=0;F<p.length;F+=1)p[F].l(m);m.forEach(b),h.forEach(b),c=M(d),a=D(d,"DIV",{class:!0});var v=A(a);q(_.$$.fragment,v),v.forEach(b),this.h()},h(){k(a,"class","svelte-f8qi58")},m(d,h){C(d,e,h),C(d,n,h),C(d,r,h),L(r,i),L(r,s),L(r,u);for(let m=0;m<p.length;m+=1)p[m]&&p[m].m(u,null);C(d,c,h),C(d,a,h),X(_,a,null),f=!0},p(d,[h]){if(h&5){g=J([...d[0].FIB.map]);let v;for(v=0;v<g.length;v+=1){const F=Ze(d,g,v);p[v]?(p[v].p(F,h),B(p[v],1)):(p[v]=et(F),p[v].c(),B(p[v],1),p[v].m(u,null))}for(se(),v=g.length;v<p.length;v+=1)w(v);ue()}const m={};h&1&&(m.callback=d[1](d[0].FIB.addEmptyEntry)),_.$set(m)},i(d){if(!f){for(let h=0;h<g.length;h+=1)B(p[h]);B(_.$$.fragment,d),f=!0}},o(d){p=p.filter(Boolean);for(let h=0;h<p.length;h+=1)N(p[h]);N(_.$$.fragment,d),f=!1},d(d){d&&(b(e),b(n),b(r),b(c),b(a)),Re(p,d),G(_)}}}function on(l,e,t){let{router:n}=e;function r(a){return()=>{a(),t(0,n)}}function i(a,_){if(!(a.target instanceof HTMLInputElement))return;const f=a.target.value;n.FIB.updateAddress(_,f)}const o=(a,_)=>{i(_,a)};function s(a,_){a[_][1].label=be(this.value),t(0,n)}function u(a,_){a[_][1].nextHop=this.value,t(0,n)}const c=a=>{n.FIB.deleteEntry(a),t(0,n)};return l.$$set=a=>{"router"in a&&t(0,n=a.router)},[n,r,i,o,s,u,c]}class sn extends ee{constructor(e){super(),te(this,e,on,rn,Z,{router:0})}}function un(l){let e,t="You somehow double-clicked on a router that can't be found?";return{c(){e=R("p"),e.textContent=t},l(n){e=D(n,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1214eal"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&b(e)}}}function an(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w=l[0].id+"",d,h,m,v,F,z,I,y,P,j,$=l[0]instanceof de&&tt(l),O=l[0]instanceof ve&&nt(l),H=(l[0]instanceof ve||l[0]instanceof Ne)&&lt(l);return I=new ye({props:{text:"Delete Router",callback:l[3]}}),{c(){e=R("div"),t=R("div"),n=R("label"),r=re(`Label:
          `),i=R("input"),o=x(),s=R("label"),u=re(`Position:
        `),c=R("input"),a=x(),_=R("input"),f=x(),g=R("p"),p=re("ID: "),d=re(w),h=x(),$&&$.c(),m=x(),O&&O.c(),v=x(),H&&H.c(),F=x(),z=R("div"),Y(I.$$.fragment),this.h()},l(T){e=D(T,"DIV",{});var S=A(e);t=D(S,"DIV",{});var ae=A(t);n=D(ae,"LABEL",{});var Ee=A(n);r=ie(Ee,`Label:
          `),i=D(Ee,"INPUT",{type:!0,class:!0}),Ee.forEach(b),ae.forEach(b),o=M(S),s=D(S,"LABEL",{});var pe=A(s);u=ie(pe,`Position:
        `),c=D(pe,"INPUT",{type:!0,class:!0}),a=M(pe),_=D(pe,"INPUT",{type:!0,class:!0}),pe.forEach(b),f=M(S),g=D(S,"P",{});var $e=A(g);p=ie($e,"ID: "),d=ie($e,w),$e.forEach(b),S.forEach(b),h=M(T),$&&$.l(T),m=M(T),O&&O.l(T),v=M(T),H&&H.l(T),F=M(T),z=D(T,"DIV",{class:!0});var Ce=A(z);q(I.$$.fragment,Ce),Ce.forEach(b),this.h()},h(){k(i,"type","text"),k(i,"class","svelte-cihl2i"),k(c,"type","number"),c.disabled=l[2],k(c,"class","svelte-cihl2i"),k(_,"type","number"),_.disabled=l[2],k(_,"class","svelte-cihl2i"),k(z,"class","margin-top svelte-cihl2i")},m(T,S){C(T,e,S),L(e,t),L(t,n),L(n,r),L(n,i),oe(i,l[0].node.label),L(e,o),L(e,s),L(s,u),L(s,c),oe(c,l[0].node.x),L(s,a),L(s,_),oe(_,l[0].node.y),L(e,f),L(e,g),L(g,p),L(g,d),C(T,h,S),$&&$.m(T,S),C(T,m,S),O&&O.m(T,S),C(T,v,S),H&&H.m(T,S),C(T,F,S),C(T,z,S),X(I,z,null),y=!0,P||(j=[K(i,"input",l[4]),K(c,"input",l[5]),K(_,"input",l[6]),K(e,"input",l[7])],P=!0)},p(T,S){S&1&&i.value!==T[0].node.label&&oe(i,T[0].node.label),(!y||S&4)&&(c.disabled=T[2]),S&1&&be(c.value)!==T[0].node.x&&oe(c,T[0].node.x),(!y||S&4)&&(_.disabled=T[2]),S&1&&be(_.value)!==T[0].node.y&&oe(_,T[0].node.y),(!y||S&1)&&w!==(w=T[0].id+"")&&me(d,w),T[0]instanceof de?$?($.p(T,S),S&1&&B($,1)):($=tt(T),$.c(),B($,1),$.m(m.parentNode,m)):$&&(se(),N($,1,1,()=>{$=null}),ue()),T[0]instanceof ve?O?(O.p(T,S),S&1&&B(O,1)):(O=nt(T),O.c(),B(O,1),O.m(v.parentNode,v)):O&&(se(),N(O,1,1,()=>{O=null}),ue()),T[0]instanceof ve||T[0]instanceof Ne?H?(H.p(T,S),S&1&&B(H,1)):(H=lt(T),H.c(),B(H,1),H.m(F.parentNode,F)):H&&(se(),N(H,1,1,()=>{H=null}),ue())},i(T){y||(B($),B(O),B(H),B(I.$$.fragment,T),y=!0)},o(T){N($),N(O),N(H),N(I.$$.fragment,T),y=!1},d(T){T&&(b(e),b(h),b(m),b(v),b(F),b(z)),$&&$.d(T),O&&O.d(T),H&&H.d(T),G(I),P=!1,Be(j)}}}function tt(l){let e,t="Address:",n,r,i=l[0].address+"",o,s,u,c,a,_,f,g;function p(d){l[9](d)}let w={};return l[0]!==void 0&&(w.router=l[0]),c=new en({props:w}),fe.push(()=>ge(c,"router",p)),{c(){e=R("p"),e.textContent=t,n=x(),r=R("button"),o=re(i),s=x(),u=R("div"),Y(c.$$.fragment),this.h()},l(d){e=D(d,"P",{"data-svelte-h":!0}),le(e)!=="svelte-18hoeeh"&&(e.textContent=t),n=M(d),r=D(d,"BUTTON",{class:!0});var h=A(r);o=ie(h,i),h.forEach(b),s=M(d),u=D(d,"DIV",{class:!0});var m=A(u);q(c.$$.fragment,m),m.forEach(b),this.h()},h(){Pe(e,"display","inline"),k(r,"class","svelte-cihl2i"),k(u,"class","margin-top svelte-cihl2i")},m(d,h){C(d,e,h),C(d,n,h),C(d,r,h),L(r,o),C(d,s,h),C(d,u,h),X(c,u,null),_=!0,f||(g=K(r,"click",l[8]),f=!0)},p(d,h){(!_||h&1)&&i!==(i=d[0].address+"")&&me(o,i);const m={};!a&&h&1&&(a=!0,m.router=d[0],_e(()=>a=!1)),c.$set(m)},i(d){_||(B(c.$$.fragment,d),_=!0)},o(d){N(c.$$.fragment,d),_=!1},d(d){d&&(b(e),b(n),b(r),b(s),b(u)),G(c),f=!1,g()}}}function nt(l){let e,t,n,r;function i(s){l[10](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new sn({props:o}),fe.push(()=>ge(t,"router",i)),{c(){e=R("div"),Y(t.$$.fragment),this.h()},l(s){e=D(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(b),this.h()},h(){k(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const c={};!n&&u&1&&(n=!0,c.router=s[0],_e(()=>n=!1)),t.$set(c)},i(s){r||(B(t.$$.fragment,s),r=!0)},o(s){N(t.$$.fragment,s),r=!1},d(s){s&&b(e),G(t)}}}function lt(l){let e,t,n,r;function i(s){l[11](s)}let o={};return l[0]!==void 0&&(o.router=l[0]),t=new ln({props:o}),fe.push(()=>ge(t,"router",i)),{c(){e=R("div"),Y(t.$$.fragment),this.h()},l(s){e=D(s,"DIV",{class:!0});var u=A(e);q(t.$$.fragment,u),u.forEach(b),this.h()},h(){k(e,"class","margin-top svelte-cihl2i")},m(s,u){C(s,e,u),X(t,e,null),r=!0},p(s,u){const c={};!n&&u&1&&(n=!0,c.router=s[0],_e(()=>n=!1)),t.$set(c)},i(s){r||(B(t.$$.fragment,s),r=!0)},o(s){N(t.$$.fragment,s),r=!1},d(s){s&&b(e),G(t)}}}function fn(l){let e,t,n,r;const i=[an,un],o=[];function s(u,c){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,c){o[e].m(u,c),C(u,n,c),r=!0},p(u,c){let a=e;e=s(u),e===a?o[e].p(u,c):(se(),N(o[a],1,1,()=>{o[a]=null}),ue(),t=o[e],t?t.p(u,c):(t=o[e]=i[e](u),t.c()),B(t,1),t.m(n.parentNode,n))},i(u){r||(B(t),r=!0)},o(u){N(t),r=!1},d(u){u&&b(n),o[e].d(u)}}}function cn(l){let e,t,n;function r(o){l[12](o)}let i={$$slots:{default:[fn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>ge(e,"dialog",r)),e.$on("close",l[13]),{c(){Y(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&16389&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],_e(()=>t=!1)),e.$set(u)},i(o){n||(B(e.$$.fragment,o),n=!0)},o(o){N(e.$$.fragment,o),n=!1},d(o){G(e,o)}}}function dn(l,e,t){let n;he(l,De,h=>t(2,n=h));let{router:r}=e,{dialog:i}=e;function o(){!n&&r?confirm("Are you sure you want to delete this router?")&&(U.deleteRouter(r.id),i.close()):alert("You can't delete a router while the network is locked.")}function s(){r.node.label=this.value,t(0,r)}function u(){r.node.x=be(this.value),t(0,r)}function c(){r.node.y=be(this.value),t(0,r)}const a=()=>{U.notify()},_=async()=>{r instanceof de&&await navigator.clipboard.writeText(r.address)};function f(h){r=h,t(0,r)}function g(h){r=h,t(0,r)}function p(h){r=h,t(0,r)}function w(h){i=h,t(1,i)}const d=()=>{if(r instanceof de)for(const h of r.firstHop.keys())h===""&&r.firstHop.delete(h);U.notify()};return l.$$set=h=>{"router"in h&&t(0,r=h.router),"dialog"in h&&t(1,i=h.dialog)},[r,i,n,o,s,u,c,a,_,f,g,p,w,d]}class hn extends ee{constructor(e){super(),te(this,e,dn,cn,Z,{router:0,dialog:1})}}function pn(l){let e,t="You somehow double-clicked on a link that can't be found?";return{c(){e=R("p"),e.textContent=t},l(n){e=D(n,"P",{"data-svelte-h":!0}),le(e)!=="svelte-1tevm7q"&&(e.textContent=t)},m(n,r){C(n,e,r)},p:ne,i:ne,o:ne,d(n){n&&b(e)}}}function _n(l){let e,t=l[0].distance+"",n,r,i,o,s,u,c,a,_,f,g;return a=new ye({props:{text:"Delete Link",callback:l[3]}}),{c(){e=re("Distance: "),n=re(t),r=re(` km
    `),i=R("label"),o=re(`Bandwidth:
      `),s=R("input"),u=x(),c=R("div"),Y(a.$$.fragment),this.h()},l(p){e=ie(p,"Distance: "),n=ie(p,t),r=ie(p,` km
    `),i=D(p,"LABEL",{class:!0});var w=A(i);o=ie(w,`Bandwidth:
      `),s=D(w,"INPUT",{type:!0,class:!0}),w.forEach(b),u=M(p),c=D(p,"DIV",{class:!0});var d=A(c);q(a.$$.fragment,d),d.forEach(b),this.h()},h(){k(s,"type","number"),s.disabled=l[2],k(s,"class","svelte-11gx5jd"),k(i,"class","svelte-11gx5jd"),k(c,"class","svelte-11gx5jd")},m(p,w){C(p,e,w),C(p,n,w),C(p,r,w),C(p,i,w),L(i,o),L(i,s),oe(s,l[0].bandwidth),C(p,u,w),C(p,c,w),X(a,c,null),_=!0,f||(g=K(s,"input",l[4]),f=!0)},p(p,w){(!_||w&1)&&t!==(t=p[0].distance+"")&&me(n,t),(!_||w&4)&&(s.disabled=p[2]),w&1&&be(s.value)!==p[0].bandwidth&&oe(s,p[0].bandwidth)},i(p){_||(B(a.$$.fragment,p),_=!0)},o(p){N(a.$$.fragment,p),_=!1},d(p){p&&(b(e),b(n),b(r),b(i),b(u),b(c)),G(a),f=!1,g()}}}function gn(l){let e,t,n,r;const i=[_n,pn],o=[];function s(u,c){return u[0]?0:1}return e=s(l),t=o[e]=i[e](l),{c(){t.c(),n=Q()},l(u){t.l(u),n=Q()},m(u,c){o[e].m(u,c),C(u,n,c),r=!0},p(u,c){let a=e;e=s(u),e===a?o[e].p(u,c):(se(),N(o[a],1,1,()=>{o[a]=null}),ue(),t=o[e],t?t.p(u,c):(t=o[e]=i[e](u),t.c()),B(t,1),t.m(n.parentNode,n))},i(u){r||(B(t),r=!0)},o(u){N(t),r=!1},d(u){u&&b(n),o[e].d(u)}}}function mn(l){let e,t,n;function r(o){l[5](o)}let i={$$slots:{default:[gn]},$$scope:{ctx:l}};return l[1]!==void 0&&(i.dialog=l[1]),e=new Ve({props:i}),fe.push(()=>ge(e,"dialog",r)),e.$on("close",l[6]),{c(){Y(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,s){X(e,o,s),n=!0},p(o,[s]){const u={};s&133&&(u.$$scope={dirty:s,ctx:o}),!t&&s&2&&(t=!0,u.dialog=o[1],_e(()=>t=!1)),e.$set(u)},i(o){n||(B(e.$$.fragment,o),n=!0)},o(o){N(e.$$.fragment,o),n=!1},d(o){G(e,o)}}}function bn(l,e,t){let n;he(l,De,a=>t(2,n=a));let{link:r}=e,{dialog:i}=e;function o(){!n&&r&&confirm("Are you sure you want to delete this link?")&&(U.deleteLink(r.id),i.close())}function s(){r.bandwidth=be(this.value),t(0,r)}function u(a){i=a,t(1,i)}const c=()=>{U.notify()};return l.$$set=a=>{"link"in a&&t(0,r=a.link),"dialog"in a&&t(1,i=a.dialog)},[r,i,n,o,s,u,c]}class kn extends ee{constructor(e){super(),te(this,e,bn,mn,Z,{link:0,dialog:1})}}function rt(l){let e,t="Loading...";return{c(){e=R("p"),e.textContent=t,this.h()},l(n){e=D(n,"P",{style:!0,"data-svelte-h":!0}),le(e)!=="svelte-qybri"&&(e.textContent=t),this.h()},h(){Pe(e,"font-size","200px")},m(n,r){C(n,e,r)},d(n){n&&b(e)}}}function it(l){let e,t,n,r,i,o;return{c(){e=Le("line"),this.h()},l(s){e=Ie(s,"line",{class:!0,x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0}),A(e).forEach(b),this.h()},h(){k(e,"class","preview"),k(e,"x1",t=l[4].node.x),k(e,"y1",n=l[4].node.y),k(e,"x2",r=l[17](l[2].x)),k(e,"y2",i=l[18](l[2].y)),k(e,"stroke",o=l[6]===l[11].CONNECTING?"green":"blue")},m(s,u){C(s,e,u)},p(s,u){u[0]&16&&t!==(t=s[4].node.x)&&k(e,"x1",t),u[0]&16&&n!==(n=s[4].node.y)&&k(e,"y1",n),u[0]&4&&r!==(r=s[17](s[2].x))&&k(e,"x2",r),u[0]&4&&i!==(i=s[18](s[2].y))&&k(e,"y2",i),u[0]&64&&o!==(o=s[6]===s[11].CONNECTING?"green":"blue")&&k(e,"stroke",o)},d(s){s&&b(e)}}}function vn(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w,d=!l[9]&&rt(),h=(!l[0]&&l[6]===l[11].CONNECTING||l[6]===l[11].ADDING_DESTINATION)&&l[4]&&it(l);const m=l[21].default,v=Et(m,l,l[20],null);function F($){l[24]($)}function z($){l[25]($)}let I={};l[4]!==void 0&&(I.router=l[4]),l[7]!==void 0&&(I.dialog=l[7]),o=new hn({props:I}),fe.push(()=>ge(o,"router",F)),fe.push(()=>ge(o,"dialog",z));function y($){l[26]($)}function P($){l[27]($)}let j={};return l[5]!==void 0&&(j.link=l[5]),l[8]!==void 0&&(j.dialog=l[8]),a=new kn({props:j}),fe.push(()=>ge(a,"link",y)),fe.push(()=>ge(a,"dialog",P)),{c(){d&&d.c(),e=x(),t=Le("svg"),h&&h.c(),n=Q(),v&&v.c(),i=x(),Y(o.$$.fragment),c=x(),Y(a.$$.fragment),this.h()},l($){d&&d.l($),e=M($),t=Ie($,"svg",{viewBox:!0,role:!0,tabindex:!0,class:!0});var O=A(t);h&&h.l(O),n=Q(),v&&v.l(O),O.forEach(b),i=M($),q(o.$$.fragment,$),c=M($),q(a.$$.fragment,$),this.h()},h(){k(t,"viewBox",r=`${l[1].x} ${l[1].y} ${l[1].width} ${l[1].height}`),k(t,"role","button"),k(t,"tabindex","-1"),k(t,"class","svelte-1cmb9l6"),Pe(t,"cursor",l[10][l[6]])},m($,O){d&&d.m($,O),C($,e,O),C($,t,O),h&&h.m(t,null),L(t,n),v&&v.m(t,null),l[23](t),C($,i,O),X(o,$,O),C($,c,O),X(a,$,O),g=!0,p||(w=[K(t,"pointerdown",l[12]),K(t,"pointerup",l[13]),K(t,"wheel",l[14]),K(t,"dblclick",l[15]),K(t,"dragover",zt(l[22])),K(t,"drop",l[16])],p=!0)},p($,O){$[9]?d&&(d.d(1),d=null):d||(d=rt(),d.c(),d.m(e.parentNode,e)),(!$[0]&&$[6]===$[11].CONNECTING||$[6]===$[11].ADDING_DESTINATION)&&$[4]?h?h.p($,O):(h=it($),h.c(),h.m(t,n)):h&&(h.d(1),h=null),v&&v.p&&(!g||O[0]&1048576)&&Ct(v,m,$,$[20],g?It(m,$[20],O,null):Lt($[20]),null),(!g||O[0]&2&&r!==(r=`${$[1].x} ${$[1].y} ${$[1].width} ${$[1].height}`))&&k(t,"viewBox",r),O[0]&1088&&Pe(t,"cursor",$[10][$[6]]);const H={};!s&&O[0]&16&&(s=!0,H.router=$[4],_e(()=>s=!1)),!u&&O[0]&128&&(u=!0,H.dialog=$[7],_e(()=>u=!1)),o.$set(H);const T={};!_&&O[0]&32&&(_=!0,T.link=$[5],_e(()=>_=!1)),!f&&O[0]&256&&(f=!0,T.dialog=$[8],_e(()=>f=!1)),a.$set(T)},i($){g||(B(v,$),B(o.$$.fragment,$),B(a.$$.fragment,$),g=!0)},o($){N(v,$),N(o.$$.fragment,$),N(a.$$.fragment,$),g=!1},d($){$&&(b(e),b(t),b(i),b(c)),d&&d.d($),h&&h.d(),v&&v.d($),l[23](null),G(o,$),G(a,$),p=!1,Be(w)}}}function $n(l,e,t){let n,r;he(l,De,E=>t(0,r=E));let{$$slots:i={},$$scope:o}=e;var s=(E=>(E[E.NONE=0]="NONE",E[E.DRAGGING=1]="DRAGGING",E[E.PANNING=2]="PANNING",E[E.CONNECTING=3]="CONNECTING",E[E.ADDING_DESTINATION=4]="ADDING_DESTINATION",E))(s||{});const u={x:0,y:0,width:0,height:0,get scale(){return _?this.width/_.getBoundingClientRect().width:1}},c={x:0,y:0},a={x:0,y:0};let _=null,f=null,g=null,p=0,w,d,h=!1;Bt(()=>{if(!_)return;new ResizeObserver(m).observe(_),requestAnimationFrame(()=>{_&&(t(1,u.x=_.getBoundingClientRect().width/-2,u),t(1,u.y=_.getBoundingClientRect().height/-2,u))}),t(9,h=!0)});function m(){if(!_)return;const E=u.scale||1;t(1,u.width=_.getBoundingClientRect().width*E,u),t(1,u.height=_.getBoundingClientRect().height*E,u)}function v(E){if(!(E.target instanceof Element))return;E.preventDefault(),_==null||_.addEventListener("pointermove",z),_==null||_.setPointerCapture(E.pointerId);const W=E.target.id;if(W){if(t(4,f=U.getRouter(parseInt(W))||null),!f)return;E.shiftKey?t(6,p=3):E.altKey&&f instanceof de?t(6,p=4):(a.x=f.node.x,a.y=f.node.y,t(6,p=1))}else t(6,p=2);t(2,c.x=E.clientX,c),t(2,c.y=E.clientY,c)}function F(E){if(E.target instanceof Element){if(E.preventDefault(),f&&p===4){const W=document.elementFromPoint(E.clientX,E.clientY),ce=(W==null?void 0:W.tagName)==="circle"?W.id:null,ke=U.getRouter(parseInt(ce??""));if(ke instanceof de){const Ht=Pt.findShortestPath(f,ke);Nt(Ht,ke.address.toUpperCase()),U.notify()}else alert("Destination must be a CE")}t(6,p=0),t(4,f=null),_==null||_.releasePointerCapture(E.pointerId),_==null||_.removeEventListener("pointermove",z)}}function z(E){E.preventDefault();const W={x:(E.clientX-c.x)*u.scale,y:(E.clientY-c.y)*u.scale};if(!r&&p===1&&f)t(4,f.node.x=Math.round(a.x+W.x),f),t(4,f.node.y=Math.round(a.y+W.y),f),U.notify();else if(p===2)t(2,c.x=E.clientX,c),t(2,c.y=E.clientY,c),t(1,u.x-=W.x,u),t(1,u.y-=W.y,u);else if(p===4)t(2,c.x=E.clientX,c),t(2,c.y=E.clientY,c);else if(!r&&p===3){t(2,c.x=E.clientX,c),t(2,c.y=E.clientY,c);const ce=document.elementFromPoint(E.clientX,E.clientY);if(!ce)return;const ke=U.getRouter(parseInt(ce.id));ce.tagName==="circle"&&ke&&f&&(U.addLink({source:f,target:ke}),t(4,f=ke))}}function I(E){E.preventDefault(),t(2,c.x=E.clientX,c),t(2,c.y=E.clientY,c);const W=E.deltaY>0?1.025:.975;y(W,c)}function y(E,W){if(!_||u.scale<.1&&E<1||u.scale>5&&E>1)return;const ce=_.getBoundingClientRect(),ke={x:(W.x-ce.left)/ce.width,y:(W.y-ce.top)/ce.height};t(1,u.x-=u.width*(E-1)*ke.x,u),t(1,u.y-=u.height*(E-1)*ke.y,u),t(1,u.width*=E,u),t(1,u.height*=E,u)}function P(E){if(!(E.target instanceof Element))return;E.preventDefault();const W=document.elementFromPoint(E.clientX,E.clientY);W&&(W.tagName==="circle"?j(W.id):W.tagName==="rect"&&$(W.id))}function j(E){const W=U.getRouter(parseInt(E));W&&(t(4,f=W),w.showModal())}function $(E){const W=U.links.find(ce=>E===ce.id);W&&(t(5,g=W),d.showModal())}function O(E){var ce;E.preventDefault();const W=(ce=E.dataTransfer)==null?void 0:ce.getData("text/plain");if(W)switch(W){case"CE":U.createCE(H(E.clientX),T(E.clientY));break;case"LER":U.createLER(H(E.clientX),T(E.clientY));break;case"LSR":U.createLSR(H(E.clientX),T(E.clientY));break}}function H(E){return _?(E-_.getBoundingClientRect().left)*u.scale+u.x:E}function T(E){return _?(E-_.getBoundingClientRect().top)*u.scale+u.y:E}function S(E){Rt.call(this,l,E)}function ae(E){fe[E?"unshift":"push"](()=>{_=E,t(3,_)})}function Ee(E){f=E,t(4,f)}function pe(E){w=E,t(7,w)}function $e(E){g=E,t(5,g)}function Ce(E){d=E,t(8,d)}return l.$$set=E=>{"$$scope"in E&&t(20,o=E.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1&&t(10,n={0:"move",1:r?"not-allowed":"grabbing",2:"grabbing",3:r?"not-allowed":"crosshair",4:"crosshair"})},[r,u,c,_,f,g,p,w,d,h,n,s,v,F,I,P,O,H,T,y,o,i,S,ae,Ee,pe,$e,Ce]}class wn extends ee{constructor(e){super(),te(this,e,$n,vn,Z,{zoom:19},null,[-1,-1])}get zoom(){return this.$$.ctx[19]}}function yn(l){let e,t,n,r;return{c(){e=R("button"),t=re(l[0]),this.h()},l(i){e=D(i,"BUTTON",{style:!0,class:!0});var o=A(e);t=ie(o,l[0]),o.forEach(b),this.h()},h(){k(e,"style",l[2]),k(e,"class","svelte-v6s8rg")},m(i,o){C(i,e,o),L(e,t),n||(r=K(e,"click",function(){Dt(l[1])&&l[1].apply(this,arguments)}),n=!0)},p(i,[o]){l=i,o&1&&me(t,l[0]),o&4&&k(e,"style",l[2])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function En(l,e,t){let{text:n}=e,{callback:r=()=>{}}=e,{style:i=void 0}=e;return l.$$set=o=>{"text"in o&&t(0,n=o.text),"callback"in o&&t(1,r=o.callback),"style"in o&&t(2,i=o.style)},[n,r,i]}class we extends ee{constructor(e){super(),te(this,e,En,yn,Z,{text:0,callback:1,style:2})}}function Cn(l){let e,t,n=l[0].address+"",r,i,o,s="→",u,c,a=l[1].address+"",_,f,g,p,w,d;return g=new we({props:{text:"Play",callback:l[2]}}),w=new we({props:{text:"Delete",callback:l[3]}}),{c(){e=R("div"),t=R("p"),r=re(n),i=x(),o=R("p"),o.textContent=s,u=x(),c=R("p"),_=re(a),f=x(),Y(g.$$.fragment),p=x(),Y(w.$$.fragment),this.h()},l(h){e=D(h,"DIV",{class:!0});var m=A(e);t=D(m,"P",{class:!0});var v=A(t);r=ie(v,n),v.forEach(b),i=M(m),o=D(m,"P",{class:!0,"data-svelte-h":!0}),le(o)!=="svelte-1giyjq6"&&(o.textContent=s),u=M(m),c=D(m,"P",{class:!0});var F=A(c);_=ie(F,a),F.forEach(b),f=M(m),q(g.$$.fragment,m),p=M(m),q(w.$$.fragment,m),m.forEach(b),this.h()},h(){k(t,"class","svelte-ikhsiz"),k(o,"class","svelte-ikhsiz"),k(c,"class","svelte-ikhsiz"),k(e,"class","svelte-ikhsiz")},m(h,m){C(h,e,m),L(e,t),L(t,r),L(e,i),L(e,o),L(e,u),L(e,c),L(c,_),L(e,f),X(g,e,null),L(e,p),X(w,e,null),d=!0},p(h,[m]){(!d||m&1)&&n!==(n=h[0].address+"")&&me(r,n),(!d||m&2)&&a!==(a=h[1].address+"")&&me(_,a)},i(h){d||(B(g.$$.fragment,h),B(w.$$.fragment,h),d=!0)},o(h){N(g.$$.fragment,h),N(w.$$.fragment,h),d=!1},d(h){h&&b(e),G(g),G(w)}}}function Ln(l,e,t){let{source:n}=e,{destination:r}=e;function i(){U.addPacket(n,r)}function o(){n.deleteEntry(r.address),U.notify()}return l.$$set=s=>{"source"in s&&t(0,n=s.source),"destination"in s&&t(1,r=s.destination)},[n,r,i,o]}class In extends ee{constructor(e){super(),te(this,e,Ln,Cn,Z,{source:0,destination:1})}}function ot(l,e,t){const n=l.slice();return n[2]=e[t],n}function st(l,e,t){const n=l.slice();return n[5]=e[t][0],n}function ut(l){let e,t;return e=new In({props:{source:l[2],destination:U.getSureCERouter(l[5])}}),{c(){Y(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p(n,r){const i={};r&1&&(i.source=n[2]),r&1&&(i.destination=U.getSureCERouter(n[5])),e.$set(i)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}function at(l){let e,t,n=J([...l[2].firstHop]),r=[];for(let o=0;o<n.length;o+=1)r[o]=ut(st(l,n,o));const i=o=>N(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,s){if(s&1){n=J([...o[2].firstHop]);let u;for(u=0;u<n.length;u+=1){const c=st(o,n,u);r[u]?(r[u].p(c,s),B(r[u],1)):(r[u]=ut(c),r[u].c(),B(r[u],1),r[u].m(e.parentNode,e))}for(se(),u=n.length;u<r.length;u+=1)i(u);ue()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)B(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)N(r[s]);t=!1},d(o){o&&b(e),Re(r,o)}}}function Rn(l){let e,t,n=J(l[0]),r=[];for(let o=0;o<n.length;o+=1)r[o]=at(ot(l,n,o));const i=o=>N(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=Q()},l(o){for(let s=0;s<r.length;s+=1)r[s].l(o);e=Q()},m(o,s){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(o,s);C(o,e,s),t=!0},p(o,[s]){if(s&1){n=J(o[0]);let u;for(u=0;u<n.length;u+=1){const c=ot(o,n,u);r[u]?(r[u].p(c,s),B(r[u],1)):(r[u]=at(c),r[u].c(),B(r[u],1),r[u].m(e.parentNode,e))}for(se(),u=n.length;u<r.length;u+=1)i(u);ue()}},i(o){if(!t){for(let s=0;s<n.length;s+=1)B(r[s]);t=!0}},o(o){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)N(r[s]);t=!1},d(o){o&&b(e),Re(r,o)}}}function Dn(l,e,t){let n,r;return he(l,U,i=>t(1,r=i)),l.$$.update=()=>{l.$$.dirty&2&&t(0,n=r.routers.filter(i=>i instanceof de))},[n,r]}class Bn extends ee{constructor(e){super(),te(this,e,Dn,Rn,Z,{})}}function ft(l,e,t){const n=l.slice();return n[13]=e[t],n}function ct(l){let e,t;const n=[l[13],{style:"padding: 10px 20px"}];let r={};for(let i=0;i<n.length;i+=1)r=Se(r,n[i]);return e=new we({props:r}),{c(){Y(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&32?Oe(n,[je(i[13]),n[1]]):{};e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Tn(l){let e,t,n,r,i,o,s,u="Packet Controls",c,a,_,f,g,p,w=l[1].speedMultiplier.toFixed(1)+"",d,h,m,v,F,z,I,y,P,j=J(l[5]),$=[];for(let H=0;H<j.length;H+=1)$[H]=ct(ft(l,j,H));const O=H=>N($[H],1,1,()=>{$[H]=null});return F=new Bn({}),{c(){e=R("div"),t=R("div"),r=x(),i=R("div"),o=R("div"),s=R("p"),s.textContent=u,c=x(),a=R("div");for(let H=0;H<$.length;H+=1)$[H].c();_=x(),f=R("div"),g=R("p"),p=re("Speed Multiplier: "),d=re(w),h=x(),m=R("input"),v=x(),Y(F.$$.fragment),this.h()},l(H){e=D(H,"DIV",{id:!0,style:!0,class:!0});var T=A(e);t=D(T,"DIV",{id:!0,class:!0}),A(t).forEach(b),T.forEach(b),r=M(H),i=D(H,"DIV",{id:!0,style:!0,class:!0});var S=A(i);o=D(S,"DIV",{id:!0,class:!0});var ae=A(o);s=D(ae,"P",{id:!0,class:!0,"data-svelte-h":!0}),le(s)!=="svelte-1cfybk8"&&(s.textContent=u),c=M(ae),a=D(ae,"DIV",{id:!0,class:!0});var Ee=A(a);for(let Ce=0;Ce<$.length;Ce+=1)$[Ce].l(Ee);Ee.forEach(b),_=M(ae),f=D(ae,"DIV",{id:!0,class:!0});var pe=A(f);g=D(pe,"P",{});var $e=A(g);p=ie($e,"Speed Multiplier: "),d=ie($e,w),$e.forEach(b),h=M(pe),m=D(pe,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),pe.forEach(b),v=M(ae),q(F.$$.fragment,ae),ae.forEach(b),S.forEach(b),this.h()},h(){k(t,"id","resize-bar"),k(t,"class","svelte-17azkas"),k(e,"id","visual-resize-bar"),k(e,"style",n=`width: ${l[0]?1:0}px`),k(e,"class","svelte-17azkas"),k(s,"id","packet-controls-title"),k(s,"class","svelte-17azkas"),k(a,"id","control-panel-buttons"),k(a,"class","svelte-17azkas"),k(m,"type","range"),k(m,"min","0.1"),k(m,"max","2"),k(m,"step","0.001"),k(m,"class","svelte-17azkas"),k(f,"id","slider"),k(f,"class","svelte-17azkas"),k(o,"id","control-panel-content"),k(o,"class","svelte-17azkas"),k(i,"id","control-panel"),k(i,"style",z=`width: ${l[4]}px; transition: ${l[3]};`),k(i,"class","svelte-17azkas")},m(H,T){C(H,e,T),L(e,t),l[9](t),C(H,r,T),C(H,i,T),L(i,o),L(o,s),L(o,c),L(o,a);for(let S=0;S<$.length;S+=1)$[S]&&$[S].m(a,null);L(o,_),L(o,f),L(f,g),L(g,p),L(g,d),L(f,h),L(f,m),oe(m,l[1].speedMultiplier),L(o,v),X(F,o,null),I=!0,y||(P=[K(t,"pointerdown",l[6]),K(m,"change",l[10]),K(m,"input",l[10])],y=!0)},p(H,[T]){if((!I||T&1&&n!==(n=`width: ${H[0]?1:0}px`))&&k(e,"style",n),T&32){j=J(H[5]);let S;for(S=0;S<j.length;S+=1){const ae=ft(H,j,S);$[S]?($[S].p(ae,T),B($[S],1)):($[S]=ct(ae),$[S].c(),B($[S],1),$[S].m(a,null))}for(se(),S=j.length;S<$.length;S+=1)O(S);ue()}(!I||T&2)&&w!==(w=H[1].speedMultiplier.toFixed(1)+"")&&me(d,w),T&2&&oe(m,H[1].speedMultiplier),(!I||T&24&&z!==(z=`width: ${H[4]}px; transition: ${H[3]};`))&&k(i,"style",z)},i(H){if(!I){for(let T=0;T<j.length;T+=1)B($[T]);B(F.$$.fragment,H),I=!0}},o(H){$=$.filter(Boolean);for(let T=0;T<$.length;T+=1)N($[T]);N(F.$$.fragment,H),I=!1},d(H){H&&(b(e),b(r),b(i)),l[9](null),Re($,H),G(F),y=!1,Be(P)}}}function Pn(l,e,t){let n,r,i,o,s,u;he(l,De,d=>t(0,o=d)),he(l,Te,d=>t(1,s=d)),he(l,U,d=>t(8,u=d));let c,a="width 250ms";function _(d){o&&(t(3,a="none"),c.setPointerCapture(d.pointerId),c.addEventListener("pointermove",f),c.addEventListener("pointerup",g))}function f(d){t(4,i=window.innerWidth-d.clientX),i<=20&&t(4,i=0),i>=window.innerWidth-350&&t(4,i=window.innerWidth-350)}function g(d){c.removeEventListener("pointermove",f),c.removeEventListener("pointerup",g),c.releasePointerCapture(d.pointerId),t(3,a="width 250ms")}function p(d){fe[d?"unshift":"push"](()=>{c=d,t(2,c)})}function w(){s.speedMultiplier=be(this.value),Te.set(s)}return l.$$.update=()=>{l.$$.dirty&256&&t(7,n=u.routers.filter(d=>d instanceof de)),l.$$.dirty&130&&t(5,r=[{text:s.running?"Pause":"Resume",callback:()=>{Fe(Te,s.running=!s.running,s)}},{text:"Reset",callback:()=>{U.clearPackets()}},{text:"Play All",callback:()=>{for(const d of n)for(const[h]of d.firstHop)U.addPacket(d,U.getSureCERouter(h))}}]),l.$$.dirty&1&&t(4,i=o?350:0)},[o,s,c,a,i,r,_,n,u,p,w]}class Nn extends ee{constructor(e){super(),te(this,e,Pn,Tn,Z,{})}}function Hn(l){let e;return{c(){e=Le("circle"),this.h()},l(t){e=Ie(t,"circle",{r:!0,class:!0}),A(e).forEach(b),this.h()},h(){k(e,"r","5"),k(e,"class","svelte-rvo2j9"),Ye(e,"labeled",l[0].label!==-1)},m(t,n){C(t,e,n),l[4](e)},p(t,[n]){n&1&&Ye(e,"labeled",t[0].label!==-1)},i:ne,o:ne,d(t){t&&b(e),l[4](null)}}}function xn(l,e,t){let n;he(l,Te,f=>t(3,n=f));let{packet:r}=e,i,o,s;function u(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}const f=Math.sqrt((r.node.x-r.nextHop.node.x)**2+(r.node.y-r.nextHop.node.y)**2);i=Math.round(f/250*1e3)}function c(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}u(),s&&(t(2,o=s.animate([{transform:`translate(${r.node.x}px, ${r.node.y}px)`},{transform:`translate(${r.nextHop.node.x}px, ${r.nextHop.node.y}px)`}],{duration:i,easing:"linear"})),t(2,o.onfinish=a,o))}function a(){if(!r.nextHop){r.drop(),alert("Packet has no next hop.");return}t(0,r.node=r.nextHop.node,r),r.nextHop.receivePacket(r),c()}requestAnimationFrame(c);function _(f){fe[f?"unshift":"push"](()=>{s=f,t(1,s)})}return l.$$set=f=>{"packet"in f&&t(0,r=f.packet)},l.$$.update=()=>{l.$$.dirty&12&&o&&t(2,o.playbackRate=n.speedMultiplier,o),l.$$.dirty&12&&o&&(n.running?o.play():o.pause())},[r,s,o,n,_]}class Mn extends ee{constructor(e){super(),te(this,e,xn,Hn,Z,{packet:0})}}function zn(l){let e,t,n,r,i,o,s,u,c=l[0].distance+"",a,_,f,g;return{c(){e=Le("line"),t=x(),n=Le("rect"),s=x(),u=Le("text"),a=re(c),_=re(" km"),this.h()},l(p){e=Ie(p,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),A(e).forEach(b),t=M(p),n=Ie(p,"rect",{id:!0,x:!0,y:!0,width:!0,height:!0,class:!0}),A(n).forEach(b),s=M(p),u=Ie(p,"text",{x:!0,y:!0,"dominant-baseline":!0,class:!0});var w=A(u);a=ie(w,c),_=ie(w," km"),w.forEach(b),this.h()},h(){k(e,"x1",l[4]),k(e,"y1",l[2]),k(e,"x2",l[3]),k(e,"y2",l[1]),k(n,"id",r=l[0].id),k(n,"x",i=l[5].x-ze/2),k(n,"y",o=l[5].y-Ae/2),k(n,"width",ze),k(n,"height",Ae),k(n,"class","svelte-zjn2k6"),k(u,"x",f=l[5].x),k(u,"y",g=l[5].y),k(u,"dominant-baseline","central"),k(u,"class","svelte-zjn2k6")},m(p,w){C(p,e,w),C(p,t,w),C(p,n,w),C(p,s,w),C(p,u,w),L(u,a),L(u,_)},p(p,[w]){w&16&&k(e,"x1",p[4]),w&4&&k(e,"y1",p[2]),w&8&&k(e,"x2",p[3]),w&2&&k(e,"y2",p[1]),w&1&&r!==(r=p[0].id)&&k(n,"id",r),w&32&&i!==(i=p[5].x-ze/2)&&k(n,"x",i),w&32&&o!==(o=p[5].y-Ae/2)&&k(n,"y",o),w&1&&c!==(c=p[0].distance+"")&&me(a,c),w&32&&f!==(f=p[5].x)&&k(u,"x",f),w&32&&g!==(g=p[5].y)&&k(u,"y",g)},i:ne,o:ne,d(p){p&&(b(e),b(t),b(n),b(s),b(u))}}}const ze=50,Ae=20;function dt(l,e){return(l+e)/2}function An(l,e,t){let n,r,i,o,s,{link:u}=e;return l.$$set=c=>{"link"in c&&t(0,u=c.link)},l.$$.update=()=>{l.$$.dirty&1&&t(4,n=u.source.node.x),l.$$.dirty&1&&t(3,r=u.target.node.x),l.$$.dirty&1&&t(2,i=u.source.node.y),l.$$.dirty&1&&t(1,o=u.target.node.y),l.$$.dirty&30&&t(5,s={x:dt(n,r),y:dt(i,o)})},[u,o,i,r,n,s]}class Fn extends ee{constructor(e){super(),te(this,e,An,zn,Z,{link:0})}}function Sn(l){let e,t,n,r,i,o,s,u=l[0].node.label+"",c,a,_;return{c(){e=Le("circle"),o=x(),s=Le("text"),c=re(u),this.h()},l(f){e=Ie(f,"circle",{id:!0,cx:!0,cy:!0,r:!0,fill:!0,class:!0}),A(e).forEach(b),o=M(f),s=Ie(f,"text",{x:!0,y:!0,"dominant-baseline":!0,"font-size":!0,class:!0});var g=A(s);c=ie(g,u),g.forEach(b),this.h()},h(){k(e,"id",t=l[0].id.toString()),k(e,"cx",n=l[0].node.x),k(e,"cy",r=l[0].node.y),k(e,"r","20"),k(e,"fill",i=l[1][l[0].type]),k(e,"class","svelte-17jcsko"),k(s,"x",a=l[0].node.x),k(s,"y",_=l[0].node.y),k(s,"dominant-baseline","central"),k(s,"font-size","smaller"),k(s,"class","svelte-17jcsko")},m(f,g){C(f,e,g),C(f,o,g),C(f,s,g),L(s,c)},p(f,[g]){g&1&&t!==(t=f[0].id.toString())&&k(e,"id",t),g&1&&n!==(n=f[0].node.x)&&k(e,"cx",n),g&1&&r!==(r=f[0].node.y)&&k(e,"cy",r),g&1&&i!==(i=f[1][f[0].type])&&k(e,"fill",i),g&1&&u!==(u=f[0].node.label+"")&&me(c,u),g&1&&a!==(a=f[0].node.x)&&k(s,"x",a),g&1&&_!==(_=f[0].node.y)&&k(s,"y",_)},i:ne,o:ne,d(f){f&&(b(e),b(o),b(s))}}}function On(l,e,t){let{router:n}=e;const r={CE:"#7FC8F8",LER:"#FFE45E",LSR:"#FF6392"};return l.$$set=i=>{"router"in i&&t(0,n=i.router)},[n,r]}class jn extends ee{constructor(e){super(),te(this,e,On,Sn,Z,{router:0})}}function Un(l){let e,t,n,r;return{c(){e=R("div"),t=re(l[0]),this.h()},l(i){e=D(i,"DIV",{draggable:!0,role:!0,tabindex:!0,style:!0,class:!0});var o=A(e);t=ie(o,l[0]),o.forEach(b),this.h()},h(){k(e,"draggable","true"),k(e,"role","button"),k(e,"tabindex","-1"),Pe(e,"background-color",l[1]),k(e,"class","svelte-dfkep2")},m(i,o){C(i,e,o),L(e,t),n||(r=K(e,"dragstart",l[2]),n=!0)},p(i,[o]){o&1&&me(t,i[0]),o&2&&Pe(e,"background-color",i[1])},i:ne,o:ne,d(i){i&&b(e),n=!1,r()}}}function Vn(l,e,t){let n;he(l,De,u=>t(4,n=u));let{text:r}=e,{type:i}=e,{color:o}=e;function s(u){var c;if(n){alert("Network is locked.");return}(c=u.dataTransfer)==null||c.setData("text/plain",i)}return l.$$set=u=>{"text"in u&&t(0,r=u.text),"type"in u&&t(3,i=u.type),"color"in u&&t(1,o=u.color)},[r,o,s,i]}class Yn extends ee{constructor(e){super(),te(this,e,Vn,Un,Z,{text:0,type:3,color:1})}}function ht(l,e,t){const n=l.slice();return n[5]=e[t],n}function pt(l,e,t){const n=l.slice();return n[8]=e[t],n}function _t(l){let e,t,n,r=J(l[2]),i=[];for(let a=0;a<r.length;a+=1)i[a]=gt(pt(l,r,a));const o=a=>N(i[a],1,1,()=>{i[a]=null});let s=J(l[1]),u=[];for(let a=0;a<s.length;a+=1)u[a]=mt(ht(l,s,a));const c=a=>N(u[a],1,1,()=>{u[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=x();for(let a=0;a<u.length;a+=1)u[a].c();t=Q()},l(a){for(let _=0;_<i.length;_+=1)i[_].l(a);e=M(a);for(let _=0;_<u.length;_+=1)u[_].l(a);t=Q()},m(a,_){for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(a,_);C(a,e,_);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(a,_);C(a,t,_),n=!0},p(a,_){if(_&4){r=J(a[2]);let f;for(f=0;f<r.length;f+=1){const g=pt(a,r,f);i[f]?(i[f].p(g,_),B(i[f],1)):(i[f]=gt(g),i[f].c(),B(i[f],1),i[f].m(e.parentNode,e))}for(se(),f=r.length;f<i.length;f+=1)o(f);ue()}if(_&2){s=J(a[1]);let f;for(f=0;f<s.length;f+=1){const g=ht(a,s,f);u[f]?(u[f].p(g,_),B(u[f],1)):(u[f]=mt(g),u[f].c(),B(u[f],1),u[f].m(t.parentNode,t))}for(se(),f=s.length;f<u.length;f+=1)c(f);ue()}},i(a){if(!n){for(let _=0;_<r.length;_+=1)B(i[_]);for(let _=0;_<s.length;_+=1)B(u[_]);n=!0}},o(a){i=i.filter(Boolean);for(let _=0;_<i.length;_+=1)N(i[_]);u=u.filter(Boolean);for(let _=0;_<u.length;_+=1)N(u[_]);n=!1},d(a){a&&(b(e),b(t)),Re(i,a),Re(u,a)}}}function gt(l){let e,t;const n=[l[8]];let r={};for(let i=0;i<n.length;i+=1)r=Se(r,n[i]);return e=new Yn({props:r}),{c(){Y(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&4?Oe(n,[je(i[8])]):{};e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function mt(l){let e,t;const n=[l[5]];let r={};for(let i=0;i<n.length;i+=1)r=Se(r,n[i]);return e=new we({props:r}),{c(){Y(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,o){X(e,i,o),t=!0},p(i,o){const s=o&2?Oe(n,[je(i[5])]):{};e.$set(s)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){N(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function qn(l){let e,t,n,r;e=new we({props:{text:l[0]?"Edit":"Simulation",callback:l[4],style:`width: 100px; background-color: ${l[0]?"#3CB371":"#6495ED"};`}});let i=!l[0]&&_t(l);return{c(){Y(e.$$.fragment),t=x(),i&&i.c(),n=Q()},l(o){q(e.$$.fragment,o),t=M(o),i&&i.l(o),n=Q()},m(o,s){X(e,o,s),C(o,t,s),i&&i.m(o,s),C(o,n,s),r=!0},p(o,[s]){const u={};s&1&&(u.text=o[0]?"Edit":"Simulation"),s&1&&(u.callback=o[4]),s&1&&(u.style=`width: 100px; background-color: ${o[0]?"#3CB371":"#6495ED"};`),e.$set(u),o[0]?i&&(se(),N(i,1,1,()=>{i=null}),ue()):i?(i.p(o,s),s&1&&B(i,1)):(i=_t(o),i.c(),B(i,1),i.m(n.parentNode,n))},i(o){r||(B(e.$$.fragment,o),B(i),r=!0)},o(o){N(e.$$.fragment,o),N(i),r=!1},d(o){o&&(b(t),b(n)),G(e,o),i&&i.d(o)}}}function Xn(l,e,t){let n,r,i;he(l,U,u=>t(3,r=u)),he(l,De,u=>t(0,i=u));const o=[{text:"+ Customer",type:"CE",color:"#7FC8F8"},{text:"+ Edge",type:"LER",color:"#FFE45E"},{text:"+ Switch",type:"LSR",color:"#FF6392"}],s=()=>{Fe(De,i=!i,i),U.clearPackets()};return l.$$.update=()=>{l.$$.dirty&9&&t(1,n=[{text:"Clear Network",callback:()=>{if(i){alert("Network is locked.");return}confirm("Are you sure you want to clear the network?")&&U.clear()}},{text:"Clear Links",callback:()=>{if(i){alert("Network is locked.");return}confirm("Are you sure you want to clear the links?")&&U.clearLinks()}},{text:"Clear Tables",callback:()=>{if(i){alert("Network is locked.");return}confirm("Are you sure you want to clear the routing tables?")&&U.clearTables()}},{text:"Export",callback:()=>{const u={routers:r.routers.map(g=>{if(g instanceof de)return{...g,type:g.type,firstHop:Object.fromEntries(g.firstHop)};if(g instanceof ve)return{...g,type:g.type,FIB:Object.fromEntries(g.FIB.map),LIB:Object.fromEntries(g.LIB.map)};if(g instanceof Ne)return{...g,type:g.type,LIB:Object.fromEntries(g.LIB.map)}}),links:r.links.map(g=>({...g,source:g.source.id,target:g.target.id}))},c=JSON.stringify(u,null,2),a=new Blob([c],{type:"application/json"}),_=window.URL.createObjectURL(a),f=document.createElement("a");f.href=_,f.download="network.json",f.click(),window.URL.revokeObjectURL(_)}}])},[i,n,o,r,s]}class Gn extends ee{constructor(e){super(),te(this,e,Xn,qn,Z,{})}}function Wn(l){let e,t="Drag and drop routers to add them to the network.",n,r,i="Hold the shift key and drag routers to make links.",o,s,u="Hold the ctrl key and drag CE's to add destinations.",c,a,_="Double click a router or link to configure it.",f,g,p="The clear button will delete the entire network.",w,d,h="The export button will download your network as a .json file",m,v,F,z,I="Press Esc to close this popup.";return{c(){e=R("p"),e.textContent=t,n=x(),r=R("p"),r.textContent=i,o=x(),s=R("p"),s.textContent=u,c=x(),a=R("p"),a.textContent=_,f=x(),g=R("p"),g.textContent=p,w=x(),d=R("p"),d.textContent=h,m=x(),v=R("br"),F=x(),z=R("p"),z.textContent=I},l(y){e=D(y,"P",{"data-svelte-h":!0}),le(e)!=="svelte-bhocp0"&&(e.textContent=t),n=M(y),r=D(y,"P",{"data-svelte-h":!0}),le(r)!=="svelte-ddjc2m"&&(r.textContent=i),o=M(y),s=D(y,"P",{"data-svelte-h":!0}),le(s)!=="svelte-33j76o"&&(s.textContent=u),c=M(y),a=D(y,"P",{"data-svelte-h":!0}),le(a)!=="svelte-qvtprs"&&(a.textContent=_),f=M(y),g=D(y,"P",{"data-svelte-h":!0}),le(g)!=="svelte-vcl8s3"&&(g.textContent=p),w=M(y),d=D(y,"P",{"data-svelte-h":!0}),le(d)!=="svelte-1ww5ij7"&&(d.textContent=h),m=M(y),v=D(y,"BR",{}),F=M(y),z=D(y,"P",{"data-svelte-h":!0}),le(z)!=="svelte-1dvt5v1"&&(z.textContent=I)},m(y,P){C(y,e,P),C(y,n,P),C(y,r,P),C(y,o,P),C(y,s,P),C(y,c,P),C(y,a,P),C(y,f,P),C(y,g,P),C(y,w,P),C(y,d,P),C(y,m,P),C(y,v,P),C(y,F,P),C(y,z,P)},p:ne,d(y){y&&(b(e),b(n),b(r),b(o),b(s),b(c),b(a),b(f),b(g),b(w),b(d),b(m),b(v),b(F),b(z))}}}function Kn(l){let e,t,n,r,i,o;t=new we({props:{text:"Help",callback:l[1]}});function s(c){l[2](c)}let u={$$slots:{default:[Wn]},$$scope:{ctx:l}};return l[0]!==void 0&&(u.dialog=l[0]),r=new Ve({props:u}),fe.push(()=>ge(r,"dialog",s)),{c(){e=R("div"),Y(t.$$.fragment),n=x(),Y(r.$$.fragment)},l(c){e=D(c,"DIV",{});var a=A(e);q(t.$$.fragment,a),a.forEach(b),n=M(c),q(r.$$.fragment,c)},m(c,a){C(c,e,a),X(t,e,null),C(c,n,a),X(r,c,a),o=!0},p(c,[a]){const _={};a&1&&(_.callback=c[1]),t.$set(_);const f={};a&8&&(f.$$scope={dirty:a,ctx:c}),!i&&a&1&&(i=!0,f.dialog=c[0],_e(()=>i=!1)),r.$set(f)},i(c){o||(B(t.$$.fragment,c),B(r.$$.fragment,c),o=!0)},o(c){N(t.$$.fragment,c),N(r.$$.fragment,c),o=!1},d(c){c&&(b(e),b(n)),G(t),G(r,c)}}}function Jn(l,e,t){let n;const r=()=>{n.showModal()};function i(o){n=o,t(0,n)}return[n,r,i]}class Qn extends ee{constructor(e){super(),te(this,e,Jn,Kn,Z,{})}}function Zn(l){let e,t,n,r,i,o;return e=new we({props:{text:" - ",callback:l[1]}}),n=new we({props:{text:"Fullscreen",callback:l[2]}}),i=new we({props:{text:" + ",callback:l[3]}}),{c(){Y(e.$$.fragment),t=x(),Y(n.$$.fragment),r=x(),Y(i.$$.fragment)},l(s){q(e.$$.fragment,s),t=M(s),q(n.$$.fragment,s),r=M(s),q(i.$$.fragment,s)},m(s,u){X(e,s,u),C(s,t,u),X(n,s,u),C(s,r,u),X(i,s,u),o=!0},p(s,[u]){const c={};u&1&&(c.callback=s[1]),e.$set(c);const a={};u&1&&(a.callback=s[3]),i.$set(a)},i(s){o||(B(e.$$.fragment,s),B(n.$$.fragment,s),B(i.$$.fragment,s),o=!0)},o(s){N(e.$$.fragment,s),N(n.$$.fragment,s),N(i.$$.fragment,s),o=!1},d(s){s&&(b(t),b(r)),G(e,s),G(n,s),G(i,s)}}}function el(l,e,t){let{zoom:n}=e;const r=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(1.1,s)},i=async()=>{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()},o=()=>{const s={x:window.innerWidth/2,y:window.innerHeight/2};n(.9,s)};return l.$$set=s=>{"zoom"in s&&t(0,n=s.zoom)},[n,r,i,o]}class tl extends ee{constructor(e){super(),te(this,e,el,Zn,Z,{zoom:0})}}function bt(l,e,t){const n=l.slice();return n[5]=e[t],n}function kt(l,e,t){const n=l.slice();return n[8]=e[t],n}function vt(l,e,t){const n=l.slice();return n[11]=e[t],n}function $t(l,e){let t,n,r;return n=new Fn({props:{link:e[11]}}),{key:l,first:null,c(){t=Q(),Y(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.link=e[11]),n.$set(s)},i(i){r||(B(n.$$.fragment,i),r=!0)},o(i){N(n.$$.fragment,i),r=!1},d(i){i&&b(t),G(n,i)}}}function wt(l,e){let t,n,r;return n=new jn({props:{router:e[8]}}),{key:l,first:null,c(){t=Q(),Y(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.router=e[8]),n.$set(s)},i(i){r||(B(n.$$.fragment,i),r=!0)},o(i){N(n.$$.fragment,i),r=!1},d(i){i&&b(t),G(n,i)}}}function yt(l,e){let t,n,r;return n=new Mn({props:{packet:e[5]}}),{key:l,first:null,c(){t=Q(),Y(n.$$.fragment),this.h()},l(i){t=Q(),q(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,o){C(i,t,o),X(n,i,o),r=!0},p(i,o){e=i;const s={};o&2&&(s.packet=e[5]),n.$set(s)},i(i){r||(B(n.$$.fragment,i),r=!0)},o(i){N(n.$$.fragment,i),r=!1},d(i){i&&b(t),G(n,i)}}}function nl(l){let e=[],t=new Map,n,r=[],i=new Map,o,s=[],u=new Map,c,a,_=J(l[1].links);const f=h=>h[11].id;for(let h=0;h<_.length;h+=1){let m=vt(l,_,h),v=f(m);t.set(v,e[h]=$t(v,m))}let g=J(l[1].routers);const p=h=>h[8].id;for(let h=0;h<g.length;h+=1){let m=kt(l,g,h),v=p(m);i.set(v,r[h]=wt(v,m))}let w=J(l[1].packets);const d=h=>h[5].id;for(let h=0;h<w.length;h+=1){let m=bt(l,w,h),v=d(m);u.set(v,s[h]=yt(v,m))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();n=x();for(let h=0;h<r.length;h+=1)r[h].c();o=x();for(let h=0;h<s.length;h+=1)s[h].c();c=Q()},l(h){for(let m=0;m<e.length;m+=1)e[m].l(h);n=M(h);for(let m=0;m<r.length;m+=1)r[m].l(h);o=M(h);for(let m=0;m<s.length;m+=1)s[m].l(h);c=Q()},m(h,m){for(let v=0;v<e.length;v+=1)e[v]&&e[v].m(h,m);C(h,n,m);for(let v=0;v<r.length;v+=1)r[v]&&r[v].m(h,m);C(h,o,m);for(let v=0;v<s.length;v+=1)s[v]&&s[v].m(h,m);C(h,c,m),a=!0},p(h,m){m&2&&(_=J(h[1].links),se(),e=Me(e,m,f,1,h,_,t,n.parentNode,xe,$t,n,vt),ue()),m&2&&(g=J(h[1].routers),se(),r=Me(r,m,p,1,h,g,i,o.parentNode,xe,wt,o,kt),ue()),m&2&&(w=J(h[1].packets),se(),s=Me(s,m,d,1,h,w,u,c.parentNode,xe,yt,c,bt),ue())},i(h){if(!a){for(let m=0;m<_.length;m+=1)B(e[m]);for(let m=0;m<g.length;m+=1)B(r[m]);for(let m=0;m<w.length;m+=1)B(s[m]);a=!0}},o(h){for(let m=0;m<e.length;m+=1)N(e[m]);for(let m=0;m<r.length;m+=1)N(r[m]);for(let m=0;m<s.length;m+=1)N(s[m]);a=!1},d(h){h&&(b(n),b(o),b(c));for(let m=0;m<e.length;m+=1)e[m].d(h);for(let m=0;m<r.length;m+=1)r[m].d(h);for(let m=0;m<s.length;m+=1)s[m].d(h)}}}function ll(l){let e,t,n,r,i,o,s,u,c,a,_,f,g,p,w,d,h;function m(I){l[2](I)}let v={$$slots:{default:[nl]},$$scope:{ctx:l}};l[0]!==void 0&&(v.zoom=l[0]),n=new wn({props:v}),fe.push(()=>ge(n,"zoom",m)),s=new Gn({}),a=new Qn({});function F(I){l[3](I)}let z={};return l[0]!==void 0&&(z.zoom=l[0]),g=new tl({props:z}),fe.push(()=>ge(g,"zoom",F)),d=new Nn({}),{c(){e=R("div"),t=R("div"),Y(n.$$.fragment),i=x(),o=R("div"),Y(s.$$.fragment),u=x(),c=R("div"),Y(a.$$.fragment),_=x(),f=R("div"),Y(g.$$.fragment),w=x(),Y(d.$$.fragment),this.h()},l(I){e=D(I,"DIV",{id:!0,class:!0});var y=A(e);t=D(y,"DIV",{id:!0,class:!0});var P=A(t);q(n.$$.fragment,P),i=M(P),o=D(P,"DIV",{id:!0,class:!0});var j=A(o);q(s.$$.fragment,j),j.forEach(b),u=M(P),c=D(P,"DIV",{id:!0,class:!0});var $=A(c);q(a.$$.fragment,$),$.forEach(b),_=M(P),f=D(P,"DIV",{id:!0,class:!0});var O=A(f);q(g.$$.fragment,O),O.forEach(b),P.forEach(b),w=M(y),q(d.$$.fragment,y),y.forEach(b),this.h()},h(){k(o,"id","top-left-bar"),k(o,"class","absolute-flex svelte-1kpnzxr"),k(c,"id","bottom-left-bar"),k(c,"class","absolute-flex svelte-1kpnzxr"),k(f,"id","bottom-right-bar"),k(f,"class","absolute-flex svelte-1kpnzxr"),k(t,"id","network"),k(t,"class","svelte-1kpnzxr"),k(e,"id","mpls"),k(e,"class","svelte-1kpnzxr")},m(I,y){C(I,e,y),L(e,t),X(n,t,null),L(t,i),L(t,o),X(s,o,null),L(t,u),L(t,c),X(a,c,null),L(t,_),L(t,f),X(g,f,null),L(e,w),X(d,e,null),h=!0},p(I,[y]){const P={};y&16386&&(P.$$scope={dirty:y,ctx:I}),!r&&y&1&&(r=!0,P.zoom=I[0],_e(()=>r=!1)),n.$set(P);const j={};!p&&y&1&&(p=!0,j.zoom=I[0],_e(()=>p=!1)),g.$set(j)},i(I){h||(B(n.$$.fragment,I),B(s.$$.fragment,I),B(a.$$.fragment,I),B(g.$$.fragment,I),B(d.$$.fragment,I),h=!0)},o(I){N(n.$$.fragment,I),N(s.$$.fragment,I),N(a.$$.fragment,I),N(g.$$.fragment,I),N(d.$$.fragment,I),h=!1},d(I){I&&b(e),G(n),G(s),G(a),G(g),G(d)}}}function rl(l,e,t){let n,r;he(l,Te,u=>t(4,n=u)),he(l,U,u=>t(1,r=u));let i;Bt(()=>{window.addEventListener("visibilitychanged",()=>{Fe(Te,n.running=!document.hidden,n)})});function o(u){i=u,t(0,i)}function s(u){i=u,t(0,i)}return[i,r,o,s]}class il extends ee{constructor(e){super(),te(this,e,rl,ll,Z,{})}}function ol(l){let e,t;return e=new il({}),{c(){Y(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p:ne,i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}class gl extends ee{constructor(e){super(),te(this,e,null,ol,Z,{})}}export{gl as component};
